repo_owner,repo_name,commit_hash,author_name,author_email,author_date,committer_name,committer_email,committer_date,message,filenames,touches_rmd,touches_r,touches_r_or_rmd,is_merge,added,deleted,changed,diff
Triangle-Modeling-and-Analytics,TRMG2,7e3017f0cb7bcdb616aaa79ade0030386b0d6730,Si Shi,si_shi_itre@ncsu.edu,2024-07-18T15:08:13Z,Si Shi,si_shi_itre@ncsu.edu,2024-07-18T15:08:13Z,Fix scenario comparison tool,src/utils/ScenarioComparison.rsc,False,False,False,False,27,15,42,"---FILE: src/utils/ScenarioComparison.rsc---
@@ -169,7 +169,7 @@ Macro ""Compare Summary Tables"" (MacroOpts)
         {""/output/_summaries/resident_nhb/nhb_trip_stats_by_modeperiod.csv"", {""trip_type"", ""period"", ""mode""}, {""Sum"", ""SumDiag"", ""PctDiag""}},
         {""/output/_summaries/resident_nhb/nhb_trip_stats_by_type.csv"", {""matrix""}, {""Sum"", ""SumDiag"", ""PctDiag"", ""avg_length_mi"", ""avg_time_min""}},
         {""/output/sedata/scenario_se.bin"", {""TAZ""}, {""HH"", ""HH_POP"", ""Median_Inc"", ""Industry"", ""Office"", ""Service_RateLow"", ""Service_RateHigh"", ""Retail""}},
-        {""/output/networks/scenario_links.bin"", {""ID""}, {""Total_Flow_Daily"", ""Total_VMT_Daily"", ""Total_VHT_Daily"", ""Total_Delay_Daily""}},
+        {""/output/networks/scenario_links.bin"", {""ID""}, {""Total_Flow_Daily"", ""Total_VMT_Daily"", ""Total_VHT_Daily"", ""Total_Delay_Daily"", ""AB_TransitFlow""}},
         {""/output/_summaries/overall_mode_shares_bytaz.bin"", {""TAZ""}, {""auto"", ""transit"", ""nm""}},
         {""/output/_summaries/overall_mode_shares_bycounty.bin"", {""County""}, {""auto"", ""transit"", ""nm""}},
         {""/output/_summaries/hhstrata.csv"", {""market_segment""}, {""count""}}
@@ -226,21 +226,32 @@ Macro ""Diff Tables"" (MacroOpts)
     end
 
     // Create tables and rename/add fields
+    // Rename all columns as sometimes TC uses random names like Table_21 instead of Table 1
+    out_fields = id_cols + cols_to_diff
     tbl1 = CreateObject(""Table"", {FileName: table1})
-    tbl1 = tbl1.Export({FieldNames: id_cols + cols_to_diff})
+    tbl1 = tbl1.Export({FieldNames: out_fields})
     tbl2 = CreateObject(""Table"", table2)
-    tbl2 = tbl2.Export({FieldNames: id_cols + cols_to_diff})
-    for col in cols_to_diff do
+    tbl2 = tbl2.Export({FieldNames: out_fields})
+    
+    for col in out_fields do
         tbl1.ChangeField({FieldName: col, NewName: col + ""_ref"", Type: ""real""})
         tbl2.ChangeField({FieldName: col, NewName: col + ""_new"", Type: ""real""})
         tbl2.AddField(col + ""_diff"")
     end
+
+    // Rebuild join fields
+    left_id_cols = null
+    right_id_cols = null
+    for field in id_cols do
+        left_id_cols = left_id_cols + {field + ""_ref""}
+        right_id_cols = right_id_cols + {field + ""_new""}
+    end
     
     // Calculate differences
     tbl3 = tbl1.Join({
         Table: tbl2,
-        LeftFields: id_cols,
-        RightFields: id_cols
+        LeftFields: left_id_cols,
+        RightFields: right_id_cols
     })
     for col in cols_to_diff do
         tbl3.(col + ""_diff"") = tbl3.(col + ""_new"") - tbl3.(col + ""_ref"")
@@ -250,8 +261,8 @@ Macro ""Diff Tables"" (MacroOpts)
     // Clean up id name columns
     tbl4 = CreateObject(""Table"", out_file)
     for col in id_cols do
-        tbl4.RenameField({FieldName: ""Table_2."" + col, NewName: col})
-        tbl4.DropFields(""Table_3."" + col)
+        tbl4.RenameField({FieldName: col + ""_ref"", NewName: col})
+        tbl4.DropFields(col + ""_new"")
     end
 endmacro
 
@@ -341,13 +352,7 @@ Macro ""Compare Link Data"" (MacroOpts)
     
     ref_scen = MacroOpts.ref_scen
     new_scen = MacroOpts.new_scen
-    sub_poly = MacroOpts.sub_poly
-
-    // Call the link layer Diff tool on both highway layers
-    RunMacro(""Diff Line Layers"", {
-        old_dbd: ref_scen + ""/input/networks/scenario_links.dbd"",
-        new_dbd: new_scen + ""/input/networks/scenario_links.dbd""
-    })
+    sub_poly = MacroOpts.sub_poly    
 
     comp_dir = new_scen + ""/comparison_outputs""
     map_dir = comp_dir + ""/maps""
@@ -434,6 +439,13 @@ Macro ""Compare Link Data"" (MacroOpts)
         map.CreateLegend()
         map.Save(map_dir + ""/"" + field + "" Differences.map"")
     end
+
+    // Call the link layer Diff tool on both highway layers
+    RunMacro(""Diff Line Layers"", {
+        old_dbd: ref_scen + ""/input/networks/scenario_links.dbd"",
+        new_dbd: new_scen + ""/input/networks/scenario_links.dbd""
+    })
+
 endmacro
 
 /*"
Triangle-Modeling-and-Analytics,TRMG2,404ed486b7fc3c6e494e23b0792a4e232d4ab577,Si Shi,si_shi_itre@ncsu.edu,2024-07-16T17:54:38Z,Si Shi,si_shi_itre@ncsu.edu,2024-07-16T17:54:38Z,"Reporting tools fix

- Revise mode share summary
- Fix bug in the transit comparison tool when switch to table class
- Update the transit coverage tool to accommodate new SE data change",src/19 - Summaries.rsc;src/utils/TRMTransitCoverage_Poverty.rsc;src/utils/transittool.rsc,False,False,False,False,58,34,92,"---FILE: src/19 - Summaries.rsc---
@@ -2722,14 +2722,14 @@ Macro ""Performance Measures Reports"" (Args)
     // Build an equivalency array that maps modes to summary mode levels
     equiv = {
       sov: ""sov"",
-      auto: ""sov"",
+      auto: ""sov"", //university auto mode is set to sov
       hov2: ""hov"",
       hov3: ""hov"",
       walk: ""nm"",
       bike: ""nm"",
       walkbike: ""nm"",
-      auto: ""hov"",
-      transit: ""alltransit""
+      auto_pay: ""hov"", //NHB auto pay mode is set to hov
+      transit: ""nhballtransit""
     }
     transit_modes = RunMacro(""Get Transit Modes"", mode_table)
     for access_mode in access_modes do
@@ -2764,12 +2764,12 @@ Macro ""Performance Measures Reports"" (Args)
       result = RunMacro(""Summarize HB Univ RowSums"", {equiv: equiv, group: group, trip_dir: trip_dir, result: result})
 
       // Resident HB nm trips
-      trip_dir = out_dir + ""/resident/nonmotorized""
-      result = RunMacro(""Summarize HB Univ RowSums"", {equiv: equiv, group: group, trip_dir: trip_dir, result: result})
+      trip_mtx = out_dir + ""/resident/nonmotorized/nm_gravity.mtx""
+      result = RunMacro(""Summarize HB NM RowSums"", {group: group, trip_mtx: trip_mtx, result: result})
 
       // University trips
       trip_dir = out_dir + ""/university/mode""
-      result = RunMacro(""Summarize HB Univ RowSums"", {equiv: equiv, group: group, trip_dir: trip_dir, result: result})
+      if group <> ""W_HB_W"" then result = RunMacro(""Summarize HB Univ RowSums"", {equiv: equiv, group: group, trip_dir: trip_dir, result: result})
 
       // NHB trips
       trip_bin = out_dir + ""/resident/nhb/dc/NHBTripsForDC.bin""
@@ -2798,21 +2798,12 @@ Macro ""Summarize HB Univ RowSums"" (MacroOpts)
   mtx_files = RunMacro(""Catalog Files"", {dir: trip_dir, ext: ""mtx""})
   for mtx_file in mtx_files do
     if group = ""PM"" and position(mtx_file, group) = 0 then continue
-    if group = ""W_HB_W"" and position(mtx_file, group) = 0  and right(mtx_file, 14) <> ""nm_gravity.mtx"" then continue
+    if group = ""W_HB_W"" and position(mtx_file, group) = 0 then continue
 
     mtx = CreateObject(""Matrix"", mtx_file)
     core_names = mtx.GetCoreNames()
     for core_name in core_names do
-      // hb nm matrices need special handling, core name does not have mode info
-      if right(mtx_file, 14) = ""nm_gravity.mtx"" then do 
-        equiv.(core_name) = ""nm"" 
-        parts = ParseString(core_name, ""_"")
-        if group = ""Daily"" and ArrayLength(parts) > 4 then continue
-          else if group = ""PM"" and parts[5] <> ""PM"" then continue
-          else if group = ""W_HB_W"" and position(core_name, group) = null then continue
-      end
-
-      // hb motorized and univ can be handled below
+      // hb motorized and univ can be handled below, core names have mode info
       if equiv.(core_name) = null then continue
       out_name = equiv.(core_name) + ""_"" + group
       v = mtx.GetVector({Core: core_name, Marginal: ""Row Sum""})
@@ -2825,6 +2816,32 @@ Macro ""Summarize HB Univ RowSums"" (MacroOpts)
   return(result)
 endmacro
 
+Macro ""Summarize HB NM RowSums"" (MacroOpts)
+  
+  // hb nm matrix needs special handling, core names do not have mode info
+  trip_mtx = MacroOpts.trip_mtx
+  group = MacroOpts.group
+  result = MacroOpts.result
+
+  mtx = CreateObject(""Matrix"", mtx_file)
+  core_names = mtx.GetCoreNames()
+  for core_name in core_names do
+    parts = ParseString(core_name, ""_"")
+    if group = ""Daily"" and ArrayLength(parts) <> 4 then continue
+      else if group = ""PM"" and parts[5] <> ""PM"" then continue
+      else if group = ""W_HB_W"" and core_name <> ""W_HB_W_All"" then continue
+    end
+
+    out_name = ""nm_"" + group
+    v = mtx.GetVector({Core: core_name, Marginal: ""Row Sum""})
+
+    if TypeOf(result.(out_name)) = ""null""
+      then result.(out_name) = nz(v)
+      else result.(out_name) = result.(out_name) + nz(v)
+
+  return(result)
+endmacro
+
 Macro ""Summarize NHB"" (MacroOpts)
   
   equiv = MacroOpts.equiv
@@ -2836,7 +2853,8 @@ Macro ""Summarize NHB"" (MacroOpts)
   flds = nhb.GetFieldNames()
   for fld in flds do
     parts = ParseString(fld, ""_"")
-    if ArrayLength(parts) = 3 then mode = parts[2] else if ArrayLength(parts) = 4 then mode = parts[3] else mode = ""TAZ""// set mode
+    mode = ""default""
+    if ArrayLength(parts) = 3 then mode = parts[2] else if ArrayLength(parts) = 4 then mode = parts[3] else if ArrayLength(parts) = 5 then mode = ""auto_pay""// set mode
     if equiv.(mode) = null then continue // if fld is not trip fields
     if group = ""PM"" and right(fld, 2) <> ""PM"" then continue // if group = PM then only add PM flds
     
@@ -2846,7 +2864,6 @@ Macro ""Summarize NHB"" (MacroOpts)
     if TypeOf(result.(out_name)) = ""null""
         then result.(out_name) = nz(v)
         else result.(out_name) = result.(out_name) + nz(v)
-
   end
   return(result)
 

---FILE: src/utils/TRMTransitCoverage_Poverty.rsc---
@@ -185,13 +185,13 @@ Macro ""Poverty_HH_Estimator_Route"" (Args, BG_Layer_CDF, Census_Poverty_Data_Dir,
     SE = OpenTable(""SE"",""FFB"",{se_file,})
     jn_vw1 = JoinViews(""Buffer_Poverty"", TAZ_Buffer+"".AREA_1"", TAZ_Poverty + "".AREA_1"",)
     jn_vw2 = JoinViews(""SE_Buffer_Poverty"", SE + "".TAZ"", jn_vw1 + ""."" + TAZ_Buffer + "".AREA_1"",)
-    jn_vw3= JoinViews(""TAZ_SE_Buffer_Poverty"", tlyr + "".ID"", jn_vw2 + ""."" + SE + "".TAZ"", )
-    CreateExpression(jn_vw3, ""BGPoverty_Pct"", ""if BG_TotHH > 0 then BG_PovertyHH/BG_TotHH else 0"",)
-    CreateExpression(jn_vw3, ""Total_HH"", ""HH * PERCENT_1"",)
-    CreateExpression(jn_vw3, ""Poverty_HH"", ""BGPoverty_Pct * HH * PERCENT_1"",)
-    CreateExpression(jn_vw3, ""Poverty_Pct"", ""Poverty_HH/HH"",)
+    //jn_vw3= JoinViews(""TAZ_SE_Buffer_Poverty"", tlyr + "".ID"", jn_vw2 + ""."" + SE + "".TAZ"", ) //The equity summary will add MPO and county info to the SE table so no need to use TAZ layer
+    CreateExpression(jn_vw2, ""BGPoverty_Pct"", ""if BG_TotHH > 0 then BG_PovertyHH/BG_TotHH else 0"",)
+    CreateExpression(jn_vw2, ""Total_HH"", ""HH * PERCENT_1"",)
+    CreateExpression(jn_vw2, ""Poverty_HH"", ""BGPoverty_Pct * HH * PERCENT_1"",)
+    CreateExpression(jn_vw2, ""Poverty_Pct"", ""Poverty_HH/HH"",)
     output_name1 = output_dir + ""/"" + TOD + ""_Route_"" + mode +""_PovertyReachedin"" + R2S(RouteBuffer) + ""Mi.csv""
-    ExportView(jn_vw3 + ""|"", ""CSV"", output_name1, 
+    ExportView(jn_vw2 + ""|"", ""CSV"", output_name1, 
               {""TAZ"", ""MPO"", ""County"", ""Total_HH"", ""Poverty_Pct"", ""Poverty_HH""}, 
               {{""CSV Header"", ""True""}, { ""Row Order"", {{""TAZ"", ""Ascending""}} }})
 
@@ -321,13 +321,13 @@ Macro ""Poverty_HH_Estimator_Stop"" (Args, BG_Layer_CDF, Census_Poverty_Data_Dir,
     SE = OpenTable(""SE"",""FFB"",{se_file,})
     jn_vw1 = JoinViews(""Buffer_Poverty"", TAZ_Buffer+"".AREA_1"", TAZ_Poverty + "".AREA_1"",)
     jn_vw2 = JoinViews(""SE_Buffer_Poverty"", SE + "".TAZ"", jn_vw1 + ""."" + TAZ_Buffer + "".AREA_1"",)
-    jn_vw3= JoinViews(""TAZ_SE_Buffer_Poverty"", tlyr + "".ID"", jn_vw2 + ""."" + SE + "".TAZ"", )
-    CreateExpression(jn_vw3, ""BGPoverty_Pct"", ""if BG_TotHH > 0 then BG_PovertyHH/BG_TotHH else 0"",)
-    CreateExpression(jn_vw3, ""Total_HH"", ""HH * PERCENT_1"",)
-    CreateExpression(jn_vw3, ""Poverty_HH"", ""BGPoverty_Pct * HH * PERCENT_1"",)
-    CreateExpression(jn_vw3, ""Poverty_Pct"", ""Poverty_HH/HH"",)
+    //jn_vw3= JoinViews(""TAZ_SE_Buffer_Poverty"", tlyr + "".ID"", jn_vw2 + ""."" + SE + "".TAZ"", )
+    CreateExpression(jn_vw2, ""BGPoverty_Pct"", ""if BG_TotHH > 0 then BG_PovertyHH/BG_TotHH else 0"",)
+    CreateExpression(jn_vw2, ""Total_HH"", ""HH * PERCENT_1"",)
+    CreateExpression(jn_vw2, ""Poverty_HH"", ""BGPoverty_Pct * HH * PERCENT_1"",)
+    CreateExpression(jn_vw2, ""Poverty_Pct"", ""Poverty_HH/HH"",)
     output_name1 = output_dir + ""/"" + TOD + ""_Stop_"" + mode +""_PovertyReachedin"" + R2S(StopBuffer) + ""Mi.csv""
-    ExportView(jn_vw3 + ""|"", ""CSV"", output_name1, 
+    ExportView(jn_vw2 + ""|"", ""CSV"", output_name1, 
               {""TAZ"", ""MPO"", ""County"", ""Total_HH"", ""Poverty_Pct"", ""Poverty_HH""}, 
               {{""CSV Header"", ""True""}, { ""Row Order"", {{""TAZ"", ""Ascending""}} }})
 

---FILE: src/utils/transittool.rsc---
@@ -211,11 +211,12 @@ Macro ""TransitScenarioComparison"" (Args, S2_Dir, TOD)
         {FieldName: ""PctDiff_access_pop"", Type: ""real""}
       }
       df_S2.AddFields({Fields: fields})
+      df_S2.RenameField({FieldName:""TAZ"", NewName: ""TAZ_todelete""})
       
       join = df_S1.Join({
       Table: df_S2,
       LeftFields: ""TAZ"",
-      RightFields: ""TAZ""
+      RightFields: ""TAZ_todelete""
       })
 
       names = join.GetFieldNames()
@@ -231,11 +232,17 @@ Macro ""TransitScenarioComparison"" (Args, S2_Dir, TOD)
       join.PctDiff_access_job = if join.(names[11]) > 0 then join.Diff_access_job / join.(names[11]) else null
       join.PctDiff_access_pop = if join.(names[12])  >0 then join.Diff_access_pop / join.(names[12]) else null
 
-      join.Export({FileName: S1_tod_dir + ""\\"" + comp_string + ""_"" + TOD + ""_comparison.csv""})
+      join.Export({FileName: S1_tod_dir + ""\\temp.csv""})
       df_S1 = null
       df_S2 = null
       join = null
-      
+      df = CreateObject(""Table"", S1_tod_dir + ""\\temp.csv"")
+      df.DropFields(""TAZ_todelete"")
+      df.Export({FileName: S1_tod_dir + ""\\"" + comp_string + ""_"" + TOD + ""_comparison.csv""})
+      df = null
+      DeleteFile(S1_tod_dir + ""\\temp.csv"")
+      DeleteFile(S1_tod_dir + ""\\temp.dcc"")
+
       //4.2 Compare route level difference
       //    Set up file path
       s1_routefolder = S1_Dir + ""/output/_summaries/transit"""
Triangle-Modeling-and-Analytics,TRMG2,6ad4b2c34bd0a731095cd345d4e2d28d2cbd57c0,Si Shi,si_shi_itre@ncsu.edu,2024-07-11T16:26:34Z,Si Shi,si_shi_itre@ncsu.edu,2024-07-11T16:26:34Z,"Network fix and 2055 preliminary SE data

- Fix the disconnected CC in TAZ 2651
- Include the 2055 preliminary SE data",master/networks/master_links.BIN;master/networks/master_links.BX;master/networks/master_links.dln;master/networks/master_links.kln;master/networks/master_links.pts;master/networks/master_links_.BIN;master/networks/master_links_.BX;master/sedata/se_2055.DCB;master/sedata/se_2055.bin;trmg2.scenarios,False,False,False,False,50,1,51,"---FILE: master/sedata/se_2055.DCB---
@@ -0,0 +1,49 @@
+
+238,codepage=65001
+""TAZ"",I,1,4,0,11,0,,"""","""",,""Sum"",
+""Type"",C,5,10,0,10,0,,"""","""",,""Copy"",
+""HH"",I,15,4,0,11,0,,"""","""",,""Sum"",
+""HH_POP"",I,19,4,0,11,0,,"""","""",,""Sum"",
+""Median_Inc"",I,23,4,0,11,0,,"""","""",,""Sum"",
+""Pct_Worker"",I,27,4,0,11,0,,"""","""",,""Sum"",
+""Pct_Child"",R,31,8,0,15,4,,"""","""",,""Sum"",
+""Pct_Senior"",R,39,8,0,15,4,,"""","""",,""Sum"",
+""Industry"",I,47,4,0,11,0,,"""","""",,""Sum"",
+""Office"",I,51,4,0,11,0,,"""","""",,""Sum"",
+""Service_RateLow"",I,55,4,0,11,0,,"""","""",,""Sum"",
+""Service_RateHigh"",I,59,4,0,11,0,,"""","""",,""Sum"",
+""Retail"",I,63,4,0,11,0,,"""","""",,""Sum"",
+""PctHighPay"",I,67,4,0,11,0,,"""","""",,""Sum"",
+""StudGQ_NCSU"",I,71,4,0,11,0,,"""","""",,""Sum"",
+""StudGQ_UNC"",I,75,4,0,11,0,,"""","""",,""Sum"",
+""StudGQ_DUKE"",I,79,4,0,11,0,,"""","""",,""Sum"",
+""StudGQ_NCCU"",I,83,4,0,11,0,,"""","""",,""Sum"",
+""StudOff_NCSU"",I,87,4,0,11,0,,"""","""",,""Sum"",
+""StudOff_UNC"",I,91,4,0,11,0,,"""","""",,""Sum"",
+""StudOff_DUKE"",I,95,4,0,11,0,,"""","""",,""Sum"",
+""StudOff_NCCU"",I,99,4,0,11,0,,"""","""",,""Sum"",
+""BuildingS_NCSU"",I,103,4,0,11,0,,"""","""",,""Sum"",
+""BuildingS_UNC"",I,107,4,0,11,0,,"""","""",,""Sum"",
+""BuildingS_DUKE"",I,111,4,0,11,0,,"""","""",,""Sum"",
+""BuildingS_NCCU"",I,115,4,0,11,0,,"""","""",,""Sum"",
+""K12"",I,119,4,0,11,0,,"""","""",,""Copy"",
+""CollegeOn"",I,123,4,0,11,0,,"""","""",,""Sum"",
+""CollegeOff"",I,127,4,0,11,0,,"""","""",,""Sum"",
+""Hospital"",I,131,4,0,8,0,,"""","""",,""Sum"",
+""ParkDistrict"",I,135,4,0,11,0,,"""","""",,""Sum"",
+""ParkCostW"",I,139,4,0,11,0,,"""","""",,""Sum"",
+""ParkCostU"",I,143,4,0,11,0,,"""","""",,""Sum"",
+""ParkCostO"",I,147,4,0,11,0,,"""","""",,""Sum"",
+""EmpSpaces"",I,151,4,0,11,0,,"""","""",,""Sum"",
+""StudSpaces"",I,155,4,0,11,0,,"""","""",,""Sum"",
+""OtherSpaces"",I,159,4,0,11,0,,"""","""",,""Sum"",
+""SParking"",I,163,4,0,11,0,,"""","""",,""Sum"",
+""Enplanements"",I,167,4,0,8,0,,"""","""",,""Sum"",
+""AWDT"",I,171,4,0,11,0,,"""","""",,""Sum"",
+""IEEI_Distance"",C,175,16,0,16,0,,"""","""",,""Copy"",
+""PCT_AUTO_EE"",R,191,8,0,15,2,,"""","""",,""Sum"",
+""PCT_AUTO_IEEI"",R,199,8,0,10,2,,"""","""",,""Sum"",
+""PCT_CVSUT_EE"",R,207,8,0,15,2,,"""","""",,""Sum"",
+""PCT_CVMUT_EE"",R,215,8,0,15,2,,"""","""",,""Sum"",
+""PCT_CVSUT_IEEI"",R,223,8,0,15,2,,"""","""",,""Sum"",
+""PCT_CVMUT_IEEI"",R,231,8,0,15,2,,"""","""",,""Sum"",

---FILE: trmg2.scenarios---
@@ -10,7 +10,7 @@ EndScenario
     
 Scenario ""2055""
     
-    [Master SE] = ""%Master Folder%\\sedata\\se_2020.bin""
+    [Master SE] = ""%Master Folder%\\sedata\\se_2055.bin""
     [Scenario Folder] = ""%Scenarios Folder%\\2055""
     InitCongTimes = ""%Input Folder%\\networks\\init_cong_time_2050.bin""
 EndScenario"
Triangle-Modeling-and-Analytics,TRMG2,2f212aae1484c2e2a564cfe58d229a7d264ecb38,Kyle Ward,kyleward084@gmail.com,2024-07-10T20:24:26Z,Kyle Ward,kyleward084@gmail.com,2024-07-10T20:24:26Z,"Set threads to 1 or PM and NT pnr skim

This prevents differences introduced by hyperthreading with a fixed pnr usage table.",src/02 - Network Calculations.rsc;src/10 - Skimming.rsc,False,False,False,False,10,0,10,"---FILE: src/02 - Network Calculations.rsc---
@@ -1251,6 +1251,9 @@ Macro ""Set Route Network"" (Args, opts)
             if GetFileInfo(Args.(""ReturnParkingLotUsed""+transit_mode)) <> null then do
                 opts.ParkingUsage = Args.(""ReturnParkingLotUsed""+transit_mode)
             end
+            // In the PM and NT, since the PNR is fixed for the day, we need to
+            // make sure the parking lot can be used for the return trip.
+            opts.MaxDriveTime = 999
             o.DriveEgress(opts)
         end
         else 

---FILE: src/10 - Skimming.rsc---
@@ -280,7 +280,14 @@ Macro ""Create Transit Skims"" (Args, overrides)
                     tmpAMmtx = GetTempFileName(""*.mtx"")
                     obj.ReportAccessParkMatrix({MatrixFile: tmpAMmtx})
                 end
+
+                // To avoid hyperthreading issues leading to slight differences
+                // only use one thread for the skim calculation for PM and NT.
+                if (period = ""PM"" or period = ""NT"") and access = ""pnr"" then do
+                    SetNumThreads(1)
+                end
                 obj.Run()
+                SetNumThreads(GetMaxNumThreads())
                 obj = null
                 if access = ""pnr"" and period = ""AM"" then do // for AM pnr skimming, open the parking lot matrix and transpose
                     m = CreateObject(""Matrix"", tmpAMmtx)"
Triangle-Modeling-and-Analytics,TRMG2,a487b6fc5b7e142e35a5d2a39dfe16ea8f927c3b,Si Shi,si_shi_itre@ncsu.edu,2024-06-26T18:42:22Z,Si Shi,si_shi_itre@ncsu.edu,2024-06-26T18:42:22Z,"Upgrade routes to TC10 and fix external model delete file issue

- External model will crash when try to delete a temporary matrix file. This commit fix this issue by commenting the line out.
- Upgrade master route layer to TC10",master/networks/master_routes.rtg;master/networks/master_routes.rts;master/networks/master_routesL.BX;master/networks/master_routesL.bin;master/networks/master_routesR.BX;master/networks/master_routesR.bin;master/networks/master_routesS.lok;master/networks/master_routesS.r0;src/utils/utils.rsc,False,False,False,False,6,5,11,"---FILE: src/utils/utils.rsc---
@@ -1617,7 +1617,7 @@ Macro ""Count Difference Map"" (macro_opts)
   )
 
   // Set color theme line styles and colors
-  line_colors =	{
+  line_colors = {
     ColorRGB(17733,30069,46260),
     ColorRGB(29812,44461,53713),
     ColorRGB(43947,55769,59881),
@@ -2246,12 +2246,13 @@ Macro ""Gravity2"" (MacroOpts)
     SetDataVectors(se_vw + ""|sel"", data, )
 
     // Create the gravity object
-    temp_mtx = Substitute(output_matrix, "".mtx"", String(i) + "".mtx"", )
-    temp_mtxs = temp_mtxs + {temp_mtx}
+//    temp_mtx2 = Substitute(output_matrix, "".mtx"", String(i) + "".mtx"", )
+    temp_mtx2 = GetTempFileName(""*.mtx"")
+    temp_mtxs = temp_mtxs + {temp_mtx2}
     obj = CreateObject(""Distribution.Gravity"")
     obj.DataSource = {TableName: se_file}
     obj.OutputMatrix({
-      MatrixFile: temp_mtx,
+      MatrixFile: temp_mtx2,
       MatrixLabel: ""Gravity Matrix"",
       Compression: ""true"",
       ColumnMajor: ""false""
@@ -2311,7 +2312,7 @@ Macro ""Gravity2"" (MacroOpts)
 
       temp_mtx = null
       temp_core = null
-      DeleteFile(temp_mtx_file)
+//      DeleteFile(temp_mtx_file)
     end
   end
 "
Triangle-Modeling-and-Analytics,TRMG2,5c051482c0831737db6abce0a26a878e5cdea85a,Kyle Ward,kyleward084@gmail.com,2024-06-11T14:30:21Z,Kyle Ward,kyleward084@gmail.com,2024-06-11T14:30:21Z,"Enhance fixed OD multi tool

You can now include multiple project IDs on the same row. Each row is a separate scenario, and all projects listed on that row will either be included or removed depending on what option you chose.",src/utils/FixedODAssignment.rsc,False,False,False,False,58,36,94,"---FILE: src/utils/FixedODAssignment.rsc---
@@ -213,22 +213,26 @@ Macro ""FixedOD Multiple Projects"" (MacroOpts)
     mr = null
 
     proj_tbl = CreateObject(""Table"", proj_list)
-    proj_ids = proj_tbl.ProjID
-    if proj_ids.type <> ""string"" then proj_ids = String(proj_ids)
-
-    for proj_id in proj_ids do
-      MacroOpts.proj_id = proj_id
+    data = proj_tbl.GetDataVectors()
+    // for each row in the project list
+    for i = 1 to data[1][2].length do
+      // create an array of all project IDs in that row
+      for j = 1 to data.length do
+        proj_id = data[j][2][i]
+        if TypeOf(proj_id) = ""null"" then continue
+        if TypeOf(proj_id) <> ""string"" then proj_id = String(proj_id)
+        proj_ids = proj_ids + {proj_id}
+      end
+      
+      MacroOpts.proj_ids = proj_ids
       RunMacro(""Create FixedOD Project Scenario"", MacroOpts)
       RunMacro(""Fixed OD Assignment"", MacroOpts)
-
       // Remove the scenario from the flowchart
       mr = CreateObject(""Model.Runtime"")
       {, new_scen_name} = mr.GetScenario()
-      // mr.SetScenario(new_scen_name)
       mr.DeleteScenario(new_scen_name)
       mr.SetScenario(ref_scen_name)
     end
-
 endmacro
 
 /*
@@ -239,14 +243,26 @@ Macro ""Create FixedOD Project Scenario"" (MacroOpts)
 
     ref_scen_dir = MacroOpts.ref_scen_dir
     ref_scen_name = MacroOpts.ref_scen_name
-    proj_list = MacroOpts.proj_list
-    proj_id = MacroOpts.proj_id
+    proj_ids = MacroOpts.proj_ids
     add_or_remove = MacroOpts.add_or_remove
     
     // create the directory and copy project lists over
+    scen_name_suffix = proj_ids[1]
     if add_or_remove = ""add""
-      then new_scen_dir = ref_scen_dir + ""_plus_"" + proj_id
-      else new_scen_dir = ref_scen_dir + ""_minus_"" + proj_id
+      then new_scen_dir = ref_scen_dir + ""_plus_"" + scen_name_suffix
+      else new_scen_dir = ref_scen_dir + ""_minus_"" + scen_name_suffix
+    // Multiple rows could start with the same project ID and include
+    // different projects. If the directory already exists, add a number
+    // to the end of the directory name to make it unique. 
+    if GetDirectoryInfo(new_scen_dir, ""All"") <> null then do
+      for i = 1 to 1000 do
+        temp = new_scen_dir + ""_"" + String(i)
+        if GetDirectoryInfo(temp, ""All"") = null then do
+          new_scen_dir = temp
+          break
+        end
+      end
+    end
     RunMacro(""Create Directory"", new_scen_dir)
     parts = ParseString(new_scen_dir, ""\\"")
     new_scen_name = parts[parts.length]
@@ -259,36 +275,42 @@ Macro ""Create FixedOD Project Scenario"" (MacroOpts)
       new_scen_dir + ""\\TransitProjectList.csv""
     )
 
-    file = new_scen_dir + ""\\RoadwayProjectList.csv""
+    csv_file = new_scen_dir + ""\\RoadwayProjectList.csv""
+    tbl = CreateObject(""Table"", csv_file)
+    ids = tbl.ProjID
+    if TypeOf(ids) <> ""null"" and TypeOf(ids[1]) <> ""string"" then ids = String(ids)
+    tbl = null
     if add_or_remove = ""add"" then do
-      // Check if this project ID is already in the list
-      tbl = CreateObject(""Table"", file)
-      if tbl.ProjID.position(proj_id) > 0 then Throw(
-        ""Project ID to add ('"" + proj_id + ""') is already in the project list"" + 
-        "" and so is in the original scenario.""
-      )
-      tbl = null
-
-      // Add this project ID to the end of the roadway project list
-      file = OpenFile(file, ""a"")
-      WriteLine(file, proj_id)
-      CloseFile(file)
+      for proj_id in proj_ids do
+        // Check if this project ID is already in the list
+        if ids.position(proj_id) > 0 then Throw(
+          ""Project ID to add ('"" + proj_id + ""') is already in the project list"" + 
+          "" and so is in the original scenario.""
+        )
+        tbl = null
+
+        // Add this project ID to the end of the roadway project list
+        file = OpenFile(csv_file, ""a"")
+        WriteLine(file, proj_id)
+        CloseFile(file)
+      end
     end else do
       // Remove the project ID
-      tbl = CreateObject(""Table"", file)
-      ids = tbl.ProjID
-      tbl = null
-      file = OpenFile(file, ""w"")
+      // tbl = CreateObject(""Table"", file)
+      // ids = tbl.ProjID
+      // tbl = null
+      for proj_id in proj_ids do
+        if ids.position(proj_id) = 0 then Throw(
+          ""Project ID to remove ('"" + proj_id + ""') not found in project list\n"" +
+          ""(and so isn't in original scenario).""
+        )
+      end
+      file = OpenFile(csv_file, ""w"")
       WriteLine(file, ""ProjID"")
       for id in ids do
-        if id = proj_id then project_found = true
-        if id <> proj_id then WriteLine(file, id)
+        if proj_ids.position(id) = 0 then WriteLine(file, id)
       end
-      // Throw an error if the project ID wasn't found
-      if !project_found then Throw(
-        ""Project ID to remove ('"" + proj_id + ""') not found in project list\n"" +
-        ""(and so isn't in original scenario).""
-      )
+      CloseFile(file)
     end
 
     // Create the scenario in the flowchart"
Triangle-Modeling-and-Analytics,TRMG2,3a338bbb71c09e6e87abd0f4dbb2afdf09ccb6bb,Andres Rabinowicz,andres@caliper.com,2024-06-03T14:18:25Z,Andres Rabinowicz,andres@caliper.com,2024-06-03T14:18:25Z,"Update 18 - Transit Assignment.rsc

class variable need to be nulled if used in a loop to avoid incorrect destructor and constructor of the variable",src/18 - Transit Assignment.rsc,False,False,False,False,1,0,1,"---FILE: src/18 - Transit Assignment.rsc---
@@ -220,6 +220,7 @@ Macro ""Transit Assignment"" (Args)
         for core_name in core_names do
             net_file = net_dir + ""/tnet_"" + period + ""_"" + core_name + "".tnw""
 
+            o = null
             o = CreateObject(
                 ""Network.PublicTransportAssignment"",
                 {RS: rts_file, NetworkName: net_file}"
Triangle-Modeling-and-Analytics,TRMG2,15f44cb49ea483b337ed596c3372d4b8b3fc6f45,Kyle Ward,kyleward084@gmail.com,2024-05-13T17:31:37Z,Kyle Ward,kyleward084@gmail.com,2024-05-13T17:31:37Z,"Implement project removal from Fixed OD Multi tool

This allows projects to be removed from a reference scenario instead of being added. A radio button lets the user choose.",src/utils/FixedODAssignment.rsc,False,False,False,False,61,13,74,"---FILE: src/utils/FixedODAssignment.rsc---
@@ -16,7 +16,7 @@ dBox ""FixedOD"" (Args) center, center, 50, 8 Title: ""Fixed OD Assignment"" Help: ""
     return()
   enditem
 
-  Edit Text 15, 1, 15 Prompt: ""Completed Scenario:"" Variable: full_scen_dir
+  Edit Text 15, 1, 15 Prompt: ""Reference Scenario:"" Variable: full_scen_dir
   Button after, same, 5, 1 Prompt: ""..."" do
     on error, escape goto skip1
     full_scen_dir = ChooseDirectory(""Choose Full Scenario Folder"", {""Initial Directory"": scen_dir})
@@ -118,18 +118,20 @@ Run the fixed OD tool for multiple scenarios
 Macro ""Open FixedOD Multiple Projects Dbox"" (Args)
 	RunDbox(""FixedOD Multiple Projects"", Args)
 endmacro
-dBox ""FixedOD Multiple Projects"" (Args) center, center, 50, 8 Title: ""Fixed OD Multiple Projects"" Help: ""test"" toolbox
+dBox ""FixedOD Multiple Projects"" (Args) center, center, 50, 12 Title: ""Fixed OD Multiple Projects"" Help: ""test"" toolbox
 
   init do
-    static full_scen_dir, sl_query, proj_list
+    static full_scen_dir, sl_query, proj_list, add_rem_int, add_or_remove
+    if add_rem_int = null then add_rem_int = 1
+    if add_or_remove = null then add_or_remove = ""add""
     scen_dir = Args.[Scenarios Folder]
   enditem
 
   close do
     return()
   enditem
 
-  Text 15, after, 15 Prompt: ""Completed Scenario:"" Variable: ""(current scenario)""
+  Text 15, after, 15 Prompt: ""Reference Scenario:"" Variable: ""(current scenario)""
 
   Edit Text 15, 2, 15 Prompt: ""Project List:"" Variable: proj_list
   Button after, same, 5, 1 Prompt: ""..."" do
@@ -143,8 +145,8 @@ dBox ""FixedOD Multiple Projects"" (Args) center, center, 50, 8 Title: ""Fixed OD M
       ""The project list should be a CSV file with a single column of project IDs "" +
       ""to be analyzed.\n"" + 
       ""For each project in the list, a new scenario will be created that includes "" +
-      ""all projects in the completed scenario plus the single extra project id.\n"" +
-      ""Do not include projects that are already in the completed scenario.""
+      ""all projects in the reference scenario plus the single extra project id.\n"" +
+      ""Do not include projects that are already in the reference scenario.""
     )
   enditem
 
@@ -157,9 +159,24 @@ dBox ""FixedOD Multiple Projects"" (Args) center, center, 50, 8 Title: ""Fixed OD M
   enditem
   Text after, same, 10 Variable: ""(optional)""
 
-  Button 12, 6.5 Prompt: ""Run"" do
+  Radio List ""add_or_remove"" 15, 6, 15, 2 Prompt: ""Add or Remove Projects?"" Variable: add_rem_int
+    Radio Button ""add"" 15, 7 Prompt: ""Add"" do
+      add_or_remove = ""add""
+    enditem
+    Radio Button ""remove"" 15, 8 Prompt: ""Remove"" do
+      add_or_remove = ""remove""
+    enditem
+  Button 38, 6, 3, 1 Prompt: ""?"" do
+    ShowMessage(
+      ""Should the projects in the project list be removed from the "" + 
+      ""reference scenario or added?""
+    )
+  enditem
+
+  Button 12, 10 Prompt: ""Run"" do
     opts.sl_query = sl_query
     opts.proj_list = proj_list
+    opts.add_or_remove = add_or_remove
     RunMacro(""FixedOD Multiple Projects"", opts)
     ShowMessage(""FixedOD Multiple Projects Complete"")
   enditem
@@ -185,7 +202,7 @@ Macro ""FixedOD Multiple Projects"" (MacroOpts)
 
     proj_list = MacroOpts.proj_list
 
-    // Get the base/completed scenario name/dir and save it
+    // Get the reference scenario name/dir and save it
     mr = CreateObject(""Model.Runtime"")
     {, full_scen_name} = mr.GetScenario()
     full_scen_name = mr.GetScenarioName(full_scen_name)
@@ -223,9 +240,12 @@ Macro ""Create FixedOD Project Scenario"" (MacroOpts)
     full_scen_name = MacroOpts.full_scen_name
     proj_list = MacroOpts.proj_list
     proj_id = MacroOpts.proj_id
+    add_or_remove = MacroOpts.add_or_remove
     
     // create the directory and copy project lists over
-    new_scen_dir = full_scen_dir + ""_"" + proj_id
+    if add_or_remove = ""add""
+      then new_scen_dir = full_scen_dir + ""_plus_"" + proj_id
+      else new_scen_dir = full_scen_dir + ""_minus_"" + proj_id
     RunMacro(""Create Directory"", new_scen_dir)
     parts = ParseString(new_scen_dir, ""\\"")
     new_scen_name = parts[parts.length]
@@ -237,10 +257,38 @@ Macro ""Create FixedOD Project Scenario"" (MacroOpts)
       full_scen_dir + ""\\TransitProjectList.csv"",
       new_scen_dir + ""\\TransitProjectList.csv""
     )
-    // Append this project ID to the end of the roadway project list
-    file = OpenFile(new_scen_dir + ""\\RoadwayProjectList.csv"", ""a"")
-    WriteLine(file, proj_id)
-    CloseFile(file)
+
+    file = new_scen_dir + ""\\RoadwayProjectList.csv""
+    if add_or_remove = ""add"" then do
+      // Check if this project ID is already in the list
+      tbl = CreateObject(""Table"", file)
+      if tbl.ProjID.position(proj_id) > 0 then Throw(
+        ""Project ID to add ('"" + proj_id + ""') is already in the project list"" + 
+        "" and so is in the original scenario.""
+      )
+      tbl = null
+
+      // Add this project ID to the end of the roadway project list
+      file = OpenFile(file, ""a"")
+      WriteLine(file, proj_id)
+      CloseFile(file)
+    end else do
+      // Remove the project ID
+      tbl = CreateObject(""Table"", file)
+      ids = tbl.ProjID
+      tbl = null
+      file = OpenFile(file, ""w"")
+      WriteLine(file, ""ProjID"")
+      for id in ids do
+        if id = proj_id then project_found = true
+        if id <> proj_id then WriteLine(file, id)
+      end
+      // Throw an error if the project ID wasn't found
+      if !project_found then Throw(
+        ""Project ID to remove ('"" + proj_id + ""') not found in project list\n"" +
+        ""(and so isn't in original scenario).""
+      )
+    end
 
     // Create the scenario in the flowchart
     mr = CreateObject(""Model.Runtime"")"
Triangle-Modeling-and-Analytics,TRMG2,12017f7aecb29fbd636e329e7a9a140300ca95d3,Kyle Ward,kyleward084@gmail.com,2024-05-07T13:14:51Z,Kyle Ward,kyleward084@gmail.com,2024-05-07T13:15:20Z,"Create the Fixed OD Multi tool

Closes #382",src/flow_chart/trmg2_menu.rsc;src/utils/FixedODAssignment.rsc,False,False,False,False,149,0,149,"---FILE: src/flow_chart/trmg2_menu.rsc---
@@ -139,6 +139,13 @@ menu ""Highway Analysis""
         Args = mr.GetValues()
         mr.RunCode(""Open Fixed OD Dbox"", Args)
     enditem
+
+    MenuItem ""fixed_od_multi"" text: ""FixedOD Multiple Projects"" do
+        mr = CreateObject(""Model.Runtime"")
+        Args = mr.GetValues()
+        mr.RunCode(""Open FixedOD Multiple Projects Dbox"", Args)
+    enditem
+
 endMenu
 
 menu ""Accessibility Analysis""

---FILE: src/utils/FixedODAssignment.rsc---
@@ -110,4 +110,146 @@ Macro ""Copy Files for Fixed OD"" (Args, full_scen_dir)
         to_file = to_od_dir + ""/od_veh_trips_"" + period + "".mtx""
         CopyFile(from_file, to_file)
     end
+endmacro
+
+/*
+Run the fixed OD tool for multiple scenarios
+*/
+Macro ""Open FixedOD Multiple Projects Dbox"" (Args)
+	RunDbox(""FixedOD Multiple Projects"", Args)
+endmacro
+dBox ""FixedOD Multiple Projects"" (Args) center, center, 50, 8 Title: ""Fixed OD Multiple Projects"" Help: ""test"" toolbox
+
+  init do
+    static full_scen_dir, sl_query, proj_list
+    scen_dir = Args.[Scenarios Folder]
+  enditem
+
+  close do
+    return()
+  enditem
+
+  Text 15, after, 15 Prompt: ""Completed Scenario:"" Variable: ""(current scenario)""
+
+  Edit Text 15, 2, 15 Prompt: ""Project List:"" Variable: proj_list
+  Button after, same, 5, 1 Prompt: ""..."" do
+    on error, escape goto skip2
+    proj_list = ChooseFile({{""CSV (*.csv)"", ""*.csv""}}, ""Choose Project List"", {""Initial Directory"": scen_dir})
+    skip2:
+    on error default
+  enditem
+  Button after, same, 3, 1 Prompt: ""?"" do
+    ShowMessage(
+      ""The project list should be a CSV file with a single column of project IDs "" +
+      ""to be analyzed.\n"" + 
+      ""For each project in the list, a new scenario will be created that includes "" +
+      ""all projects in the completed scenario plus the single extra project id.\n"" +
+      ""Do not include projects that are already in the completed scenario.""
+    )
+  enditem
+
+  Edit Text 15, 4, 15 Prompt: ""Select Link Query:"" Variable: sl_query
+  Button after, same, 5, 1 Prompt: ""..."" do
+    on error, escape goto skip3
+    sl_query = ChooseFile({{""Query (*.qry)"", ""*.qry""}}, ""Choose Select Link Query"", {""Initial Directory"": scen_dir})
+    skip3:
+    on error default
+  enditem
+  Text after, same, 10 Variable: ""(optional)""
+
+  Button 12, 6.5 Prompt: ""Run"" do
+    opts.sl_query = sl_query
+    opts.proj_list = proj_list
+    RunMacro(""FixedOD Multiple Projects"", opts)
+    ShowMessage(""FixedOD Multiple Projects Complete"")
+  enditem
+  Button 20, same Prompt: ""Quit"" do
+    Return()
+  enditem
+  Button 28, same Prompt: ""Help"" do
+    ShowMessage(
+      ""This tool runs the FixedOD utility for multiple projects.\n"" + 
+      ""It requires one fully-run scenario and then a project list of "" + 
+      ""projects to analyze.\n"" + 
+      ""A scenario will be created for each project in that list and the "" +
+      ""FixedOD utility will be run for each of them.""
+    )
+  enditem
+enddbox
+
+/*
+
+*/
+
+Macro ""FixedOD Multiple Projects"" (MacroOpts)
+
+    proj_list = MacroOpts.proj_list
+
+    // Get the base/completed scenario name/dir and save it
+    mr = CreateObject(""Model.Runtime"")
+    {, full_scen_name} = mr.GetScenario()
+    full_scen_name = mr.GetScenarioName(full_scen_name)
+    MacroOpts.full_scen_name = full_scen_name
+    Args = mr.GetValues()
+    MacroOpts.full_scen_dir = Args.[Scenario Folder]
+    mr = null
+
+    proj_tbl = CreateObject(""Table"", proj_list)
+    proj_ids = proj_tbl.ProjID
+    if proj_ids.type <> ""string"" then proj_ids = String(proj_ids)
+
+    for proj_id in proj_ids do
+      MacroOpts.proj_id = proj_id
+      RunMacro(""Create FixedOD Project Scenario"", MacroOpts)
+      RunMacro(""Fixed OD Assignment"", MacroOpts)
+
+      // Remove the scenario from the flowchart
+      mr = CreateObject(""Model.Runtime"")
+      {, new_scen_name} = mr.GetScenario()
+      // mr.SetScenario(new_scen_name)
+      mr.DeleteScenario(new_scen_name)
+      mr.SetScenario(full_scen_name)
+    end
+
+endmacro
+
+/*
+
+*/
+
+Macro ""Create FixedOD Project Scenario"" (MacroOpts)
+
+    full_scen_dir = MacroOpts.full_scen_dir
+    full_scen_name = MacroOpts.full_scen_name
+    proj_list = MacroOpts.proj_list
+    proj_id = MacroOpts.proj_id
+    
+    // create the directory and copy project lists over
+    new_scen_dir = full_scen_dir + ""_"" + proj_id
+    RunMacro(""Create Directory"", new_scen_dir)
+    parts = ParseString(new_scen_dir, ""\\"")
+    new_scen_name = parts[parts.length]
+    CopyFile(
+      full_scen_dir + ""\\RoadwayProjectList.csv"",
+      new_scen_dir + ""\\RoadwayProjectList.csv""
+    )
+    CopyFile(
+      full_scen_dir + ""\\TransitProjectList.csv"",
+      new_scen_dir + ""\\TransitProjectList.csv""
+    )
+    // Append this project ID to the end of the roadway project list
+    file = OpenFile(new_scen_dir + ""\\RoadwayProjectList.csv"", ""a"")
+    WriteLine(file, proj_id)
+    CloseFile(file)
+
+    // Create the scenario in the flowchart
+    mr = CreateObject(""Model.Runtime"")
+    parentName = full_scen_name
+    new_scen_name_full = mr.CreateScenario(parentName, new_scen_name, )
+    mr.SetScenario(new_scen_name_full)
+    mr.SetScenarioValues({""Scenario Folder"": new_scen_dir})
+    mr.SetScenario(new_scen_name_full)
+
+    // Call the standard TRMG2 create scenario macro
+    ret = mr.RunCode(""Create Scenario"", mr.GetValues())
 endmacro
\ No newline at end of file"
Triangle-Modeling-and-Analytics,TRMG2,114a27c7fea784d9e8383fc04fe472c58b1309ef,Kyle Ward,kyleward084@gmail.com,2024-05-07T13:14:35Z,Kyle Ward,kyleward084@gmail.com,2024-05-07T13:14:35Z,"Simplify roadway project manager

Pulled the project list combination out into project code to keep the manager macro itself simpler. This allowed it to be used more easily with the fixed OD multi tool (and with any other tools in the future).",src/01 - CreateScenario.rsc;src/utils/RoadwayProjectManagement.rsc,False,False,False,False,37,26,63,"---FILE: src/01 - CreateScenario.rsc---
@@ -24,16 +24,21 @@ Macro ""Check for Creation Files"" (Args)
 
   scen_dir = Args.[Scenario Folder]
 
+  // check to see which roadway project csv are present
+  campo_list = GetFileInfo(scen_dir + ""/RoadwayProjectList_CAMPO.csv"") <> null
+  dchc_list = GetFileInfo(scen_dir + ""/RoadwayProjectList_DCHC.csv"") <> null
+  final_list = GetFileInfo(scen_dir + ""/RoadwayProjectList.csv"") <> null
+
   // Ensure the minimum files are present
   if GetDirectoryInfo(scen_dir, ""All"") = null then Throw(
     ""The scenario directory does not exist.\n"" +
     ""Scenario Directory: \n"" +
     scen_dir
   )
-  else if GetFileInfo(scen_dir + ""/RoadwayProjectList_CAMPO.csv"") = null then Throw(
+  else if !campo_list and !final_list then Throw(
     ""The scenario directory is missing RoadwayProjectList_CAMPO.csv""
   )
-  else if GetFileInfo(scen_dir + ""/RoadwayProjectList_DCHC.csv"") = null then Throw(
+  else if !dchc_list and !final_list then Throw(
     ""The scenario directory is missing RoadwaRoadwayProjectList_DCHCyProjectList.csv""
   )
   else if GetFileInfo(scen_dir + ""/TransitProjectList.csv"") = null then Throw(
@@ -167,11 +172,35 @@ Macro ""Create Scenario Roadway"" (Args)
   if GetFileInfo(scen_hwy) <> null then DeleteFile(scen_hwy)
   CopyDatabase(master_hwy, scen_hwy)
 
+  // check to see which roadway project csv are present
+  scen_dir = Args.[Scenario Folder]
+  campo_list = GetFileInfo(scen_dir + ""/RoadwayProjectList_CAMPO.csv"") <> null
+  dchc_list = GetFileInfo(scen_dir + ""/RoadwayProjectList_DCHC.csv"") <> null
+  final_list = GetFileInfo(scen_dir + ""/RoadwayProjectList.csv"") <> null
+
+  // Combine two project lists into one (if both are present)
+  if campo_list and dchc_list then do
+    output_proj_list = scen_dir + ""/RoadwayProjectList.csv""
+    proj_list_CAMPO = scen_dir + ""/RoadwayProjectList_CAMPO.csv""
+    proj_list_DCHC = scen_dir + ""/RoadwayProjectList_DCHC.csv""
+    df = CreateObject(""df"", proj_list_CAMPO)
+    output = df.copy()
+    if output.tbl = null
+      then output = CreateObject(""df"", proj_list_DCHC)
+      else do
+        df = CreateObject(""df"", proj_list_DCHC)
+        if df.tbl.ProjID > 0 then output.bind_rows(df)
+      end
+    if output.tbl.ProjID > 0 then output.write_csv(output_proj_list)
+        else CopyFile(proj_list_CAMPO, output_proj_list)
+  end else if !final_list then Throw(
+    ""The scenario directory is missing RoadwayProjectList.csv""
+  )
+
   // Update the network using the project manager
   opts = null
   opts.hwy_dbd = scen_hwy
-  opts.proj_list_CAMPO = Args.[Scenario Folder] + ""/RoadwayProjectList_CAMPO.csv""
-  opts.proj_list_DCHC = Args.[Scenario Folder] + ""/RoadwayProjectList_DCHC.csv""
+  opts.proj_list = scen_dir + ""/RoadwayProjectList.csv""
   opts.master_dbd = master_hwy
   RunMacro(""Roadway Project Management"", opts)
 

---FILE: src/utils/RoadwayProjectManagement.rsc---
@@ -36,36 +36,18 @@ the project attributes.
 Macro ""Roadway Project Management"" (MacroOpts)
 
   hwy_dbd = MacroOpts.hwy_dbd
-  proj_list_CAMPO = MacroOpts.proj_list_CAMPO
-  proj_list_DCHC = MacroOpts.proj_list_DCHC
+  proj_list = MacroOpts.proj_list
   master_dbd = MacroOpts.master_dbd
 
   // Argument check
   if hwy_dbd = null then Throw(""'hwy_dbd' not provided"")
-  if proj_list_CAMPO = null then Throw(""'proj_list_CAMPO' not provided"")
-  if proj_list_DCHC = null then Throw(""'proj_list_DCHC' not provided"")
+  if proj_list = null then Throw(""'proj_list' not provided"")
   if master_dbd = null then Throw(""'master_dbd' not provided"")
 
-  // Combine two project lists into one
-  {drive, path, name, ext} = SplitPath(proj_list_CAMPO)
-  output_proj_list = drive + path + ""RoadwayProjectList.csv""
-
-  df = CreateObject(""df"", proj_list_CAMPO)
-  output = df.copy()
-  if output.tbl = null
-    then output = CreateObject(""df"", proj_list_DCHC)
-    else do
-      df = CreateObject(""df"", proj_list_DCHC)
-      if df.tbl.ProjID > 0 then output.bind_rows(df)
-    end
-  if output.tbl.ProjID > 0 then output.write_csv(output_proj_list)
-      else CopyFile(proj_list_CAMPO, output_proj_list)
-  
-  // Get vector of project IDs from the project list file
-  // gplyr's read functions won't work here until it can handle empty files.
+  output_proj_list = proj_list
   csv_tbl = OpenTable(""tbl"", ""CSV"", {output_proj_list, })
   v_projIDs = GetDataVector(csv_tbl + ""|"", ""ProjID"", )
-  v_projIDs = String(v_projIDs)
+  if v_projIDs.type <> ""string"" then v_projIDs = String(v_projIDs)
   CloseView(csv_tbl)
   DeleteFile(Substitute(output_proj_list, "".csv"", "".DCC"", ))
 "
Triangle-Modeling-and-Analytics,TRMG2,816f04b94d314c1afadd27b7fbd7049f59acad9f,Kyle Ward,kyleward084@gmail.com,2024-05-02T18:56:28Z,Kyle Ward,kyleward084@gmail.com,2024-05-02T18:56:28Z,"Improve scenario creation

Now the checking and ""Done"" message are done outside the creation macro itself. This allows the creation macro to be called from other places (like the fixed od tool).",src/01 - CreateScenario.rsc;src/flow_chart/trmg2_menu.rsc,False,False,False,False,23,25,48,"---FILE: src/01 - CreateScenario.rsc---
@@ -6,31 +6,14 @@ Macro ""Create Scenario"" (Args)
 
   pbar = CreateObject(""G30 Progress Bar"", ""Scenario Creation"", ""False"", )
 
-  scen_dir = Args.[Scenario Folder]
-  // Check if anything has already been created in the scenario directory
-  dir = Args.[Input Folder] + ""/*""
-  if GetDirectoryInfo(dir, ""All"") <> null then do
-    opts = null
-    opts.Buttons = ""YesNo""
-    opts.Caption = ""Note""
-    str = ""The input folder already contains information.\n"" +
-      ""Continuing will overwrite any manual changes made.\n"" +
-      ""(The output folder will not be modified.)\n"" +
-      ""Are you sure you want to continue?""
-    yesno = MessageBox(str, opts)
-  end
-
-  if yesno = ""Yes"" or yesno = null then do
-    RunMacro(""Check for Creation Files"", Args)
-    RunMacro(""Create Folder Structure"", Args)
-    RunMacro(""Copy TAZ"", Args)
-    RunMacro(""Create Scenario SE"", Args)
-    RunMacro(""Create Scenario Roadway"", Args)
-    RunMacro(""Check Scenario Roadway"", Args)
-    RunMacro(""Create Scenario Transit"", Args)
-  end
+  RunMacro(""Check for Creation Files"", Args)
+  RunMacro(""Create Folder Structure"", Args)
+  RunMacro(""Copy TAZ"", Args)
+  RunMacro(""Create Scenario SE"", Args)
+  RunMacro(""Create Scenario Roadway"", Args)
+  RunMacro(""Check Scenario Roadway"", Args)
+  RunMacro(""Create Scenario Transit"", Args)
 
-  ShowMessage(""Scenario Created"")
 EndMacro
 
 /*

---FILE: src/flow_chart/trmg2_menu.rsc---
@@ -70,7 +70,22 @@ menu ""TRMG2 Menu""
             return()
         end
 
-        mr.RunCode(""Create Scenario"", Args)
+        // Check if anything has already been created in the scenario directory
+        dir = Args.[Input Folder] + ""/*""
+        if GetDirectoryInfo(dir, ""All"") <> null then do
+            opts = null
+            opts.Buttons = ""YesNo""
+            opts.Caption = ""Note""
+            str = ""The input folder already contains information.\n"" +
+            ""Continuing will overwrite any manual changes made.\n"" +
+            ""(The output folder will not be modified.)\n"" +
+            ""Are you sure you want to continue?""
+            yesno = MessageBox(str, opts)
+        end
+        if yesno = ""Yes"" or yesno = null then do
+            mr.RunCode(""Create Scenario"", Args)
+            ShowMessage(""Scenario Created"")
+        end
         return(1)
     enditem
 "
Triangle-Modeling-and-Analytics,TRMG2,4de3c916ed806f1ec17c251e38d7aa169eaf43a8,Kyle Ward,kyleward084@gmail.com,2024-05-02T15:06:36Z,Kyle Ward,kyleward084@gmail.com,2024-05-02T15:06:36Z,"Add transit flow to list of fields to diff

Issue #327",src/utils/ScenarioComparison.rsc,False,False,False,False,2,1,3,"---FILE: src/utils/ScenarioComparison.rsc---
@@ -393,7 +393,8 @@ Macro ""Compare Link Data"" (MacroOpts)
 
     jv = join_tbl.GetView()
     fields_to_map = {
-        ""Total_Flow_Daily"", ""Total_VMT_Daily"", ""Total_VHT_Daily"", ""Total_Delay_Daily""
+        ""Total_Flow_Daily"", ""Total_VMT_Daily"", ""Total_VHT_Daily"", ""Total_Delay_Daily"",
+        ""AB_TransitFlow""
     }
     map.SetLayer(link_lyr)
 "
Triangle-Modeling-and-Analytics,TRMG2,d9450416229aa0d483eccd36b7ba466841a5cf9d,Kyle Ward,kyleward084@gmail.com,2024-05-02T15:06:03Z,Kyle Ward,kyleward084@gmail.com,2024-05-02T15:06:03Z,"Add a transit flow map

Issue #327",src/19 - Summaries.rsc,False,False,False,False,22,0,22,"---FILE: src/19 - Summaries.rsc---
@@ -9,6 +9,7 @@ Macro ""Maps"" (Args)
     RunMacro(""Calculate Daily Fields"", Args)
     RunMacro(""Create Count Difference Map"", Args)
     RunMacro(""VOC Maps"", Args)
+    RunMacro(""Transit Maps"", Args)
     RunMacro(""Speed Maps"", Args)
     //RunMacro(""Isochrones"", Args)
 	  RunMacro(""Accessibility Maps"", Args)
@@ -465,6 +466,27 @@ Macro ""VOC Maps"" (Args)
   end
 EndMacro
 
+/*
+Creates a map showing transit flow
+*/
+
+Macro ""Transit Maps"" (Args)
+  
+  hwy_dbd = Args.Links
+  output_dir = Args.[Output Folder] + ""/_summaries/maps""
+  if GetDirectoryInfo(output_dir, ""All"") = null then CreateDirectory(output_dir)
+
+  map = CreateObject(""Map"", hwy_dbd)
+  {nlyr, llyr} = map.GetLayerNames()
+  map.SetLayer(llyr)
+  map.SizeTheme({
+    FieldName: ""AB_TransitFlow""
+  })
+  map.HideLayer(nlyr)
+  map.Save(output_dir + ""/transit_flow.map"")
+
+endmacro
+
 /*
 Creates a map showing speed reductions (similar to Google) for each period
 */"
Triangle-Modeling-and-Analytics,TRMG2,bce672054160e5c470086ccd6e052a68cd0ee48d,Kyle Ward,kyleward084@gmail.com,2024-04-09T16:41:49Z,Kyle Ward,kyleward084@gmail.com,2024-04-09T16:41:49Z,"Update NestedDC.rsc

Small correction to NestedDC class. Does not impact model results but prevents an error found in Reno which uses irregular zone numbers (starting at 101).",src/utils/NestedDC.rsc,False,False,False,False,2,1,3,"---FILE: src/utils/NestedDC.rsc---
@@ -83,6 +83,7 @@ Class ""NestedDC"" (ClassOpts)
         // Run zone-level DC
         self.util_file = self.ClassOpts.zone_utils
         self.zone_level = ""true""
+        self.dc_spec = self.ClassOpts.dc_spec
         self.RunChoiceModels(zone_opts)
         
         // Build cluster-level choice data
@@ -114,7 +115,7 @@ Class ""NestedDC"" (ClassOpts)
         
         util_file = self.util_file
         zone_level = self.zone_level
-        dc_spec = self.ClassOpts.dc_spec
+        dc_spec = self.dc_spec
         trip_type = self.ClassOpts.trip_type
         segments = self.ClassOpts.segments
         period = self.ClassOpts.period"
Triangle-Modeling-and-Analytics,TRMG2,6a6e6d208334b4ad63f94e0e0981a71e4bbfc717,Kyle Ward,kyle@caliper.com,2024-04-03T16:40:55Z,Kyle Ward,kyle@caliper.com,2024-04-03T16:40:55Z,Make a few minor fixes,src/03 - Accessibility.rsc;src/10 - Skimming.rsc,False,False,False,False,6,1,7,"---FILE: src/03 - Accessibility.rsc---
@@ -305,6 +305,7 @@ Macro ""Create Accessibility Skims"" (Args)
     RunMacro(""Create Transit Skims"", Args, overrides)
 
     // intrazonals
+    obj = null
     obj = CreateObject(""Distribution.Intrazonal"")
     obj.OperationType = ""Replace""
     obj.TreatMissingAsZero = false

---FILE: src/10 - Skimming.rsc---
@@ -78,7 +78,7 @@ Macro ""Create Roadway Skims"" (Args, OtherOpts)
     v_area = GetDataVector(tlyr + ""|"", ""Area"", {{""Sort Order"",{{""ID"",""Ascending""}}}})
     //       {diagonal of a square } / 3  * {30 mph = 2 minutes per mile}
     v_time = (sqrt(v_area) * sqrt(2) / 3) * (60 / 30) 
-    // Create a vector of the correct length
+    // Create a vector of the correct length (including external centroids)
     se_vw = OpenTable(""se"", ""FFB"", {se_file})
     n = GetRecordCount(se_vw, )
     CloseView(se_vw)
@@ -89,6 +89,7 @@ Macro ""Create Roadway Skims"" (Args, OtherOpts)
 
     for period in periods do
         for mode in modes do
+            obj = null
             obj = CreateObject(""Network.Skims"")
             obj.Network = net_dir + ""/net_"" + period + ""_"" + mode + "".net""
             obj.LayerDB = link_dbd
@@ -108,17 +109,20 @@ Macro ""Create Roadway Skims"" (Args, OtherOpts)
             ret_value = obj.Run()
 
             // intrazonals
+            obj = null
             obj = CreateObject(""Distribution.Intrazonal"")
             obj.OperationType = ""Replace""
             obj.TreatMissingAsZero = false
             obj.Neighbours = 3
             obj.Factor = .75
             m = CreateObject(""Matrix"", out_file)
             corenames = m.GetCoreNames()
+            m = null
             for core in corenames do
                 obj.SetMatrix({MatrixFile: out_file, Matrix: core})
                 ok = obj.Run()
             end
+            m = CreateObject(""Matrix"", out_file)
             m.SetVector({Core: corenames[1], Vector: v_iz, Diagonal: ""true""})
 
             // Auto pay fare"
Triangle-Modeling-and-Analytics,TRMG2,d706c89b3910662ef393930f19d77beeab8b981c,Kyle Ward,kyleward084@gmail.com,2024-03-28T11:15:28Z,Kyle Ward,kyleward084@gmail.com,2024-03-29T17:37:05Z,"Comment out the dcc file deletion

This prevents a bug discovered in TC 10",src/02 - Network Calculations.rsc,False,False,False,False,1,1,2,"---FILE: src/02 - Network Calculations.rsc---
@@ -131,7 +131,7 @@ Macro ""Filter Transit Modes"" (Args)
     DeleteRecordsInSet(del_set)
     ExportView(mode_vw + ""|"", ""CSV"", Args.TransModeTable, , {""CSV Header"": ""true""})
     CloseView(mode_vw)
-    DeleteFile(Substitute(Args.TransModeTable, "".csv"", "".dcc"", ))
+    // DeleteFile(Substitute(Args.TransModeTable, "".csv"", "".dcc"", ))
     
     // Remove modes from MC parameter files
     RunMacro(""Filter Resident HB Transit Modes"", Args)"
Triangle-Modeling-and-Analytics,TRMG2,a3aeb486bc3d154092fe86dbb38da660e2d3fc91,Kyle Ward,kyleward084@gmail.com,2024-03-28T10:17:10Z,Kyle Ward,kyleward084@gmail.com,2024-03-28T10:17:10Z,"Correct a check query during scenario creation

Prevents greenways and other walk-only links from looking like errors.",src/01 - CreateScenario.rsc,False,False,False,False,1,1,2,"---FILE: src/01 - CreateScenario.rsc---
@@ -213,7 +213,7 @@ Macro ""Check Scenario Roadway"" (Args)
   check_queries = {
     ""Dir = 1 and nz(ABLanes) = 0"",
     ""Dir = -1 and nz(BALanes) = 0"",
-    ""Dir = 0 and (nz(ABLanes) = 0 or nz(BALanes) = 0)""
+    ""Dir = 0 and DTWB contains 'D' and DTWB contains 'T' and (nz(ABLanes) = 0 or nz(BALanes) = 0)""
   }
   for query in check_queries do
     RunMacro(""G30 create set"", ""error"")"
Triangle-Modeling-and-Analytics,TRMG2,924e90e66f6c2c17aa755398da424fe37f85186d,Kyle,kyle@caliper.com,2024-03-14T19:29:08Z,Kyle,kyle@caliper.com,2024-03-14T19:29:08Z,Flip NT period and fix bug,src/02 - Network Calculations.rsc;src/10 - Skimming.rsc;src/flow_chart/trmg2.parameters,False,False,False,False,9,5,14,"---FILE: src/02 - Network Calculations.rsc---
@@ -1247,9 +1247,9 @@ Macro ""Set Route Network"" (Args, opts)
         if access_mode = ""knr"" 
             then opts.ParkingNodes = ""KNR = 1""
             else opts.ParkingNodes = ""PNR = 1""
-        if period = ""PM"" and access_mode = ""pnr"" then do
-            if GetFileInfo(Args.PMParkingLotUsed) <> null then do
-                opts.ParkingUsage = {{MatrixFile: Args.PMParkingLotUsed, MatrixCore: ""Parking Nodes""}}
+        if (period = ""PM"" or period = ""NT"") and access_mode = ""pnr"" then do
+            if GetFileInfo(Args.(""ReturnParkingLotUsed""+transit_mode)) <> null then do
+                opts.ParkingUsage = {{MatrixFile: Args.(""ReturnParkingLotUsed""+transit_mode), MatrixCore: ""Parking Nodes""}}
             end
             o.DriveEgress(opts)
         end

---FILE: src/10 - Skimming.rsc---
@@ -283,7 +283,7 @@ Macro ""Create Transit Skims"" (Args, overrides)
                     tmpAM2 = GetTempFileName(""*.mtx"")
                     mT = m.Transpose({OutputFile: tmpAM2})
                     mT2 = OpenMatrix(tmpAM2,)
-                    tmat = FlipMatrix(mT2, {""File Name"": Args.PMParkingLotUsed, Label: ""ParkingMatrix""})
+                    tmat = FlipMatrix(mT2, {""File Name"": Args.(""ReturnParkingLotUsed""+mode), Label: ""ParkingMatrix""+mode})
                     mT2 = null
                 end
                 // Flip to AP format in the PM period

---FILE: src/flow_chart/trmg2.parameters---
@@ -56,7 +56,11 @@
     Section = ""Network Calculations|Transit""
         
         Args.TransModeTable = { ""Type"":""File"" , ""Value"":""%Input Folder%\\networks\\transit_mode_table.csv"", ""Description"":""Table that defines mode-specific attributes."" }
-        Args.PMParkingLotUsed = { ""Type"":""File"" , ""Value"":""%Output Folder%\\skims\\transit\\PNRTransitParkingLot.mtx"", ""Description"":""Matrix that describes parking lot used for PNR drive egress in the PM period."" }
+        Args.ReturnParkingLotUsedlb = { ""Type"":""File"" , ""Value"":""%Output Folder%\\skims\\transit\\PNRTransitParkingLotLB.mtx"", ""Description"":""Matrix that describes parking lot used for PNR drive egress in the PM period LB."" }
+        Args.ReturnParkingLotUsedeb = { ""Type"":""File"" , ""Value"":""%Output Folder%\\skims\\transit\\PNRTransitParkingLotEB.mtx"", ""Description"":""Matrix that describes parking lot used for PNR drive egress in the PM period EB."" }
+        Args.ReturnParkingLotUsedbrt = { ""Type"":""File"" , ""Value"":""%Output Folder%\\skims\\transit\\PNRTransitParkingLotBRT.mtx"", ""Description"":""Matrix that describes parking lot used for PNR drive egress in the PM period BRT."" }
+        Args.ReturnParkingLotUsedcr = { ""Type"":""File"" , ""Value"":""%Output Folder%\\skims\\transit\\PNRTransitParkingLotCR.mtx"", ""Description"":""Matrix that describes parking lot used for PNR drive egress in the PM period CR."" }
+        Args.ReturnParkingLotUsedlr = { ""Type"":""File"" , ""Value"":""%Output Folder%\\skims\\transit\\PNRTransitParkingLotLR.mtx"", ""Description"":""Matrix that describes parking lot used for PNR drive egress in the PM period LR."" }
     
     Section = ""Accessibilities""
     "
Triangle-Modeling-and-Analytics,TRMG2,cd45ff3b198f9bf600d4b66d08369ff9ba7505aa,Si Shi,si_shi_itre@ncsu.edu,2024-03-05T14:39:49Z,Si Shi,si_shi_itre@ncsu.edu,2024-03-05T14:39:49Z,Add reports to fix OD tool and transit summary,src/utils/FixedODAssignment.rsc;src/utils/utils.rsc,False,False,False,False,9,0,9,"---FILE: src/utils/FixedODAssignment.rsc---
@@ -90,6 +90,7 @@ Macro ""Fixed OD Assignment"" (MacroOpts)
     RunMacro(""VOC Maps"", Args)
     RunMacro(""Speed Maps"", Args)
     RunMacro(""Summarize Links"", Args)
+    RunMacro(""VMT_Delay Summary"", Args)
 endmacro
 
 /*

---FILE: src/utils/utils.rsc---
@@ -2014,6 +2014,14 @@ Macro ""Summarize Transit"" (MacroOpts)
     df.write_csv(output_dir + ""/boardings_and_alightings_daily_by_"" + var + "".csv"")
   end
 
+  df = onoff.copy()
+  df.group_by({""agency"", ""mode""})
+  df.summarize(cols_to_summarize, ""sum"")
+  opts = null
+  opts.new_names = {""agency"", ""mode""} + cols_to_summarize
+  df.colnames(opts)
+  df.write_csv(output_dir + ""/boardings_and_alightings_daily_by_mode_by_agency.csv"")
+
   // aggregate transit flow by link and join to layer
   agg = tables.agg
   agg.group_by(""ID1"")"
Triangle-Modeling-and-Analytics,TRMG2,b73ed17b0938dacc008e7c41f2ea4652f9d3c3b7,Si Shi,si_shi_itre@ncsu.edu,2024-02-20T22:14:13Z,Si Shi,si_shi_itre@ncsu.edu,2024-02-20T22:14:13Z,Fix formatting issue with MOVES input,other/_reportingtool/MOVES/SourceType_param.csv,False,False,False,False,105,105,210,"---FILE: other/_reportingtool/MOVES/SourceType_param.csv---
@@ -1,105 +1,105 @@
-sourcetypeID,year,styFactor,,
-11,2020,0.029854971,,styFactor based on DAQ number of vehicles for Wake County distributed by MOVES default sourceType for Wake County. This is an update from previous default values.
-21,2020,0.406233059,,
-31,2020,0.47384282,,
-32,2020,0.048479771,,
-41,2020,0.001155693,,
-42,2020,0.000373924,,
-43,2020,0.001528686,,
-51,2020,0.000178727,,
-52,2020,0.026168069,,
-53,2020,0.001179975,,
-54,2020,0.003453037,,
-61,2020,0.004864902,,
-62,2020,0.002686365,,
-11,2025,0.03427345,,
-21,2025,0.3494465,,
-31,2025,0.51643685,,
-32,2025,0.05283759,,
-41,2025,0.00122832,,
-42,2025,0.00038875,,
-43,2025,0.00160898,,
-51,2025,0.00020623,,
-52,2025,0.03019423,,
-53,2025,0.00136152,,
-54,2025,0.00398429,,
-61,2025,0.00517544,,
-62,2025,0.00285784,,
-11,2030,0.033830564,,
-21,2030,0.301540383,,
-31,2030,0.556449309,,
-32,2030,0.056931292,,
-41,2030,0.001324593,,
-42,2030,0.000419224,,
-43,2030,0.001735089,,
-51,2030,0.000227482,,
-52,2030,0.033306189,,
-53,2030,0.001501843,,
-54,2030,0.004394941,,
-61,2030,0.005372458,,
-62,2030,0.002966633,,
-11,2035,0.033467166,,
-21,2035,0.262005743,,
-31,2035,0.58952134,,
-32,2035,0.060314951,,
-41,2035,0.001397544,,
-42,2035,0.000442312,,
-43,2035,0.001830649,,
-51,2035,0.000245658,,
-52,2035,0.035967603,,
-53,2035,0.001621855,,
-54,2035,0.004746117,,
-61,2035,0.005436866,,
-62,2035,0.003002198,,
-11,2040,0.033216684,,
-21,2040,0.237236463,,
-31,2040,0.609649423,,
-32,2040,0.062374372,,
-41,2040,0.001454371,,
-42,2040,0.000460297,,
-43,2040,0.0019051,,
-51,2040,0.000261191,,
-52,2040,0.038241781,,
-53,2040,0.001724396,,
-54,2040,0.005046214,,
-61,2040,0.005430838,,
-62,2040,0.002998869,,
-11,2045,0.033045094,,
-21,2045,0.222841925,,
-31,2045,0.620669345,,
-32,2045,0.06350183,,
-41,2045,0.001498721,,
-42,2045,0.000474334,,
-43,2045,0.001963186,,
-51,2045,0.000275213,,
-52,2045,0.040294868,,
-53,2045,0.001816979,,
-54,2045,0.005317133,,
-61,2045,0.005348157,,
-62,2045,0.002953215,,
-11,2050,0.032914808,,
-21,2050,0.212865415,,
-31,2050,0.628009086,,
-32,2050,0.064252799,,
-41,2050,0.001531288,,
-42,2050,0.000484639,,
-43,2050,0.00200584,,
-51,2050,0.000287698,,
-52,2050,0.042122614,,
-53,2050,0.001899399,,
-54,2050,0.005558316,,
-61,2050,0.00519787,,
-62,2050,0.002870228,,
-11,2055,0.032795439,,
-21,2055,0.204084645,,
-31,2055,0.634624408,,
-32,2055,0.064929651,,
-41,2055,0.001551237,,
-42,2055,0.000490953,,
-43,2055,0.002031975,,
-51,2055,0.000298553,,
-52,2055,0.04371224,,
-53,2055,0.001971075,,
-54,2055,0.005768079,,
-61,2055,0.004987618,,
-62,2055,0.002754126,,
+sourcetypeID,year,styFactor
+11,2020,0.029854971
+21,2020,0.406233059
+31,2020,0.47384282
+32,2020,0.048479771
+41,2020,0.001155693
+42,2020,0.000373924
+43,2020,0.001528686
+51,2020,0.000178727
+52,2020,0.026168069
+53,2020,0.001179975
+54,2020,0.003453037
+61,2020,0.004864902
+62,2020,0.002686365
+11,2025,0.03427345
+21,2025,0.3494465
+31,2025,0.51643685
+32,2025,0.05283759
+41,2025,0.00122832
+42,2025,0.00038875
+43,2025,0.00160898
+51,2025,0.00020623
+52,2025,0.03019423
+53,2025,0.00136152
+54,2025,0.00398429
+61,2025,0.00517544
+62,2025,0.00285784
+11,2030,0.033830564
+21,2030,0.301540383
+31,2030,0.556449309
+32,2030,0.056931292
+41,2030,0.001324593
+42,2030,0.000419224
+43,2030,0.001735089
+51,2030,0.000227482
+52,2030,0.033306189
+53,2030,0.001501843
+54,2030,0.004394941
+61,2030,0.005372458
+62,2030,0.002966633
+11,2035,0.033467166
+21,2035,0.262005743
+31,2035,0.58952134
+32,2035,0.060314951
+41,2035,0.001397544
+42,2035,0.000442312
+43,2035,0.001830649
+51,2035,0.000245658
+52,2035,0.035967603
+53,2035,0.001621855
+54,2035,0.004746117
+61,2035,0.005436866
+62,2035,0.003002198
+11,2040,0.033216684
+21,2040,0.237236463
+31,2040,0.609649423
+32,2040,0.062374372
+41,2040,0.001454371
+42,2040,0.000460297
+43,2040,0.0019051
+51,2040,0.000261191
+52,2040,0.038241781
+53,2040,0.001724396
+54,2040,0.005046214
+61,2040,0.005430838
+62,2040,0.002998869
+11,2045,0.033045094
+21,2045,0.222841925
+31,2045,0.620669345
+32,2045,0.06350183
+41,2045,0.001498721
+42,2045,0.000474334
+43,2045,0.001963186
+51,2045,0.000275213
+52,2045,0.040294868
+53,2045,0.001816979
+54,2045,0.005317133
+61,2045,0.005348157
+62,2045,0.002953215
+11,2050,0.032914808
+21,2050,0.212865415
+31,2050,0.628009086
+32,2050,0.064252799
+41,2050,0.001531288
+42,2050,0.000484639
+43,2050,0.00200584
+51,2050,0.000287698
+52,2050,0.042122614
+53,2050,0.001899399
+54,2050,0.005558316
+61,2050,0.00519787
+62,2050,0.002870228
+11,2055,0.032795439
+21,2055,0.204084645
+31,2055,0.634624408
+32,2055,0.064929651
+41,2055,0.001551237
+42,2055,0.000490953
+43,2055,0.002031975
+51,2055,0.000298553
+52,2055,0.04371224
+53,2055,0.001971075
+54,2055,0.005768079
+61,2055,0.004987618
+62,2055,0.002754126"
Triangle-Modeling-and-Analytics,TRMG2,e4c9cdf14adceaa020f1df8f84ae03a3fc8cba2b,Si Shi,si_shi_itre@ncsu.edu,2024-02-08T21:08:24Z,Si Shi,si_shi_itre@ncsu.edu,2024-02-08T21:08:24Z,Comment typo fix,src/utils/trip_aggregation_moto.rsc;src/utils/trip_aggregation_nm.rsc,False,False,False,False,2,2,4,"---FILE: src/utils/trip_aggregation_moto.rsc---
@@ -103,7 +103,7 @@ Macro ""Aggregate matrix"" (Args)
             end
         end
 
-        //uhb trip
+        //nhb trip
         nhb_trip_files = RunMacro(""Catalog Files"", {dir: nhb_dir, ext: ""mtx""})
         for trip_file in nhb_trip_files do
             {, , name, } = SplitPath(trip_file)

---FILE: src/utils/trip_aggregation_nm.rsc---
@@ -98,7 +98,7 @@ Macro ""Aggregate matrix"" (Args)
             end
         end
 
-        //uhb trip
+        //nhb trip
         nhb_trip_file = nhb_dir + ""/NHB_walkbike_"" + period + "".mtx""
         trip_mtx = CreateObject(""Matrix"", nhb_trip_file)
         trip_core = trip_mtx.GetCore(""Total"")"
Triangle-Modeling-and-Analytics,TRMG2,8f763b4909fd151292e01c48a970770ab8bf485d,Si Shi,si_shi_itre@ncsu.edu,2024-01-26T15:15:17Z,Si Shi,si_shi_itre@ncsu.edu,2024-01-26T15:15:17Z,v2 project lists revision to correct issues in v1.3,scenarios/2030/RoadwayProjectList_CAMPO.csv;scenarios/2030/RoadwayProjectList_DCHC.csv;scenarios/2040/RoadwayProjectList_CAMPO.csv;scenarios/2040/RoadwayProjectList_DCHC.csv;scenarios/2050/RoadwayProjectList_CAMPO.csv;scenarios/2050/RoadwayProjectList_DCHC.csv,False,False,False,False,47,12,59,"---FILE: scenarios/2030/RoadwayProjectList_CAMPO.csv---
@@ -14,7 +14,6 @@ A16
 A160a
 A160d
 A160e
-A163a1
 A163a2
 A163a3
 A164a2

---FILE: scenarios/2030/RoadwayProjectList_DCHC.csv---
@@ -1,27 +1,28 @@
 ProjID
+910
 1000
+113.1
 123.11
 15
 15.407
 201
 202
 203001
-211
 220
 221
 223
 23
+373
 379
-40
 43
 437
 44
 45.3
-480.1
-481
-626
 638
-650
 690
 75.1
 75.2
+77.3
+CHTBRT
+CHTNSBRT
+DCHCPNR

---FILE: scenarios/2040/RoadwayProjectList_CAMPO.csv---
@@ -14,7 +14,6 @@ A16
 A160a
 A160d
 A160e
-A163a1
 A163a2
 A163a3
 A164a2
@@ -198,7 +197,6 @@ A427b
 A432
 A433
 A434
-A440c
 A444
 A449
 A480a1
@@ -221,6 +219,7 @@ A59b
 A59c
 A606
 A613
+A616a
 A616b2
 A619a
 A622
@@ -233,6 +232,7 @@ A643
 A64a
 A64b
 A652
+A440c
 A667
 A672
 A678

---FILE: scenarios/2040/RoadwayProjectList_DCHC.csv---
@@ -1,6 +1,8 @@
 ProjID
+910
 1000
 111
+113.05
 113.1
 123.11
 147.01
@@ -22,29 +24,46 @@ ProjID
 346
 35
 36
+373
 379
-40
 43
 437
 44
+440.01
 45.3
+428.1
+438
 479
 48
 48.1
 480.1
-481
 50.11
 51
 626
 638
 646
 650
+69.11
 690
 70
 70.3
 70.31
 70.6
 73
 75.1
+75.2
+75.3
+77.3
 87
 89.3
+900
+CHTBRT
+CHTNSBRT
+DCHCPNR
+147.03
+69.22
+69.31
+69.41
+485.11
+116.11
+434.1

---FILE: scenarios/2050/RoadwayProjectList_CAMPO.csv---
@@ -23,6 +23,7 @@ A187b1
 A187b3
 A193a2
 A201a
+A207c
 A20b2
 A21
 A217a1
@@ -38,6 +39,7 @@ A231a
 A236a
 A236b
 A240c
+A27c1a
 A28b
 A2b1
 A2b2
@@ -55,8 +57,10 @@ A480a2
 A480b
 A486
 A49a
+A544c1
 A557
 A615
+A630
 A634
 A640
 A641
@@ -75,11 +79,13 @@ A689
 A697
 A705a
 A705b
+A707
 A731
 A744
 A745
 A754
 A755a
+A769
 A784
 A81a
 A82a
@@ -88,6 +94,7 @@ A90c
 A927
 A930
 A933
+A934
 F10
 F11-1a
 F17b
@@ -190,7 +197,6 @@ A427b
 A432
 A433
 A434
-A440c
 A444
 A449
 A480a1
@@ -213,6 +219,7 @@ A59b
 A59c
 A606
 A613
+A616a
 A616b2
 A619a
 A622
@@ -225,6 +232,7 @@ A643
 A64a
 A64b
 A652
+A440c
 A667
 A672
 A678
@@ -419,6 +427,7 @@ A698
 A699
 A700
 A701
+A717
 A722
 A723
 A726

---FILE: scenarios/2050/RoadwayProjectList_DCHC.csv---
@@ -41,7 +41,10 @@ ProjID
 434
 437
 44
+440.01
 45.3
+428.1
+438
 479
 48
 48.1
@@ -64,6 +67,7 @@ ProjID
 70.6
 73
 75.1
+75.2
 75.3
 77.1
 77.3
@@ -84,3 +88,6 @@ DCHCPNR
 69.41
 DOBRT
 53.1
+485.11
+116.11
+434.1"
Triangle-Modeling-and-Analytics,TRMG2,abf3c410dd567aa0fbc14930dd0c568ab787d914,Si Shi,si_shi_itre@ncsu.edu,2024-01-24T20:17:37Z,Si Shi,si_shi_itre@ncsu.edu,2024-01-24T20:17:37Z,fix bug in transit aggregation tool,src/19 - Summaries.rsc,False,False,False,False,1,1,2,"---FILE: src/19 - Summaries.rsc---
@@ -2221,7 +2221,7 @@ Macro ""Aggregate Transit Flow by Route"" (Args)
   if GetDirectoryInfo(output_dir, ""All"") = null then CreateDirectory(output_dir)
   access_modes = Args.access_modes
   mode_table = Args.TransModeTable
-  periods = RunMacro(""Get Unconverged Periods"", Args)
+  periods = Args.periods
   orig_transit_modes = RunMacro(""Get Transit Modes"", mode_table)
 
   // Loop through transit assn bin files"
Triangle-Modeling-and-Analytics,TRMG2,e8facd816073a3b4b907d6428fdd7d19d7f741da,Si Shi,si_shi_itre@ncsu.edu,2024-01-23T15:32:14Z,Si Shi,si_shi_itre@ncsu.edu,2024-01-23T15:32:14Z,"Revise summarize links macro and fix -1 lanes in DCHC area

- Create roadway_tables dir before generating summary reports.
- Changed 5 links with AB/BALanes = -1 to -99 in DCHC area.",master/networks/master_links.BIN;src/19 - Summaries.rsc,False,False,False,False,3,2,5,"---FILE: src/19 - Summaries.rsc---
@@ -1234,7 +1234,8 @@ Macro ""Summarize Links"" (Args)
   CloseMap(map)
 
   opts.hwy_dbd = hwy_dbd
-  out_dir = Args.[Output Folder]
+  out_dir = Args.[Output Folder] + ""/_summaries/roadway_tables""
+  if GetDirectoryInfo(out_dir, ""All"") = null then CreateDirectory(out_dir)
   for period in periods do
     
     if period = ""Daily""
@@ -1245,7 +1246,7 @@ Macro ""Summarize Links"" (Args)
     opts.summary_fields = {total + ""_Flow_"" + period, total + ""_VMT_"" + period, total + ""_VHT_"" + period, total + ""_Delay_"" + period}
     grouping_fields = {""AreaType"", ""MPO"", ""County""}
     for grouping_field in grouping_fields do
-      opts.output_csv = out_dir + ""/_summaries/roadway_tables/Link_Summary_by_FT_and_"" + grouping_field + ""_"" + period + "".csv""
+      opts.output_csv = out_dir + ""/Link_Summary_by_FT_and_"" + grouping_field + ""_"" + period + "".csv""
       opts.grouping_fields = {""HCMType"", grouping_field}
       RunMacro(""Link Summary"", opts)
       // Calculate space-mean-speed"
Triangle-Modeling-and-Analytics,TRMG2,05797768d18fcd69b453ff59223deee7aa119290,Kyle Ward,kyleward084@gmail.com,2024-01-19T16:09:05Z,Kyle Ward,kyleward084@gmail.com,2024-01-19T16:09:05Z,Redo the ID width correction,master/networks/master_links.DCB,False,False,False,False,1,1,2,"---FILE: master/networks/master_links.DCB---
@@ -1,6 +1,6 @@
 master_links
 599
-""ID"",I,1,4,0,4,0,,"""","""",,""Sum"",
+""ID"",I,1,4,0,10,0,,"""","""",,""Sum"",
 ""RoadName"",C,5,32,0,32,0,,"""","""",,""Copy"",
 ""AltName"",C,37,32,0,32,0,,"""","""",,""Copy"",
 ""NCDOTClass"",C,69,14,0,14,0,,"""",""This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"","
Triangle-Modeling-and-Analytics,TRMG2,35e3366af7deb568ad01dfc674e17dada55bc796,Kyle Ward,kyleward084@gmail.com,2024-01-19T15:55:17Z,Kyle Ward,kyleward084@gmail.com,2024-01-19T15:55:17Z,Fix the master links dcb file,master/networks/master_links.DCB,False,False,False,False,57,59,116,"---FILE: master/networks/master_links.DCB---
@@ -1,6 +1,6 @@
 master_links
-599
-""ID"",I,1,4,0,10,0,,"""","""",,""Sum"",
+583
+""ID"",I,1,4,0,4,0,,"""","""",,""Sum"",
 ""RoadName"",C,5,32,0,32,0,,"""","""",,""Copy"",
 ""AltName"",C,37,32,0,32,0,,"""","""",,""Copy"",
 ""NCDOTClass"",C,69,14,0,14,0,,"""",""This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"",
@@ -15,60 +15,58 @@ master_links
 ""TollType"",C,144,4,0,4,0,,"""",""Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
 ""TollCostT"",R,148,8,0,10,2,,"""",""Toll cost ($) with a transponder for 2-axle vehicles||The model will automatically apply 2x this rate to|SUT and 4x this rate to MUT. Also, the % of vehicles|with transponders can be changed. See parameter|'TransponderRatio'."",,""Copy"",
 ""TollCostNT"",R,156,8,0,10,2,,"""",""Toll cost ($) without a transponder for 2-axle vehicles||The model will automatically apply 2x this cost to|SUT and 4x this rate to MUT. Also, the % of vehicles|with transponders can be changed. See parameter|'TransponderRatio'."",,""Copy"",
-""WalkSpeed"",R,164,8,0,10,2,,"""",""Use this field to override the default walk speed (3 mph)|Faster speeds can be used to represent sidewalks."",,""Sum"",
-""BikeSpeed"",R,172,8,0,10,2,,"""",""Use this field to override the default bike speed (15 mph).|Faster speeds can be used to represent bike lanes or other accommodations."",,""Sum"",
-""CountID"",C,180,16,0,16,0,,"""",""The CVG/VLM ID of the count"",,""Copy"",
-""CountPointID"",I,196,4,0,8,0,,"""",""The point ID from the count geo file"",,""Copy"",
-""DailyCount"",I,200,4,0,8,0,,"""",""2020 AWDT count volume"",,""Copy"",
-""DailyCountSUT"",I,204,4,0,8,0,,"""",""2020 AWDT SUT count volume"",,""Copy"",
-""DailyCountMUT"",I,208,4,0,8,0,,"""",""2020 AWDT MUT count volume"",,""Copy"",
-""Screenline"",I,212,4,0,8,0,,"""",""The screenline this link belongs to (if any)||The line layer of screenlines is stored in|master/networks/screenlines"",,""Copy"",
-""Cutline"",I,216,4,0,8,0,,"""",""The cutline this link belongs to (if any)||The line layer of screenlines is stored in|master/networks/screenlines"",,""Copy"",
-""p1ID"",C,220,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
-""p1Dir"",S,236,2,0,4,0,,"""","""",,""Copy"",
-""p1NCDOTClass"",C,238,16,0,16,0,,"""",""Project Field|This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"",
-""p1HCMType"",C,254,14,0,14,0,,"""",""Project Field|Highway Capacity Manual Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|Superstreet|MajorArterial|Arterial|MajorCollector|Collector|Local|Ramp|CC|TransitOnly"",,""Copy"",
-""p1ABLanes"",I,268,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""p1BALanes"",I,272,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""p1PostedSpeed"",I,276,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
-""p1HCMMedian"",C,280,14,0,14,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
-""p1DTWB"",C,294,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
-""p1HOV"",C,303,4,0,4,0,,"""",""Project Field|None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
-""p1BOSSS"",I,307,4,0,8,0,,"""",""Project Field|Bus on Side Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Copy"",
-""p1TollType"",C,311,4,0,4,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
-""p2ID"",C,315,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
-""p2Dir"",S,331,2,0,4,0,,"""","""",,""Copy"",
-""p2NCDOTClass"",C,333,16,0,16,0,,"""",""Project Field|This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"",
-""p2HCMType"",C,349,14,0,14,0,,"""",""Project Field|Highway Capacity Manual Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|Superstreet|MajorArterial|Arterial|MajorCollector|Collector|Local|Ramp|CC|TransitOnly"",,""Copy"",
-""p2ABLanes"",I,363,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""p2BALanes"",I,367,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""p2PostedSpeed"",I,371,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
-""p2HCMMedian"",C,375,14,0,14,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
-""p2DTWB"",C,389,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
-""p2HOV"",C,398,4,0,4,0,,"""",""Project Field|None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
-""p2BOSSS"",I,402,4,0,8,0,,"""",""Project Field|Bus on Side Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Copy"",
-""p2TollType"",C,406,4,0,4,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
-""p3ID"",C,410,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
-""p3Dir"",S,426,2,0,4,0,,"""","""",,""Copy"",
-""p3NCDOTClass"",C,428,16,0,16,0,,"""",""Project Field|This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"",
-""p3HCMType"",C,444,14,0,14,0,,"""",""Project Field|Highway Capacity Manual Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|Superstreet|MajorArterial|Arterial|MajorCollector|Collector|Local|Ramp|CC|TransitOnly"",,""Copy"",
-""p3ABLanes"",I,458,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""p3BALanes"",I,462,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""p3PostedSpeed"",I,466,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
-""p3HCMMedian"",C,470,14,0,14,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
-""p3DTWB"",C,484,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
-""p3HOV"",C,493,4,0,4,0,,"""",""Project Field|None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
-""p3BOSSS"",I,497,4,0,8,0,,"""",""Project Field|Bus on Side Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Copy"",
-""p3TollType"",C,501,4,0,4,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
-""p4ID"",C,505,16,0,16,0,,"""","""",,""Copy"",
-""p4Dir"",S,521,2,0,4,0,,"""","""",,""Copy"",
-""p4NCDOTClass"",C,523,16,0,16,0,,"""","""",,""Copy"",
-""p4HCMType"",C,539,14,0,14,0,,"""","""",,""Copy"",
-""p4ABLanes"",I,553,4,0,8,0,,"""","""",,""Copy"",
-""p4BALanes"",I,557,4,0,8,0,,"""","""",,""Copy"",
-""p4PostedSpeed"",I,561,4,0,8,0,,"""","""",,""Copy"",
-""p4HCMMedian"",C,565,14,0,14,0,,"""","""",,""Copy"",
-""p4DTWB"",C,579,9,0,9,0,,"""","""",,""Copy"",
-""p4HOV"",C,588,4,0,4,0,,"""","""",,""Copy"",
-""p4BOSSS"",I,592,4,0,8,0,,"""","""",,""Copy"",
-""p4TollType"",C,596,4,0,4,0,,"""","""",,""Copy"",
+""CountID"",C,164,16,0,16,0,,"""",""The CVG/VLM ID of the count"",,""Copy"",
+""CountPointID"",I,180,4,0,8,0,,"""",""The point ID from the count geo file"",,""Copy"",
+""DailyCount"",I,184,4,0,8,0,,"""",""2020 AWDT count volume"",,""Copy"",
+""DailyCountSUT"",I,188,4,0,8,0,,"""",""2020 AWDT SUT count volume"",,""Copy"",
+""DailyCountMUT"",I,192,4,0,8,0,,"""",""2020 AWDT MUT count volume"",,""Copy"",
+""Screenline"",I,196,4,0,8,0,,"""",""The screenline this link belongs to (if any)||The line layer of screenlines is stored in|master/networks/screenlines"",,""Copy"",
+""Cutline"",I,200,4,0,8,0,,"""",""The cutline this link belongs to (if any)||The line layer of screenlines is stored in|master/networks/screenlines"",,""Copy"",
+""p1ID"",C,204,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
+""p1Dir"",S,220,2,0,4,0,,"""","""",,""Copy"",
+""p1NCDOTClass"",C,222,16,0,16,0,,"""",""Project Field|This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"",
+""p1HCMType"",C,238,14,0,14,0,,"""",""Project Field|Highway Capacity Manual Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|Superstreet|MajorArterial|Arterial|MajorCollector|Collector|Local|Ramp|CC|TransitOnly"",,""Copy"",
+""p1ABLanes"",I,252,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""p1BALanes"",I,256,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""p1PostedSpeed"",I,260,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
+""p1HCMMedian"",C,264,14,0,14,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
+""p1DTWB"",C,278,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
+""p1HOV"",C,287,4,0,4,0,,"""",""Project Field|None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
+""p1BOSSS"",I,291,4,0,8,0,,"""",""Project Field|Bus on Side Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Copy"",
+""p1TollType"",C,295,4,0,4,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
+""p2ID"",C,299,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
+""p2Dir"",S,315,2,0,4,0,,"""","""",,""Copy"",
+""p2NCDOTClass"",C,317,16,0,16,0,,"""",""Project Field|This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"",
+""p2HCMType"",C,333,14,0,14,0,,"""",""Project Field|Highway Capacity Manual Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|Superstreet|MajorArterial|Arterial|MajorCollector|Collector|Local|Ramp|CC|TransitOnly"",,""Copy"",
+""p2ABLanes"",I,347,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""p2BALanes"",I,351,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""p2PostedSpeed"",I,355,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
+""p2HCMMedian"",C,359,14,0,14,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
+""p2DTWB"",C,373,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
+""p2HOV"",C,382,4,0,4,0,,"""",""Project Field|None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
+""p2BOSSS"",I,386,4,0,8,0,,"""",""Project Field|Bus on Side Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Copy"",
+""p2TollType"",C,390,4,0,4,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
+""p3ID"",C,394,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
+""p3Dir"",S,410,2,0,4,0,,"""","""",,""Copy"",
+""p3NCDOTClass"",C,412,16,0,16,0,,"""",""Project Field|This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"",
+""p3HCMType"",C,428,14,0,14,0,,"""",""Project Field|Highway Capacity Manual Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|Superstreet|MajorArterial|Arterial|MajorCollector|Collector|Local|Ramp|CC|TransitOnly"",,""Copy"",
+""p3ABLanes"",I,442,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""p3BALanes"",I,446,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""p3PostedSpeed"",I,450,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
+""p3HCMMedian"",C,454,14,0,14,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
+""p3DTWB"",C,468,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
+""p3HOV"",C,477,4,0,4,0,,"""",""Project Field|None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
+""p3BOSSS"",I,481,4,0,8,0,,"""",""Project Field|Bus on Side Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Copy"",
+""p3TollType"",C,485,4,0,4,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
+""p4ID"",C,489,16,0,16,0,,"""","""",,""Copy"",
+""p4Dir"",S,505,2,0,4,0,,"""","""",,""Copy"",
+""p4NCDOTClass"",C,507,16,0,16,0,,"""","""",,""Copy"",
+""p4HCMType"",C,523,14,0,14,0,,"""","""",,""Copy"",
+""p4ABLanes"",I,537,4,0,8,0,,"""","""",,""Copy"",
+""p4BALanes"",I,541,4,0,8,0,,"""","""",,""Copy"",
+""p4PostedSpeed"",I,545,4,0,8,0,,"""","""",,""Copy"",
+""p4HCMMedian"",C,549,14,0,14,0,,"""","""",,""Copy"",
+""p4DTWB"",C,563,9,0,9,0,,"""","""",,""Copy"",
+""p4HOV"",C,572,4,0,4,0,,"""","""",,""Copy"",
+""p4BOSSS"",I,576,4,0,8,0,,"""","""",,""Copy"",
+""p4TollType"",C,580,4,0,4,0,,"""","""",,""Copy"","
Triangle-Modeling-and-Analytics,TRMG2,a4faec376ec2ad781fadde6f70af73035b2369eb,Si Shi,si_shi_itre@ncsu.edu,2024-01-12T18:33:03Z,Si Shi,si_shi_itre@ncsu.edu,2024-01-12T18:33:03Z,Fix project list separation issues,src/01 - CreateScenario.rsc;src/utils/RoadwayProjectManagement.rsc,False,False,False,False,3,3,6,"---FILE: src/01 - CreateScenario.rsc---
@@ -47,10 +47,10 @@ Macro ""Check for Creation Files"" (Args)
     scen_dir
   )
   else if GetFileInfo(scen_dir + ""/RoadwayProjectList_CAMPO.csv"") = null then Throw(
-    ""The scenario directory is missing RoadwayProjectList.csv""
+    ""The scenario directory is missing RoadwayProjectList_CAMPO.csv""
   )
   else if GetFileInfo(scen_dir + ""/RoadwayProjectList_DCHC.csv"") = null then Throw(
-    ""The scenario directory is missing RoadwayProjectList.csv""
+    ""The scenario directory is missing RoadwaRoadwayProjectList_DCHCyProjectList.csv""
   )
   else if GetFileInfo(scen_dir + ""/TransitProjectList.csv"") = null then Throw(
     ""The scenario directory is missing TransitProjectList.csv""

---FILE: src/utils/RoadwayProjectManagement.rsc---
@@ -86,7 +86,7 @@ Macro ""Roadway Project Management"" (MacroOpts)
   attrList = attrList + {""position""}
 
   // Add fields that tell project positions in the project list
-  RunMacro(""Add Project Position"", llyr, proj_list, projGroups)
+  RunMacro(""Add Project Position"", llyr, output_proj_list, projGroups)
 
   // Build a named array of vectors to work with
   for p in {""""} + projGroups do"
Triangle-Modeling-and-Analytics,TRMG2,b9f0b1d20a2a5a6dfeb801b3d02a3b565cca42b3,Si Shi,si_shi_itre@ncsu.edu,2024-01-09T16:30:39Z,Si Shi,si_shi_itre@ncsu.edu,2024-01-09T16:30:39Z,Revise formatting issues with validation tool and fix bug in daily trip aggregation tool,other/_reportingtool/validation_obs_data/Target_HB_MCShares_agg.csv;other/_reportingtool/validation_obs_data/ao_calib_targets.csv;other/_reportingtool/validation_obs_data/hb_trip_stats_by_type_obs.csv;other/_reportingtool/validation_obs_data/nm_calibration_targets.csv;other/_reportingtool/validation_obs_data/transit_ridership.csv;other/_reportingtool/validation_tablenames.csv;src/19 - Summaries.rsc;src/utils/concatenate.rsc;src/utils/trip_aggregation_daily.rsc,False,False,False,False,174,125,299,"---FILE: other/_reportingtool/validation_obs_data/Target_HB_MCShares_agg.csv---
@@ -1,55 +1,55 @@
 trip_type,mode,obs_share
-W_HB_EK12_All,sov,0.0151
-W_HB_EK12_All,hov2,0.4955
-W_HB_EK12_All,hov3,0.4874
-W_HB_EK12_All,other_auto,0.002
-W_HB_O_All,sov,0.7006
-W_HB_O_All,hov2,0.1656
-W_HB_O_All,hov3,0.106
-W_HB_O_All,auto_pay,0.001
-W_HB_O_All,other_auto,0.0185
-W_HB_O_All,w_lb,0.0062
-W_HB_O_All,w_eb,0.0021
-W_HB_W_All,sov,0.8805
-W_HB_W_All,hov2,0.0494
-W_HB_W_All,hov3,0.0185
-W_HB_W_All,auto_pay,0.0062
-W_HB_W_All,other_auto,0.0247
-W_HB_W_All,w_lb,0.0175
-W_HB_W_All,w_eb,0.0031
-N_HB_K12_All,sov,0.1775
-N_HB_K12_All,hov2,0.2384
-N_HB_K12_All,hov3,0.3096
-N_HB_K12_All,auto_pay,0.001
-N_HB_K12_All,other_auto,0.0485
-N_HB_K12_All,w_lb,0.0062
-N_HB_K12_All,w_eb,0.001
-N_HB_K12_All,school_bus,0.2178
-N_HB_OD_Long,sov,0.4283
-N_HB_OD_Long,hov2,0.2427
-N_HB_OD_Long,hov3,0.2481
-N_HB_OD_Long,auto_pay,0.0043
-N_HB_OD_Long,other_auto,0.055
-N_HB_OD_Long,w_lb,0.0151
-N_HB_OD_Long,w_eb,0.0011
-N_HB_OD_Long,school_bus,0.0054
-N_HB_OD_Short,sov,0.4099
-N_HB_OD_Short,hov2,0.297
-N_HB_OD_Short,hov3,0.2608
-N_HB_OD_Short,auto_pay,0.0027
-N_HB_OD_Short,other_auto,0.0121
-N_HB_OD_Short,w_lb,0.0134
-N_HB_OD_Short,school_bus,0.004
-N_HB_OME_All,sov,0.4598
-N_HB_OME_All,hov2,0.2918
-N_HB_OME_All,hov3,0.2019
-N_HB_OME_All,auto_pay,0.0053
-N_HB_OME_All,other_auto,0.0349
-N_HB_OME_All,w_lb,0.0063
-N_HB_OMED_All,sov,0.4213
-N_HB_OMED_All,hov2,0.3039
-N_HB_OMED_All,hov3,0.1354
-N_HB_OMED_All,auto_pay,0.0281
-N_HB_OMED_All,other_auto,0.0853
-N_HB_OMED_All,w_lb,0.0251
-N_HB_OMED_All,w_eb,0.001
+W_HB_EK12_All,sov,0.02
+W_HB_EK12_All,hov2,0.50
+W_HB_EK12_All,hov3,0.49
+W_HB_EK12_All,other_auto,0.00
+W_HB_O_All,sov,0.70
+W_HB_O_All,hov2,0.17
+W_HB_O_All,hov3,0.11
+W_HB_O_All,auto_pay,0.00
+W_HB_O_All,other_auto,0.02
+W_HB_O_All,w_lb,0.01
+W_HB_O_All,w_eb,0.00
+W_HB_W_All,sov,0.88
+W_HB_W_All,hov2,0.05
+W_HB_W_All,hov3,0.02
+W_HB_W_All,auto_pay,0.01
+W_HB_W_All,other_auto,0.02
+W_HB_W_All,w_lb,0.02
+W_HB_W_All,w_eb,0.00
+N_HB_K12_All,sov,0.18
+N_HB_K12_All,hov2,0.24
+N_HB_K12_All,hov3,0.31
+N_HB_K12_All,auto_pay,0.00
+N_HB_K12_All,other_auto,0.05
+N_HB_K12_All,w_lb,0.01
+N_HB_K12_All,w_eb,0.00
+N_HB_K12_All,school_bus,0.22
+N_HB_OD_Long,sov,0.43
+N_HB_OD_Long,hov2,0.24
+N_HB_OD_Long,hov3,0.25
+N_HB_OD_Long,auto_pay,0.00
+N_HB_OD_Long,other_auto,0.06
+N_HB_OD_Long,w_lb,0.02
+N_HB_OD_Long,w_eb,0.00
+N_HB_OD_Long,school_bus,0.01
+N_HB_OD_Short,sov,0.41
+N_HB_OD_Short,hov2,0.30
+N_HB_OD_Short,hov3,0.26
+N_HB_OD_Short,auto_pay,0.00
+N_HB_OD_Short,other_auto,0.01
+N_HB_OD_Short,w_lb,0.01
+N_HB_OD_Short,school_bus,0.00
+N_HB_OME_All,sov,0.46
+N_HB_OME_All,hov2,0.29
+N_HB_OME_All,hov3,0.20
+N_HB_OME_All,auto_pay,0.01
+N_HB_OME_All,other_auto,0.03
+N_HB_OME_All,w_lb,0.01
+N_HB_OMED_All,sov,0.42
+N_HB_OMED_All,hov2,0.30
+N_HB_OMED_All,hov3,0.14
+N_HB_OMED_All,auto_pay,0.03
+N_HB_OMED_All,other_auto,0.09
+N_HB_OMED_All,w_lb,0.03
+N_HB_OMED_All,w_eb,0.00

---FILE: other/_reportingtool/validation_obs_data/ao_calib_targets.csv---
@@ -1,6 +1,6 @@
 autos,weight,pct
-0,35059.99996,0.05059324004796845
-1,217978.63647,0.3145534938059812
-2,288793.6019,0.4167428420397562
-3,106067.18372,0.1530599684335519
-4,45078.53166,0.06505045567274227
+0,"" 35,060 "",0.05
+1,"" 217,979 "",0.31
+2,"" 288,794 "",0.42
+3,"" 106,067 "",0.15
+4,"" 45,079 "",0.07

---FILE: other/_reportingtool/validation_obs_data/hb_trip_stats_by_type_obs.csv---
@@ -1,9 +1,9 @@
-""matrix"",""core"",""Sum"",""SumDiag"",""PctDiag"",""avg_length_mi"",""avg_time_min""
-""N_HB_K12_All"",""trip_weight"",210608.83,4879.27,2.31675,6.08397,8.69448
-""N_HB_OD_Long"",""trip_weight"",226032.60,17301.77,7.65455,5.89351,8.29963
-""N_HB_OD_Short"",""trip_weight"",226032.60,17301.77,7.65455,5.89351,8.29963
-""N_HB_OMED_All"",""trip_weight"",64425.22,364.695,0.566075,10.3561,13.9789
-""N_HB_OME_All"",""trip_weight"",552691.55,18290.68,3.30938,5.72655,8.01208
-""W_HB_EK12_All"",""trip_weight"",54386.27,624.053,1.14745,5.96125,8.46662
-""W_HB_O_All"",""trip_weight"",289949.46,9648.32,3.32759,7.45216,10.0336
-""W_HB_W_All"",""trip_weight"",368966.30,3588.58,0.972604,12.5176,16.5139
+matrix,core,Sum,SumDiag,PctDiag,avg_length_mi,avg_time_min
+N_HB_K12_All,trip_weight,"" 210,609 "","" 4,879 "",2.32,6.08,8.69
+N_HB_OD_Long,trip_weight,"" 226,033 "","" 17,302 "",7.65,5.89,8.30
+N_HB_OD_Short,trip_weight,"" 226,033 "","" 17,302 "",7.65,5.89,8.30
+N_HB_OMED_All,trip_weight,"" 64,425 "", 365 ,0.57,10.36,13.98
+N_HB_OME_All,trip_weight,"" 552,692 "","" 18,291 "",3.31,5.73,8.01
+W_HB_EK12_All,trip_weight,"" 54,386 "", 624 ,1.15,5.96,8.47
+W_HB_O_All,trip_weight,"" 289,949 "","" 9,648 "",3.33,7.45,10.03
+W_HB_W_All,trip_weight,"" 368,966 "","" 3,589 "",0.97,12.52,16.51

---FILE: other/_reportingtool/validation_obs_data/nm_calibration_targets.csv---
@@ -1,15 +1,15 @@
 trip_type,obs_nm_share
-W_HB_EK12_All,0.8
-W_HB_O_All,2.6
-W_HB_W_All,2.9
-W_NH_EK12_All,1.3
-W_NH_O_All,12.4
-W_NH_WR_All,12.3
-N_HB_K12_All,2.9
-N_HB_OD_Long,7.4
-N_HB_OD_Short,25.8
-N_HB_OME_All,5.4
-N_HB_OMED_All,0.4
-N_NH_K12_All,6.9
-N_NH_O_All,12.2
-N_NH_OME_All,5.5
+W_HB_EK12_All,0.008
+W_HB_O_All,0.026
+W_HB_W_All,0.029
+W_NH_EK12_All,0.013
+W_NH_O_All,0.124
+W_NH_WR_All,0.123
+N_HB_K12_All,0.029
+N_HB_OD_Long,0.074
+N_HB_OD_Short,0.258
+N_HB_OME_All,0.054
+N_HB_OMED_All,0.004
+N_NH_K12_All,0.069
+N_NH_O_All,0.122
+N_NH_OME_All,0.055

---FILE: other/_reportingtool/validation_obs_data/transit_ridership.csv---
@@ -1,11 +1,11 @@
 Agency,obs_ridership
-Chapel Hill Transit,26444
+Chapel Hill Transit,26444 
 Chatham Transit,
-Duke,13602
-GoCary,1003
-GoDurham,21602
-GoRaleigh,23489
-GoTriangle,9691
-NCSU Wolfline,16699
+Duke,13602 
+GoCary,1003 
+GoDurham,21602 
+GoRaleigh,23489 
+GoTriangle,9691 
+NCSU Wolfline,16699 
 Orange County Public Transit,
 PART,

---FILE: other/_reportingtool/validation_tablenames.csv---
@@ -0,0 +1,13 @@
+dir,tablename
+validation,ao_ownership.csv
+validation,nonmotorized.csv
+validation,modechoice.csv
+validation,destinationchoice.csv
+validation,transitassignment.csv
+validation,count_comparison_regional.csv
+validation,count_comparison_by_cutline.csv
+validation,count_comparison_by_screenline.csv
+validation,count_comparison_by_vol_group.csv
+validation,count_comparison_by_fac_type.csv
+validation,count_comparison_by_ft_and_at.csv
+validation,count_comparison_by_ft_and_at_and_med.csv

---FILE: src/19 - Summaries.rsc---
@@ -17,9 +17,9 @@ Macro ""Maps"" (Args)
 endmacro
 
 Macro ""Calibration Reports"" (Args)
-    /*
+    
     RunMacro(""Count PRMSEs"", Args)
-    */
+    
     return(1)
 endmacro
 
@@ -315,7 +315,7 @@ Macro ""Count PRMSEs"" (Args)
   opts.median_field = ""HCMMedian""
   opts.screenline_field = ""Cutline""
   opts.volume_breaks = {10000, 25000, 50000, 100000}
-  opts.out_dir = Args.[Output Folder] + ""/_summaries/roadway_tables""
+  opts.out_dir = Args.[Output Folder] + ""/_summaries/validation""
   RunMacro(""Roadway Count Comparison Tables"", opts)
 
   // Rename screenline to cutline
@@ -2375,10 +2375,6 @@ Macro ""Validation Reports"" (Args)
   est_data = summary_dir + ""/nm_summary.csv""
   
   est_tbl = CreateObject(""Table"", est_data)
-  est_tbl.RenameField({FieldName: ""moto_total"", NewName: ""est_moto_trips""})
-  est_tbl.RenameField({FieldName: ""moto_share"", NewName: ""est_moto_share""})
-  est_tbl.RenameField({FieldName: ""nm_total"", NewName: ""est_nm_trips""})
-  est_tbl.RenameField({FieldName: ""nm_share"", NewName: ""est_nm_share""})
 
   obs_tbl = CreateObject(""Table"", obs_data)
   obs_tbl.RenameField({FieldName: ""nonmotorized"", NewName: ""obs_nm_share""})
@@ -2391,9 +2387,15 @@ Macro ""Validation Reports"" (Args)
   join.Export({FileName: validation_dir + ""/nonmotorized.bin""})
 
   join = CreateObject(""Table"", validation_dir + ""/nonmotorized.bin"")
-  join.AddField({FieldName: ""pct_diff_nm_share"", Type: ""real""})
-  join.pct_diff_nm_share = (join.est_nm_share - join.obs_nm_share)/join.obs_nm_share
-  join.DropFields({FieldNames: {""trip_type:1"",	""est_nm_trips""}})
+  join.AddField({FieldName: ""est_nm_share"", Type: ""string""})
+  join.AddField({FieldName: ""pcfdiff_nm_share"", Type: ""string""})
+  v1 = join.nm_share/100
+  join.est_nm_share = Format(v1, ""*.000"")
+  v2 = (join.nm_share - join.obs_nm_share)/join.obs_nm_share
+  //v = if v = null then 0 else v
+  join.pcfdiff_nm_share = Format(v2, ""*.00"")
+  join.DropFields({FieldNames:{""trip_type:1"", ""moto_total"", ""moto_share"", ""nm_total"", ""nm_share""}})
+
   join.Export({FileName: validation_dir + ""/nonmotorized.csv""})
   join = null
 
@@ -2409,12 +2411,14 @@ Macro ""Validation Reports"" (Args)
     GroupBy: ""Autos"",
     FieldStats: {WEIGHT: ""sum""}
   })
-  agg_est_tbl.RenameField({FieldName: ""sum_WEIGHT"", NewName: ""est_weight""})
-  agg_est_tbl.AddField(""est_share"")
-	sum_est_weight = VectorStatistic(agg_est_tbl.est_weight, ""Sum"", )
-  v_est_share = agg_est_tbl.est_weight / sum_est_weight
-	agg_est_tbl.est_share = v_est_share
-  agg_est_tbl.AddField(""pct_diff_share"")
+	sum_est_weight = VectorStatistic(agg_est_tbl.sum_WEIGHT, ""Sum"", )
+  v_est_share = agg_est_tbl.sum_WEIGHT / sum_est_weight
+  agg_est_tbl.AddField({FieldName: ""est_weight"", Type: ""string""})
+  agg_est_tbl.AddField({FieldName: ""est_share_temp"", Type: ""real""})
+  agg_est_tbl.AddField({FieldName: ""est_share"", Type: ""string""})
+  agg_est_tbl.AddField({FieldName: ""pcfdiff_share"", Type: ""string""})
+  agg_est_tbl.est_weight = Format(agg_est_tbl.sum_WEIGHT, "",*0."")
+  agg_est_tbl.est_share_temp = v_est_share
   
   obs_tbl = CreateObject(""Table"", obs_data)
   obs_tbl.RenameField({FieldName: ""weight"", NewName: ""obs_weight""})
@@ -2425,10 +2429,18 @@ Macro ""Validation Reports"" (Args)
 		LeftFields: ""autos"",
 		RightFields: ""Autos""
 	})
-	join.pct_diff_share = (join.est_share - join.obs_share)/join.obs_share
-  //join.DropFields({FieldNames: {""Autos:1""}})
+  join.Export({FileName: validation_dir + ""/ao.bin""})
+
+  join = CreateObject(""Table"", validation_dir + ""/ao.bin"")
+	v = (join.est_share_temp - join.obs_share)/join.obs_share
+  join.pcfdiff_share = Format(v, ""*.00"")
+  join.est_share = Format(join.est_share_temp, "",*.00"")
+  join.DropFields({FieldNames:{""sum_WEIGHT"", ""est_share_temp""}})
   join.Export({FileName: validation_dir + ""/ao_ownership.csv""})
+  join = null
 
+  DeleteFile(validation_dir + ""/ao.bin"")
+  DeleteFile(validation_dir + ""/ao.dcb"")
 
   //3. Destination Choice
   obs_data = obs_dir + ""/hb_trip_stats_by_type_obs.csv""
@@ -2437,7 +2449,6 @@ Macro ""Validation Reports"" (Args)
   obs_tbl = CreateObject(""Table"", obs_data)
   obs_tbl.RenameField({FieldName: ""avg_length_mi"", NewName: ""obs_avg_length_mi""})
   est_tbl = CreateObject(""Table"", est_data)
-  est_tbl.RenameField({FieldName: ""avg_length_mi"", NewName: ""est_avg_length_mi""})
 
   join = obs_tbl.Join({
       Table: est_tbl,
@@ -2447,9 +2458,12 @@ Macro ""Validation Reports"" (Args)
   join.Export({FileName: validation_dir + ""/destinationchoice.bin""})
 
   join = CreateObject(""Table"", validation_dir + ""/destinationchoice.bin"")
-  join.AddField(""pct_diff_length_mi"")
-  join.pct_diff_length_mi = (join.est_avg_length_mi - join.obs_avg_length_mi)/join.obs_avg_length_mi
-  join.DropFields({FieldNames: {""core"",	""Sum"",	""SumDiag"",	""PctDiag"", ""avg_time_min"", ""matrix:1"",	""core:1"",	""Sum:1"",	""SumDiag:1"",	""PctDiag:1"", ""avg_time_min:1""}})
+  join.AddField({FieldName: ""est_avg_length_mi"", Type: ""string""})
+  join.est_avg_length_mi = Format(join.avg_length_mi, ""*.00"")
+  join.AddField({FieldName: ""pcfdiff_length_mi"", Type: ""string""})
+  v = (join.avg_length_mi - join.obs_avg_length_mi)/join.obs_avg_length_mi
+  join.pcfdiff_length_mi = Format(v, ""*.00"")
+  join.DropFields({FieldNames: {""core"",	""Sum"",	""SumDiag"",	""PctDiag"", ""avg_length_mi"", ""avg_time_min"", ""matrix:1"",	""core:1"",	""Sum:1"",	""SumDiag:1"",	""PctDiag:1"", ""avg_time_min:1""}})
   join.Export({FileName: validation_dir + ""/destinationchoice.csv""})
   join = null
 
@@ -2473,8 +2487,9 @@ Macro ""Validation Reports"" (Args)
   join.Export({FileName: validation_dir + ""/modechoice.bin""})
 
   join = CreateObject(""Table"", validation_dir + ""/modechoice.bin"")
-  join.AddField(""pct_diff_share"")
-  join.pct_diff_share = (join.est_share - join.obs_share)/join.obs_share
+  join.AddField({FieldName: ""pcfdiff_share"", Type: ""string""})
+  v = (join.est_share - join.obs_share)/join.obs_share
+  join.pcfdiff_share = Format(v, ""*.00"")
   join.DropFields({FieldNames: {""trip_type:1"",	""mode:1"",	""Sum"",	""total""}})
   join.Export({FileName: validation_dir + ""/modechoice.csv""})
   join = null
@@ -2487,9 +2502,9 @@ Macro ""Validation Reports"" (Args)
   est_data = summary_dir + ""/transit/boardings_and_alightings_daily_by_agency.csv""
 
   obs_tbl = CreateObject(""Table"", obs_data)
-
+  obs_tbl.RenameField({FieldName: ""obs_ridership"", NewName: ""obs_ridership_temp""})
   est_tbl = CreateObject(""Table"", est_data)
-  est_tbl.RenameField({FieldName: ""On"", NewName: ""est_ridership""})
+  est_tbl.RenameField({FieldName: ""On"", NewName: ""est_ridership_temp""})
 
   join = obs_tbl.Join({
       Table: est_tbl,
@@ -2499,14 +2514,28 @@ Macro ""Validation Reports"" (Args)
   join.Export({FileName: validation_dir + ""/transitassignment.bin""})
 
   join = CreateObject(""Table"", validation_dir + ""/transitassignment.bin"")
-  join.AddField(""pct_diff_ridership"")
-  join.pct_diff_ridership = (join.est_ridership - join.obs_ridership)/join.obs_ridership
-  join.DropFields({FieldNames: {""agency:1"", ""Off"",	""DriveAccessOn"",	""WalkAccessOn"",	""DirectTransferOn"",	""WalkTransferOn"",	""DirectTransferOff"",	""WalkTransferOff"",	""EgressOff""}})
+  join.AddField({FieldName: ""obs_ridership"", Type: ""string""})
+  join.obs_ridership = Format(join.obs_ridership_temp, ""*,."")
+  join.AddField({FieldName: ""est_ridership"", Type: ""string""})
+  join.est_ridership = Format(join.est_ridership_temp, ""*,."")
+  join.AddField({FieldName: ""pcfdiff_ridership"", Type: ""string""})
+  v = (join.est_ridership_temp - join.obs_ridership_temp)/join.obs_ridership_temp
+  join.pcfdiff_ridership = Format(v, ""*.00"")
+  join.DropFields({FieldNames: {""obs_ridership_temp"", ""agency:1"", ""est_ridership_temp"",""Off"",	""DriveAccessOn"",	""WalkAccessOn"",	""DirectTransferOn"",	""WalkTransferOn"",	""DirectTransferOff"",	""WalkTransferOff"",	""EgressOff""}})
   join.Export({FileName: validation_dir + ""/transitassignment.csv""})
   join = null
 
   DeleteFile(validation_dir + ""/transitassignment.bin"")
   DeleteFile(validation_dir + ""/transitassignment.dcb"")
 
+  //6. R-square for Regionwide Estimated Volumes vs. Traffic Counts
 
+  //7. Concatenate reports
+  opts = null
+  opts.model_dir = Args.[Base Folder]
+  opts.scen_dir = Args.[Scenario Folder]
+  opts.inputtable_file = opts.model_dir + ""\\other\\_reportingtool\\validation_tablenames.csv""
+  opts.output_file = opts.scen_dir + ""\\output\\_summaries\\validation\\validation_summary.csv""
+  RunMacro(""Concatenate Files"", opts)
+  
 endmacro
\ No newline at end of file

---FILE: src/utils/concatenate.rsc---
@@ -29,8 +29,11 @@ dBox ""Concatenate Files"" (Args) center, center, 60, 6
 
     // Run Button
     button 18, 4, 20 Prompt:""Generate Results"" do 
-
-        if !RunMacro(""Concatenate Files"", Args) then Throw(""Something went wrong"")
+        opts.model_dir = Args.[Base Folder]
+        opts.scen_dir = Args.[Scenario Folder]
+        opts.inputtable_file = opts.model_dir + ""\\other\\_reportingtool\\Concatenate_tablenames.csv""
+        opts.output_file = opts.scen_dir + ""\\output\\_summaries\\concatenate_summary.csv""
+        if !RunMacro(""Concatenate Files"", opts) then Throw(""Something went wrong"")
  
         ShowMessage(""Reports have been created successfully."")
 	return(1)
@@ -49,11 +52,10 @@ enddbox
 
 
 Macro ""Concatenate Files"" (Args)
-    model_dir = Args.[Base Folder]
-    scen_dir = Args.[Scenario Folder]
-    summary_dir = Args.[Summary Folder]
-    inputtable_file = model_dir + ""\\other\\_reportingtool\\Concatenate_tablenames.csv""
-    output_file = summary_dir + ""\\concatenate_summary.csv""
+    scen_dir = Args.scen_dir
+    summary_dir = scen_dir + ""\\output\\_summaries""
+    inputtable_file = Args.inputtable_file
+    output_file = Args.output_file
     if GetFileInfo(output_file) <> null then deleteFile(output_file)
     
     input_vw = OpenTable(""inputtable"", ""CSV"", {inputtable_file})  

---FILE: src/utils/trip_aggregation_daily.rsc---
@@ -52,6 +52,11 @@ Macro ""Create matrix"" (Args)
         daily_mtx = CreateObject(""Matrix"", out_file_daily)
         core_names = daily_mtx.GetCoreNames()
 
+        for core_name in core_names do
+            daily_mtx.(core_name) := 0 //reset everything to 0
+        end 
+        
+        
         for period in periods do        
             if market = ""university"" then
                 mtx_file = dir + ""\\"" + market + ""_trips_"" + period + "".mtx"""
Triangle-Modeling-and-Analytics,TRMG2,58e8f5d834ed47b80215355ea01d9d22a2d154dc,Si Shi,si_shi_itre@ncsu.edu,2023-12-11T20:11:14Z,Si Shi,si_shi_itre@ncsu.edu,2023-12-11T20:11:14Z,Fix scenario comparison tool when subarea is provided,src/utils/ScenarioComparison.rsc,False,False,False,False,1,1,2,"---FILE: src/utils/ScenarioComparison.rsc---
@@ -179,7 +179,7 @@ Macro ""Compare Summary Tables"" (MacroOpts)
     if sub_poly <> null then tables_to_compare = tables_to_compare + {
         {""/output/_summaries/resident_hb/hb_trip_mode_shares_subarea_by_subarea.csv"", {""trip_type"", ""mode""}, {""total"", ""pct""}},
         {""/output/_summaries/resident_hb/hb_trip_stats_by_modeperiod_subarea_by_subarea.csv"", {""trip_type"", ""period"", ""mode""}, {""Sum"", ""SumDiag"", ""PctDiag""}},
-        {""/output/_summaries/overall_mode_shares_subarea_bytaz.bin"", {""County""}, {""sov"", ""hov"", ""transit"", ""nm""}},
+        {""/output/_summaries/overall_mode_shares_subarea_bytaz.bin"", {""TAZ""}, {""sov"", ""hov"", ""transit"", ""nm""}},
         {""/output/_summaries/hhstrata_subarea.csv"", {""market_segment""}, {""count""}}
     }
 "
Triangle-Modeling-and-Analytics,TRMG2,46cde96dae66c5c07517362f8d100e8fbd04e267,Kyle Ward,kyleward084@gmail.com,2023-12-08T16:46:58Z,Kyle Ward,kyleward084@gmail.com,2023-12-08T16:46:58Z,"Change ID field width to 10

This avoids a bug in TC 9 where exporting the bin file leads to the ID field being changed to a 2-byte integer. (This bug has been fixed in TC 10.)",master/networks/master_links.DCB,False,False,False,False,1,1,2,"---FILE: master/networks/master_links.DCB---
@@ -1,6 +1,6 @@
 master_links
 599
-""ID"",I,1,4,0,4,0,,"""","""",,""Sum"",
+""ID"",I,1,4,0,10,0,,"""","""",,""Sum"",
 ""RoadName"",C,5,32,0,32,0,,"""","""",,""Copy"",
 ""AltName"",C,37,32,0,32,0,,"""","""",,""Copy"",
 ""NCDOTClass"",C,69,14,0,14,0,,"""",""This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"","
Triangle-Modeling-and-Analytics,TRMG2,fbfb93870e1951128b26ef75a8ca68d2638135cf,Si Shi,si_shi_itre@ncsu.edu,2023-11-20T20:12:54Z,Si Shi,si_shi_itre@ncsu.edu,2023-11-20T20:12:54Z,Fix bug in the scenario comparison tool,src/utils/ScenarioComparison.rsc,False,False,False,False,1,1,2,"---FILE: src/utils/ScenarioComparison.rsc---
@@ -179,7 +179,7 @@ Macro ""Compare Summary Tables"" (MacroOpts)
     if sub_poly <> null then tables_to_compare = tables_to_compare + {
         {""/output/_summaries/resident_hb/hb_trip_mode_shares_subarea_by_subarea.csv"", {""trip_type"", ""mode""}, {""total"", ""pct""}},
         {""/output/_summaries/resident_hb/hb_trip_stats_by_modeperiod_subarea_by_subarea.csv"", {""trip_type"", ""period"", ""mode""}, {""Sum"", ""SumDiag"", ""PctDiag""}},
-        {""/output/_summaries/overall_mode_shares_subarea.bin"", {""County""}, {""sov"", ""hov"", ""transit"", ""nm""}},
+        {""/output/_summaries/overall_mode_shares_subarea_bytaz.bin"", {""County""}, {""sov"", ""hov"", ""transit"", ""nm""}},
         {""/output/_summaries/hhstrata_subarea.csv"", {""market_segment""}, {""count""}}
     }
 "
Triangle-Modeling-and-Analytics,TRMG2,647d5fa991f34b3d655101c7f22e4f75b5e0eb05,Si Shi,si_shi_itre@ncsu.edu,2023-09-13T14:06:13Z,Si Shi,si_shi_itre@ncsu.edu,2023-09-13T14:06:13Z,Fixed bug for reporting tools,other/_reportingtool/Concatenate_tablenames.csv;src/utils/MOVES.rsc;src/utils/ScenarioComparison.rsc,False,False,False,False,12,8,20,"---FILE: other/_reportingtool/Concatenate_tablenames.csv---
@@ -8,17 +8,13 @@ VMT_Delay,VMT_Delay_by_County.csv
 VMT_Delay,VMT_Delay_by_HCMType.csv
 VMT_Delay,VMT_Delay_by_AreaType.csv
 VMT_Delay,VMT_Delay_by_HCMType_by_County.csv
-VMT_Delay,VMT_perCapita.csv
+VMT_Delay,VMT_perCapita_andHH.csv
 CongestionCost,CongestionCost_summary_by_MPO.csv
 CongestionCost,CongestionCost_summary_by_County.csv
 CongestionCost,CongestionCost_summary_by_HCMType.csv
 CongestionCost,CongestionCost_summary_by_AreaType.csv
 resident_hb,hb_trip_mode_shares.csv
-resident_hb,hb_trip_mode_shares_subarea.csv
-resident_hb,hb_trip_purpmode_shares.csv
-resident_hb,hb_trip_purpmode_shares_subarea.csv
 resident_hb,hb_trip_stats_by_modeperiod.csv
-resident_hb,hb_trip_stats_by_modeperiod_subarea.csv
 resident_hb,hb_trip_stats_by_type.csv
 resident_nhb,nhb_trip_stats_by_modeperiod.csv
 resident_nhb,nhb_trip_stats_by_type.csv

---FILE: src/utils/MOVES.rsc---
@@ -44,12 +44,19 @@ dBox ""Prepare MOVES Input"" (Args) location: center, center, 46, 7
   enditem
 
   // Quit Button
-  button 5, 5, 10 Prompt:""Quit"" do
+  button 4, 5, 10 Prompt:""Quit"" do
     Return(1)
   enditem
 
+  // Help Button
+  button 32, 5, 8 Prompt:""Help"" do
+    ShowMessage(
+        ""This tool is to prepare inputs for MOVES air quality analysis. Please select the corresponding year from the drop down list based on your selected scenario.""
+     )
+  enditem
+
   // Run Button
-  button 21, 5, 20 Prompt:""Generate Results"" do 
+  button 19, 5, 8 Prompt:""Run"" do 
 
     if !RunMacro(""MOVES"", Args, region, year) then Throw(""Something went wrong"")
  

---FILE: src/utils/ScenarioComparison.rsc---
@@ -170,7 +170,8 @@ Macro ""Compare Summary Tables"" (MacroOpts)
         {""/output/_summaries/resident_nhb/nhb_trip_stats_by_type.csv"", {""matrix""}, {""Sum"", ""SumDiag"", ""PctDiag"", ""avg_length_mi"", ""avg_time_min""}},
         {""/output/sedata/scenario_se.bin"", {""TAZ""}, {""HH"", ""HH_POP"", ""Median_Inc"", ""Industry"", ""Office"", ""Service_RateLow"", ""Service_RateHigh"", ""Retail""}},
         {""/output/networks/scenario_links.bin"", {""ID""}, {""Total_Flow_Daily"", ""Total_VMT_Daily"", ""Total_VHT_Daily"", ""Total_Delay_Daily""}},
-        {""/output/_summaries/overall_mode_shares.bin"", {""County""}, {""sov"", ""hov"", ""transit"", ""nm""}},
+        {""/output/_summaries/overall_mode_shares_bytaz.bin"", {""TAZ""}, {""sov"", ""hov"", ""transit"", ""nm""}},
+        {""/output/_summaries/overall_mode_shares_bycounty.bin"", {""County""}, {""sov"", ""hov"", ""transit"", ""nm""}},
         {""/output/_summaries/hhstrata.csv"", {""market_segment""}, {""count""}}
     }
 "
Triangle-Modeling-and-Analytics,TRMG2,45a4a04f6b2062800b6b8adb5b6c6197ce6f9c13,Si Shi,si_shi_itre@ncsu.edu,2023-09-07T13:38:42Z,Si Shi,si_shi_itre@ncsu.edu,2023-09-07T13:38:42Z,Add error message for roadway project management and revise error message for transit project management,src/utils/RoadwayProjectManagement.rsc;src/utils/TransitProjectManagement.rsc,False,False,False,False,4,1,5,"---FILE: src/utils/RoadwayProjectManagement.rsc---
@@ -154,6 +154,9 @@ Macro ""Roadway Project Management"" (MacroOpts)
     CopyDatabase(new_dbd, hwy_dbd)
     DeleteDatabase(new_dbd)
   end
+
+  if missing_projects <> null then ShowMessage(""Projects not found in the master network. See RoadwayBuildingError.csv in the input/networks folder. A draft version of the scenario network was built, however the project errors must be resolved before a final scenario is built."")
+
 EndMacro
 
 /*

---FILE: src/utils/TransitProjectManagement.rsc---
@@ -718,7 +718,7 @@ Macro ""Convert ProjID to RouteID"" (MacroOpts)
 
   CloseFile(file)
   if num_notfound > 0 then Throw(
-    ""Projects not found in the master route system. See error log in the scenario folder.""
+    ""Projects not found in the master route system. See error log (TransitBuildingError.csv) in the scenario input>networks folder.""
   )
   //remove error log once scenario created successfully
   if num_notfound = 0 and GetFileInfo(error_file) <> null then DeleteFile(error_file)"
Triangle-Modeling-and-Analytics,TRMG2,8ee4c749163727706581bcf0e5822edcc443849d,Si Shi,si_shi_itre@ncsu.edu,2023-08-24T14:03:23Z,Si Shi,si_shi_itre@ncsu.edu,2023-08-24T14:03:23Z,"Revert ""Fix bug where transit routes on links with HCMType missing""

This reverts commit 8e10c031d8320003929153369f9d40d79e9fa4b1.",master/networks/master_links.BIN;master/networks/master_routes.rts,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,c7166d57f1c5569baeebb1bf20058bdb88286c2e,Si Shi,si_shi_itre@ncsu.edu,2023-08-23T20:07:51Z,Si Shi,si_shi_itre@ncsu.edu,2023-08-23T20:07:51Z,Correct missing values and fix set data vector error,master/networks/master_links.BIN;master/networks/master_links.BX;master/networks/master_links.DCB;master/networks/master_links.dln;master/networks/master_links.kln;master/networks/master_links.pts;master/networks/master_links.sty;master/networks/master_links_.BIN;master/networks/master_links_.BX;master/networks/master_links_.DCB;master/networks/master_links_.sty,False,False,False,False,69,69,138,"---FILE: master/networks/master_links.DCB---
@@ -1,72 +1,72 @@
 master_links
-608
+583
 ""ID"",I,1,4,0,4,0,,"""","""",,""Sum"",
 ""RoadName"",C,5,32,0,32,0,,"""","""",,""Copy"",
 ""AltName"",C,37,32,0,32,0,,"""","""",,""Copy"",
-""NCDOTClass"",C,69,17,0,17,0,,"""",""This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"",
-""HCMType"",C,86,14,0,14,0,,"""",""Highway Capacity Manual Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|Superstreet|MajorArterial|Arterial|MajorCollector|Collector|Local|Ramp|CC|TransitOnly"",,""Copy"",
-""ABLanes"",I,100,4,0,8,0,,"""",""Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""BALanes"",I,104,4,0,8,0,,"""",""Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""PostedSpeed"",I,108,4,0,8,0,,"""",""Speed as posted on roadway signage"",,""Copy"",
-""HCMMedian"",C,112,14,0,14,0,,"""",""HCM Median Type|Restrictive|NonRestrictive|None||This field is ignored for freeways and superstreets (restrictive median is assumed).|For collectors and arterials:|NonRestrictive = 4% capacity increase|Restrictive = 8% capacity increase"",,""Copy"",
-""DTWB"",C,126,9,0,9,0,,"""",""Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc.||Sample query to select drive links:|DTWB contains \""D\"""",,""Copy"",
-""HOV"",C,135,4,0,4,0,,"""",""None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
-""BOSSS"",R,139,8,0,10,2,,"""",""Bus on Side Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Copy"",
-""TollType"",C,147,4,0,4,0,,"""",""Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
-""TollCostT"",R,151,8,0,10,2,,"""",""Toll cost ($) with a transponder for 2-axle vehicles||The model will automatically apply 2x this rate to|SUT and 4x this rate to MUT. Also, the % of vehicles|with transponders can be changed. See parameter|'TransponderRatio'."",,""Copy"",
-""TollCostNT"",R,159,8,0,10,2,,"""",""Toll cost ($) without a transponder for 2-axle vehicles||The model will automatically apply 2x this cost to|SUT and 4x this rate to MUT. Also, the % of vehicles|with transponders can be changed. See parameter|'TransponderRatio'."",,""Copy"",
-""CountID"",C,167,16,0,16,0,,"""",""The CVG/VLM ID of the count"",,""Copy"",
-""CountPointID"",I,183,4,0,8,0,,"""",""The point ID from the count geo file"",,""Copy"",
-""DailyCount"",I,187,4,0,8,0,,"""",""2020 AWDT count volume"",,""Copy"",
-""DailyCountSUT"",I,191,4,0,8,0,,"""",""2020 AWDT SUT count volume"",,""Copy"",
-""DailyCountMUT"",I,195,4,0,8,0,,"""",""2020 AWDT MUT count volume"",,""Copy"",
-""Screenline"",I,199,4,0,8,0,,"""",""The screenline this link belongs to (if any)||The line layer of screenlines is stored in|master/networks/screenlines"",,""Copy"",
-""Cutline"",I,203,4,0,8,0,,"""",""The cutline this link belongs to (if any)||The line layer of screenlines is stored in|master/networks/screenlines"",,""Copy"",
-""p1ID"",C,207,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
-""p1Dir"",I,223,4,0,4,0,,"""","""",,""Copy"",
-""p1NCDOTClass"",C,227,16,0,16,0,,"""",""Project Field|This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"",
-""p1HCMType"",C,243,14,0,14,0,,"""",""Project Field|Highway Capacity Manual Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|Superstreet|MajorArterial|Arterial|MajorCollector|Collector|Local|Ramp|CC|TransitOnly"",,""Copy"",
-""p1ABLanes"",I,257,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""p1BALanes"",I,261,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""p1PostedSpeed"",I,265,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
-""p1HCMMedian"",C,269,14,0,14,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
-""p1DTWB"",C,283,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
-""p1HOV"",C,292,4,0,4,0,,"""",""Project Field|None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
-""p1BOSSS"",I,296,4,0,8,0,,"""",""Project Field|Bus on Side Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Copy"",
-""p1TollType"",C,300,4,0,4,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
-""p2ID"",C,304,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
-""p2Dir"",I,320,4,0,4,0,,"""","""",,""Copy"",
-""p2NCDOTClass"",C,324,16,0,16,0,,"""",""Project Field|This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"",
-""p2HCMType"",C,340,14,0,14,0,,"""",""Project Field|Highway Capacity Manual Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|Superstreet|MajorArterial|Arterial|MajorCollector|Collector|Local|Ramp|CC|TransitOnly"",,""Copy"",
-""p2ABLanes"",I,354,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""p2BALanes"",I,358,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""p2PostedSpeed"",I,362,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
-""p2HCMMedian"",C,366,14,0,14,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
-""p2DTWB"",C,380,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
-""p2HOV"",C,389,4,0,4,0,,"""",""Project Field|None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
-""p2BOSSS"",I,393,4,0,8,0,,"""",""Project Field|Bus on Side Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Copy"",
-""p2TollType"",C,397,4,0,4,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
-""p3ID"",C,401,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
-""p3Dir"",I,417,4,0,4,0,,"""","""",,""Copy"",
-""p3NCDOTClass"",C,421,16,0,16,0,,"""",""Project Field|This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"",
-""p3HCMType"",C,437,14,0,14,0,,"""",""Project Field|Highway Capacity Manual Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|Superstreet|MajorArterial|Arterial|MajorCollector|Collector|Local|Ramp|CC|TransitOnly"",,""Copy"",
-""p3ABLanes"",I,451,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""p3BALanes"",I,455,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""p3PostedSpeed"",I,459,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
-""p3HCMMedian"",C,463,14,0,14,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
-""p3DTWB"",C,477,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
-""p3HOV"",C,486,4,0,4,0,,"""",""Project Field|None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
-""p3BOSSS"",I,490,4,0,8,0,,"""",""Project Field|Bus on Side Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Copy"",
-""p3TollType"",C,494,4,0,4,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
-""p4ID"",C,498,16,0,16,0,,"""","""",,""Copy"",
-""p4Dir"",I,514,4,0,4,0,,"""","""",,""Copy"",
-""p4NCDOTClass"",C,518,16,0,16,0,,"""","""",,""Copy"",
-""p4HCMType"",C,534,14,0,14,0,,"""","""",,""Copy"",
-""p4ABLanes"",I,548,4,0,8,0,,"""","""",,""Copy"",
-""p4BALanes"",I,552,4,0,8,0,,"""","""",,""Copy"",
-""p4PostedSpeed"",I,556,4,0,8,0,,"""","""",,""Copy"",
-""p4HCMMedian"",C,560,16,0,16,0,,"""","""",,""Copy"",
-""p4DTWB"",C,576,9,0,9,0,,"""","""",,""Copy"",
-""p4HOV"",C,585,4,0,4,0,,"""","""",,""Copy"",
-""p4BOSSS"",I,589,4,0,8,0,,"""","""",,""Copy"",
-""p4TollType"",C,593,16,0,16,0,,"""","""",,""Copy"",
+""NCDOTClass"",C,69,14,0,14,0,,"""",""This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"",
+""HCMType"",C,83,14,0,14,0,,"""",""Highway Capacity Manual Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|Superstreet|MajorArterial|Arterial|MajorCollector|Collector|Local|Ramp|CC|TransitOnly"",,""Copy"",
+""ABLanes"",I,97,4,0,8,0,,"""",""Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""BALanes"",I,101,4,0,8,0,,"""",""Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""PostedSpeed"",I,105,4,0,8,0,,"""",""Speed as posted on roadway signage"",,""Copy"",
+""HCMMedian"",C,109,14,0,14,0,,"""",""HCM Median Type|Restrictive|NonRestrictive|None||This field is ignored for freeways and superstreets (restrictive median is assumed).|For collectors and arterials:|NonRestrictive = 4% capacity increase|Restrictive = 8% capacity increase"",,""Copy"",
+""DTWB"",C,123,9,0,9,0,,"""",""Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc.||Sample query to select drive links:|DTWB contains \""D\"""",,""Copy"",
+""HOV"",C,132,4,0,4,0,,"""",""None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
+""BOSSS"",R,136,8,0,10,2,,"""",""Bus on Side Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Copy"",
+""TollType"",C,144,4,0,4,0,,"""",""Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
+""TollCostT"",R,148,8,0,10,2,,"""",""Toll cost ($) with a transponder for 2-axle vehicles||The model will automatically apply 2x this rate to|SUT and 4x this rate to MUT. Also, the % of vehicles|with transponders can be changed. See parameter|'TransponderRatio'."",,""Copy"",
+""TollCostNT"",R,156,8,0,10,2,,"""",""Toll cost ($) without a transponder for 2-axle vehicles||The model will automatically apply 2x this cost to|SUT and 4x this rate to MUT. Also, the % of vehicles|with transponders can be changed. See parameter|'TransponderRatio'."",,""Copy"",
+""CountID"",C,164,16,0,16,0,,"""",""The CVG/VLM ID of the count"",,""Copy"",
+""CountPointID"",I,180,4,0,8,0,,"""",""The point ID from the count geo file"",,""Copy"",
+""DailyCount"",I,184,4,0,8,0,,"""",""2020 AWDT count volume"",,""Copy"",
+""DailyCountSUT"",I,188,4,0,8,0,,"""",""2020 AWDT SUT count volume"",,""Copy"",
+""DailyCountMUT"",I,192,4,0,8,0,,"""",""2020 AWDT MUT count volume"",,""Copy"",
+""Screenline"",I,196,4,0,8,0,,"""",""The screenline this link belongs to (if any)||The line layer of screenlines is stored in|master/networks/screenlines"",,""Copy"",
+""Cutline"",I,200,4,0,8,0,,"""",""The cutline this link belongs to (if any)||The line layer of screenlines is stored in|master/networks/screenlines"",,""Copy"",
+""p1ID"",C,204,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
+""p1Dir"",S,220,2,0,4,0,,"""","""",,""Copy"",
+""p1NCDOTClass"",C,222,16,0,16,0,,"""",""Project Field|This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"",
+""p1HCMType"",C,238,14,0,14,0,,"""",""Project Field|Highway Capacity Manual Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|Superstreet|MajorArterial|Arterial|MajorCollector|Collector|Local|Ramp|CC|TransitOnly"",,""Copy"",
+""p1ABLanes"",I,252,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""p1BALanes"",I,256,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""p1PostedSpeed"",I,260,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
+""p1HCMMedian"",C,264,14,0,14,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
+""p1DTWB"",C,278,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
+""p1HOV"",C,287,4,0,4,0,,"""",""Project Field|None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
+""p1BOSSS"",I,291,4,0,8,0,,"""",""Project Field|Bus on Side Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Copy"",
+""p1TollType"",C,295,4,0,4,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
+""p2ID"",C,299,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
+""p2Dir"",S,315,2,0,4,0,,"""","""",,""Copy"",
+""p2NCDOTClass"",C,317,16,0,16,0,,"""",""Project Field|This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"",
+""p2HCMType"",C,333,14,0,14,0,,"""",""Project Field|Highway Capacity Manual Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|Superstreet|MajorArterial|Arterial|MajorCollector|Collector|Local|Ramp|CC|TransitOnly"",,""Copy"",
+""p2ABLanes"",I,347,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""p2BALanes"",I,351,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""p2PostedSpeed"",I,355,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
+""p2HCMMedian"",C,359,14,0,14,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
+""p2DTWB"",C,373,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
+""p2HOV"",C,382,4,0,4,0,,"""",""Project Field|None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
+""p2BOSSS"",I,386,4,0,8,0,,"""",""Project Field|Bus on Side Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Copy"",
+""p2TollType"",C,390,4,0,4,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
+""p3ID"",C,394,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
+""p3Dir"",S,410,2,0,4,0,,"""","""",,""Copy"",
+""p3NCDOTClass"",C,412,16,0,16,0,,"""",""Project Field|This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"",
+""p3HCMType"",C,428,14,0,14,0,,"""",""Project Field|Highway Capacity Manual Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|Superstreet|MajorArterial|Arterial|MajorCollector|Collector|Local|Ramp|CC|TransitOnly"",,""Copy"",
+""p3ABLanes"",I,442,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""p3BALanes"",I,446,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""p3PostedSpeed"",I,450,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
+""p3HCMMedian"",C,454,14,0,14,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
+""p3DTWB"",C,468,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
+""p3HOV"",C,477,4,0,4,0,,"""",""Project Field|None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
+""p3BOSSS"",I,481,4,0,8,0,,"""",""Project Field|Bus on Side Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Copy"",
+""p3TollType"",C,485,4,0,4,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
+""p4ID"",C,489,16,0,16,0,,"""","""",,""Copy"",
+""p4Dir"",S,505,2,0,4,0,,"""","""",,""Copy"",
+""p4NCDOTClass"",C,507,16,0,16,0,,"""","""",,""Copy"",
+""p4HCMType"",C,523,14,0,14,0,,"""","""",,""Copy"",
+""p4ABLanes"",I,537,4,0,8,0,,"""","""",,""Copy"",
+""p4BALanes"",I,541,4,0,8,0,,"""","""",,""Copy"",
+""p4PostedSpeed"",I,545,4,0,8,0,,"""","""",,""Copy"",
+""p4HCMMedian"",C,549,14,0,14,0,,"""","""",,""Copy"",
+""p4DTWB"",C,563,9,0,9,0,,"""","""",,""Copy"",
+""p4HOV"",C,572,4,0,4,0,,"""","""",,""Copy"",
+""p4BOSSS"",I,576,4,0,8,0,,"""","""",,""Copy"",
+""p4TollType"",C,580,4,0,4,0,,"""","""",,""Copy"",

---FILE: master/networks/master_links_.DCB---
@@ -1,6 +1,6 @@
 master_links
 16
-""new_id"",I,1,4,0,4,0,,"""","""",,""Sum"",
+""ID"",I,1,4,0,10,0,,"""","""",,""Sum"",
 ""Centroid"",I,5,4,0,8,0,,"""",""Nodes on the network where travel can begin/end.|||1: the node is a centroid|0: not a centroid"",,""Blank"",
 ""External"",I,9,4,0,8,0,,"""",""1: the node is an external centroid/station|0: is not||All external stations are centroids. Not all centroids|are external stations."",,""Blank"",
 ""PNR"",I,13,4,0,8,0,,"""","""",,""Sum"","
Triangle-Modeling-and-Analytics,TRMG2,8e10c031d8320003929153369f9d40d79e9fa4b1,Si Shi,si_shi_itre@ncsu.edu,2023-08-23T18:24:48Z,Si Shi,si_shi_itre@ncsu.edu,2023-08-23T18:24:48Z,"Fix bug where transit routes on links with HCMType missing

Link 72643 and adjacent links with a 2040 route",master/networks/master_links.BIN;master/networks/master_routes.rts,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,9bdc46f363d553ecac49b0fc51ab3e1ad3371dd5,Kyle,kyle@caliper.com,2023-06-09T19:02:02Z,Kyle,kyle@caliper.com,2023-06-09T19:02:02Z,"Correct TPM attribute update

When the same ProjID was on two different routes, the attribute update was only updating the first due to the LocateRecord() approach. This change fixes that so that any route with the ProjID will get updated.",src/utils/TransitProjectManagement.rsc,False,False,False,False,10,12,22,"---FILE: src/utils/TransitProjectManagement.rsc---
@@ -508,6 +508,7 @@ Macro ""Update Scenario Attributes"" (MacroOpts)
   // Create a map of the scenario RTS
   map = CreateObject(""Map"", output_rts_file)
   {nlyr, llyr, rlyr, slyr} = map.GetLayerNames()
+  rtbl = CreateObject(""Table"", rlyr)
 
   SetLayer(rlyr)
 
@@ -531,18 +532,15 @@ Macro ""Update Scenario Attributes"" (MacroOpts)
         pid = v_pid[i]
         value = v_value[i]
 
-        // Locate the route with this project ID. If not found, throw an error.
-        opts = null
-        opts.Exact = ""true""
-        rh = LocateRecord(rlyr + ""|"", ""ProjID"", {String(pid)}, opts)
-        if rh = null then do
-          pid_string = if TypeOf(pid) = ""string"" then pid else String(pid)
-          Throw(""ProjID '"" + pid_string + ""' not found in route layer"")
-        end
-
-        // Update the attribute
-        SetRecord(rlyr, rh)
-        rlyr.(field_name) = value
+        if TypeOf(pid) = ""string""
+          then pid = pid
+          else pid = String(pid)
+        n = rtbl.SelectByQuery({
+          SetName: ""temp"",
+          Query: ""ProjID = '"" + pid + ""'""
+        })
+        if n = 0 then Throw(""ProjID '"" + pid_string + ""' not found in route layer"")
+        rtbl.(field_name) = value
       end
     end
   end"
Triangle-Modeling-and-Analytics,TRMG2,73a9b72dee90e6450e2077939b8bb09717cd1858,Si Shi,si_shi_itre@ncsu.edu,2023-05-25T20:11:28Z,Si Shi,si_shi_itre@ncsu.edu,2023-05-25T20:11:28Z,Fix bug in VMT by VMT per capita by MPO/County,src/19 - Summaries.rsc,False,False,False,False,1,0,1,"---FILE: src/19 - Summaries.rsc---
@@ -1472,6 +1472,7 @@ Macro ""VMT_Delay Summary"" (Args)
   scen_outdir = Args.[Output Folder]
   hwy_dbd = Args.Links
   taz_dbd = Args.TAZs
+  se_bin = Args.SE
   report_dir = scen_outdir + ""\\_summaries"" //need to create this dir in argument file 
   output_dir = report_dir + ""\\VMT_Delay"" //need to create this dir in argument file
   RunMacro(""Create Directory"", output_dir)"
Triangle-Modeling-and-Analytics,TRMG2,28b886375a8c9b5aec283bf85a73f0162e87f5ae,Kyle,kyle@caliper.com,2023-05-04T14:00:29Z,Kyle,kyle@caliper.com,2023-05-04T14:00:29Z,"Correct bug in non-motorized model

The income per capita field was being filled with the wrong vector. Corrected and ran the model to make sure the change didn't impact calibration.",src/06 - NonMotorized.rsc,False,False,False,False,1,1,2,"---FILE: src/06 - NonMotorized.rsc---
@@ -49,7 +49,7 @@ Macro ""Create NonMotorized Features"" (Args)
     v_vpa = v_autos / v_adult
     SetDataVector(hh_vw + ""|"", ""veh_per_adult"", v_vpa, )
     v_ipc = v_inc / v_size
-    SetDataVector(hh_vw + ""|"", ""inc_per_capita"", v_vpa, )
+    SetDataVector(hh_vw + ""|"", ""inc_per_capita"", v_ipc, )
     v_age = GetDataVector(per_vw + ""|"", ""Age"", )
     v_age_flag = if v_age >= 16 and v_age <= 18 then 1 else 0
     SetDataVector(per_vw + ""|"", ""age_16_18"", v_age_flag, )"
Triangle-Modeling-and-Analytics,TRMG2,0eda0fe10ff398eb087b484def0168b40a4c174a,Si Shi,si_shi_itre@ncsu.edu,2023-04-14T17:35:03Z,Si Shi,si_shi_itre@ncsu.edu,2023-04-14T17:35:03Z,Fix bug in VMT tool,src/utils/ZonalVMTCalculation_new.rsc,False,False,False,False,1,1,2,"---FILE: src/utils/ZonalVMTCalculation_new.rsc---
@@ -347,7 +347,7 @@ Macro ""Create HBW PA Vehicle Trip Matrices"" (Args)
     factor_file = Args.HBHOV3OccFactors
     periods = Args.periods
     trip_dir = Args.[Scenario Folder] + ""\\output\\resident\\trip_matrices""
-    output_dir = Args.[Scenario Folder] + ""\\output\\_summaries\\Zone_VMT""
+    output_dir = Args.[Scenario Folder] + ""\\output\\_summaries\\Zonal_VMT_Comparison""
 
     fac_vw = OpenTable(""factors"", ""CSV"", {factor_file})
     "
Triangle-Modeling-and-Analytics,TRMG2,8634e3b4db5fafd4a2005d02448767f9140abc89,Si Shi,si_shi_itre@ncsu.edu,2023-04-07T15:59:53Z,Si Shi,si_shi_itre@ncsu.edu,2023-04-07T15:59:53Z,Fix bug in MOVES tool,other/_reportingtool/MOVES/SourceType_param.csv;other/_reportingtool/MOVES/SourceType_param_up8Nov2022.csv;other/_reportingtool/MOVES/fixed_template/HourVMT_template.csv;other/_reportingtool/MOVES/fixed_template/Ramp_template.csv;other/_reportingtool/MOVES/fixed_template/Roadtype_template.csv;other/_reportingtool/MOVES/fixed_template/Sourcetype_template.csv;src/utils/MOVES.rsc,False,False,False,False,22,52,74,"---FILE: other/_reportingtool/MOVES/SourceType_param.csv---
@@ -1,4 +1,4 @@
-sourcetype,year,styFactor
+sourcetypeID,year,styFactor
 11,2015,0.045797305
 21,2015,0.498456772
 31,2015,0.332224503

---FILE: other/_reportingtool/MOVES/SourceType_param_up8Nov2022.csv---
@@ -1,31 +0,0 @@
-sourcetype,year,styFactor,, sourceTypePopulation_Alamance ,styFactor-Alamance, sourceTypePopulation_Chatham ,styFactor-Chatham, sourceTypePopulation_Durham ,styFactor-Durham, sourceTypePopulation_Franklin ,styFactor-Franklin, sourceTypePopulation_Granville ,styFactor-Granville, sourceTypePopulation_Harnett ,styFactor-Harnett, sourceTypePopulation_Johnston ,styFactor-Johnston, sourceTypePopulation_Nash ,styFactor-Nash, sourceTypePopulation_Orange ,styFactor-Orange, sourceTypePopulation_Person ,styFactor-Person, sourceTypePopulation_Wake ,styFactor-Wake, sourceTypePopulation_TRM Area ,styFactor-TRM Area, sourceTypePopulation_DCHC ,styFactor-DCHC, sourceTypePopulation_CAMPO ,styFactor-CAMPO
-11,2020, 0.04512 ,, 564 , 0.02270 ,"" 1,042 "", 0.02151 ,"" 2,761 "", 0.01340 ,"" 1,358 "", 0.02644 , 823 , 0.02540 , 948 , 0.03103 ,"" 3,910 "", 0.02449 , 75 , 0.02026 ,"" 1,683 "", 0.01742 , 927 , 0.02855 ,"" 12,132 "", 0.01497 ,"" 26,223 "", 0.01752 ,"" 5,965 "", 0.01752 ,"" 17,174 "", 0.01752 
-21,2020, 0.49339 ,,"" 18,287 "", 0.73658 ,"" 35,179 "", 0.72590 ,"" 172,733 "", 0.83822 ,"" 34,561 "", 0.67308 ,"" 22,118 "", 0.68236 ,"" 20,709 "", 0.67800 ,"" 111,228 "", 0.69656 ,"" 2,584 "", 0.70190 ,"" 76,975 "", 0.79679 ,"" 20,994 "", 0.64622 ,"" 658,386 "", 0.81219 ,"" 1,173,754 "", 0.78420 ,"" 266,998 "", 0.78420 ,"" 768,733 "", 0.78420 
-31,2020, 0.32819 ,,"" 3,762 "", 0.15152 ,"" 7,585 "", 0.15652 ,"" 19,304 "", 0.09367 ,"" 9,958 "", 0.19393 ,"" 6,280 "", 0.19376 ,"" 5,747 "", 0.18816 ,"" 28,303 "", 0.17725 , 633 , 0.17205 ,"" 11,422 "", 0.11823 ,"" 6,772 "", 0.20845 ,"" 83,502 "", 0.10301 ,"" 183,269 "", 0.12244 ,"" 41,689 "", 0.12244 ,"" 120,029 "", 0.12244 
-32,2020, 0.08342 ,,"" 1,493 "", 0.06013 ,"" 3,097 "", 0.06390 ,"" 7,669 "", 0.03721 ,"" 3,867 "", 0.07530 ,"" 2,344 "", 0.07231 ,"" 2,223 "", 0.07278 ,"" 11,275 "", 0.07061 , 254 , 0.06887 ,"" 4,541 "", 0.04701 ,"" 2,599 "", 0.08000 ,"" 35,943 "", 0.04434 ,"" 75,304 "", 0.05031 ,"" 17,130 "", 0.05031 ,"" 49,319 "", 0.05031 
-41,2020, 0.00001 ,, 71 , 0.00286 , 154 , 0.00318 , 337 , 0.00164 , 155 , 0.00301 , 82 , 0.00252 , 89 , 0.00292 , 474 , 0.00297 , 13 , 0.00364 , 184 , 0.00190 , 120 , 0.00368 ,"" 1,921 "", 0.00237 ,"" 3,600 "", 0.00241 , 819 , 0.00241 ,"" 2,358 "", 0.00241 
-42,2020, 0.00034 ,, 43 , 0.00175 , 94 , 0.00195 , 207 , 0.00100 , 95 , 0.00185 , 50 , 0.00155 , 55 , 0.00179 , 291 , 0.00182 , 8 , 0.00223 , 113 , 0.00117 , 73 , 0.00226 ,"" 1,177 "", 0.00145 ,"" 2,206 "", 0.00147 , 502 , 0.00147 ,"" 1,445 "", 0.00147 
-43,2020, 0.00088 ,, 121 , 0.00486 , 261 , 0.00539 , 593 , 0.00288 , 267 , 0.00519 , 141 , 0.00435 , 153 , 0.00500 , 823 , 0.00515 , 23 , 0.00618 , 326 , 0.00337 , 201 , 0.00619 ,"" 3,394 "", 0.00419 ,"" 6,301 "", 0.00421 ,"" 1,433 "", 0.00421 ,"" 4,127 "", 0.00421 
-51,2020, 0.00029 ,, 6 , 0.00025 , 14 , 0.00028 , 30 , 0.00014 , 14 , 0.00027 , 7 , 0.00022 , 8 , 0.00026 , 42 , 0.00026 , 1 , 0.00032 , 16 , 0.00017 , 11 , 0.00033 , 170 , 0.00021 , 318 , 0.00021 , 72 , 0.00021 , 209 , 0.00021 
-52,2020, 0.02852 ,, 254 , 0.01024 , 547 , 0.01129 ,"" 1,321 "", 0.00641 , 574 , 0.01118 , 303 , 0.00936 , 326 , 0.01067 ,"" 1,789 "", 0.01120 , 48 , 0.01296 , 731 , 0.00757 , 415 , 0.01277 ,"" 7,600 "", 0.00938 ,"" 13,908 "", 0.00929 ,"" 3,164 "", 0.00929 ,"" 9,109 "", 0.00929 
-53,2020, 0.00120 ,, 18 , 0.00071 , 38 , 0.00078 , 88 , 0.00043 , 39 , 0.00076 , 21 , 0.00064 , 22 , 0.00073 , 121 , 0.00076 , 3 , 0.00090 , 49 , 0.00050 , 29 , 0.00089 , 506 , 0.00062 , 933 , 0.00062 , 212 , 0.00062 , 611 , 0.00062 
-54,2020, 0.00708 ,, 33 , 0.00132 , 70 , 0.00144 , 194 , 0.00094 , 78 , 0.00152 , 41 , 0.00128 , 43 , 0.00142 , 250 , 0.00156 , 6 , 0.00166 , 109 , 0.00113 , 51 , 0.00157 ,"" 1,129 "", 0.00139 ,"" 2,005 "", 0.00134 , 456 , 0.00134 ,"" 1,313 "", 0.00134 
-61,2020, 0.00525 ,, 100 , 0.00401 , 216 , 0.00446 , 475 , 0.00231 , 218 , 0.00424 , 115 , 0.00355 , 125 , 0.00411 , 668 , 0.00418 , 19 , 0.00512 , 260 , 0.00269 , 168 , 0.00516 ,"" 2,710 "", 0.00334 ,"" 5,073 "", 0.00339 ,"" 1,154 "", 0.00339 ,"" 3,323 "", 0.00339 
-62,2020, 0.00633 ,, 76 , 0.00306 , 165 , 0.00340 , 361 , 0.00175 , 166 , 0.00323 , 88 , 0.00270 , 96 , 0.00313 , 508 , 0.00318 , 14 , 0.00390 , 197 , 0.00204 , 128 , 0.00394 ,"" 2,059 "", 0.00254 ,"" 3,857 "", 0.00258 , 877 , 0.00258 ,"" 2,526 "", 0.00258 
-,,,,"" 24,827 "", 1 ,"" 48,463 "", 1 ,"" 206,072 "", 1 ,"" 51,348 "", 1 ,"" 32,414 "", 1 ,"" 30,544 "", 1 ,"" 159,682 "", 1 ,"" 3,682 "", 1 ,"" 96,606 "", 1 ,"" 32,487 "", 1 ,"" 810,629 "", 1 ,"" 1,496,753 "", 1 ,"" 340,472 "", 1 ,"" 980,276 "", 1 
-,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
-,,,, sourceTypePopulation_Alamance ,styFactor-Alamance, sourceTypePopulation_Chatham ,styFactor-Chatham, sourceTypePopulation_Durham ,styFactor-Durham, sourceTypePopulation_Franklin ,styFactor-Franklin, sourceTypePopulation_Granville ,styFactor-Granville, sourceTypePopulation_Harnett ,styFactor-Harnett, sourceTypePopulation_Johnston ,styFactor-Johnston, sourceTypePopulation_Nash ,styFactor-Nash, sourceTypePopulation_Orange ,styFactor-Orange, sourceTypePopulation_Person ,styFactor-Person, sourceTypePopulation_Wake ,styFactor-Wake, sourceTypePopulation_TRM Area ,styFactor-TRM Area, sourceTypePopulation_DCHC ,styFactor-DCHC, sourceTypePopulation_CAMPO ,styFactor-CAMPO
-11,2050,0.044076315,, 872 , 0.02270 ,"" 1,765 "", 0.02151 ,"" 3,985 "", 0.01340 ,"" 2,470 "", 0.02644 ,"" 1,244 "", 0.02540 ,"" 1,326 "", 0.03103 ,"" 6,729 "", 0.02449 , 77 , 0.02026 ,"" 2,185 "", 0.01742 , 934 , 0.02855 ,"" 20,468 "", 0.01497 ,"" 42,053 "", 0.01747 ,"" 8,515 "", 0.01747 ,"" 28,077 "", 0.01747 
-21,2050,0.496094482,,"" 28,284 "", 0.73658 ,"" 59,574 "", 0.72590 ,"" 249,309 "", 0.83822 ,"" 62,867 "", 0.67308 ,"" 33,414 "", 0.68236 ,"" 28,974 "", 0.67800 ,"" 191,399 "", 0.69656 ,"" 2,664 "", 0.70190 ,"" 99,917 "", 0.79679 ,"" 21,146 "", 0.64622 ,"" 1,110,753 "", 0.81219 ,"" 1,888,301 "", 0.78441 ,"" 382,328 "", 0.78441 ,"" 1,260,728 "", 0.78441 
-31,2050,0.330032675,,"" 5,818 "", 0.15152 ,"" 12,845 "", 0.15652 ,"" 27,861 "", 0.09367 ,"" 18,114 "", 0.19393 ,"" 9,488 "", 0.19376 ,"" 8,041 "", 0.18816 ,"" 48,703 "", 0.17725 , 653 , 0.17205 ,"" 14,826 "", 0.11823 ,"" 6,821 "", 0.20845 ,"" 140,875 "", 0.10301 ,"" 294,046 "", 0.12215 ,"" 59,536 "", 0.12215 ,"" 196,321 "", 0.12215 
-32,2050,0.083945887,,"" 2,309 "", 0.06013 ,"" 5,244 "", 0.06390 ,"" 11,068 "", 0.03721 ,"" 7,033 "", 0.07530 ,"" 3,541 "", 0.07231 ,"" 3,110 "", 0.07278 ,"" 19,402 "", 0.07061 , 261 , 0.06887 ,"" 5,895 "", 0.04701 ,"" 2,618 "", 0.08000 ,"" 60,638 "", 0.04434 ,"" 121,121 "", 0.05031 ,"" 24,524 "", 0.05031 ,"" 80,866 "", 0.05031 
-41,2050,7.68E-06,, 110 , 0.00286 , 261 , 0.00318 , 486 , 0.00164 , 281 , 0.00301 , 124 , 0.00252 , 125 , 0.00292 , 816 , 0.00297 , 14 , 0.00364 , 239 , 0.00190 , 120 , 0.00368 ,"" 3,241 "", 0.00237 ,"" 5,817 "", 0.00242 ,"" 1,178 "", 0.00242 ,"" 3,884 "", 0.00242 
-42,2050,0.000241946,, 67 , 0.00175 , 160 , 0.00195 , 298 , 0.00100 , 172 , 0.00185 , 76 , 0.00155 , 76 , 0.00179 , 500 , 0.00182 , 8 , 0.00223 , 146 , 0.00117 , 74 , 0.00226 ,"" 1,987 "", 0.00145 ,"" 3,565 "", 0.00148 , 722 , 0.00148 ,"" 2,380 "", 0.00148 
-43,2050,0.000633668,, 187 , 0.00486 , 442 , 0.00539 , 856 , 0.00288 , 485 , 0.00519 , 213 , 0.00435 , 214 , 0.00500 ,"" 1,415 "", 0.00515 , 23 , 0.00618 , 423 , 0.00337 , 202 , 0.00619 ,"" 5,726 "", 0.00419 ,"" 10,187 "", 0.00423 ,"" 2,063 "", 0.00423 ,"" 6,801 "", 0.00423 
-51,2050,0.000205462,, 10 , 0.00025 , 23 , 0.00028 , 43 , 0.00014 , 25 , 0.00027 , 11 , 0.00022 , 11 , 0.00026 , 72 , 0.00026 , 1 , 0.00032 , 21 , 0.00017 , 11 , 0.00033 , 287 , 0.00021 , 515 , 0.00021 , 104 , 0.00021 , 344 , 0.00021 
-52,2050,0.025919381,, 393 , 0.01024 , 926 , 0.01129 ,"" 1,906 "", 0.00641 ,"" 1,044 "", 0.01118 , 458 , 0.00936 , 456 , 0.01067 ,"" 3,078 "", 0.01120 , 49 , 0.01296 , 949 , 0.00757 , 418 , 0.01277 ,"" 12,822 "", 0.00938 ,"" 22,500 "", 0.00935 ,"" 4,556 "", 0.00935 ,"" 15,022 "", 0.00935 
-53,2050,0.001072833,, 27 , 0.00071 , 64 , 0.00078 , 127 , 0.00043 , 71 , 0.00076 , 31 , 0.00064 , 31 , 0.00073 , 208 , 0.00076 , 3 , 0.00090 , 63 , 0.00050 , 29 , 0.00089 , 854 , 0.00062 ,"" 1,510 "", 0.00063 , 306 , 0.00063 ,"" 1,008 "", 0.00063 
-54,2050,0.006511764,, 51 , 0.00132 , 118 , 0.00144 , 280 , 0.00094 , 142 , 0.00152 , 63 , 0.00128 , 61 , 0.00142 , 430 , 0.00156 , 6 , 0.00166 , 142 , 0.00113 , 51 , 0.00157 ,"" 1,905 "", 0.00139 ,"" 3,249 "", 0.00135 , 658 , 0.00135 ,"" 2,169 "", 0.00135 
-61,2050,0.004875826,, 154 , 0.00401 , 366 , 0.00446 , 686 , 0.00231 , 396 , 0.00424 , 174 , 0.00355 , 175 , 0.00411 ,"" 1,149 "", 0.00418 , 19 , 0.00512 , 337 , 0.00269 , 169 , 0.00516 ,"" 4,572 "", 0.00334 ,"" 8,198 "", 0.00341 ,"" 1,660 "", 0.00341 ,"" 5,473 "", 0.00341 
-62,2050,0.006382079,, 118 , 0.00306 , 279 , 0.00340 , 521 , 0.00175 , 302 , 0.00323 , 132 , 0.00270 , 134 , 0.00313 , 874 , 0.00318 , 15 , 0.00390 , 256 , 0.00204 , 129 , 0.00394 ,"" 3,473 "", 0.00254 ,"" 6,233 "", 0.00259 ,"" 1,262 "", 0.00259 ,"" 4,161 "", 0.00259 
-,,,,"" 38,399 "", 1 ,"" 82,068 "", 1 ,"" 297,427 "", 1 ,"" 93,402 "", 1 ,"" 48,969 "", 1 ,"" 42,734 "", 1 ,"" 274,777 "", 1 ,"" 3,795 "", 1 ,"" 125,399 "", 1 ,"" 32,723 "", 1 ,"" 1,367,600 "", 1 ,"" 2,407,295 "", 1 ,"" 487,410 "", 1 ,"" 1,607,236 "", 1 

---FILE: other/_reportingtool/MOVES/fixed_template/HourVMT_template.csv---
@@ -1,4 +1,4 @@
-sourcetype,roadTypeID,day,hour,hourvmtfraction
+sourcetypeID,roadTypeID,day,hour,hourvmtfraction
 11,1,2,1,0.0214739
 11,1,2,2,0.0144428
 11,1,2,3,0.0109684

---FILE: other/_reportingtool/MOVES/fixed_template/Ramp_template.csv---
@@ -1,4 +1,4 @@
-roadType,Ramp,Urban
+roadTypeID,Ramp,Urban
 2,Ramp,0
 3,Ramp,0
 4,Ramp,1

---FILE: other/_reportingtool/MOVES/fixed_template/Roadtype_template.csv---
@@ -1,4 +1,4 @@
-sourcetype,roadTypeID
+sourcetypeID,roadTypeID
 11,5
 11,4
 11,3

---FILE: other/_reportingtool/MOVES/fixed_template/Sourcetype_template.csv---
@@ -1,4 +1,4 @@
-sourcetype,month,day
+sourcetypeID,month,day
 11,1,5
 11,1,2
 31,1,5

---FILE: src/utils/MOVES.rsc---
@@ -186,7 +186,7 @@ Macro ""MOVES"" (Args, region, year)
   roadtype = Createobject(""df"", roadtype_file)
   agg.mutate(""roadTypeVMTFraction"", agg.tbl.Total_VMT_Daily/agg.tbl.Total_VMT_Daily.sum())
   roadtype.left_join(agg,""roadTypeID"", ""roadTypeID"")
-  roadtype.select({""sourcetype"", ""roadTypeID"", ""roadTypeVMTFraction""})
+  roadtype.select({""sourcetypeID"", ""roadTypeID"", ""roadTypeVMTFraction""})
   roadtype.write_csv(summary_dir + ""/roadtype.csv"")
   
   //4. Sourcetype output
@@ -196,12 +196,12 @@ Macro ""MOVES"" (Args, region, year)
   weekendparam = Createobject(""df"", weekendparam_file)
 
   sourcetype. mutate(""year"", s2i(year))
-  sourcetype.left_join(sourcetypeparam, {""sourcetype"", ""year""}, {""sourcetype"", ""year""})
+  sourcetype.left_join(sourcetypeparam, {""sourcetypeID"", ""year""}, {""sourcetypeID"", ""year""})
   sourcetype.left_join(monthparam, ""month"")
   sourcetype.left_join(weekendparam, {""year"", ""day""}, {""year"", ""day""})
 	tot_VMT = agg.tbl.Total_VMT_Daily.sum()
   sourcetype.mutate(""VMT"", sourcetype.tbl.styFactor * sourcetype.tbl.month_model * sourcetype.tbl.wkFactor * tot_VMT)
-  sourcetype.select({""sourcetype"", ""month"", ""day"", ""year"", ""styFactor"", ""VMT""})
+  sourcetype.select({""sourcetypeID"", ""month"", ""day"", ""year"", ""styFactor"", ""VMT""})
   sourcetype.write_csv(summary_dir + ""/sourcetype_vmt.csv"")
   
   //5. Hour output
@@ -211,27 +211,28 @@ Macro ""MOVES"" (Args, region, year)
   hour.left_join(agg, ""roadTypeID"", ""roadTypeID"")
   hour.mutate(""hourlyvmt"", if hour.tbl.TOD = ""AM"" then hour.tbl.Tot_VMT_AM/2 * hour.tbl.hourFac else if hour.tbl.TOD = ""MD"" then hour.tbl.Tot_VMT_MD/6.5 * hour.tbl.hourFac 
                             else if hour.tbl.TOD = ""PM"" then hour.tbl.Tot_VMT_PM/2.75 * hour.tbl.hourFac else hour.tbl.Tot_VMT_NT/12.75 * hour.tbl.hourFac)
-  hour.group_by({""sourcetype"", ""roadTypeID"", ""day"", ""hour""})
+  hour.group_by({""sourcetypeID"", ""roadTypeID"", ""day"", ""hour""})
   hour.summarize({""hourlyvmt"", ""Total_VMT_Daily"", ""hourvmtfraction""}, {""sum"", ""avg""})
   hour.mutate(""hourlypct"", if hour.tbl.dayID = 5 then hour.tbl.sum_hourlyVMT/hour.tbl.sum_Total_VMT_Daily else hour.tbl.avg_hourvmtfraction)
-  hour.select({""sourcetype"", ""roadTypeID"", ""day"", ""hour"", ""hourlypct""})
+  hour.select({""sourcetypeID"", ""roadTypeID"", ""day"", ""hour"", ""hourlypct""})
   hour.write_csv(summary_dir + ""/hourlyvmt.csv"")
 
   //6. Speed output
   df1 = df.copy()
   //Calculate speed bin
   for period in periods do
     // first calculate speed, as DBD file only has AB/BA speed.
-    vmt = df1.get_col(""Tot_VMT_AM"")
-    vht = df1.get_col(""Tot_VHT_AM"")
-    speed = vmt/vht
-    df1.mutate(""speed"", speed)
-    df1.mutate(""speedbin_""+ period, if df1.tbl.speed <72.5 then Ceil((df1.tbl.speed + 2.5)/5) else 16)
+    v_vmt = df1.get_col(""Tot_VMT_"" + period)
+    v_vht = df1.get_col(""Tot_VHT_"" + period)
+    v_speed = v_vmt/v_vht
+    df1.mutate(""speed_"" + period, v_speed)
+    df1.mutate(""speedbin_""+ period, if df1.tbl.(""speed_"" + period) <72.5 then Ceil((df1.tbl.(""speed_"" + period) + 2.5)/5) else 16)
   end
+
   //Calculate VHT fraction
   gather_cols = {""speedbin_AM"", ""speedbin_MD"", ""speedbin_PM"", ""speedbin_NT""} // wide table to long
-  df1.gather(gather_cols, ""TOD"",""bin"")
-  df1.mutate(""TOD"", right(df1.tbl.TOD, 2))
+  df1.gather(gather_cols, ""TOD"", ""bin"")
+  df1.mutate(""TOD"", right(df1.tbl.(""TOD""), 2))
   df1.mutate(""VHT"", if df1.tbl.TOD = ""AM"" then df1.tbl.Tot_VHT_AM else if df1.tbl.TOD = ""MD"" then df1.tbl.Tot_VHT_MD else if df1.tbl.TOD = ""PM"" then df1.tbl.Tot_VHT_PM else df1.tbl.Tot_VHT_NT)
   df1.group_by({""TOD"", ""roadTypeID"", ""bin""})
   df1.summarize(""VHT"", ""sum"")
@@ -244,14 +245,14 @@ Macro ""MOVES"" (Args, region, year)
   df2.rename('sum_VHT', ""total_VHT"")
 
   df1.left_join(df2, {""TOD"", ""roadTypeID""}, {""TOD"", ""roadTypeID""})
-  df1.mutate(""AvgSpeedFraction"", df1.tbl.VHT/df1.tbl.total_VHT) // get fraction
+  df1.mutate(""Fraction"", if df1.tbl.VHT/df1.tbl.total_VHT>0 then df1.tbl.VHT/df1.tbl.total_VHT else 0) // get fraction
 
   //Join results to the speed template
   speed = Createobject(""df"", speed_file)
-  speed.rename(""AvgSpeedFraction"", ""DefaultFraction"")
+  speed.rename(""avgSpeedFraction"", ""DefaultFraction"")
   speed.left_join(df1, {""TOD"", ""roadTypeID"", ""avgSpeedBinID""}, {""TOD"", ""roadTypeID"", ""bin""})
-  speed.mutate(""AvgSpeedFraction"", if speed.tbl.AvgSpeedFraction >0 then speed.tbl.AvgSpeedFraction else 0) //fill in missing zero
-  speed.mutate(""AvgSpeedFraction"", if speed.tbl.dayID <>2 then speed.tbl.AvgSpeedFraction else speed.tbl.DefaultFraction) // weekend fraction should be set to default
+  speed.mutate(""AvgSpeedFraction"", if speed.tbl.dayID <>2 then speed.tbl.Fraction else speed.tbl.DefaultFraction) // weekend fraction should be set to default
+  speed.select({""sourceTypeID"", ""roadTypeID"", ""hourDayID"", ""hourID"", ""dayID"", ""TOD"", ""avgSpeedBinID"", ""AvgSpeedFraction""})
   speed.write_csv(summary_dir + ""/speed.csv"")
 
   DeleteFile(summary_dir + ""/agg_link_table.csv"")"
Triangle-Modeling-and-Analytics,TRMG2,4e071f52fbf4e84aeac6587ff646174bc06d76ca,Kyle Ward,kyleward084@gmail.com,2023-03-31T19:55:25Z,Kyle Ward,kyleward084@gmail.com,2023-03-31T19:55:25Z,"Remove second project list code

The second project list approach was causing an issue because some project IDs can be repeated (if one project ID is both the outbound and inbound route).",src/utils/TransitProjectManagement.rsc,False,False,False,False,42,42,84,"---FILE: src/utils/TransitProjectManagement.rsc---
@@ -134,15 +134,15 @@ Macro ""Transit Project Management"" (MacroOpts)
   MacroOpts.out_dir = out_dir
   MacroOpts.delete_shape_stops = delete_shape_stops
 
-  // broken_routes = RunMacro(""Migrate Route System"", MacroOpts)
-  // if broken_routes <> null then do
-  //   MacroOpts.broken_routes = broken_routes
-  //   RunMacro(""Prepare Broken Routes"", MacroOpts)
-  //   RunMacro(""Export to GTFS"", MacroOpts)
-  //   RunMacro(""Import from GTFS"", MacroOpts) 
-  //   RunMacro(""Merge Route Systems"", MacroOpts)
-  // end
-  // RunMacro(""Update Scenario Attributes"", MacroOpts)
+  broken_routes = RunMacro(""Migrate Route System"", MacroOpts)
+  if broken_routes <> null then do
+    MacroOpts.broken_routes = broken_routes
+    RunMacro(""Prepare Broken Routes"", MacroOpts)
+    RunMacro(""Export to GTFS"", MacroOpts)
+    RunMacro(""Import from GTFS"", MacroOpts) 
+    RunMacro(""Merge Route Systems"", MacroOpts)
+  end
+  RunMacro(""Update Scenario Attributes"", MacroOpts)
   RunMacro(""Check Scenario Route System"", MacroOpts)
   if delete_shape_stops then RunMacro(""Remove Shape Stops"", MacroOpts)
 
@@ -290,17 +290,17 @@ Macro ""Prepare Broken Routes"" (MacroOpts)
     DeleteRoute(rlyr, name)
   end
 
-  // Create a new projet list that is only of the broken routes
-  tbl = CreateObject(""Table"", proj_list)
-  for pid in v_proj_ids do
-    tbl.SelectByQuery({
-      SetName: ""broken_routes"",
-      Query: ""ProjID = "" + pid,
-      Operation: ""more""
-    })
-  end
-  proj_list2 = Substitute(proj_list, "".csv"", ""_2.csv"", )
-  tbl.Export({FileName: proj_list2})
+  // // Create a new projet list that is only of the broken routes
+  // tbl = CreateObject(""Table"", proj_list)
+  // for pid in v_proj_ids do
+  //   tbl.SelectByQuery({
+  //     SetName: ""broken_routes"",
+  //     Query: ""ProjID = "" + pid,
+  //     Operation: ""more""
+  //   })
+  // end
+  // proj_list2 = Substitute(proj_list, "".csv"", ""_2.csv"", )
+  // tbl.Export({FileName: proj_list2})
 endmacro
 
 /*
@@ -310,20 +310,22 @@ endmacro
 Macro ""Export to GTFS"" (MacroOpts)
 
   master_rts = MacroOpts.master_rts
-  proj_list = Substitute(MacroOpts.proj_list, "".csv"", ""_2.csv"", )
+  broken_routes = MacroOpts.broken_routes
+  // proj_list = Substitute(MacroOpts.proj_list, "".csv"", ""_2.csv"", )
   scen_hwy = MacroOpts.scen_hwy
 
-  // Get project IDs from the project list
-  proj_tbl = CreateObject(""Table"", proj_list)
-  v_pid = proj_tbl.ProjID
-  if TypeOf(v_pid) = ""null"" then Throw(""No transit project IDs found"")
-  if TypeOf(v_pid[1]) <> ""string"" then v_pid = String(v_pid)
+  // // Get project IDs from the project list
+  // proj_tbl = CreateObject(""Table"", proj_list)
+  // v_pid = proj_tbl.ProjID
+  // if TypeOf(v_pid) = ""null"" then Throw(""No transit project IDs found"")
+  // if TypeOf(v_pid[1]) <> ""string"" then v_pid = String(v_pid)
 
-  // Convert the project IDs into route IDs
-  opts = null
-  opts.rts_file = master_rts
-  opts.v_pid = v_pid
-  {v_rid, } = RunMacro(""Convert ProjID to RouteID"", opts)
+  // // Convert the project IDs into route IDs
+  // opts = null
+  // opts.rts_file = master_rts
+  // opts.v_pid = v_pid
+  // {v_rid, } = RunMacro(""Convert ProjID to RouteID"", opts)
+  v_rid = A2V(broken_routes)
 
   // Select routes based on route ids
   map = CreateObject(""Map"", master_rts)
@@ -337,12 +339,12 @@ Macro ""Export to GTFS"" (MacroOpts)
     qry = ""Select * where Route_ID = "" + rid
     operation = if i = 1 then ""several"" else ""more""
     n = SelectByQuery(export_set, operation, qry)
-    if n <= n_prev then Throw(T(
-      ""Transit Manager: Project %s in the project list was not found in the "" +
-      ""master route system."", 
-      {v_pid[i]}
-    ))
-    n_prev = n
+    // if n <= n_prev then Throw(T(
+    //   ""Transit Manager: Project %s in the project list was not found in the "" +
+    //   ""master route system."", 
+    //   {v_pid[i]}
+    // ))
+    // n_prev = n
   end
 
   // Create a gtfs folder to hold the export
@@ -494,7 +496,7 @@ broken routes.
 Macro ""Merge Route Systems"" (MacroOpts)
   output_rts_file = MacroOpts.output_rts_file
   output_rts_file2 = Substitute(output_rts_file, "".rts"", ""_2.rts"", )
-  proj_list = Substitute(MacroOpts.proj_list, "".csv"", ""_2.csv"", )
+  // proj_list = Substitute(MacroOpts.proj_list, "".csv"", ""_2.csv"", )
 
   rts = CreateObject(""Map"", output_rts_file)
   {nlyr, llyr, rlyr, slyr} = rts.GetLayerNames()
@@ -526,8 +528,8 @@ Macro ""Merge Route Systems"" (MacroOpts)
 
   // Delete the broken route files
   DeleteRouteSystem(output_rts_file2)
-  DeleteFile(proj_list)
-  DeleteFile(Substitute(proj_list, "".csv"", "".dcc"", ))
+  // DeleteFile(proj_list)
+  // DeleteFile(Substitute(proj_list, "".csv"", "".dcc"", ))
 endmacro
 
 /*
@@ -640,8 +642,6 @@ Macro ""Check Scenario Route System"" (MacroOpts)
     rid_m = v_rid_m[i]
     rid_s = v_rid_s[i]
 
-if pid = ""30"" then Throw()
-
     // Calculate the route length in the master rts
     opts = null
     opts.rlyr = rlyr_m"
Triangle-Modeling-and-Analytics,TRMG2,f9de4728f2e74444ede1a2c47e4673c5d394a12c,Kyle,kyle@caliper.com,2023-03-09T21:25:39Z,Kyle,kyle@caliper.com,2023-03-09T21:25:39Z,"Fix up the scenario comparison tool

Corrected one last error and filled in the help button text.",src/utils/ScenarioComparison.rsc,False,False,False,False,5,2,7,"---FILE: src/utils/ScenarioComparison.rsc---
@@ -60,7 +60,11 @@ dBox ""scen_comp_tool"" center, center, 40, 10 Title: ""Scenario Comparison Tool"" t
     enditem
     Button 28, same Prompt: ""Help"" do
         ShowMessage(
-            ""placeholder""
+            ""This tool allows you to select two previously-run scenarios and "" +
+            ""creates comparison tables and maps. Optionally, you can include "" +
+            ""a polygon file to only compare a subarea.\n\n"" +
+            ""Find the output in the 'comparison_outputs' folder, which will "" +
+            ""be created in the 'New Scenario' directory.""
         )
     enditem
 enddbox
@@ -145,7 +149,6 @@ Macro ""Compare Summary Tables"" (MacroOpts)
     RunMacro(""Create Directory"", comp_dir)
     tables_to_compare = {
         {""/output/_summaries/resident_hb/hb_trip_mode_shares.csv"", {""mode""}, {""total"", ""pct""}},
-        {""/output/_summaries/resident_hb/hb_trip_purpmode_shares.csv"", {""trip_type"", ""mode""}, {""Sum"", ""total"", ""pct""}},
         {""/output/_summaries/resident_hb/hb_trip_stats_by_modeperiod.csv"", {""trip_type"", ""period"", ""mode""}, {""Sum"", ""SumDiag"", ""PctDiag""}},
         {""/output/_summaries/resident_hb/hb_trip_stats_by_type.csv"", {""matrix""}, {""Sum"", ""SumDiag"", ""PctDiag"", ""avg_length_mi"", ""avg_time_min""}},
         {""/output/_summaries/resident_nhb/nhb_trip_stats_by_modeperiod.csv"", {""trip_type"", ""period"", ""mode""}, {""Sum"", ""SumDiag"", ""PctDiag""}},"
Triangle-Modeling-and-Analytics,TRMG2,7dbd13fcf72346374472bba469f53cf73f29ad86,Kyle Ward,kyleward084@gmail.com,2023-02-09T21:01:12Z,Kyle Ward,kyleward084@gmail.com,2023-02-09T21:01:12Z,"Update TC build number to 32885

This TC build contains a fix to the GTFS import function that improves results.",src/flow_chart/trmg2_plugin_macros.rsc,False,False,False,False,1,1,2,"---FILE: src/flow_chart/trmg2_plugin_macros.rsc---
@@ -21,7 +21,7 @@ Macro ""Model.Attributes"" (Args,Result)
         {""Requires"",
 {{""Program"", ""TransCAD""},
 {""Version"", 9},
-{""Build"", 32880}}},
+{""Build"", 32885}}},
 {""RunParallel"", 0},
 {""Shape"", ""Rectangle""},
 {""ShowTaskMonitor"", 1},"
Triangle-Modeling-and-Analytics,TRMG2,87c8c71aeb1dddd59a983f7b1cfc175df72509ee,nitabhave,nnbhave@ncsu.edu,2023-02-08T19:57:44Z,nitabhave,nnbhave@ncsu.edu,2023-02-08T19:57:44Z,"fixed Transit Only links with no speed

The 2020 model wasn't running bc some transit routes were using network links with no speeds.",master/networks/master_links.BIN,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,31a68be13aaadf1ddddde9db6acd13dbf99fb262,nitabhave,nnbhave@ncsu.edu,2023-02-03T16:16:23Z,nitabhave,nnbhave@ncsu.edu,2023-02-03T16:16:23Z,"LOTS of rts fixes. A few network edits.

Fixing routes so they appear in the scenario as they are coded in the master. For both 2020 and 2050.",master/networks/master_links.BIN;master/networks/master_links.dln;master/networks/master_links.pts;master/networks/master_routes.rtg;master/networks/master_routes.rts;master/networks/master_routesL.BX;master/networks/master_routesL.bin;master/networks/master_routesR.BX;master/networks/master_routesR.bin;master/networks/master_routesS.BX;master/networks/master_routesS.bin;master/networks/master_routesS.grp;master/networks/master_routesS.lok;master/networks/master_routesS.pnk;master/networks/master_routesS.r0;scenarios/mtp_2050/TransitProjectList.csv,False,False,False,False,1,1,2,"---FILE: scenarios/mtp_2050/TransitProjectList.csv---
@@ -81,7 +81,6 @@ ProjID,AMHeadway,MDHeadway,PMHeadway,NTHeadway
 127,,,,
 128,30,40,30,40
 129,,,,
-130,,,,
 136,,,,
 137,,,,
 138,30,60,30,60
@@ -181,3 +180,4 @@ ProjID,AMHeadway,MDHeadway,PMHeadway,NTHeadway
 394,,,,
 395,,,,
 397,,,,
+403,,,,"
Triangle-Modeling-and-Analytics,TRMG2,9cfd9583d9f075248225993a747407a49cf51d92,Kyle Ward,kyleward084@gmail.com,2023-01-20T15:25:21Z,Kyle Ward,kyleward084@gmail.com,2023-01-20T15:25:21Z,"Make corrections to the master RTS

Also removed the shape_stop field completed and made the associated code changes.",master/networks/master_routes.rts;master/networks/master_routesS.BX;master/networks/master_routesS.DCB;master/networks/master_routesS.bin;master/networks/master_routesS.grp;master/networks/master_routesS.lok;master/networks/master_routesS.pnk;master/networks/master_routesS.r0;src/01 - CreateScenario.rsc;src/utils/TransitProjectManagement.rsc,False,False,False,False,5,8,13,"---FILE: master/networks/master_routesS.DCB---
@@ -1,7 +1,6 @@
 
-32
+28
 ""STOP_ID"",I,1,4,0,9,0,,"""","""",,""Sum"",
-""shape_stop"",I,5,4,0,8,0,,"""","""",,""Sum"",
-""dwell_on"",R,9,8,0,8,2,,"""","""",,""Sum"",
-""dwell_off"",R,17,8,0,8,2,,"""","""",,""Sum"",
-""xfer_pen"",R,25,8,0,8,2,,"""","""",,""Sum"",
+""dwell_on"",R,5,8,0,8,2,,"""","""",,""Sum"",
+""dwell_off"",R,13,8,0,8,2,,"""","""",,""Sum"",
+""xfer_pen"",R,21,8,0,8,2,,"""","""",,""Sum"",

---FILE: src/01 - CreateScenario.rsc---
@@ -209,7 +209,7 @@ Macro ""Create Scenario Transit"" (Args)
   opts.scen_hwy = Args.[Input Links]
   opts.proj_list = scen_dir + ""/TransitProjectList.csv""
   opts.centroid_qry = ""Centroid = 1""
-  opts.link_qry = ""HCMType <> null""
+  opts.link_qry = ""HCMType <> null and HCMType <> 'CC'""
   {, , rts_name, ext} = SplitPath(scen_rts)
   opts.output_rts_file = rts_name + ext
   RunMacro(""Transit Project Management"", opts)

---FILE: src/utils/TransitProjectManagement.rsc---
@@ -302,7 +302,6 @@ Macro ""Import from GTFS"" (MacroOpts)
   }})
   // Add back stop attributes from master
   fields = {
-    {FieldName: ""shape_stop"", Type: ""integer""},
     {FieldName: ""dwell_on"", Type: ""real""},
     {FieldName: ""dwell_off"", Type: ""real""},
     {FieldName: ""xfer_pen"", Type: ""real""}
@@ -315,7 +314,6 @@ Macro ""Import from GTFS"" (MacroOpts)
     LeftFields: ""Master_Stop_ID"",
     RightFields: ""ID""
   })
-  join_tbl.(slyr + "".shape_stop"") = join_tbl.(master_slyr + "".shape_stop"")
   join_tbl.(slyr + "".dwell_on"") = join_tbl.(master_slyr + "".dwell_on"")
   join_tbl.(slyr + "".dwell_off"") = join_tbl.(master_slyr + "".dwell_off"")
   join_tbl.(slyr + "".xfer_pen"") = join_tbl.(master_slyr + "".xfer_pen"")"
Triangle-Modeling-and-Analytics,TRMG2,ebc6c27c38476b23efa68ffc5a2743cc41f642b7,Kyle Ward,kyleward084@gmail.com,2023-01-04T20:14:03Z,Kyle Ward,kyleward084@gmail.com,2023-01-04T20:14:03Z,"Update se_2050.bin

These files were sent by Nita on 12/14 and contain corrections to the student GQ fields made by Jenna.",master/sedata/se_2050.bin,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,2fe9235471840ddb72cf78edcc9f3b334412e01c,Kyle Ward,kyleward084@gmail.com,2022-12-13T20:44:51Z,Kyle Ward,kyleward084@gmail.com,2022-12-13T20:45:42Z,Correct the route name issue,src/utils/TransitProjectManagement.rsc,False,False,False,False,9,289,298,"---FILE: src/utils/TransitProjectManagement.rsc---
@@ -112,7 +112,7 @@ Macro ""Transit Project Management"" (MacroOpts)
   a_path = SplitPath(scen_hwy)
   out_dir = a_path[1] + a_path[2]
   out_dir = RunMacro(""Normalize Path"", out_dir)
-  output_rts_file = out_dir + ""/"" + output_rts_file
+  output_rts_file = out_dir + ""\\"" + output_rts_file
 
   // Update the values of MacroOpts
   MacroOpts.output_rts_file = output_rts_file
@@ -124,8 +124,7 @@ Macro ""Transit Project Management"" (MacroOpts)
   RunMacro(""Export to GTFS"", MacroOpts)
   RunMacro(""Import from GTFS"", MacroOpts)
   RunMacro(""Update Scenario Attributes"", MacroOpts)
-  Throw()
-  // RunMacro(""Check Scenario Route System"", MacroOpts)
+  RunMacro(""Check Scenario Route System"", MacroOpts)
 EndMacro
 
 /*
@@ -212,7 +211,6 @@ Macro ""Import from GTFS"" (MacroOpts)
   // TODO: drop physical stops when dev can run successfully
   // gtfs.Import({DropPhysicalStops: true})
   gtfs.Import()
-
   // Create map with both route systems
   map = CreateObject(""Map"", output_rts_file)
   {nlyr, llyr, rlyr, slyr} = map.GetLayerNames()
@@ -221,6 +219,7 @@ Macro ""Import from GTFS"" (MacroOpts)
   // Clean up route attributes
   tbl = CreateObject(""Table"", rlyr)
   tbl.Route_Name = tbl.[Short Name]
+  ReloadRouteSystem(output_rts_file)
   tbl.RenameField({FieldName: ""Route"", NewName: ""Master_Route_ID""})
   tbl.ChangeField({
     FieldName: ""Master_Route_ID"",
@@ -318,275 +317,6 @@ Macro ""Import from GTFS"" (MacroOpts)
   end
 endmacro
 
-/*
-Creates the scenario route system.
-*/
-
-Macro ""Create Scenario Route System"" (MacroOpts)
-
-  // Argument extraction
-  master_rts = MacroOpts.master_rts
-  scen_hwy = MacroOpts.scen_hwy
-  proj_list = MacroOpts.proj_list
-  centroid_qry = MacroOpts.centroid_qry
-  link_qry = MacroOpts.link_qry
-  output_rts_file = MacroOpts.output_rts_file
-  out_dir = MacroOpts.out_dir
-  delete_shape_stops = MacroOpts.delete_shape_stops
-
-  // Make a copy of the master_rts into the output directory to prevent
-  // this macro from modifying the actual master RTS.
-  opts = null
-  opts.from_rts = master_rts
-  opts.to_dir = out_dir
-  opts.include_hwy_files = ""true""
-  {master_rts_copy, master_hwy_copy} = RunMacro(""Copy RTS Files"", opts)
-
-  // Get project IDs from the project list
-  proj = OpenTable(""projects"", ""CSV"", {proj_list, })
-  v_pid = GetDataVector(proj + ""|"", ""ProjID"", )
-  if TypeOf(v_pid) = ""null"" then Throw(""No transit project IDs found"")
-  if TypeOf(v_pid[1]) <> ""string"" then v_pid = String(v_pid)
-
-  // Convert the project IDs into route IDs
-  opts = null
-  opts.rts_file = master_rts
-  opts.v_pid = v_pid
-  {v_rid, } = RunMacro(""Convert ProjID to RouteID"", opts)
-
-  // Open the route's stop dbd and add the scen_hwy
-  master_stops_dbd = Substitute(master_rts_copy, "".rts"", ""S.dbd"", )
-  opts = null
-  opts.file = master_stops_dbd
-  {map, } = RunMacro(""Create Map"", opts)
-  {slyr} = GetDBLayers(master_stops_dbd)
-  {nlyr, llyr} = GetDBLayers(scen_hwy)
-  AddLayer(map, nlyr, scen_hwy, nlyr)
-  AddLayer(map, llyr, scen_hwy, llyr)
-
-  // Create a selection set of route stops from the proj_list using
-  // the route IDs. (The ProjID field is not in the stops dbd.)
-  SetLayer(slyr)
-  route_stops = ""scenario routes""
-  for i = 1 to v_rid.length do
-    id = v_rid[i]
-
-    id = if TypeOf(id) = ""string"" then ""'"" + id + ""'"" else String(id)
-    qry = ""Select * where Route_ID = "" + id
-    operation = if i = 1 then ""several"" else ""more""
-    SelectByQuery(route_stops, operation, qry)
-  end
-
-  /*
-  Add stop layer fields. The tour table required to create a fresh route
-  system requires the following fields:
-  Master_Route_ID
-  Node_ID
-  Stop_Flag
-  Stop_ID
-  Stop_Name
-
-  On a freshly-created route system, only the following fields are present
-  on the stop layer:
-  Route_ID (can be renamed to Master_Route_ID)
-  STOP_ID (can be renamed to Stop_ID)
-
-  Thus, the following fields must be created:
-  Stop_Flag (filled with 1 because these are stop records)
-  Node_ID (filled by tagging stops to nodes)
-  Stop_Name (left empty)
-
-  A final field ""missing_node"" is added for reporting purposes.
-  */
-  a_fields = {
-    {""Stop_Flag"", ""Integer"", 10,,,,,""Filled with 1s""},
-    {""Stop_Name"", ""Character"", 10,,,,,""""},
-    {""Node_ID"", ""Integer"", 10,,,,,""Scenario network node id""},
-    {""missing_node"", ""Integer"", 10,,,,,
-    ""1: a stop in the master rts could not find a nearby node""}
-  }
-  RunMacro(""Add Fields"", {view: slyr, a_fields: a_fields, initial_values:{1, , , 0}})
-
-  // Create a selection set of centroids on the node layer. These will be
-  // excluded so that routes do not pass through them. Also create a
-  // non-centroid set.
-  SetLayer(nlyr)
-  centroid_set = CreateSet(""centroids"")
-  num_centroids = SelectByQuery(centroid_set, ""several"", centroid_qry)
-  non_centroid_set = CreateSet(""non-centroids"")
-  SetInvert(non_centroid_set, centroid_set)
-
-  // If provided, use the link_qry to further reduce the non_centroid_set
-  if link_qry <> null then do
-    SetLayer(llyr)
-    route_link_set = CreateSet(""route links"")
-    n = SelectByQuery(route_link_set, ""several"", link_qry)
-    if n = 0 then Throw(""'link_qry' results in 0 valid links for routes to use."")
-    SetLayer(nlyr)
-    route_link_nodes = CreateSet(""route link nodes"")
-    SelectByLinks(route_link_nodes, ""several"", ""route links"", )
-    SetAND(non_centroid_set, {non_centroid_set, route_link_nodes})
-  end
-
-  // Perform a spatial join to match scenario nodes to master stops.
-  opts = null
-  opts.master_layer = slyr
-  opts.master_set = route_stops
-  opts.slave_layer = nlyr
-  opts.slave_set = non_centroid_set
-  jv = RunMacro(""Spatial Join"", opts)
-
-  // Transfer the scenario node ID into the Node_ID field
-  v = GetDataVector(jv + ""|"", nlyr + "".ID"", )
-  SetDataVector(jv + ""|"", slyr + "".Node_ID"", v, )
-  CloseView(jv)
-
-  // The spatial join leaves ""slave_id"" and ""slave_dist"" fields.
-  // Use them to determine missing nodes and then remove them.
-  SetLayer(slyr)
-  set = CreateSet(""set"")
-  qry = ""Select * where slave_dist <> null and slave_id = null""
-  n = SelectByQuery(set, ""several"", qry)
-  if n > 0 then do
-    opts = null
-    opts.Constant = 1
-    v = Vector(n, ""Long"", opts)
-    SetDataVector(slyr + ""|"" + set, ""missing_node"", v, )
-    DeleteSet(set)
-  end
-  RunMacro(""Remove Field"", slyr, {""slave_id"", ""slave_dist""})
-
-  // Read in the selected records to a data frame
-  stop_df = CreateObject(""df"")
-  opts = null
-  opts.view = slyr
-  opts.set = route_stops
-  stop_df.read_view(opts)
-
-  // shape_stop
-  // Some stops on the master rts can be marked as shape stops, which
-  // are used to improve the accuracy of the resulting route, but should
-  // not be assigned as stops. Handle those here. Test to make sure the
-  // shape_stop field exists so as not to make this field a requirement.
-  if delete_shape_stops then do
-    if stop_df.in(""shape_stop"", stop_df.colnames()) then do
-      v_shape_stop = stop_df.get_col(""shape_stop"")
-      v_stop_flag = stop_df.get_col(""Stop_Flag"")
-      v_stop_flag = if (v_shape_stop = 1) then 0 else 1
-      stop_df.mutate(""Stop_Flag"", v_stop_flag)
-    end
-  end
-
-  // In order to draw routes to nodes in the right order, sort by
-  // Route_ID and then mile post.
-  stop_df.arrange({""Route_ID"", ""Milepost""})
-
-  // Create a table with the proper format to be read by TC's
-  // create-route-from-table method. In TC6 help, this is called
-  // ""Creating a Route System from a Tour Table"", and is in the drop down
-  // menu Route Systems -> Utilities -> Create from table...
-  // Fields:
-  // Master_Route_ID
-  // Node_ID
-  // Stop_Flag
-  // Stop_ID
-  // Stop_Name
-  create_df = stop_df.copy()
-  create_df.rename(
-    {""Route_ID"", ""STOP_ID"", ""Stop Name""},
-    {""Master_Route_ID"", ""Stop_ID"", ""Stop_Name""}
-  )
-  create_df.filter(""missing_node <> 1"")
-  create_df.select(
-    {""Master_Route_ID"", ""Node_ID"", ""Stop_Flag"", ""Stop_ID"", ""Stop_Name""}
-  )
-  tour_table = out_dir + ""/create_rts_from_table.bin""
-  create_df.write_bin(tour_table)
-
-  // Create a simple network
-  opts = null
-  opts.llyr = llyr
-  opts.centroid_qry = centroid_qry
-  opts.link_qry = link_qry
-  net_file = RunMacro(""Create Simple Roadway Net"", opts)
-
-  // Get the name of the master (copy) route layer
-  {, , a_info} = GetRouteSystemInfo(master_rts_copy)
-  rlyr = a_info.Name
-
-  // Call TransCAD macro for importing a route system from a stop table.
-  Opts = null
-  Opts.Input.Network = net_file
-  Opts.Input.[Link Set] = {scen_hwy + ""|"" + llyr, llyr}
-  Opts.Input.[Tour Table] = {tour_table}
-  Opts.Global.[Cost Field] = 1
-  Opts.Global.[Route ID Field] = 1
-  Opts.Global.[Node ID Field] = 2
-  Opts.Global.[Include Stop] = 1
-  Opts.Global.[RS Layers].RouteLayer = rlyr
-  Opts.Global.[RS Layers].StopLayer = slyr
-  Opts.Global.[Stop Flag Field] = 3
-  Opts.Global.[User ID Field] = 2
-  Opts.Output.[Output Routes] = output_rts_file
-  ret_value = RunMacro(""TCB Run Operation"", ""Create RS From Table"", Opts, &Ret)
-  if !ret_value then Throw(""Create RS From Table failed"")
-  // The tcb method leaves a layer open. Use close all to close it and the map.
-  RunMacro(""Close All"")
-
-  // The new route system is created without attributes, but with Time and
-  // Distance fields added. Remove those fields and then join back the originals.
-  vw_temp = OpenTable(""vw_temp"", ""FFB"", {Substitute(output_rts_file, "".rts"", ""R.bin"", )})
-  RunMacro(""Remove Field"", vw_temp, ""Time"")
-  RunMacro(""Remove Field"", vw_temp, ""Distance"")
-  CloseView(vw_temp)
-  master_df = CreateObject(""df"")
-  master_df.read_bin(
-    Substitute(master_rts_copy, "".rts"", ""R.bin"", )
-  )
-  scen_df = CreateObject(""df"")
-  scen_df.read_bin(
-    Substitute(output_rts_file, "".rts"", ""R.bin"", )
-  )
-
-  scen_df.remove({""Route_Name"", ""Time"", ""Distance""})
-  scen_df.left_join(master_df, ""Master_Route_ID"", ""Route_ID"")
-  scen_df.desc = CopyArray(master_df.desc)
-  scen_df.update_bin(
-    Substitute(output_rts_file, "".rts"", ""R.bin"", )
-  )
-  RunMacro(""Close All"")
-  
-  // Join any extra stop attributes (like dwell time)
-  master_df = CreateObject(""df"")
-  master_df.read_bin(
-    Substitute(master_rts_copy, "".rts"", ""S.bin"", )
-  )
-  scen_df = CreateObject(""df"")
-  scen_df.read_bin(
-    Substitute(output_rts_file, "".rts"", ""S.bin"", )
-  )
-  master_df.remove({""Stop_Flag"", ""Stop_Name"", ""Node_ID"", ""missing_node""})
-  scen_df.rename(""[Stop_ID:1]"", ""stop_id_orig"")  
-  scen_df.left_join(master_df, ""stop_id_orig"", ""Stop_ID"")
-  scen_df.desc = CopyArray(master_df.desc)
-  scen_df.set_desc(""stop_id_orig"", ""The stop ID in the master network"")
-  scen_df.update_bin(
-    Substitute(output_rts_file, "".rts"", ""S.bin"", )
-  )
-
-  // Reload the route system, which takes care of a few issues created by the
-  // create-from-stops and join steps.
-  opts = null
-  opts.file = output_rts_file
-  {map, a_layers} = RunMacro(""Create Map"", opts)
-  ReloadRouteSystem(output_rts_file)
-
-  // Clean up the files created by this macro that aren't needed anymore
-  RunMacro(""Close All"")
-  DeleteTableFiles(""FFB"", tour_table, )
-  DeleteFile(net_file)
-EndMacro
-
 /*
 Updates the scenario route system attributes based on the TransitProjectList.csv
 Also tags stops with node IDs in the 'node_id' field.
@@ -671,9 +401,8 @@ Macro ""Check Scenario Route System"" (MacroOpts)
 
   // Create path to the copy of the master rts and roadway files
   {drive, path, filename, ext} = SplitPath(master_rts)
-  master_rts_copy = out_dir + ""/"" + filename + ext
   opts = null
-  opts.rts_file = master_rts_copy
+  opts.rts_file = master_rts
   master_hwy_copy = RunMacro(""Get RTS Roadway File"", opts)
 
   // Get project IDs from the project list and convert to route ids on both
@@ -684,7 +413,7 @@ Macro ""Check Scenario Route System"" (MacroOpts)
   if TypeOf(v_pid[1]) <> ""string"" then v_pid = String(v_pid)
   CloseView(proj)
   opts = null
-  opts.rts_file = master_rts_copy
+  opts.rts_file = master_rts
   opts.v_pid = v_pid
   {v_rid_m, v_rev_pid} = RunMacro(""Convert ProjID to RouteID"", opts)
   opts.rts_file = output_rts_file
@@ -694,14 +423,15 @@ Macro ""Check Scenario Route System"" (MacroOpts)
   // all the fields in one table, you have to open the RTS file, which
   // links multiple tables together.
   opts = null
-  opts.file = master_rts_copy
+  opts.file = master_rts
   {master_map, {rlyr_m, slyr_m, , , llyr_m}} = RunMacro(""Create Map"", opts)
   stops_df = CreateObject(""df"")
   opts = null
   opts.view = slyr_m
-  opts.fields = {""Route_ID"", ""missing_node""}
+  // opts.fields = {""Route_ID"", ""missing_node""}
+  opts.fields = {""Route_ID""}
   stops_df.read_view(opts)
-  stops_df.mutate(""missing_node"", nz(stops_df.get_col(""missing_node"")))
+  stops_df.mutate(""missing_node"", null)
   stops_df.group_by(""Route_ID"")
   stops_df.summarize(""missing_node"", ""sum"")
   stops_df.rename(""sum_missing_node"", ""missing_node"")
@@ -761,17 +491,7 @@ Macro ""Check Scenario Route System"" (MacroOpts)
   final_df.rename(""missing_node"", ""missing_stops"")
   final_df.write_csv(out_dir + ""/_rts_creation_results.csv"")
 
-
-  // Clean up files
   RunMacro(""Close All"")
-  DeleteRouteSystem(master_rts_copy)
-  if GetFileInfo(Substitute(master_rts_copy, "".rts"", ""R.bin"", )) <> null
-    then DeleteFile(Substitute(master_rts_copy, "".rts"", ""R.bin"", ))
-  if GetFileInfo(Substitute(master_rts_copy, "".rts"", ""R.BX"", )) <> null
-    then DeleteFile(Substitute(master_rts_copy, "".rts"", ""R.BX"", ))
-  if GetFileInfo(Substitute(master_rts_copy, "".rts"", ""R.DCB"", )) <> null
-    then DeleteFile(Substitute(master_rts_copy, "".rts"", ""R.DCB"", ))
-  DeleteDatabase(master_hwy_copy)
 EndMacro
 
 /*"
Triangle-Modeling-and-Analytics,TRMG2,b053befc650d77ced647b374352c2b35d0fe65d1,Kyle Ward,kyleward084@gmail.com,2022-11-03T18:02:15Z,Kyle Ward,kyleward084@gmail.com,2022-11-03T18:02:15Z,"Change location of roadway error log

Have both error logs written to the input/network folder (just like the other manager logs are)",src/01 - CreateScenario.rsc;src/utils/RoadwayProjectManagement.rsc,False,False,False,False,3,3,6,"---FILE: src/01 - CreateScenario.rsc---
@@ -185,7 +185,6 @@ Macro ""Create Scenario Roadway"" (Args)
   opts.hwy_dbd = scen_hwy
   opts.proj_list = Args.[Scenario Folder] + ""/RoadwayProjectList.csv""
   opts.master_dbd = master_hwy
-  opts.scen_folder = Args.[Scenario Folder]
   RunMacro(""Roadway Project Management"", opts)
 
   RunMacro(""Close All"")

---FILE: src/utils/RoadwayProjectManagement.rsc---
@@ -38,7 +38,6 @@ Macro ""Roadway Project Management"" (MacroOpts)
   hwy_dbd = MacroOpts.hwy_dbd
   proj_list = MacroOpts.proj_list
   master_dbd = MacroOpts.master_dbd
-  scen_folder = MacroOpts.scen_folder
 
   // Argument check
   if hwy_dbd = null then Throw(""'hwy_dbd' not provided"")
@@ -73,7 +72,9 @@ Macro ""Roadway Project Management"" (MacroOpts)
 
   // Loop over each project ID
   num_notfound = 0
-  error_file = scen_folder + ""/NetworkBuildingError.csv""
+
+  {drive, path, , } = SplitPath(hwy_dbd)
+  error_file = drive + path + ""RoadwayBuildingError.csv""
   file = OpenFile(error_file, ""w"")
   WriteLine(file, ""Below projects are missing:"")
   "
Triangle-Modeling-and-Analytics,TRMG2,df84af381a7dd07c49e1cc541ea7c901431ed119,Kyle Ward,kyleward084@gmail.com,2022-11-03T17:59:46Z,Kyle Ward,kyleward084@gmail.com,2022-11-03T17:59:46Z,Create transit proj manager error log,src/utils/TransitProjectManagement.rsc,False,False,False,False,25,5,30,"---FILE: src/utils/TransitProjectManagement.rsc---
@@ -601,23 +601,43 @@ Macro ""Convert ProjID to RouteID"" (MacroOpts)
   opts.file = rts_file
   {map, {rlyr, slyr, phlyr}} = RunMacro(""Create Map"", opts)
 
+  // Create an error file that will list any project IDs not found in the
+  // route system.
+  num_notfound = 0
+  {drive, path, , } = SplitPath(rts_file)
+  error_file = drive + path + ""TransitBuildingError.csv""
+  file = OpenFile(error_file, ""w"")
+  WriteLine(file, ""Below projects are missing:"")
+
   // Convert project IDs into route IDs
   SetLayer(rlyr)
   route_set = ""scenario routes""
   for i = 1 to v_pid.length do
     id = v_pid[i]
 
     // Select routes that match the current project id
-    id = if TypeOf(id) = ""string"" then ""'"" + id + ""'"" else String(id)
-    qry = ""Select * where ProjID = "" + id
+    type = TypeOf(id)
+    id2 = if type = ""string"" then ""'"" + id + ""'"" else String(id)
+    qry = ""Select * where ProjID = "" + id2
     operation = if i = 1 then ""several"" else ""more""
     n = SelectByQuery(route_set, operation, qry)
-    if n = 0 then do
-      string = ""Route with ProjID = "" + id + "" not found in route layer.""
-      Throw(string)
+    if n = n_prev then do
+      num_notfound = num_notfound + 1
+      if type = ""string""
+        then WriteLine(file, id)
+        else WriteLine(file, String(id))
     end
+
+    n_prev = n
   end
 
+  CloseFile(file)
+  if num_notfound > 0 then Throw(
+    ""Projects not found in the master route system. See error log in the scenario folder.""
+  )
+  //remove error log once scenario created successfully
+  if num_notfound = 0 and GetFileInfo(error_file) <> null then DeleteFile(error_file)
+
   // Get final results
   v_rid = GetDataVector(rlyr + ""|"" + route_set, ""Route_ID"", )
   v_rev_pid = GetDataVector(rlyr + ""|"" + route_set, ""ProjID"", )"
Triangle-Modeling-and-Analytics,TRMG2,b1e9b40f8e689d8416f2d294e3f04bb68e1e43c2,Kyle Ward,kyleward084@gmail.com,2022-11-03T17:59:29Z,Kyle Ward,kyleward084@gmail.com,2022-11-03T17:59:29Z,Correct roadway proj manager error log,src/01 - CreateScenario.rsc;src/utils/RoadwayProjectManagement.rsc,False,False,False,False,3,1,4,"---FILE: src/01 - CreateScenario.rsc---
@@ -185,6 +185,7 @@ Macro ""Create Scenario Roadway"" (Args)
   opts.hwy_dbd = scen_hwy
   opts.proj_list = Args.[Scenario Folder] + ""/RoadwayProjectList.csv""
   opts.master_dbd = master_hwy
+  opts.scen_folder = Args.[Scenario Folder]
   RunMacro(""Roadway Project Management"", opts)
 
   RunMacro(""Close All"")

---FILE: src/utils/RoadwayProjectManagement.rsc---
@@ -138,7 +138,8 @@ Macro ""Roadway Project Management"" (MacroOpts)
   CloseFile(file)
   errmsg = ""Projects not found in the master network. See error log in the scenario folder.""
   if num_notfound > 0 then Throw(errmsg)
-  if num_notfound = 0 and GetFileInfo(file) <> null then DeleteFile(file) //remove error log once scenario created successfully
+  //remove error log once scenario created successfully
+  if num_notfound = 0 and GetFileInfo(error_file) <> null then DeleteFile(error_file)
 
   // Delete links with -99 in any project-related attribute.
   // DeleteRecordsInSet() and DeleteLink() are both slow."
Triangle-Modeling-and-Analytics,TRMG2,ebde3db649ba0ea4d0d1f38f7927cb9154c1b4bc,Si Shi,si_shi_itre@ncsu.edu,2022-11-01T14:26:07Z,Si Shi,si_shi_itre@ncsu.edu,2022-11-01T14:26:07Z,"Update RoadwayProjectManagement.rsc

Instead of crashing at each missing project, now the script will loop over entire list and generate an error log for missing projects.",src/utils/RoadwayProjectManagement.rsc,False,False,False,False,14,3,17,"---FILE: src/utils/RoadwayProjectManagement.rsc---
@@ -38,6 +38,7 @@ Macro ""Roadway Project Management"" (MacroOpts)
   hwy_dbd = MacroOpts.hwy_dbd
   proj_list = MacroOpts.proj_list
   master_dbd = MacroOpts.master_dbd
+  scen_folder = MacroOpts.scen_folder
 
   // Argument check
   if hwy_dbd = null then Throw(""'hwy_dbd' not provided"")
@@ -71,6 +72,11 @@ Macro ""Roadway Project Management"" (MacroOpts)
   attrList = ExcludeArrayElements(attrList, 1, 1)
 
   // Loop over each project ID
+  num_notfound = 0
+  error_file = scen_folder + ""/NetworkBuildingError.csv""
+  file = OpenFile(error_file, ""w"")
+  WriteLine(file, ""Below projects are missing:"")
+  
   for p = v_projIDs.length to 1 step -1 do
     projID = v_projIDs[p]
     type = TypeOf(projID)
@@ -122,12 +128,17 @@ Macro ""Roadway Project Management"" (MacroOpts)
     end
 
     if !proj_found then do
+      num_notfound = num_notfound + 1
       if type = ""string""
-        then errmsg = ""Project '"" + projID + ""' appears in the roadway project list but is not found in the master layer.""
-        else errmsg = ""Project '"" + String(projID) + ""' appears in the roadway project list but is not found in the master layer.""
-      Throw(errmsg)
+        then WriteLine(file, projID)
+        else WriteLine(file, String(projID))
     end
   end
+  
+  CloseFile(file)
+  errmsg = ""Projects not found in the master network. See error log in the scenario folder.""
+  if num_notfound > 0 then Throw(errmsg)
+  if num_notfound = 0 and GetFileInfo(file) <> null then DeleteFile(file) //remove error log once scenario created successfully
 
   // Delete links with -99 in any project-related attribute.
   // DeleteRecordsInSet() and DeleteLink() are both slow."
Triangle-Modeling-and-Analytics,TRMG2,fabfc46c178963145b8705a5119a2f78080faa3d,Kyle Ward,kyleward084@gmail.com,2022-10-11T17:12:20Z,Kyle Ward,kyleward084@gmail.com,2022-10-11T17:12:20Z,Improve error message,src/utils/RoadwayProjectManagement.rsc,False,False,False,False,2,2,4,"---FILE: src/utils/RoadwayProjectManagement.rsc---
@@ -123,8 +123,8 @@ Macro ""Roadway Project Management"" (MacroOpts)
 
     if !proj_found then do
       if type = ""string""
-        then errmsg = ""Project '"" + projID + ""' not found.""
-        else errmsg = ""Project '"" + String(projID) + ""' not found.""
+        then errmsg = ""Project '"" + projID + ""' appears in the roadway project list but is not found in the master layer.""
+        else errmsg = ""Project '"" + String(projID) + ""' appears in the roadway project list but is not found in the master layer.""
       Throw(errmsg)
     end
   end"
Triangle-Modeling-and-Analytics,TRMG2,b460ca214bba6cc4b2039865eb9c4c1693701377,Kyle Ward,kyleward084@gmail.com,2022-10-05T14:22:55Z,Kyle Ward,kyleward084@gmail.com,2022-10-05T14:22:55Z,"Add draft isochrone macro

This macro is not tested and will only run on the latest TC that has a few fixes. As a result, I've commented it out for now.",other/iso_exclusion/IsochroneExclusionAreas.BIN;other/iso_exclusion/IsochroneExclusionAreas.DCB;other/iso_exclusion/IsochroneExclusionAreas.cdf;other/iso_exclusion/IsochroneExclusionAreas.sty;src/19 - Summaries.rsc,False,False,False,False,76,0,76,"---FILE: other/iso_exclusion/IsochroneExclusionAreas.DCB---
@@ -0,0 +1,3 @@
+ExclusionAreas
+4
+""MergeID"",I,1,4,0,10,0,,"""","""",,""Sum"",

---FILE: src/19 - Summaries.rsc---
@@ -9,6 +9,7 @@ Macro ""Maps"" (Args)
     RunMacro(""Create Count Difference Map"", Args)
     RunMacro(""VOC Maps"", Args)
     RunMacro(""Speed Maps"", Args)
+    // RunMacro(""Isochrones"", Args)
     return(1)
 endmacro
 
@@ -570,6 +571,78 @@ Macro ""Speed Maps"" (Args)
   end
 EndMacro
 
+/*
+Creates isochrone (travel time band) maps
+*/
+
+Macro ""Isochrones"" (Args)
+  hwy_dbd = Args.Links
+  map_dir = Args.[Output Folder] + ""\\_summaries\\maps""
+  if GetDirectoryInfo(map_dir, ""All"") = null then CreateDirectory(map_dir)
+  net_dir = Args.[Output Folder] + ""\\networks""
+  exclusion_file = Args.[Model Folder] + ""\\other\\iso_exclusion\\IsochroneExclusionAreas.cdf""
+  
+  periods = {""AM""}
+  dirs = {""outbound"", ""inbound""}
+  nodes = {
+    108108, // Raleigh
+    15670,  // Durham
+    10827   // RDU
+  }
+  names = {
+    ""Raleigh"",
+    ""Durham"",
+    ""RDU""
+  }
+  
+  //Create a new, blank map
+  {map, {nlyr, llyr}} = RunMacro(""Create Map"", {file: hwy_dbd, minimized: ""false""})
+  SetLayerVisibility(map + ""|"" + nlyr, ""false"")
+  SetLayer(llyr)
+
+  for period in periods do
+    for i = 1 to nodes.length do
+      node_id = nodes[i]
+      name = names[i]
+
+      SetLayer(nlyr)
+      cord = GetPoint(node_id)
+      SetLayer(llyr)
+
+      for dir in dirs do
+        map_file = map_dir + ""\\iso_"" + name + ""_"" + dir + ""_"" + period + "".map""
+        net_file = net_dir + ""\\net_"" + period + ""_sov.net""
+
+        nh = ReadNetwork(net_file)
+
+        o = null
+        o = CreateObject(""Routing.Bands"")
+        o.NetworkName = net_file
+        o.RoutingLayer = GetLayer()
+        o.Minimize = ""CongTime""
+        o.Interval = 10
+        o.BandMax  = 30
+        o.CumulativeBands = ""Yes""
+        o.InboundBands = if dir = ""inbound""
+          then true
+          else false
+        o.CreateTheme = true
+        o.LoadExclusionAreas(exclusion_file)
+        o.CreateBands({
+          Coords: {cord},
+          FileName: GetTempFileName(""*.dbd""),
+          LayerName : name + "" "" + dir + "" bands""
+        })
+
+        RedrawMap(map)
+        SaveMap(map_file)
+      end
+    end
+  end
+
+  CloseMap()
+endmacro
+
 /*
 Creates a table of statistics and writes out
 final tables to CSV."
Triangle-Modeling-and-Analytics,TRMG2,2f0223f31520de8d4b67e2a3eee8495e588aadb6,Kyle Ward,kyleward084@gmail.com,2022-09-26T14:55:14Z,Kyle Ward,kyleward084@gmail.com,2022-09-26T14:55:14Z,Correct bug with subarea layer,src/utils/ScenarioComparison.rsc,False,False,False,False,5,1,6,"---FILE: src/utils/ScenarioComparison.rsc---
@@ -39,7 +39,10 @@ dBox ""scen_comp_tool"" center, center, 40, 10 Title: ""Scenario Comparison Tool"" t
     Text 15, after, 15 Framed Prompt: ""Subarea Polygon:"" Variable: sub_poly
     Button after, same, 5, 1 Prompt: ""..."" do
         on error, escape goto skip3
-        sub_poly = ChooseFile({{""polygon layer"", ""*.dbd""}}, ""Choose a polygon layer"", )
+        sub_poly = ChooseFile(
+            {{""polygon layer"", ""*.dbd""}}, ""Choose a polygon layer"", 
+            {""Initial Directory"": new_scen}
+        )
         skip3:
         on error default
     enditem
@@ -289,6 +292,7 @@ Macro ""Compare Link Data"" (MacroOpts)
     fields_to_map = {
         ""Total_Flow_Daily"", ""Total_VMT_Daily"", ""Total_VHT_Daily"", ""Total_Delay_Daily""
     }
+    map.SetLayer(link_lyr)
 
     for field in fields_to_map do
         expr = CreateExpression(jv, ""abs_"" + field + ""_diff"", ""abs("" + field + ""_diff)"", )"
Triangle-Modeling-and-Analytics,TRMG2,9225b53d0df3b26028af12f8e673b284905d62d0,Kyle,kyle@caliper.com,2022-09-10T22:32:10Z,Kyle,kyle@caliper.com,2022-09-12T02:12:06Z,"Correct count

CountPointID 5735 was split across links. I'm fixing it here, but it will have to be re-fixed when the new network comes in.",master/networks/master_links.BIN,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,6f38ad9d938fc809cab94689a6ee15e4594cf659,Kyle Ward,kyleward084@gmail.com,2022-08-01T15:16:57Z,Kyle Ward,kyleward084@gmail.com,2022-08-01T15:16:57Z,"Catch missing roadway projects

Scenario creation will now throw an error if a project is in the scenario project list but not in the master roadway layer.",src/utils/RoadwayProjectManagement.rsc,False,False,False,False,9,0,9,"---FILE: src/utils/RoadwayProjectManagement.rsc---
@@ -74,6 +74,7 @@ Macro ""Roadway Project Management"" (MacroOpts)
   for p = v_projIDs.length to 1 step -1 do
     projID = v_projIDs[p]
     type = TypeOf(projID)
+    proj_found = 0
 
     // Add ""UpdatedWithP"" field
     if p = v_projIDs.length then do
@@ -96,6 +97,7 @@ Macro ""Roadway Project Management"" (MacroOpts)
       qry = qry + "" and UpdatedWithP = null""
       n = SelectByQuery(""updateLinks"", ""Several"", qry)
       if n > 0 then do
+        proj_found = 1
 
         // Loop over each field to update
         for f = 1 to attrList.length do
@@ -118,6 +120,13 @@ Macro ""Roadway Project Management"" (MacroOpts)
         SetDataVector(llyr + ""|updateLinks"", ""UpdatedWithP"", v_vec, )
       end
     end
+
+    if !proj_found then do
+      if type = ""string""
+        then errmsg = ""Project '"" + projID + ""' not found.""
+        else errmsg = ""Project '"" + String(projID) + ""' not found.""
+      Throw(errmsg)
+    end
   end
 
   // Delete links with -99 in any project-related attribute."
Triangle-Modeling-and-Analytics,TRMG2,402cf0e4a240fe35c43623bb10a024348ee11bad,Srini,srinsund@gmail.com,2022-06-16T21:26:01Z,Srini,srinsund@gmail.com,2022-06-16T21:26:01Z,Replace incorrect walk access coefficient in transit utilities,master/resident/mode/n_hb_ome_all.csv;master/resident/mode/n_hb_omed_all.csv,False,False,False,False,8,8,16,"---FILE: master/resident/mode/n_hb_ome_all.csv---
@@ -37,7 +37,7 @@ w_lb,Constant,v0,3.393,Zero-vehicle households
 w_lb,Constant,vi,3.393,Vehicle insufficient households
 w_lb,w_lb_skim.[In-Vehicle Time],,-0.046,IVTT and Fare (converted by VOT)
 w_lb,w_lb_skim.Fare,,-0.232,Fare
-w_lb,w_lb_skim.[Access Walk Time],,-0.1138,Access walk time
+w_lb,w_lb_skim.[Access Walk Time],,-0.1461,Access walk time
 w_lb,w_lb_skim.[Initial Wait Time],,-0.123,Initial wait time
 w_lb,w_lb_skim.[Egress Walk Time],,-0.1972,Egress walk time
 w_lb,w_lb_skim.[Number of Transfers] > 1,,-1.4619,High transfers
@@ -46,7 +46,7 @@ w_eb,Constant,v0,3.393,Zero-vehicle households
 w_eb,Constant,vi,3.393,Vehicle insufficient households
 w_eb,w_eb_skim.[In-Vehicle Time],,-0.046,IVTT and Fare (converted by VOT)
 w_eb,w_eb_skim.Fare,,-0.232,Fare
-w_eb,w_eb_skim.[Access Walk Time],,-0.1138,Access walk time
+w_eb,w_eb_skim.[Access Walk Time],,-0.1461,Access walk time
 w_eb,w_eb_skim.[Initial Wait Time],,-0.123,Initial wait time
 w_eb,w_eb_skim.[Egress Walk Time],,-0.1972,Egress walk time
 w_eb,w_eb_skim.[Number of Transfers] > 1,,-1.4619,High transfers
@@ -57,7 +57,7 @@ w_brt,Constant,vi,0.173,Path type constant = -.25 (visibility) * 15 (mins) * IVT
 w_brt,Constant,vs,0.259,Path type constant = -.25 (visibility) * 22.5 (mins) * IVTTcoef
 w_brt,w_brt_skim.[In-Vehicle Time] *.95,,-0.046,IVTT (discounted)
 w_brt,w_brt_skim.Fare,,-0.232,Fare
-w_brt,w_brt_skim.[Access Walk Time],,-0.1138,Access walk time
+w_brt,w_brt_skim.[Access Walk Time],,-0.1461,Access walk time
 w_brt,w_brt_skim.[Initial Wait Time],,-0.123,Initial wait time
 w_brt,w_brt_skim.[Egress Walk Time],,-0.1972,Egress walk time
 w_brt,w_brt_skim.[Number of Transfers] > 1,,-1.4619,High transfers
@@ -68,7 +68,7 @@ w_lr,Constant,vi,0.345,Path type constant = -.5 (visibility) * 15 (mins) * IVTTc
 w_lr,Constant,vs,0.518,Path type constant = -.5 (visibility) * 22.5 (mins) * IVTTcoef
 w_lr,w_lr_skim.[In-Vehicle Time] * .9,,-0.046,IVTT (discounted)
 w_lr,w_lr_skim.Fare,,-0.232,Fare
-w_lr,w_lr_skim.[Access Walk Time],,-0.1138,Access walk time
+w_lr,w_lr_skim.[Access Walk Time],,-0.1461,Access walk time
 w_lr,w_lr_skim.[Initial Wait Time],,-0.123,Initial wait time
 w_lr,w_lr_skim.[Egress Walk Time],,-0.1972,Egress walk time
 w_lr,w_lr_skim.[Number of Transfers] > 1,,-1.4619,High transfers

---FILE: master/resident/mode/n_hb_omed_all.csv---
@@ -35,7 +35,7 @@ w_lb,Constant,v0,3.789,Zero-vehicle households
 w_lb,Constant,vi,3.789,Vehicle insufficient households
 w_lb,w_lb_skim.[In-Vehicle Time],,-0.046,IVTT and Fare (converted by VOT)
 w_lb,w_lb_skim.Fare,,-0.232,Fare
-w_lb,w_lb_skim.[Access Walk Time],,-0.1138,Access walk time
+w_lb,w_lb_skim.[Access Walk Time],,-0.1461,Access walk time
 w_lb,w_lb_skim.[Initial Wait Time],,-0.123,Initial wait time
 w_lb,w_lb_skim.[Egress Walk Time],,-0.1972,Egress walk time
 w_lb,w_lb_skim.[Number of Transfers] > 1,,-1.4619,High transfers
@@ -44,7 +44,7 @@ w_eb,Constant,v0,3.789,Zero-vehicle households
 w_eb,Constant,vi,3.789,Vehicle insufficient households
 w_eb,w_eb_skim.[In-Vehicle Time],,-0.046,IVTT and Fare (converted by VOT)
 w_eb,w_eb_skim.Fare,,-0.232,Fare
-w_eb,w_eb_skim.[Access Walk Time],,-0.1138,Access walk time
+w_eb,w_eb_skim.[Access Walk Time],,-0.1461,Access walk time
 w_eb,w_eb_skim.[Initial Wait Time],,-0.123,Initial wait time
 w_eb,w_eb_skim.[Egress Walk Time],,-0.1972,Egress walk time
 w_eb,w_eb_skim.[Number of Transfers] > 1,,-1.4619,High transfers
@@ -55,7 +55,7 @@ w_brt,Constant,vi,0.173,Path type constant = -.25 (visibility) * 15 (mins) * IVT
 w_brt,Constant,vs,0.259,Path type constant = -.25 (visibility) * 22.5 (mins) * IVTTcoef
 w_brt,w_brt_skim.[In-Vehicle Time] *.95,,-0.046,IVTT (discounted)
 w_brt,w_brt_skim.Fare,,-0.232,Fare
-w_brt,w_brt_skim.[Access Walk Time],,-0.1138,Access walk time
+w_brt,w_brt_skim.[Access Walk Time],,-0.1461,Access walk time
 w_brt,w_brt_skim.[Initial Wait Time],,-0.123,Initial wait time
 w_brt,w_brt_skim.[Egress Walk Time],,-0.1972,Egress walk time
 w_brt,w_brt_skim.[Number of Transfers] > 1,,-1.4619,High transfers
@@ -66,7 +66,7 @@ w_lr,Constant,vi,0.345,Path type constant = -.5 (visibility) * 15 (mins) * IVTTc
 w_lr,Constant,vs,0.518,Path type constant = -.5 (visibility) * 22.5 (mins) * IVTTcoef
 w_lr,w_lr_skim.[In-Vehicle Time] * .9,,-0.046,IVTT (discounted)
 w_lr,w_lr_skim.Fare,,-0.232,Fare
-w_lr,w_lr_skim.[Access Walk Time],,-0.1138,Access walk time
+w_lr,w_lr_skim.[Access Walk Time],,-0.1461,Access walk time
 w_lr,w_lr_skim.[Initial Wait Time],,-0.123,Initial wait time
 w_lr,w_lr_skim.[Egress Walk Time],,-0.1972,Egress walk time
 w_lr,w_lr_skim.[Number of Transfers] > 1,,-1.4619,High transfers"
Triangle-Modeling-and-Analytics,TRMG2,1fd00cd8008a3447cc9e02702522a7aa682fec27,Kyle Ward,kyleward084@gmail.com,2022-06-15T18:56:59Z,Kyle Ward,kyleward084@gmail.com,2022-06-15T18:56:59Z,"Make minor corrections to 2020 se data

Nita sent an email outlining a few corrections.",master/sedata/se_2020.bin;src/02 - Network Calculations.rsc,False,False,False,False,1,1,2,"---FILE: src/02 - Network Calculations.rsc---
@@ -310,7 +310,7 @@ Macro ""Determine Area Type"" (Args)
             ""Service_RateHigh"",
             ""Retail""
         },
-        {OptArray: TRUE}
+        {OptArray: TRUE, ""Missing as Zero"": TRUE}
     )
     tot_emp = data.Industry + data.Office + data.Service_RateLow + 
         data.Service_RateHigh + data.Retail"
Triangle-Modeling-and-Analytics,TRMG2,f8bec504e419fff85f8c1a97305c9139b519b6b8,Kyle Ward,kyle@caliper.com,2022-05-12T15:31:41Z,Kyle Ward,kyle@caliper.com,2022-05-12T15:31:41Z,Make a few minor univ doc corrections,docs/data/output/university/Apply_Productions.RDS;docs/data/output/university/Summary_Productions.RDS;docs/site_libs/navigation-1.1/codefolding.js;docs/university.Rmd;docs/university.html,True,False,True,False,24,29,53,"---FILE: docs/site_libs/navigation-1.1/codefolding.js---
@@ -34,9 +34,7 @@ window.initializeCodeFolding = function(show) {
     showCodeButton.append(showCodeText);
     showCodeButton
         .attr('data-toggle', 'collapse')
-        .attr('data-bs-toggle', 'collapse') // BS5
         .attr('data-target', '#' + id)
-        .attr('data-bs-target', '#' + id)   // BS5
         .attr('aria-expanded', showThis)
         .attr('aria-controls', id);
 

---FILE: docs/university.Rmd---
@@ -93,7 +93,7 @@ Although the Triangle region is home to several large universities, the data ava
 
 Only NCSU had a travel survey in the region, therefore the development of the university sub-model relies solely on the 2014 survey of NCSU students conducted by ITRE on behalf of the NC Department of Transportation. Unfortunately, the NCSU survey only represented a 1% sample of student trips at NCSU.  
 
-It is important to consider that when using the NCSU dataset to represent all travel, that the available survey records amount to a 0.4% sample of all four universities(`r Respondents_Total`cleaned samples/`r prettyNum(enrollment_total, big.mark = "","")` students), thus making it difficult to assure student patterns are accurately represented at all four locations.
+It is important to consider that when using the NCSU dataset to represent all travel, that the available survey records amount to a 0.4% sample of all four universities(`r Respondents_Total` cleaned samples / `r prettyNum(enrollment_total, big.mark = "","")` students), thus making it difficult to assure student patterns are accurately represented at all four locations.
 
 However, since survey records exist for NCSU students only in the dataset, it was assumed that the travel behavior of students attending NCSU is sufficiently representative of NCCU, Duke, and UNC students.^[It is recognized that each university has a unique setting, mode choice and other differences but given data availability NCSU data had to be assumed as transferable.]
 
@@ -314,7 +314,7 @@ The second step of the University Model development process is to develop a trip
 
 A distance-based gravity model is used to distribute the university trips from production zones to attraction zones. The specification of a gravity model is shown below: 
 
-T_ij = (P_i  A_j) / F_ij 
+$T_{ij} = (P_i  A_j) / F_{ij} $
 
 where T_ij denote the trips from production zone i to attraction zone j, P represents the trip productions, A represents the trip attractions, F is a measure of the separation between the production and attraction zones called a friction factor.
 
@@ -323,10 +323,12 @@ Following standard practice, it was assumed that the friction factors are a func
 F(d) =   d^(-)  e^(-d)
 
 ```{r}
-df <- tibble(Purpose = c(""Home-Campus - Off-campus students"",""Home-Other- Off-campus students"",""All other""),
-             a = c(5,0.8,0.1), 
-             b = c(5,0.9,0.1), 
-             c = c(5,1.15,0.1))
+df <- tibble(
+  Purpose = c(""Home-Campus - Off-campus students"",""Home-Other- Off-campus students"",""All other""),
+  a = c(5, 5, 5),
+  b = c(.8, .9, 1.15),
+  c = c(.1, .1, .1)
+)
 
 df  %>%
   kable(digits = 1) %>%

---FILE: docs/university.html---
@@ -15,7 +15,6 @@
 
 <title>University</title>
 
-<script src=""site_libs/header-attrs-2.13/header-attrs.js""></script>
 <script src=""site_libs/jquery-3.6.0/jquery-3.6.0.min.js""></script>
 <meta name=""viewport"" content=""width=device-width, initial-scale=1"" />
 <link href=""site_libs/bootstrap-3.3.5/css/flatly.min.css"" rel=""stylesheet"" />
@@ -35,6 +34,7 @@
 <link href=""site_libs/tocify-1.9.1/jquery.tocify.css"" rel=""stylesheet"" />
 <script src=""site_libs/tocify-1.9.1/jquery.tocify.js""></script>
 <script src=""site_libs/navigation-1.1/tabsets.js""></script>
+<script src=""site_libs/accessible-code-block-0.0.1/empty-anchor.js""></script>
 <script src=""site_libs/kePrint-0.0.1/kePrint.js""></script>
 <link href=""site_libs/lightable-0.0.1/lightable.css"" rel=""stylesheet"" />
 
@@ -45,9 +45,7 @@
   div.column{display: inline-block; vertical-align: top; width: 50%;}
   div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
   ul.task-list{list-style: none;}
-      .display.math{display: block; text-align: center; margin: 0.5rem auto;}
-  </style>
-
+    </style>
 
 
 
@@ -79,9 +77,6 @@
 summary {
   display: list-item;
 }
-details > summary > p:only-child {
-  display: inline;
-}
 pre code {
   padding: 0;
 }
@@ -306,7 +301,7 @@
 <div class=""navbar navbar-default  navbar-fixed-top"" role=""navigation"">
   <div class=""container"">
     <div class=""navbar-header"">
-      <button type=""button"" class=""navbar-toggle collapsed"" data-toggle=""collapse"" data-bs-toggle=""collapse"" data-target=""#navbar"" data-bs-target=""#navbar"">
+      <button type=""button"" class=""navbar-toggle collapsed"" data-toggle=""collapse"" data-target=""#navbar"">
         <span class=""icon-bar""></span>
         <span class=""icon-bar""></span>
         <span class=""icon-bar""></span>
@@ -316,7 +311,7 @@
     <div id=""navbar"" class=""navbar-collapse collapse"">
       <ul class=""nav navbar-nav"">
         <li class=""dropdown"">
-  <a href=""#"" class=""dropdown-toggle"" data-toggle=""dropdown"" role=""button"" data-bs-toggle=""dropdown"" aria-expanded=""false"">
+  <a href=""#"" class=""dropdown-toggle"" data-toggle=""dropdown"" role=""button"" aria-expanded=""false"">
     Databases
      
     <span class=""caret""></span>
@@ -331,7 +326,7 @@
   </ul>
 </li>
 <li class=""dropdown"">
-  <a href=""#"" class=""dropdown-toggle"" data-toggle=""dropdown"" role=""button"" data-bs-toggle=""dropdown"" aria-expanded=""false"">
+  <a href=""#"" class=""dropdown-toggle"" data-toggle=""dropdown"" role=""button"" aria-expanded=""false"">
     Surveys
      
     <span class=""caret""></span>
@@ -346,7 +341,7 @@
   </ul>
 </li>
 <li class=""dropdown"">
-  <a href=""#"" class=""dropdown-toggle"" data-toggle=""dropdown"" role=""button"" data-bs-toggle=""dropdown"" aria-expanded=""false"">
+  <a href=""#"" class=""dropdown-toggle"" data-toggle=""dropdown"" role=""button"" aria-expanded=""false"">
     Resident Models
      
     <span class=""caret""></span>
@@ -379,7 +374,7 @@
   </ul>
 </li>
 <li class=""dropdown"">
-  <a href=""#"" class=""dropdown-toggle"" data-toggle=""dropdown"" role=""button"" data-bs-toggle=""dropdown"" aria-expanded=""false"">
+  <a href=""#"" class=""dropdown-toggle"" data-toggle=""dropdown"" role=""button"" aria-expanded=""false"">
     Other Models
      
     <span class=""caret""></span>
@@ -435,7 +430,7 @@ <h2>Introduction</h2>
 <h2>University Model Sources</h2>
 <p>Although the Triangle region is home to several large universities, the data availability for university travel at each campus is limited. in 2016, these four universities had a combined enrollment of 84,481, with 31,025 students at NCSU; 29,437 at UNC; 15,904 at Duke; and 8,115 at NCCU.</p>
 <p>Only NCSU had a travel survey in the region, therefore the development of the university sub-model relies solely on the 2014 survey of NCSU students conducted by ITRE on behalf of the NC Department of Transportation. Unfortunately, the NCSU survey only represented a 1% sample of student trips at NCSU.</p>
-<p>It is important to consider that when using the NCSU dataset to represent all travel, that the available survey records amount to a 0.4% sample of all four universities(336cleaned samples/84,481 students), thus making it difficult to assure student patterns are accurately represented at all four locations.</p>
+<p>It is important to consider that when using the NCSU dataset to represent all travel, that the available survey records amount to a 0.4% sample of all four universities(336 cleaned samples / 84,481 students), thus making it difficult to assure student patterns are accurately represented at all four locations.</p>
 <p>However, since survey records exist for NCSU students only in the dataset, it was assumed that the travel behavior of students attending NCSU is sufficiently representative of NCCU, Duke, and UNC students.<a href=""#fn1"" class=""footnote-ref"" id=""fnref1""><sup>1</sup></a></p>
 <div id=""ncsu-student-travel-survey"" class=""section level3"">
 <h3>NCSU Student Travel Survey</h3>
@@ -1410,7 +1405,7 @@ <h5>Home-Other Trip Attractions, Off-Campus students</h5>
 <h2>Trip Distribution</h2>
 <p>The second step of the University Model development process is to develop a trip distribution model. In this step, the TAZ level productions and attractions estimated in the trip generation step are allocated to TAZ pairs. The allocation is based on a gravity model that takes into account the distance between each of the TAZ pairs.</p>
 <p>A distance-based gravity model is used to distribute the university trips from production zones to attraction zones. The specification of a gravity model is shown below:</p>
-<p>T_ij = (P_i  A_j) / F_ij</p>
+<p>$T_{ij} = (P_i  A_j) / F_{ij} $</p>
 <p>where T_ij denote the trips from production zone i to attraction zone j, P represents the trip productions, A represents the trip attractions, F is a measure of the separation between the production and attraction zones called a friction factor.</p>
 <p>Following standard practice, it was assumed that the friction factors are a function of highway travel distance and that they follow a gamma distribution, as below:</p>
 <p>F(d) =   d^(-)  e^(-d)</p>
@@ -1437,38 +1432,38 @@ <h2>Trip Distribution</h2>
 Home-Campus - Off-campus students
 </td>
 <td style=""text-align:right;"">
-5.0
+5
 </td>
 <td style=""text-align:right;"">
-5.0
+0.8
 </td>
 <td style=""text-align:right;"">
-5.0
+0.1
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 Home-Other- Off-campus students
 </td>
 <td style=""text-align:right;"">
-0.8
+5
 </td>
 <td style=""text-align:right;"">
 0.9
 </td>
 <td style=""text-align:right;"">
-1.1
+0.1
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 All other
 </td>
 <td style=""text-align:right;"">
-0.1
+5
 </td>
 <td style=""text-align:right;"">
-0.1
+1.1
 </td>
 <td style=""text-align:right;"">
 0.1"
Triangle-Modeling-and-Analytics,TRMG2,60d31c6c9b4e90202badca5b7a514d83440e39ed,Srini,71148365+ssrini79@users.noreply.github.com,2022-04-13T18:12:02Z,Srini,71148365+ssrini79@users.noreply.github.com,2022-04-13T18:12:02Z,"Update screen line 3

There was some double counting and other issues with the screen line definition.",master/networks/master_links.BIN,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,b9e5fb68104efe530c772f2023a9db40ca8eb18d,Srini,71148365+ssrini79@users.noreply.github.com,2022-03-30T12:09:59Z,Srini,71148365+ssrini79@users.noreply.github.com,2022-03-30T12:09:59Z,Correct bug in summaries,src/19 - Summaries.rsc,False,False,False,False,1,0,1,"---FILE: src/19 - Summaries.rsc---
@@ -304,6 +304,7 @@ Macro ""Count PRMSEs"" (Args)
   // Rename screenline to cutline
   in_file = opts.out_dir + ""/count_comparison_by_screenline.csv""
   out_file = opts.out_dir + ""/count_comparison_by_cutline.csv""
+  if GetFileInfo(out_file) <> null then DeleteFile(out_file)
   RenameFile(in_file, out_file)
 
   // Run it again to generate the screenline table"
Triangle-Modeling-and-Analytics,TRMG2,bf44cd8965f5cb2dc0cbab2c621cd7c0c4069334,Srini,71148365+ssrini79@users.noreply.github.com,2022-03-16T03:43:39Z,Srini,71148365+ssrini79@users.noreply.github.com,2022-03-16T03:43:39Z,Make further count corrections and link adjustments,master/networks/master_links.BIN;master/networks/master_links.BX;master/networks/master_links.dln;master/networks/master_links.kln;master/networks/master_links.pts;master/networks/master_routes.rts,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,68997bd5cce7f4a2edc06655540e12a8edc9de73,Srini,71148365+ssrini79@users.noreply.github.com,2022-03-15T19:49:45Z,Srini,71148365+ssrini79@users.noreply.github.com,2022-03-15T19:49:45Z,Correct route error,master/networks/master_routes.rtg;master/networks/master_routesS.BX;master/networks/master_routesS.bin;master/networks/master_routesS.grp;master/networks/master_routesS.lok;master/networks/master_routesS.pnk;master/networks/master_routesS.r0,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,c9d3c135ff3ef24bb600d285cf40fadc3b923dec,Srini,71148365+ssrini79@users.noreply.github.com,2022-03-15T18:31:56Z,Srini,71148365+ssrini79@users.noreply.github.com,2022-03-15T18:31:56Z,Make changes and corrections for validation,master/networks/master_links.BIN;master/networks/master_links.BX;master/networks/master_links.dln;master/networks/master_links.kln;master/networks/master_links.pts;master/networks/master_links_.BIN;master/networks/master_links_.BX;master/networks/master_routes.rtg;master/networks/master_routes.rts;master/networks/master_routesL.BX;master/networks/master_routesL.bin;master/networks/master_routesR.BX;master/networks/master_routesR.bin;master/networks/master_routesS.lok;master/networks/master_routesS.r0;master/sedata/se_2020.bin,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,fe8dbd1bfdac713207a8dbd130d813ece6663261,Srini,71148365+ssrini79@users.noreply.github.com,2022-03-11T20:24:59Z,Srini,71148365+ssrini79@users.noreply.github.com,2022-03-11T20:24:59Z,"Update 2020 external station AWDT

Updated the external station AWDT to reflect corrections to the count data.",master/networks/master_links.BIN;master/sedata/se_2020.bin,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,e649c87a2657ef1a069f0ccd05d38e6e330b0455,Srini,71148365+ssrini79@users.noreply.github.com,2022-03-04T15:53:23Z,Srini,71148365+ssrini79@users.noreply.github.com,2022-03-04T15:53:23Z,"Correct Fixed OD tool

Updated macro to the new name",src/utils/FixedODAssignment.rsc,False,False,False,False,1,1,2,"---FILE: src/utils/FixedODAssignment.rsc---
@@ -89,7 +89,7 @@ Macro ""Fixed OD Assignment"" (MacroOpts)
     RunMacro(""Count PRMSEs"", Args)
     RunMacro(""VOC Maps"", Args)
     RunMacro(""Speed Maps"", Args)
-    RunMacro(""Summarize by FT and AT"", Args)
+    RunMacro(""Summarize Links"", Args)
 endmacro
 
 /*"
Triangle-Modeling-and-Analytics,TRMG2,ed5f6762252e2d3949a46764e076c4b7ffe093dd,Srini,71148365+ssrini79@users.noreply.github.com,2022-03-01T03:36:19Z,Srini,71148365+ssrini79@users.noreply.github.com,2022-03-01T03:38:15Z,"Correct NHB TOD factor lookup

Also included an error trap in case the lookup factor is ever null in the future.",src/14 - NHB Models.rsc,False,False,False,False,2,1,3,"---FILE: src/14 - NHB Models.rsc---
@@ -138,7 +138,8 @@ Macro ""NHB Generation"" (Args)
                 end
 
                 // Apply TOD factors
-                tod_fac = tod_facs.(field_name)
+                tod_fac = tod_facs.(tour_type + ""_"" + mode + ""_"" + period)
+                if tod_fac = null then Throw(""NHB TOD factor not found"")
                 data.(field_name) = data.(field_name) * tod_fac
 
                 // Sum up data by tour type and mode"
Triangle-Modeling-and-Analytics,TRMG2,73349d34081f6a549a4a4027ec926499a6b4cc9d,Vince Bernardin,vince@caliper.com,2022-02-24T20:13:33Z,Vince Bernardin,vince@caliper.com,2022-02-24T20:13:33Z,Fix typo for random seed,src/04 - PopulationSynthesis.rsc,False,False,False,False,1,1,2,"---FILE: src/04 - PopulationSynthesis.rsc---
@@ -441,7 +441,7 @@ Macro ""Calculate Auto Ownership"" (Args, trip_types)
     obj.AddUtility({UtilityFunction: util})
     obj.AddPrimarySpec(primary_spec)
     obj.AddOutputSpec({ChoicesField: ""Autos""})
-    ojb.RandomSeed = 314159
+    obj.RandomSeed = 314159
     obj.Evaluate()
 
     // Convert coded field/string pairs to simple integers"
Triangle-Modeling-and-Analytics,TRMG2,7d5774a81e6f918b00da4b2a25d3180124679ec8,Srini,71148365+ssrini79@users.noreply.github.com,2022-02-16T04:49:11Z,Srini,71148365+ssrini79@users.noreply.github.com,2022-02-16T04:49:11Z,Fix issue with deleted file during assignment,src/17 - Roadway Assignment.rsc,False,False,False,False,6,2,8,"---FILE: src/17 - Roadway Assignment.rsc---
@@ -150,8 +150,12 @@ Macro ""Run Roadway Assignment"" (Args, OtherOpts)
             Time: ""MSATime"",
             Iteration: feedback_iter
         })
-        o.FlowTable = assn_dir + ""\\roadway_assignment_"" + period + "".bin""
-        if OtherOpts.flow_table <> null then o.FlowTable = OtherOpts.flow_table
+
+        if OtherOpts.flow_table <> null then 
+            o.FlowTable = OtherOpts.flow_table
+        else
+            o.FlowTable = assn_dir + ""\\roadway_assignment_"" + period + "".bin""   
+        
         // Add classes for each combination of vehicle type and VOT
         // If doing a test assignment, just create a single class from the
         // dummy matrix"
Triangle-Modeling-and-Analytics,TRMG2,71f444cc46911685a3136885ec10dbd05e05a2f9,Kyle Ward,kyleward084@gmail.com,2022-02-10T21:21:06Z,Kyle Ward,kyleward084@gmail.com,2022-02-10T21:21:06Z,Fix iz times,master/networks/init_iz_time.DCB;master/networks/init_iz_time.bin;src/10 - Skimming.rsc,False,False,False,False,18,1,19,"---FILE: master/networks/init_iz_time.DCB---
@@ -0,0 +1,7 @@
+
+20
+""TAZ"",I,1,4,0,12,0,,"""","""",,""Sum"",
+""AM"",F,5,4,0,8,2,,"""","""",,""Sum"",
+""MD"",F,9,4,0,8,2,,"""","""",,""Sum"",
+""PM"",F,13,4,0,8,2,,"""","""",,""Sum"",
+""NT"",F,17,4,0,8,2,,"""","""",,""Sum"",

---FILE: src/10 - Skimming.rsc---
@@ -70,7 +70,15 @@ Macro ""Create Roadway Skims"" (Args, OtherOpts)
     if OtherOpts.period <> null then periods = {OtherOpts.period}
     if OtherOpts.mode <> null then modes = {OtherOpts.mode}
 
+    // Open the initial IZ time file
+    iz_time_file = Args.[Input Folder] + ""/networks/init_iz_time.bin""
+    iz_vw = OpenTable(""iz"", ""FFB"", {iz_time_file})
+    iz_data = GetDataVectors(iz_vw + ""|"", periods, {{""Sort Order"",{{""TAZ"",""Ascending""}}}, {""OptArray"", ""true""}})
+    CloseView(iz_vw)
+
     for period in periods do
+        v_iz = iz_data.(period)
+
         for mode in modes do
             obj = CreateObject(""Network.Skims"")
             obj.Network = net_dir + ""/net_"" + period + ""_"" + mode + "".net""
@@ -97,10 +105,12 @@ Macro ""Create Roadway Skims"" (Args, OtherOpts)
             obj.Neighbours = 3
             obj.Factor = .75
             m = CreateObject(""Matrix"", out_file)
-            for core in m.CoreNames do
+            corenames = m.GetCoreNames()
+            for core in corenames do
                 obj.SetMatrix({MatrixFile: out_file, Matrix: core})
                 ok = obj.Run()
             end
+            m.SetVector({Core: corenames[1], Vector: v_iz, Diagonal: ""true""})
 
             // Auto pay fare
             m.AddCores({""auto_pay_fare""})"
Triangle-Modeling-and-Analytics,TRMG2,c57ae6a7b0fefd70872a6aa04d23090cc9a0270d,Kyle Ward,kyle@caliper.com,2022-02-08T16:09:10Z,Kyle Ward,kyle@caliper.com,2022-02-08T16:09:10Z,"Remove Args.fixed_od

With the change to the fixed od code, we no longer need
this special flag.",src/02 - Network Calculations.rsc;src/utils/FixedODAssignment.rsc,False,False,False,False,0,8,8,"---FILE: src/02 - Network Calculations.rsc---
@@ -913,11 +913,6 @@ endmacro
 
 Macro ""Create Route Networks"" (Args)
 
-    // Initial processing is called by the main model, but also by the Fixed
-    // OD assignment tool. When doing fixed highway assignment, skip this step
-    // to save time.
-    if Args.fixed_od then return()
-
     link_dbd = Args.Links
     rts_file = Args.Routes
     output_dir = Args.[Output Folder] + ""/networks""

---FILE: src/utils/FixedODAssignment.rsc---
@@ -69,9 +69,6 @@ Macro ""Fixed OD Assignment"" (MacroOpts)
 
     mr = CreateObject(""Model.Runtime"")
     Args = mr.GetValues()
-    // This flag is used to modify certain steps of the model.
-    // For example, 
-    Args.fixed_od = ""true"" // lets us skip transit net creation
     ret = mr.RunStep(""Create Initial Output Files"", {Silent: ""true""})
     if !ret then Throw(""Fixed OD: 'Create Initial Output Files' failed"")
     ret = mr.RunStep(""Network Calculators"", {Silent: ""true""})"
Triangle-Modeling-and-Analytics,TRMG2,11ba0a503277fe48afe2f5c11cd9d5c120354562,Srini,71148365+ssrini79@users.noreply.github.com,2022-02-08T02:07:49Z,Srini,71148365+ssrini79@users.noreply.github.com,2022-02-08T02:07:49Z,"Correct 0 HH zones

A few zones had rounded down to 0 households. Fixed.",master/sedata/se_2020.bin,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,354a6c2dc3ae7c8bf6bf28f5a159695e0d77f8b9,Vince Bernardin,vince@caliper.com,2022-02-07T16:48:05Z,Vince Bernardin,vince@caliper.com,2022-02-07T16:48:05Z,Fix AO random seed,src/04 - PopulationSynthesis.rsc,False,False,False,False,1,0,1,"---FILE: src/04 - PopulationSynthesis.rsc---
@@ -441,6 +441,7 @@ Macro ""Calculate Auto Ownership"" (Args, trip_types)
     obj.AddUtility({UtilityFunction: util})
     obj.AddPrimarySpec(primary_spec)
     obj.AddOutputSpec({ChoicesField: ""Autos""})
+    ojb.RandomSeed = 314159
     obj.Evaluate()
 
     // Convert coded field/string pairs to simple integers"
Triangle-Modeling-and-Analytics,TRMG2,9cadca818d52beed45ddcad2dd375a3c74c0f008,Srini,71148365+ssrini79@users.noreply.github.com,2022-02-07T16:37:04Z,Srini,71148365+ssrini79@users.noreply.github.com,2022-02-07T16:37:04Z,"Fix all route connectivity issues

Ran the 'Verify' tool and corrected all disconnected routes.",master/networks/master_routes.rtg;master/networks/master_routesL.BX;master/networks/master_routesL.bin;master/networks/master_routesR.BX;master/networks/master_routesS.r0,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,abf6d0e1a8f7417d63ae891c93191d96e5d096ca,Srini,71148365+ssrini79@users.noreply.github.com,2022-02-07T16:11:57Z,Srini,71148365+ssrini79@users.noreply.github.com,2022-02-07T16:11:57Z,"Make further corrections to links and routes

Route work included adding shapepoints to improve 2020 scenario route alignment. Also fixed some gaps.",master/networks/master_links.BIN;master/networks/master_routes.rtg;master/networks/master_routes.rts;master/networks/master_routesL.BX;master/networks/master_routesL.bin;master/networks/master_routesS.BX;master/networks/master_routesS.bin;master/networks/master_routesS.grp;master/networks/master_routesS.lok;master/networks/master_routesS.pnk;master/networks/master_routesS.r0,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,57a686652bcba46e19f9dbbce158aeab0bc6aa97,Srini,71148365+ssrini79@users.noreply.github.com,2022-02-07T15:10:46Z,Srini,71148365+ssrini79@users.noreply.github.com,2022-02-07T15:10:46Z,Additional corrections to 2020 links,master/networks/master_links.BIN;master/networks/master_links.dln,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,53213fa4585445f562ba48eec433b9646385c8dc,Srini,71148365+ssrini79@users.noreply.github.com,2022-02-07T00:51:22Z,Srini,71148365+ssrini79@users.noreply.github.com,2022-02-07T00:51:22Z,"Make minor correction to scenario creation

Also include bxl files to remove from the se folder",src/01 - CreateScenario.rsc,False,False,False,False,1,1,2,"---FILE: src/01 - CreateScenario.rsc---
@@ -136,7 +136,7 @@ Macro ""Create Scenario SE"" (Args)
 
   // Remove any bin or dcb files in the directory
   dir = Args.[Input Folder] + ""/sedata""
-  a_dbds = RunMacro(""Catalog Files"", {dir: dir, ext: {""bin"", ""dcb""}})
+  a_dbds = RunMacro(""Catalog Files"", {dir: dir, ext: {""bin"", ""dcb"", ""bxl""}})
   for i = 1 to a_dbds.length do
     DeleteFile(a_dbds[i])
   end"
Triangle-Modeling-and-Analytics,TRMG2,ff574fc1d3cb9719cc3703a364231981df9e2804,Srini,71148365+ssrini79@users.noreply.github.com,2022-01-31T00:29:12Z,Srini,71148365+ssrini79@users.noreply.github.com,2022-01-31T00:29:12Z,"Make facility type corrections

(Made by Kyle on Olcha)
Some overloaded facilities had facility types that were too high.",master/networks/ff_speed_alpha_beta.csv;master/networks/master_links.BIN,False,False,False,False,2,2,4,"---FILE: master/networks/ff_speed_alpha_beta.csv---
@@ -32,8 +32,8 @@ Collector,Urban,-3,1.75,3,
 Collector,Suburban,-2,1.75,3,
 Collector,Rural,-2,1.75,3,
 Local,Downtown,-3,2,3,
-Local,Urban,-3,2,3,
-Local,Suburban,-2,2,3,
+Local,Urban,-2,2,3,
+Local,Suburban,-1,2,3,
 Local,Rural,-4,4,3,
 CC,Downtown,0,0.15,4,""CC speed set separately. See the """"CCSpeeds"""" parameter in the flow chart.""
 CC,Urban,0,0.15,4,"
Triangle-Modeling-and-Analytics,TRMG2,6c3d5c7279ffb0e727d528700de2856ed9349beb,Kyle Ward,kyleward084@gmail.com,2022-01-30T02:23:10Z,Kyle Ward,kyleward084@gmail.com,2022-01-30T02:23:10Z,Additional highway speed corrections,master/networks/master_links.BIN,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,df2c67e8793cc4ca7070896808a1754a02ea57fc,Kyle Ward,kyleward084@gmail.com,2022-01-21T02:27:02Z,Kyle Ward,kyleward084@gmail.com,2022-01-21T02:27:02Z,"Update the Fixed OD Assignment tool

Closes #125",src/utils/FixedODAssignment.rsc,False,False,False,False,4,2,6,"---FILE: src/utils/FixedODAssignment.rsc---
@@ -72,8 +72,10 @@ Macro ""Fixed OD Assignment"" (MacroOpts)
     // This flag is used to modify certain steps of the model.
     // For example, 
     Args.fixed_od = ""true"" // lets us skip transit net creation
-    ret = mr.RunStep(""Network Calculations"", {Silent: ""true""})
-    if !ret then return()
+    ret = mr.RunStep(""Create Initial Output Files"", {Silent: ""true""})
+    if !ret then Throw(""Fixed OD: 'Create Initial Output Files' failed"")
+    ret = mr.RunStep(""Network Calculators"", {Silent: ""true""})
+    if !ret then Throw(""Fixed OD: 'Network Calculators' failed"")
     RunMacro(""Copy Files for Fixed OD"", Args, full_scen_dir)
 
     // Run assignments"
Triangle-Modeling-and-Analytics,TRMG2,bcf02c2f10408ee73667841ca14f55f7f2c45ab9,Srini,srinsund@gmail.com,2022-01-20T19:05:10Z,Srini,srinsund@gmail.com,2022-01-20T19:05:10Z,Fix error in transit network settings,src/02 - Network Calculations.rsc,False,False,False,False,3,3,6,"---FILE: src/02 - Network Calculations.rsc---
@@ -992,9 +992,9 @@ Macro ""Create Route Networks"" (Args)
                 o.CentroidFilter = ""Centroid = 1""
                 // o.LinkImpedance = ""IVTT""
                 o.Parameters({
-                    MaxTripCost = 240,
-                    MaxTransfers = 2,
-                    VOT = .1984 // $/min (40% of the median wage)
+                    MaxTripCost : 240,
+                    MaxTransfers : 2,
+                    VOT : 0.1984 // $/min (40% of the median wage)
                 })
                 o.AccessControl({
                     PermitWalkOnly: false,"
Triangle-Modeling-and-Analytics,TRMG2,09a400c7256b7fb3866a7ce7607519512af5cf96,Srini,srinsund@gmail.com,2022-01-19T15:22:27Z,Srini,srinsund@gmail.com,2022-01-19T15:22:27Z,Fix error in update networks by making an exception to the PMPK network,src/10 - Skimming.rsc,False,False,False,False,1,1,2,"---FILE: src/10 - Skimming.rsc---
@@ -26,7 +26,7 @@ Macro ""Update Link Networks"" (Args)
     for file in files do
         {, , name, } = SplitPath(file)
         {, period, mode} = ParseString(name, ""_"")
-        if period = ""bike"" or period = ""walk"" then continue
+        if Lower(period) = ""bike"" or Lower(period) = ""walk"" or Lower(period) = ""pmpk"" then continue
 
         obj = CreateObject(""Network.Update"")
         obj.LayerDB = hwy_dbd"
Triangle-Modeling-and-Analytics,TRMG2,d29336e726f05e53c0a643a2ff4aa71ecf0f525e,Srini,srinsund@gmail.com,2022-01-19T15:20:31Z,Srini,srinsund@gmail.com,2022-01-19T15:20:31Z,Fix errors in 'Create Assigment Matrices' wrt to handling sov cores.,src/16 - Create Assignment Matrices.rsc,False,False,False,False,5,2,7,"---FILE: src/16 - Create Assignment Matrices.rsc---
@@ -103,7 +103,7 @@ Macro ""Add Airport Trips"" (Args)
         rh = GetFirstRecord(fac_vw + ""|"", )
         while rh <> null do
             trip_type2 = fac_vw.trip_type
-            if trip_type2 <> trip_type then continue
+            if trip_type2 <> trip_type then goto next_record
             sov_fac = fac_vw.sov
             hov2_fac = fac_vw.hov2
             hov3_fac = fac_vw.hov3
@@ -117,6 +117,8 @@ Macro ""Add Airport Trips"" (Args)
                 cores.hov3 := cores.hov3 + nz(cores.(core_to_collapse)) * hov3_fac
             end
             air_mtx.DropCores({""auto_pay"", ""other_auto""})
+        
+        next_record: 
             rh = GetNextRecord(fac_vw + ""|"", rh, )
         end
         CloseView(fac_vw)
@@ -164,7 +166,8 @@ Macro ""HB Collapse Auto Modes"" (Args)
             mtx = CreateObject(""Matrix"", trip_mtx_file)
             cores = mtx.GetCores()
             for core_to_collapse in cores_to_collapse do
-                cores.sov := cores.sov + nz(cores.(core_to_collapse)) * sov_fac
+                if cores.sov <> null then
+                    cores.sov := cores.sov + nz(cores.(core_to_collapse)) * sov_fac
                 cores.hov2 := cores.hov2 + nz(cores.(core_to_collapse)) * hov2_fac
                 cores.hov3 := cores.hov3 + nz(cores.(core_to_collapse)) * hov3_fac
             end"
Triangle-Modeling-and-Analytics,TRMG2,195c6e7978e3dc2004188e4514d1363e5f3a4350,Srini,srinsund@gmail.com,2022-01-05T19:17:13Z,Srini,srinsund@gmail.com,2022-01-05T19:17:13Z,Fix error in shadow price code and upload revised shadow prices,master/resident/dc/shadow_prices.bin;src/13 - Destination Choice.rsc,False,False,False,False,2,2,4,"---FILE: src/13 - Destination Choice.rsc---
@@ -291,8 +291,8 @@ Macro ""Update Shadow Price"" (Args)
             
             v_prods = nz(GetDataVector(se_vw + ""|"", name, ))
             v_prods.rowbased = ""false""
-            cores.Total := cores.Total * v_prods
-            v_trips = out_mtx.GetVector({""Core"": ""Total"", Marginal: ""Column Sum""})
+            cores.final_prob := cores.final_prob * v_prods
+            v_trips = out_mtx.GetVector({""Core"": ""final_prob"", Marginal: ""Column Sum""})
             v_total_trips = nz(v_total_trips) + v_trips
 
             out_mtx = null"
Triangle-Modeling-and-Analytics,TRMG2,773f9c30a9e2e4b00a493ab55256dd5ab98680b0,CALIPER\srini,srinsund@gmail.com,2022-01-03T19:35:56Z,CALIPER\srini,srinsund@gmail.com,2022-01-03T19:35:56Z,Fix utility scaling method in the mode choice calibration code.,src/utils/Calibrators.rsc,False,False,False,False,2,2,4,"---FILE: src/utils/Calibrators.rsc---
@@ -84,7 +84,6 @@ endmacro
 */
 Macro ""Calibrate HB MC""(Args)
     trip_types = RunMacro(""Get HB Trip Types"", Args)
-    //trip_types = {""n_hb_omed_all""}
     //pbar1 = CreateObject(""G30 Progress Bar"", ""Calibrating MC models for each trip type ..."", true, trip_types.length)
     for trip_type in trip_types do
         if Lower(trip_type) = ""w_hb_ek12_all"" then
@@ -146,6 +145,7 @@ Macro ""Calibrate MC""(Args, Opts)
 
         // Compute Shares
         shares = RunMacro(""Get Mode Shares"", Args, Opts, altNames)
+        //return(1)
 
         // Check convergence
         converged = RunMacro(""ASC Adjustment Convergence"", shares, targets, thresholds)
@@ -338,9 +338,9 @@ Macro ""MC Eval for Calibration""(Args, Opts)
             if ArrayPosition(modelSources, {src[1]},) > 0 then
                 o.OpenMatrixSource({SourceName: src[1], FileName: src[2]})
         end
-        o.UtilityScaling = ""By Theta Product""
         probMtx = mc_dir + ""/probabilities/probability_"" + tag + "".mtx""
         o.AddMatrixOutput( ""*"",  {Probability: probMtx})
+        o.UtilityScaling = ""By Parent Theta""
         ok = o.Run()
         o = null
     end"
Triangle-Modeling-and-Analytics,TRMG2,baae58bb60c78a6e5b69fe14cc8b3677adb62ec5,Kyle Ward,kyleward084@gmail.com,2021-12-29T18:02:18Z,Kyle Ward,kyleward084@gmail.com,2021-12-29T18:02:18Z,Make a few minor corrections,src/External Models.rsc;src/University.rsc,False,False,False,False,3,3,6,"---FILE: src/External Models.rsc---
@@ -165,8 +165,8 @@ Macro ""IPF EE Seed Table"" (Args)
 								""se.EE_CV_MUT_MARG_AM"", ""se.EE_CV_MUT_MARG_MD"", ""se.EE_CV_MUT_MARG_PM"", ""se.EE_CV_MUT_MARG_NT""}
   Opts.Output.[Output Matrix].Label = ""EE Trips Matrix""
   Opts.Output.[Output Matrix].[File Name] = ee_mtx_file
+  RunMacro(""TCB Init"")
   ok = RunMacro(""TCB Run Procedure"", ""Growth Factor"", Opts, &Ret)
-  
   if !ok then Throw(""EE IPF failed"")
   
   // Check each core for errors not captured automatically by TC

---FILE: src/University.rsc---
@@ -545,7 +545,7 @@ Generate University Other to Other Trips by mode based on UHO and UCO.
 Macro ""University Other to Other"" (Args)
     trips_dir = Args.[Output Folder] + ""\\university\\""
     dir_factor_file = Args.[Input Folder] + ""\\university\\university_directionality.csv""
-    trip_rate_factor_file = Args.[Input Folder] + ""\\university\\university_trip_rates_others.csv""
+    trip_rate_factor_file = Args.[Input Folder] + ""\\university\\university_trip_rates_other.csv""
     se_file = Args.SE
     periods = Args.periods
 
@@ -685,7 +685,7 @@ Macro ""University Other to Other"" (Args)
             Opts.Field.[A Core Fields] = Opts.Field.[A Core Fields] + {""se.UOO_MARG_"" + core + ""_"" + period}
         end
         Opts.Output.[Output Matrix].[File Name] = out_mtx_file
-
+        RunMacro(""TCB Init"")
         ok = RunMacro(""TCB Run Procedure"", ""Growth Factor"", Opts, &Ret)
         if !ok then Throw(""Other to Other IPF failed"")
 "
Triangle-Modeling-and-Analytics,TRMG2,4ce7a54c521a3b74cb8ce075c20ddd941d0074e5,Kyle Ward,kyle@caliper.com,2021-12-17T16:36:50Z,Kyle Ward,kyle@caliper.com,2021-12-17T16:36:50Z,Typo correction,docs/resident_production.Rmd,True,False,True,False,1,1,2,"---FILE: docs/resident_production.Rmd---
@@ -1136,7 +1136,7 @@ R-squared: `r r_sq`
 
 Calibrating the production rates is done to ensure that the final model is
 producing the same number of trips per person on average as the survey. One
-compicating factor in this comparison is that the survey and model
+complicating factor in this comparison is that the survey and model
 socio-economic data have different total populations.
 
 - Survey: 1.71 million"
Triangle-Modeling-and-Analytics,TRMG2,7fecc1da236b208c5aa0a46c9b7e393e0c51bb92,CALIPER\srini,srinsund@gmail.com,2021-12-17T14:52:23Z,CALIPER\srini,srinsund@gmail.com,2021-12-17T14:52:23Z,Fix specification error in n_hb_od_short DC file,master/resident/dc/n_hb_od_short_zone.csv,False,False,False,False,1,1,2,"---FILE: master/resident/dc/n_hb_od_short_zone.csv---
@@ -1,6 +1,6 @@
 Expression,Segment,Coefficient,Description
 se.n_hbods_size.D,,0.475,Size term
-nz(mc_logsums.nonauto_hh),,1.98,
+nz(mc_logsums.nonhh_auto),,1.98,
 nz(mc_logsums.transit),,0.167,
 sov_skim.IZ,,1.88,
 sov_skim.CongTime,,-0.183,"
Triangle-Modeling-and-Analytics,TRMG2,c4498345dc7ed4f5c9fba335109e38eec1c881be,Kyle Ward,kyleward084@gmail.com,2021-12-17T14:16:51Z,Kyle Ward,kyleward084@gmail.com,2021-12-17T14:16:51Z,"Recalibrate NM model

Recalibration after finding an error in the nm code",master/resident/nonmotorized/n_hb_k12_all.csv;master/resident/nonmotorized/n_hb_od_long.csv;master/resident/nonmotorized/n_hb_od_short.csv;master/resident/nonmotorized/n_hb_ome_all.csv;master/resident/nonmotorized/n_hb_omed_all.csv;master/resident/nonmotorized/w_hb_o_all.csv;master/resident/nonmotorized/w_hb_w_all.csv,False,False,False,False,7,7,14,"---FILE: master/resident/nonmotorized/n_hb_k12_all.csv---
@@ -4,4 +4,4 @@ nonmotorized,person.veh_per_adult,,-0.767,HH vehicles per adult
 nonmotorized,person.age_16_18,,-0.359,Person is between 16 and 18 (driving age)
 nonmotorized,se.access_walk.O,,0.585,Interzonal walk accessibility
 nonmotorized,Constant,,-2.709,Estimated constant
-nonmotorized,Constant,,-0.1793,Calibration constant
+nonmotorized,Constant,,-0.1786,Calibration constant

---FILE: master/resident/nonmotorized/n_hb_od_long.csv---
@@ -6,4 +6,4 @@ nonmotorized,person.is_worker,,-0.283,Person is a worker
 nonmotorized,person.inc_per_capita,,0.000004,Income per person in the household
 nonmotorized,se.Walkability.O,,3.702,Intrazonal walkability
 nonmotorized,Constant,,-1.729,Estimated constant
-nonmotorized,Constant,,0.4559,Calibration constant
+nonmotorized,Constant,,0.4269,Calibration constant

---FILE: master/resident/nonmotorized/n_hb_od_short.csv---
@@ -7,4 +7,4 @@ nonmotorized,person.Autos = 0,,0.89,Person has access to 0 HH vehicles
 nonmotorized,person.inc_per_capita,,0.0000101,Income per person in the household
 nonmotorized,se.Walkability.O,,0.518,Intrazonal walkability
 nonmotorized,Constant,,-0.221,Estimated constant
-nonmotorized,Constant,,1.4607,Calibration constant
+nonmotorized,Constant,,0.8093,Calibration constant

---FILE: master/resident/nonmotorized/n_hb_ome_all.csv---
@@ -6,4 +6,4 @@ nonmotorized,person.inc_per_capita,,0.000008,Income per person in the household
 nonmotorized,se.access_walk.O,,0.548,Interzonal walk accessiblity
 nonmotorized,se.Walkability.O,,7.3,Intrazonal walkability
 nonmotorized,Constant,,-2.584,Estimated constant
-nonmotorized,Constant,,-0.0483,Calibration constant
+nonmotorized,Constant,,-0.0517,Calibration constant

---FILE: master/resident/nonmotorized/n_hb_omed_all.csv---
@@ -4,4 +4,4 @@ nonmotorized,person.is_senior,,-157479,Person is a senior
 nonmotorized,person.Autos = 0,,1.728,Person has access to 0 HH vehicles
 nonmotorized,se.access_walk.O,,4.638,Interzonal walk accessiblity
 nonmotorized,Constant,,-11.207,Estimated constant
-nonmotorized,Constant,,-4.5627,Calibration constant
+nonmotorized,Constant,,-3.8083,Calibration constant

---FILE: master/resident/nonmotorized/w_hb_o_all.csv---
@@ -5,4 +5,4 @@ nonmotorized,person.HHKids > 0,,-0.641,Kids present in the HH
 nonmotorized,person.veh_per_adult,,-1.445,HH vehicles per adult
 nonmotorized,se.access_walk.O,,1,Interzonal walk accessiblity
 nonmotorized,Constant,,-2.123,Estimated constant
-nonmotorized,Constant,,-0.4871,Calibration constant
+nonmotorized,Constant,,-0.4586,Calibration constant

---FILE: master/resident/nonmotorized/w_hb_w_all.csv---
@@ -5,4 +5,4 @@ nonmotorized,person.HHKids > 0,,-0.641,Kids present in the HH
 nonmotorized,person.veh_per_adult,,-1.445,HH vehicles per adult
 nonmotorized,se.access_walk.O,,1,Interzonal walk accessiblity
 nonmotorized,Constant,,-2.123,Estimated constant
-nonmotorized,Constant,,-0.9164,Calibration constant
+nonmotorized,Constant,,-0.8715,Calibration constant"
Triangle-Modeling-and-Analytics,TRMG2,91fc575ac2fcf974494de075212a466caf8801ef,Kyle Ward,kyleward084@gmail.com,2021-12-16T15:20:26Z,Kyle Ward,kyleward084@gmail.com,2021-12-16T15:20:26Z,Add select link support to fixed OD tool,src/17 - Roadway Assignment.rsc;src/utils/FixedODAssignment.rsc,False,False,False,False,22,5,27,"---FILE: src/17 - Roadway Assignment.rsc---
@@ -96,6 +96,7 @@ Macro ""Run Roadway Assignment"" (Args, OtherOpts)
     if OtherOpts.period <> null then periods = {OtherOpts.period}
     hov_exists = Args.hov_exists
     vot_params = Args.vot_params
+    sl_query = Args.sl_query
 
     // If this macro is called without the pre-assignment step, then fill in
     // these variables.
@@ -123,6 +124,7 @@ Macro ""Run Roadway Assignment"" (Args, OtherOpts)
         o = CreateObject(""Network.Assignment"")
         o.Network = net_file
         o.LayerDB = hwy_dbd
+        o.CriticalQueryFile = sl_query
         o.ResetClasses()
         o.Iterations = assign_iters
         o.Convergence = Args.AssignConvergence

---FILE: src/utils/FixedODAssignment.rsc---
@@ -8,15 +8,15 @@ endmacro
 dBox ""FixedOD"" (Args) center, center, 50, 8 Title: ""Fixed OD Assignment"" Help: ""test"" toolbox
 
   init do
-    static full_scen_dir
+    static full_scen_dir, sl_query
     scen_dir = Args.[Scenarios Folder]
   enditem
 
   close do
     return()
   enditem
 
-  Edit Text 15, 2, 15 Prompt: ""Completed Scenario:"" Variable: full_scen_dir
+  Edit Text 15, 1, 15 Prompt: ""Completed Scenario:"" Variable: full_scen_dir
   Button after, same, 5, 1 Prompt: ""..."" do
     on error, escape goto skip1
     full_scen_dir = ChooseDirectory(""Choose Full Scenario Folder"", {""Initial Directory"": scen_dir})
@@ -26,14 +26,25 @@ dBox ""FixedOD"" (Args) center, center, 50, 8 Title: ""Fixed OD Assignment"" Help: ""
 
   Text 15, after, 15 Prompt: ""New Scenario:"" Variable: ""(current scenario)""
 
-  Button 8, 6 Prompt: ""Run"" do
+  Edit Text same, after, 15 Prompt: ""Select Link Query:"" Variable: sl_query
+  Button after, same, 5, 1 Prompt: ""..."" do
+    on error, escape goto skip2
+    sl_query = ChooseFile({{""Query (*.qry)"", ""*.qry""}}, ""Choose Select Link Query"", {""Initial Directory"": scen_dir})
+    skip2:
+    on error default
+  enditem
+  Text after, same, 10 Variable: ""(optional)""
+
+  Button 12, 6.5 Prompt: ""Run"" do
     mr = CreateObject(""Model.Runtime"")
     Args = mr.GetValues()
     if full_scen_dir = Args.[Scenario Folder] then do
         Throw(""The full scenario and current scenario cannot be the same"")
         return()
     end
-    RunMacro(""Fixed OD Assignment"", full_scen_dir)
+    opts.full_scen_dir = full_scen_dir
+    opts.sl_query = sl_query
+    RunMacro(""Fixed OD Assignment"", opts)
     ShowMessage(""Fixed OD Assignment Complete"")
   enditem
   Button 20, same Prompt: ""Quit"" do
@@ -51,7 +62,10 @@ enddbox
 
 */
 
-Macro ""Fixed OD Assignment"" (full_scen_dir)
+Macro ""Fixed OD Assignment"" (MacroOpts)
+
+    full_scen_dir = MacroOpts.full_scen_dir
+    sl_query = MacroOpts.sl_query
 
     mr = CreateObject(""Model.Runtime"")
     Args = mr.GetValues()
@@ -63,6 +77,7 @@ Macro ""Fixed OD Assignment"" (full_scen_dir)
     RunMacro(""Copy Files for Fixed OD"", Args, full_scen_dir)
 
     // Run assignments
+    Args.sl_query = sl_query
     periods = Args.periods
     for period in periods do
         RunMacro(""Run Roadway Assignment"", Args, {period: period})"
Triangle-Modeling-and-Analytics,TRMG2,eb1332d427b980f6be66bb5a6dde2f6b6f2aa94a,Kyle Ward,kyle@caliper.com,2021-12-03T20:11:10Z,Kyle Ward,kyle@caliper.com,2021-12-03T20:11:10Z,Fix links with missing DTWB values,master/networks/master_links.BIN;master/networks/master_links.BX;master/networks/master_links.dln;master/networks/master_links.kln;master/networks/master_links.pts;master/networks/master_routes.rts,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,583ad836de492e8ce4c936693396a70f531dd74a,CALIPER\srini,srinsund@gmail.com,2021-11-30T01:20:35Z,CALIPER\srini,srinsund@gmail.com,2021-11-30T01:20:35Z,"Update calibration file for n_hb_omed.
Fix source issues in calibration code.
Add target shares file.",master/resident/mode/Target_HB_MCShares.csv;master/resident/mode/n_hb_omed_all.csv;src/utils/Calibrators.rsc,False,False,False,False,42,6,48,"---FILE: master/resident/mode/Target_HB_MCShares.csv---
@@ -0,0 +1,23 @@
+""W_HB_W_All"",""v0"",0.00,0.00,0.00,61.5181,17.8331,20.6488,0.00
+""W_HB_W_All"",""ilvi"",69.6069,10.2272,6.17331,2.34424,2.08988,9.5585,0.00
+""W_HB_W_All"",""ilvs"",90.3302,5.48602,1.3724,1.74743,0.0233805,1.04061,0.00
+""W_HB_W_All"",""ihvi"",78.8083,7.58772,5.44702,2.04554,1.04863,5.06275,0.00
+""W_HB_W_All"",""ihvs"",93.6918,3.62518,1.04597,0.303374,0.0514256,1.28225,0.00
+""W_HB_O_All"",""v0"",0.00,0.00,0.00,48.7424,0.00,51.2576,0.00
+""W_HB_O_All"",""vi"",56.5384,17.3088,19.6291,2.17345,0.00,4.35025,0.00
+""W_HB_O_All"",""vs"",72.6537,16.5859,9.52722,0.118579,0.0834277,1.03118,0.00
+""N_HB_OME_All"",""v0"",0.00,0.00,0.00,28.1276,11.0163,60.8562,0.00
+""N_HB_OME_All"",""vi"",30.3563,34.1093,29.8699,0.479116,0.856863,4.32862,0.00
+""N_HB_OME_All"",""vs"",50.1319,28.8246,18.7515,0.0946313,0.227274,1.97005,0.00
+""N_HB_OMED_All"",""v0"",0.00,0.00,0.00,27.5364,12.2275,60.2362,0.00
+""N_HB_OMED_All"",""vi"",26.6472,41.5565,20.2728,2.4327,7.16948,1.92124,0.00
+""N_HB_OMED_All"",""vs"",51.316,32.0726,13.8634,0.227787,0.987261,1.53293,0.00
+""N_HB_OD_Long"",""v0"",0.00,0.00,0.00,35.2069,12.3711,52.422,0.00
+""N_HB_OD_Long"",""vi"",32.511,27.9958,24.6503,5.401,1.30702,8.13481,0.00
+""N_HB_OD_Long"",""vs"",45.0437,24.433,25.5046,0.574756,0.17801,4.26588,0.00
+""N_HB_OD_Short"",""v0"",0.00,0.00,0.00,77.0819,0.00,22.9181,0.00
+""N_HB_OD_Short"",""vi"",29.9737,27.5231,38.7399,2.10242,0.0489049,1.612,0.00
+""N_HB_OD_Short"",""vs"",44.4865,30.4395,23.6387,0.202291,0.285672,0.947295,0.00
+""N_HB_K12_All"",""v0"",0.00,0.00,0.00,20.227,0.00,8.82129,70.9517
+""N_HB_K12_All"",""vi"",14.0425,19.9931,31.0843,2.15582,0.00,5.676,27.0483
+""N_HB_K12_All"",""vs"",18.3874,24.575,31.2829,0.328224,0.00,4.84123,20.5852

---FILE: master/resident/mode/n_hb_omed_all.csv---
@@ -6,12 +6,14 @@ sov,se.HiIncomePct.O,,0.384,High income
 sov,sov_skim.CongTime,,-0.03586,Travel time
 sov,sov_skim.[TollCostSOV (Skim)],,-0.180837,Toll cost
 hov2,Constant,,-0.5574,Constant
+hov2,Constant,v0,-99,Auto Availability
 hov2,parking.MC_LS_NonWork.D,,0.8998,Parking
 hov2,se.HiIncomePct.O,,0.3153,High income
 hov2,hov_skim.CongTime,,-0.03586,Travel time
 hov2,hov_skim.[TollCostHOV (Skim)],,-0.180837,Toll cost
 hov2,se.HHSize1Pct.O,,-0.2811,Percent of 1-person HHs
 hov3,Constant,,-0.6465,Constant
+hov3,Constant,v0,-99,Auto Availability
 hov3,parking.MC_LS_NonWork.D,,0.8998,Parking
 hov3,se.HiIncomePct.O,,0.3153,High income
 hov3,hov_skim.CongTime,,-0.03586,Travel time

---FILE: src/utils/Calibrators.rsc---
@@ -84,7 +84,6 @@ endmacro
 */
 Macro ""Calibrate HB MC""(Args)
     trip_types = RunMacro(""Get HB Trip Types"", Args)
-    trip_types = {""w_hb_w_all""}
     //pbar1 = CreateObject(""G30 Progress Bar"", ""Calibrating MC models for each trip type ..."", true, trip_types.length)
     for trip_type in trip_types do
         if Lower(trip_type) = ""w_hb_ek12_all"" then
@@ -237,9 +236,9 @@ Macro ""Get Targets""(Args, Opts)
     vw = OpenTable(""Targets"", ""CSV"", {targetsFile})
     {flds, specs} = GetFields(vw,)
     SetView(vw)
-    n = SelectByQuery(""Selection"", ""several"", ""Select * where Purpose = '"" + trip_type + ""' and Segment = '"" + segment + ""'"", )
+    n = SelectByQuery(""Selection"", ""several"", ""Select * where Lower(Purpose) = '"" + Lower(trip_type) + ""' and Lower(Segment) = '"" + Lower(segment) + ""'"", )
     if n <> 1 then
-        Throw(""Error in mode choice targets file. File does not have exactly one record for '"" + trip_type + "" and '"" + segment)
+        Throw(""Error in mode choice targets file. File does not have exactly one record for '"" + trip_type + ""' and '"" + segment +""'"")
     vecs = GetDataVectors(vw + ""|Selection"", flds, {OptArray: 1})
     CloseView(vw)
     
@@ -292,6 +291,15 @@ Macro ""MC Eval for Calibration""(Args, Opts)
         tag = trip_type + ""_"" + segment + ""_"" + period
         mdlFile = mc_dir + ""/model_files/"" + tag + ""_Calib.mdl""
 
+        // Get list of model sources
+        model = CreateObject(""NLM.Model"")
+        model.Read(mdlFile, true)
+        modelSources = null
+        for src in model.Sources.Items do
+            modelSources = modelSources + {src[1]}
+        end
+        model.Clear()
+
         if period = ""MD"" or period = ""NT"" then do
             tour_type = ""All""
             homebased = ""All""
@@ -313,10 +321,13 @@ Macro ""MC Eval for Calibration""(Args, Opts)
         
         o = CreateObject(""Choice.Mode"")
         o.ModelFile = mdlFile
-        o.OpenTableSource({SourceName: ""se"", FileName: Args.SE})
-        o.OpenTableSource({SourceName: ""parking"", FileName: Args.[Parking Logsums Table], ViewName: ""parking""})
+        if ArrayPosition(modelSources, {""se""},) > 0 then
+            o.OpenTableSource({SourceName: ""se"", FileName: Args.SE})
+        if ArrayPosition(modelSources, {""parking""},) > 0 then
+            o.OpenTableSource({SourceName: ""parking"", FileName: Args.[Parking Logsums Table], ViewName: ""parking""})
         for src in mtxSources do
-            o.OpenMatrixSource({SourceName: src[1], FileName: src[2]})
+            if ArrayPosition(modelSources, {src[1]},) > 0 then
+                o.OpenMatrixSource({SourceName: src[1], FileName: src[2]})
         end
         o.UtilityScaling = ""By Theta Product""
         probMtx = mc_dir + ""/probabilities/probability_"" + tag + "".mtx"""
Triangle-Modeling-and-Analytics,TRMG2,5e2c915e6fc19776bd657eafd718740a28a554d5,Kyle Ward,kyle@caliper.com,2021-11-09T16:42:07Z,Kyle Ward,kyle@caliper.com,2021-11-09T16:42:07Z,Add macro to check SE data for obvious errors,master/networks/master_links.DCB;src/02 - InitialProcessing.rsc,False,False,False,False,51,4,55,"---FILE: master/networks/master_links.DCB---
@@ -11,7 +11,7 @@ master_links
 ""HCMMedian"",C,112,14,0,14,0,,"""",""HCM Median Type|Restrictive|NonRestrictive|None||This field is ignored for freeways and superstreets (restrictive median is assumed).|For collectors and arterials:|NonRestrictive = 4% capacity increase|Restrictive = 8% capacity increase"",,""Copy"",
 ""DTWB"",C,126,9,0,9,0,,"""",""Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc.||Sample query to select drive links:|DTWB contains \""D\"""",,""Copy"",
 ""HOV"",C,135,4,0,4,0,,"""",""None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
-""BOSSS"",R,139,8,0,10,2,,"""",""Bus-on-Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Sum"",
+""BOSSS"",R,139,8,0,10,2,,"""",""Bus on Side Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Sum"",
 ""TollType"",C,147,4,0,4,0,,"""",""Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
 ""TollCostT"",R,151,8,0,10,2,,"""",""Toll cost ($) with a transponder for 2-axle vehicles||The model will automatically apply 2x this rate to|SUT and 4x this rate to MUT. Also, the % of vehicles|with transponders can be changed. See parameter|'TransponderRatio'."",,""Sum"",
 ""TollCostNT"",R,159,8,0,10,2,,"""",""Toll cost ($) without a transponder for 2-axle vehicles||The model will automatically apply 2x this cost to|SUT and 4x this rate to MUT. Also, the % of vehicles|with transponders can be changed. See parameter|'TransponderRatio'."",,""Sum"",
@@ -31,7 +31,7 @@ master_links
 ""p1HCMMedian"",C,277,14,0,14,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
 ""p1DTWB"",C,291,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
 ""p1HOV"",C,300,4,0,4,0,,"""",""Project Field|None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
-""p1BOSSS"",I,304,4,0,8,0,,"""",""Bus-on-Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Sum"",
+""p1BOSSS"",I,304,4,0,8,0,,"""",""Project Field|Bus on Side Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Sum"",
 ""p1TollType"",C,308,4,0,4,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
 ""p2ID"",C,312,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
 ""p2NCDOTClass"",C,328,16,0,16,0,,"""",""Project Field|This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"",
@@ -42,7 +42,7 @@ master_links
 ""p2HCMMedian"",C,370,14,0,14,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
 ""p2DTWB"",C,384,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
 ""p2HOV"",C,393,4,0,4,0,,"""",""Project Field|None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
-""p2BOSSS"",I,397,4,0,8,0,,"""",""Bus-on-Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Sum"",
+""p2BOSSS"",I,397,4,0,8,0,,"""",""Project Field|Bus on Side Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Sum"",
 ""p2TollType"",C,401,4,0,4,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
 ""p3ID"",C,405,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
 ""p3NCDOTClass"",C,421,16,0,16,0,,"""",""Project Field|This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"",
@@ -53,5 +53,5 @@ master_links
 ""p3HCMMedian"",C,463,14,0,14,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
 ""p3DTWB"",C,477,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
 ""p3HOV"",C,486,4,0,4,0,,"""",""Project Field|None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
-""p3BOSSS"",I,490,4,0,8,0,,"""",""Bus-on-Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Sum"",
+""p3BOSSS"",I,490,4,0,8,0,,"""",""Project Field|Bus on Side Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Sum"",
 ""p3TollType"",C,494,4,0,4,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",

---FILE: src/02 - InitialProcessing.rsc---
@@ -7,6 +7,7 @@ Macro ""Initial Processing"" (Args)
     created = RunMacro(""Is Scenario Created"", Args)
     if !created then return(0)
     RunMacro(""Create Output Copies"", Args)
+    RunMacro(""Check SE Data"", Args)
     RunMacro(""Determine Area Type"", Args)
     RunMacro(""Capacity"", Args)
     RunMacro(""Set CC Speeds"", Args)
@@ -82,6 +83,52 @@ Macro ""Create Output Copies"" (Args)
     CloseView(se)
 EndMacro
 
+/*
+Checks the SE data for logical problems
+*/
+
+Macro ""Check SE Data"" (Args)
+
+    se_bin = Args.SE
+
+    se_vw = OpenTable(""se"", ""FFB"", {se_bin})
+    SetView(se_vw)
+    
+    // Internal checks
+    query = ""Select * where Type = 'Internal'""
+    n = SelectByQuery(""internal"", ""several"", query)
+    if n = 0 then Throw(""No internal zones found (query = '"" + query + ""')"")
+    fields = {""HH"", ""HH_POP"", ""Median_Inc"", ""Pct_Worker"", ""Pct_Child"", ""Pct_Senior""}
+    data = GetDataVectors(
+        se_vw + ""|internal"", fields,
+        {OptArray: ""true"", ""Missing As Zero"": ""true""}
+    )
+    if RunMacro(""Any True"", data.HH > 0 and data.HH_POP = 0) 
+        then Throw(""SE Check: Zones with households are missing population"")
+    if RunMacro(""Any True"", data.HH_POP > 0 and data.HH = 0)
+        then Throw(""SE Check: Zones with population are missing households"")
+    if RunMacro(""Any True"", data.HH > 0 and data.Median_Inc = 0)
+        then Throw(""SE Check: Zones with households are missing median income"")
+    if RunMacro(""Any True"", data.HH > 0 and data.HH_POP / data.HH < 1)
+        then Throw(""SE Check: Some zones have fewer than 1 person per household"")
+    if RunMacro(""Any True"", data.Pct_worker > 100)
+        then Throw(""SE Check: Zones have 'Pct_Worker' > 100"")
+    if RunMacro(""Any True"", data.Pct_Child > 100)
+        then Throw(""SE Check: Zones have 'Pct_Child' > 100"")
+    if RunMacro(""Any True"", data.Pct_Senior > 100)
+        then Throw(""SE Check: Zones have 'Pct_Senior' > 100"")
+                
+    CloseView(se_vw)
+endmacro
+
+/*
+Helper macro for se check. Checks if any member of a vector is true.
+*/
+
+Macro ""Any True"" (v)
+    if v.position(1) <> 0 then return(""true"")
+endmacro
+
 /*
 Prepares input options for the AreaType.rsc library of tools, which
 tags TAZs and Links with area types."
Triangle-Modeling-and-Analytics,TRMG2,758a586567a32d1d72decc6e02b410c0f4ddd5a8,CALIPER\srini,srinsund@gmail.com,2021-11-05T13:41:57Z,CALIPER\srini,srinsund@gmail.com,2021-11-05T13:41:57Z,Fix minor case sensitive issues causing errors in creating OD matrices from NHB files.,src/16 - Create Assignment Matrices.rsc,False,False,False,False,2,2,4,"---FILE: src/16 - Create Assignment Matrices.rsc---
@@ -335,7 +335,7 @@ Macro ""NHB Collapse Matrices and Occupancy"" (Args)
         
         // Skip transit and walkbike matrices and any converged periods
         {, , name, } = SplitPath(nhb_mtx_file)
-        parts = ParseString(name, ""_"")
+        parts = ParseString(Lower(name), ""_"")
         if parts[2] = ""transit"" or parts[2] = ""walkbike"" then continue
         tour_type = parts[2]
         if parts[3] = ""auto"" then auto_pay = ""true"" else auto_pay = ""false""
@@ -358,7 +358,7 @@ Macro ""NHB Collapse Matrices and Occupancy"" (Args)
             SetView(hov3_vw)
             n = SelectByQuery(
                 ""sel"", ""several"", 
-                ""Select * where tour_type = '"" + Upper(tour_type) + ""' and tod = '"" + period + ""'""
+                ""Select * where tour_type = '"" + Upper(tour_type) + ""' and tod = '"" + Upper(period) + ""'""
             )
             if n = 0 then Throw(
                 ""Trying to add NHB trips into assignment matrix.\n"" +"
Triangle-Modeling-and-Analytics,TRMG2,977cc5e9802d5e8810164d9d7e84739b42a194ee,Kyle Ward,kyleward084@gmail.com,2021-10-29T17:55:15Z,Kyle Ward,kyleward084@gmail.com,2021-10-29T17:55:15Z,"Master link layer edits

Fixed some count issues and changed some centroid loadings",master/networks/master_links.BIN;master/networks/master_links.BX;master/networks/master_links.DCB;master/networks/master_links.dln;master/networks/master_links.kln;master/networks/master_links.pts;master/networks/master_links.upx;master/networks/master_links_.BIN;master/networks/master_links_.BX;master/networks/master_routes.rtg;master/networks/master_routes.rts;master/networks/master_routesL.BX;master/networks/master_routesL.bin;master/networks/master_routesR.BX;master/networks/master_routesR.bin;master/networks/master_routesS.lok;master/networks/master_routesS.r0,False,False,False,False,3,3,6,"---FILE: master/networks/master_links.DCB---
@@ -29,26 +29,26 @@
 ""p1PostedSpeed"",I,280,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
 ""p1HCMMedian"",C,284,16,0,16,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
 ""p1DTWB"",C,300,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
-""p1TollType"",C,309,9,0,9,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
 ""p1HOV"",C,318,9,0,9,0,,"""",""Project Field|None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
 ""p1BOSSS"",I,327,4,0,8,0,,"""",""Bus-on-Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Sum"",
+""p1TollType"",C,309,9,0,9,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
 ""p2ID"",C,331,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
 ""p2HCMType"",C,347,16,0,16,0,,"""",""Project Field|Highway Capacity Manuall Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|MajorArterial|MinorArterial|CollectorLocal|Ramp|CC|PNR|TransitOnly"",,""Copy"",
 ""p2ABLanes"",I,363,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
 ""p2BALanes"",I,367,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
 ""p2PostedSpeed"",I,371,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
 ""p2HCMMedian"",C,375,16,0,16,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
 ""p2DTWB"",C,391,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
-""p2TollType"",C,400,9,0,9,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
 ""p2HOV"",C,409,9,0,9,0,,"""",""Project Field|None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
 ""p2BOSSS"",I,418,4,0,8,0,,"""",""Bus-on-Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Sum"",
+""p2TollType"",C,400,9,0,9,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
 ""p3ID"",C,422,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
 ""p3HCMType"",C,438,16,0,16,0,,"""",""Project Field|Highway Capacity Manuall Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|MajorArterial|MinorArterial|CollectorLocal|Ramp|CC|PNR|TransitOnly"",,""Copy"",
 ""p3ABLanes"",I,454,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
 ""p3BALanes"",I,458,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
 ""p3PostedSpeed"",I,462,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
 ""p3HCMMedian"",C,466,16,0,16,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
 ""p3DTWB"",C,482,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
-""p3TollType"",C,491,9,0,9,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
 ""p3HOV"",C,500,9,0,9,0,,"""",""Project Field|None: No occupancy restriction|HOV: Requires at least 2 occupants to use"",,""Copy"",
 ""p3BOSSS"",I,509,4,0,8,0,,"""",""Bus-on-Shoulder Speed||If general traffic speeds drop below this speed, busses are|allowed to operate on the shoulder at a maximum of this|speed. However, busses are only allowed to travel 15 mph|faster than auto traffic."",,""Sum"",
+""p3TollType"",C,491,9,0,9,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"","
Triangle-Modeling-and-Analytics,TRMG2,a9e0da18541f265b5ef449b708802a9bf1b96cae,Kyle Ward,kyleward084@gmail.com,2021-10-27T21:25:45Z,Kyle Ward,kyleward084@gmail.com,2021-10-27T21:25:45Z,"Count corrections

Corrected several count locations where one-way pairs weren't correctly tagged.",master/networks/master_links.BIN,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,c3ae1084fdc5d807693c7c255e2ac2b4740f057a,Kyle Ward,kyle@caliper.com,2021-10-25T13:13:00Z,Kyle Ward,kyle@caliper.com,2021-10-25T13:13:00Z,Add finished message to fixed od assignment,src/utils/FixedODAssignment.rsc,False,False,False,False,1,0,1,"---FILE: src/utils/FixedODAssignment.rsc---
@@ -34,6 +34,7 @@ dBox ""FixedOD"" (Args) center, center, 50, 8 Title: ""Fixed OD Assignment"" Help: ""
         return()
     end
     RunMacro(""Fixed OD Assignment"", full_scen_dir)
+    ShowMessage(""Fixed OD Assignment Complete"")
   enditem
   Button 20, same Prompt: ""Quit"" do
     Return()"
Triangle-Modeling-and-Analytics,TRMG2,63dfac5a84f7d798b43d9b8fa17d80a4b03c6b3b,Kyle Ward,kyleward084@gmail.com,2021-10-24T01:14:33Z,Kyle Ward,kyleward084@gmail.com,2021-10-24T01:14:33Z,Fix count error on I-85,master/networks/master_links.BIN,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,ece2ee0e56147a746f61e4f6c8a272c1504215a7,Kyle Ward,kyleward084@gmail.com,2021-10-23T04:00:36Z,Kyle Ward,kyleward084@gmail.com,2021-10-23T04:00:36Z,Remove testing iterations code from fixed OD,src/utils/fixed_od_assignment.rsc,False,False,False,False,1,1,2,"---FILE: src/utils/fixed_od_assignment.rsc---
@@ -64,7 +64,7 @@ Macro ""Fixed OD Assignment"" (full_scen_dir)
     // Run assignments
     periods = Args.periods
     for period in periods do
-        RunMacro(""Run Roadway Assignment"", Args, {period: period, assign_iters: 1})
+        RunMacro(""Run Roadway Assignment"", Args, {period: period})
     end
 
     // Run summary macros of interest"
Triangle-Modeling-and-Analytics,TRMG2,68b90d6c609adf93d65e0120fa54952c6d3f355c,Kyle Ward,kyle@caliper.com,2021-10-23T02:08:59Z,Kyle Ward,kyle@caliper.com,2021-10-23T02:08:59Z,Add fixed OD assignment utility,src/02 - InitialProcessing.rsc;src/Roadway Assignment.rsc;src/_TRMCompile.lst;src/flow_chart/trmg2_menu.rsc;src/utils/fixed_od_assignment.rsc,False,False,False,False,123,13,136,"---FILE: src/02 - InitialProcessing.rsc---
@@ -810,7 +810,8 @@ Macro ""Check Highway Networks"" (Args)
         mtx = null
         mh = null
         CloseView(se_vw)
-        OtherOpts.test_opts.od_mtx = mtx_file
+        OtherOpts.od_mtx = mtx_file
+        OtherOpts.assign_iters = 1
         RunMacro(""Run Roadway Assignment"", Args, OtherOpts)
     end
 endmacro
@@ -821,6 +822,11 @@ endmacro
 
 Macro ""Create Route Networks"" (Args)
 
+    // Initial processing is called by the main model, but also by the Fixed
+    // OD assignment tool. When doing fixed highway assignment, skip this step
+    // to save time.
+    if Args.fixed_od then return()
+
     link_dbd = Args.Links
     rts_file = Args.Routes
     output_dir = Args.[Output Folder] + ""/networks""

---FILE: src/Roadway Assignment.rsc---
@@ -64,22 +64,26 @@ validity of the highway network and prevent wasted run time.
 
 For actual assignment, this macro can run all periods in series or be provided
 with a specific period to run (if running in parallel).
+
+OtherOpts
+    Can be used to override defaults
+    od_mtx (used by ""Check Highway Networks"" macro)
+    assign_iters (used by ""Check Highway Networks"" macro)
+    periods (used by the TOD assignment macros)
 */
 
 Macro ""Run Roadway Assignment"" (Args, OtherOpts)
 
     hwy_dbd = Args.Links
     net_dir = Args.[Output Folder] + ""\\networks\\""
     feedback_iter = Args.FeedbackIteration
-    assign_iters = Args.AssignIterations
     assn_dir = Args.[Output Folder] + ""/assignment/roadway""
     vot_param_file = Args.[Input Folder] + ""/assignment/vot_params.csv""
     test_opts = OtherOpts.test_opts
-    // If no period is specified, run all that are unconverged. Otherwise, only
-    // run the specified period. This allows the macro to be called in parallel
-    // by the flowchart, with each engine running a single period.
+    assign_iters = Args.AssignIterations
+    if OtherOpts.assign_iters <> null then assign_iters = OtherOpts.assign_iters
     periods = RunMacro(""Get Unconverged Periods"", Args)
-    if OtherOpts.period <> null then periods = {OtherOpts.period}
+    if OtherOpts.periods <> null then periods = OtherOpts.periods
     hov_exists = Args.hov_exists
     vot_params = Args.vot_params
 
@@ -103,14 +107,9 @@ Macro ""Run Roadway Assignment"" (Args, OtherOpts)
 
     for period in periods do
         od_mtx = assn_dir + ""/od_veh_trips_"" + period + "".mtx""
+        if OtherOpts.od_mtx <> null then od_mtx = OtherOpts.od_mtx
         net_file = net_dir + ""net_"" + period + ""_hov.net""
 
-        // If doing a test assignment, use the dummy OD matrix provided
-        if test_opts <> null then do
-            od_mtx = test_opts.od_mtx
-            assign_iters = 1
-        end
-
         o = CreateObject(""Network.Assignment"")
         o.Network = net_file
         o.LayerDB = hwy_dbd
@@ -133,7 +132,7 @@ Macro ""Run Roadway Assignment"" (Args, OtherOpts)
         // Add classes for each combination of vehicle type and VOT
         // If doing a test assignment, just create a single class from the
         // dummy matrix
-        if test_opts <> null then do
+        if OtherOpts.od_mtx <> null then do
             o.AddClass({
                 Demand: ""TAZ"",
                 PCE: 1,

---FILE: src/_TRMCompile.lst---
@@ -29,5 +29,6 @@ utils/df.rsc
 utils/RoadwayProjectManagement.rsc
 utils/TransitProjectManagement.rsc
 utils/link_diff_tool.rsc
+utils/fixed_od_assignment.rsc
 flow_chart/NLMCreateFromPMEClass.rsc
 Calibrators.rsc
\ No newline at end of file

---FILE: src/flow_chart/trmg2_menu.rsc---
@@ -96,6 +96,12 @@ menu ""TRMG2 Utilities""
         mr = CreateObject(""Model.Runtime"")
         mr.RunCode(""Open Diff Tool"")
     enditem
+
+    MenuItem ""fixed_od"" text: ""Fixed OD Assignment"" do
+        mr = CreateObject(""Model.Runtime"")
+        Args = mr.GetValues()
+        mr.RunCode(""Open Fixed OD Dbox"", Args)
+    enditem
 endMenu
 
 menu ""TRMG2 Calibrators""

---FILE: src/utils/fixed_od_assignment.rsc---
@@ -0,0 +1,98 @@
+/*
+The purpose of this tool to is allow supply side changes to be evaluated
+quickly without affecting the demand (OD matrix).
+*/
+Macro ""Open Fixed OD Dbox"" (Args)
+	RunDbox(""FixedOD"", Args)
+endmacro
+dBox ""FixedOD"" (Args) center, center, 50, 8 Title: ""Fixed OD Assignment"" Help: ""test"" toolbox
+
+  init do
+    static full_scen_dir
+    scen_dir = Args.[Scenarios Folder]
+  enditem
+
+  close do
+    return()
+  enditem
+
+  Edit Text 15, 2, 15 Prompt: ""Completed Scenario:"" Variable: full_scen_dir
+  Button after, same, 5, 1 Prompt: ""..."" do
+    on error, escape goto skip1
+    full_scen_dir = ChooseDirectory(""Choose Full Scenario Folder"", {""Initial Directory"": scen_dir})
+    skip1:
+    on error default
+  enditem
+
+  Text 15, after, 15 Prompt: ""New Scenario:"" Variable: ""(current scenario)""
+
+  Button 8, 6 Prompt: ""Run"" do
+    mr = CreateObject(""Model.Runtime"")
+    Args = mr.GetValues()
+    if full_scen_dir = Args.[Scenario Folder] then do
+        Throw(""The full scenario and current scenario cannot be the same"")
+        return()
+    end
+    RunMacro(""Fixed OD Assignment"", full_scen_dir)
+  enditem
+  Button 20, same Prompt: ""Quit"" do
+    Return()
+  enditem
+  Button 28, same Prompt: ""Help"" do
+    ShowMessage(
+      ""This tool lets you evaluate a roadway project quickly by "" +
+      ""borrowing demand info from a fully-converged scenario.""
+    )
+  enditem
+enddbox
+
+/*
+
+*/
+
+Macro ""Fixed OD Assignment"" (full_scen_dir)
+
+    mr = CreateObject(""Model.Runtime"")
+    Args = mr.GetValues()
+    // This flag is used to modify certain steps of the model.
+    // For example, 
+    Args.fixed_od = ""true"" // lets us skip transit net creation
+    ret = mr.RunStep(""Initial Processing"", {Silent: ""true""})
+    if !ret then return()
+    RunMacro(""Copy Files for Fixed OD"", Args, full_scen_dir)
+
+    // Run assignments
+    periods = Args.periods
+    for period in periods do
+        RunMacro(""Run Roadway Assignment"", Args, {period: period, assign_iters: 1})
+    end
+
+    // Run summary macros of interest
+    RunMacro(""Load Link Layer"", Args)
+    RunMacro(""Calculate Daily Fields"", Args)
+    RunMacro(""Create Count Difference Map"", Args)
+    RunMacro(""Count PRMSEs"", Args)
+    RunMacro(""VOC Maps"", Args)
+    RunMacro(""Speed Maps"", Args)
+    RunMacro(""Summarize by FT and AT"", Args)
+endmacro
+
+/*
+
+*/
+
+Macro ""Copy Files for Fixed OD"" (Args, full_scen_dir)
+
+    from_dir = full_scen_dir
+    to_dir = Args.[Scenario Folder]
+    periods = Args.periods
+
+    // OD matrices
+    from_od_dir = from_dir + ""/output/assignment/roadway""
+    to_od_dir = to_dir + ""/output/assignment/roadway/""
+    for period in periods do
+        from_file = from_od_dir + ""/od_veh_trips_"" + period + "".mtx""
+        to_file = to_od_dir + ""/od_veh_trips_"" + period + "".mtx""
+        CopyFile(from_file, to_file)
+    end
+endmacro
\ No newline at end of file"
Triangle-Modeling-and-Analytics,TRMG2,c119f8a4e782b27c4d49c912a2fe6a34cded8e15,Kyle Ward,kyle@caliper.com,2021-10-22T23:25:49Z,Kyle Ward,kyle@caliper.com,2021-10-22T23:25:49Z,"Correct project coding errors

Things like HOV = ""0"" instead of ""None"" or null",master/networks/master_links.BIN,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,3a02590b0bc37a574243a7ba64ccde35f71619d2,Kyle Ward,kyle@caliper.com,2021-10-22T20:39:33Z,Kyle Ward,kyle@caliper.com,2021-10-22T20:39:33Z,"Corrected mistakes in 2020 projects

The test assignment in the initial processing step revealed some
attribute errors in the project coding.",master/networks/master_links.BIN;master/networks/master_links.dln,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,2bbe179b3732362f9c4dd3c9fa9ae4ce2cde474d,Kyle Ward,kyle@caliper.com,2021-10-21T16:12:48Z,Kyle Ward,kyle@caliper.com,2021-10-21T16:12:48Z,"Fix merge_tool node attribute handling

Node attribute data was being lost because reserved field
names like Elevation were still included.",src/utils/merge_tool.rsc,False,False,False,False,3,0,3,"---FILE: src/utils/merge_tool.rsc---
@@ -104,6 +104,9 @@ Class ""MergeTool"" (MacroOpts)
         {node_fields, } = GetFields(out_nlyr, ""All"")
         for node_field in node_fields do
             if node_field = ""ID"" then continue
+            if node_field = ""Longitude"" then continue
+            if node_field = ""Latitude"" then continue
+            if node_field = ""Elevation"" then continue
             n_fields = n_fields + {{node_field, node_field}}
         end
         MergeGeography(out_llyr, sub_llyr + ""|"", {"
Triangle-Modeling-and-Analytics,TRMG2,3a166f42c794188aa4f93a8020607188d1a9130e,Kyle Ward,kyleward084@gmail.com,2021-10-21T15:41:28Z,Kyle Ward,kyleward084@gmail.com,2021-10-21T15:41:28Z,"Make corrections to master layer including PNR

The merge process lost node data. This puts it back and also makes a more additional corrections.",master/networks/master_links.BIN;master/networks/master_links.BX;master/networks/master_links.dln;master/networks/master_links.kln;master/networks/master_links.upx;master/networks/master_links_.BIN;master/networks/master_routes.rts;src/02 - InitialProcessing.rsc,False,False,False,False,3,3,6,"---FILE: src/02 - InitialProcessing.rsc---
@@ -249,7 +249,7 @@ Macro ""Tag Highway with Area Type"" (Args, map, views)
     a_fields = {{""AreaType"", ""Character"", 10, }}
     RunMacro(""Add Fields"", {view: llyr, a_fields: a_fields})
     SetLayer(llyr)
-    SelectByQuery(""primary"", ""several"", ""Select * where D = 1"")
+    SelectByQuery(""primary"", ""several"", ""Select * where DTWB contains 'D'"")
 
     // Loop over each area type starting with most dense.  Skip the first.
     // All remaining links after this loop will be tagged with the lowest
@@ -294,7 +294,7 @@ Macro ""Tag Highway with Area Type"" (Args, map, views)
     // Select all remaining links and assign them to the
     // first (lowest density) area type.
     SetLayer(llyr)
-    query = ""Select * where AreaType = null and D = 1""
+    query = ""Select * where AreaType = null and DTWB contains 'D'""
     n = SelectByQuery(""links"", ""Several"", query)
     if n > 0 then do
         type = area_tbl[1].AreaType
@@ -830,7 +830,7 @@ Macro ""Create Route Networks"" (Args)
 
     transit_modes = RunMacro(""Get Transit Modes"", TransModeTable)
     transit_modes = {""all""} + transit_modes
-    
+
     for period in periods do
         for transit_mode in transit_modes do
 "
Triangle-Modeling-and-Analytics,TRMG2,954b469e28bc728ed6a558ba4fafad350f7b2d76,Kyle Ward,kyleward084@gmail.com,2021-10-17T11:52:13Z,Kyle Ward,kyleward084@gmail.com,2021-10-17T11:52:13Z,"Correct handling of converged periods

The continue statement only works in for loops (not while loops). Made that change. Adding externals also needed a fix to avoid adding repeatedly to converged periods.",src/Create Assignment Matrices.rsc,False,False,False,False,7,3,10,"---FILE: src/Create Assignment Matrices.rsc---
@@ -42,7 +42,7 @@ Macro ""Directionality"" (Args)
         period = fac_vw.tod
         pa_factor = fac_vw.pa_fac
 
-        if periods.position(period) = 0 then continue
+        if periods.position(period) = 0 then goto skip
 
         pa_mtx_file = trip_dir + ""/pa_per_trips_"" + trip_type + ""_"" + period + "".mtx""
         od_mtx_file = assn_dir + ""/od_per_trips_"" + trip_type + ""_"" + period + "".mtx""
@@ -67,6 +67,7 @@ Macro ""Directionality"" (Args)
             if auto_modes.position(core_name) = 0 then mtx.DropCores({core_name})
         end
         
+        skip:
         rh = GetNextRecord(fac_vw + ""|"", rh, )
     end
     CloseView(fac_vw)
@@ -172,7 +173,7 @@ Macro ""HB Occupancy"" (Args)
         period = fac_vw.tod
         hov3_factor = fac_vw.hov3
 
-        if periods.position(period) = 0 then continue
+        if periods.position(period) = 0 then goto skip
 
         per_mtx_file = assn_dir + ""/od_per_trips_"" + trip_type + ""_"" + period + "".mtx""
         veh_mtx_file = assn_dir + ""/od_veh_trips_"" + trip_type + ""_"" + period + "".mtx""
@@ -181,6 +182,8 @@ Macro ""HB Occupancy"" (Args)
         cores = mtx.GetCores()
         cores.hov2 := cores.hov2 / 2
         cores.hov3 := cores.hov3 / hov3_factor
+
+        skip:
         rh = GetNextRecord(fac_vw + ""|"", rh, )
     end
     CloseView(fac_vw)
@@ -234,7 +237,7 @@ Simple macro that removes the interim matrices created in this folder to save
 space. For debugging these steps, comment out this macro in ""Create Assignment
 Matrices"".
 
-Note: if parallelizing more than assignment by time period, this has to change
+Note: if parallelizing the entire feedback loop, this has to change
 */
 
 Macro ""HB Remove Interim Matrices"" (Args)
@@ -641,6 +644,7 @@ Macro ""Add Externals"" (Args)
         // ee/ie core names look like ""EE_AUTO_AM"" or ""IEEI_CVMUT_MD""
         parts = ParseString(ee_core_name, ""_"")
         period = parts[3]
+        if periods.position(period) = 0 then continue
         if parts[2] = ""AUTO"" then core_name = ""sov_VOT2""
         if parts[2] = ""CVSUT"" then core_name = ""SUT_VOT2""
         if parts[2] = ""CVMUT"" then core_name = ""MUT_VOT3"""
Triangle-Modeling-and-Analytics,TRMG2,dbf264d272527208a1cb0cd9f427eab68a3c83d4,Kyle Ward,kyleward084@gmail.com,2021-10-14T18:17:07Z,Kyle Ward,kyleward084@gmail.com,2021-10-14T18:17:07Z,"Fix pre-assignment and VOI for trucks

VOI was defaulting to 1 due to null values, which caused the toll road to be over loaded.",src/Roadway Assignment.rsc;trmg2.model,False,False,False,False,4,3,7,"---FILE: src/Roadway Assignment.rsc---
@@ -175,7 +175,7 @@ Macro ""Run Roadway Assignment"" (Args, OtherOpts)
                 sut_opts = {
                     Demand: ""SUT_VOT"" + String(i),
                     PCE: 1.5,
-                    VOI: vot_params.(""sut_vot"" + String(i)) / 60 * 100,
+                    VOI: vot_params.(""sut_vot"" + String(i)) / 60, // ($/min)
                     LinkTollField: ""TollCostSUT""
                 }
                 if hov_exists then sut_opts = sut_opts + {ExclusionFilter: ""HOV <> 'None'""}
@@ -186,7 +186,7 @@ Macro ""Run Roadway Assignment"" (Args, OtherOpts)
                 mut_opts = {
                     Demand: ""MUT_VOT"" + String(i),
                     PCE: 2.5,
-                    VOI: vot_params.(""mut_vot"" + String(i)) / 60 * 100,
+                    VOI: vot_params.(""mut_vot"" + String(i)) / 60, // ($/min)
                     LinkTollField: ""TollCostMUT""
                 }
                 if hov_exists then mut_opts = mut_opts + {ExclusionFilter: ""HOV <> 'None'""}

---FILE: trmg2.model---
@@ -221,7 +221,8 @@ EndMacro
 
 
 Macro ""Pre Assignment"" (Args,Result)
-    Attributes = {{""Class"",{""GISDK""}}}
+    Attributes = {{""Class"",{""GISDK""}},
+                  {""MacroNames"",{""Pre Assignment""}}}
 Body:
     Return(True)
 EndMacro"
Triangle-Modeling-and-Analytics,TRMG2,5d36997cdea8d4a01040149830f0e34b26f4ed3d,Kyle Ward,kyleward084@gmail.com,2021-10-13T19:55:44Z,Kyle Ward,kyleward084@gmail.com,2021-10-13T19:55:44Z,"Fix trip conservation issues

Corrected multiple places where null matrix values were leading to a loss of trips.",src/11 - Destination Choice.rsc;src/Create Assignment Matrices.rsc;src/External Models.rsc;src/NHB Models.rsc;src/utils/df.rsc,False,False,False,False,79,54,133,"---FILE: src/11 - Destination Choice.rsc---
@@ -381,6 +381,7 @@ Macro ""Apportion Resident HB Trips"" (Args)
             mode_names = out_mtx.GetCoreNames()
             out_mtx.AddCores({""all_transit""})
             cores = out_mtx.GetCores()
+            cores.all_transit := 0
             modes_to_skip = {""sov"", ""hov2"", ""hov3"", ""auto_pay"", ""other_auto"", ""school_bus""}
             for mode in mode_names do
                 if modes_to_skip.position(mode) > 0 then continue

---FILE: src/Create Assignment Matrices.rsc---
@@ -1,5 +1,8 @@
 /*
-
+The macros in this script stitch together all the various travel markets
+into four assignment matrices (one for each period). Along the way,
+trip conservation snapshots are taken to help identify if trips are being
+lost during the conversion.
 */
 
 Macro ""Create Assignment Matrices"" (Args)
@@ -134,9 +137,9 @@ Macro ""HB Collapse Auto Modes"" (Args)
             mtx = CreateObject(""Matrix"", mtx_file)
             cores = mtx.GetCores()
             for core_to_collapse in cores_to_collapse do
-                cores.sov := cores.sov + cores.(core_to_collapse) * sov_fac
-                cores.hov2 := cores.hov2 + cores.(core_to_collapse) * hov2_fac
-                cores.hov3 := cores.hov3 + cores.(core_to_collapse) * hov3_fac
+                cores.sov := cores.sov + nz(cores.(core_to_collapse)) * sov_fac
+                cores.hov2 := cores.hov2 + nz(cores.(core_to_collapse)) * hov2_fac
+                cores.hov3 := cores.hov3 + nz(cores.(core_to_collapse)) * hov3_fac
             end
             mtx.DropCores({""auto_pay"", ""other_auto""})
         end
@@ -346,7 +349,7 @@ Macro ""NHB Collapse Matrices and Occupancy"" (Args)
                 ""Select * where tour_type = '"" + Upper(tour_type) + ""' and tod = '"" + period + ""'""
             )
             if n = 0 then Throw(
-                ""Trying to add NHB trips into assignment matrix./n"" +
+                ""Trying to add NHB trips into assignment matrix.\n"" +
                 ""HOV3 factor not found in lookup table.""
             )
             occ_rate = GetDataVector(hov3_vw + ""|sel"", ""hov3"", )
@@ -415,52 +418,6 @@ Macro ""Add CVs and Trucks"" (Args)
     RunMacro(""Trip Conservation Snapshot"", assn_dir, out_file)
 endmacro
 
-/*
-
-*/
-
-Macro ""Add Externals"" (Args)
-
-    assn_dir = Args.[Output Folder] + ""/assignment/roadway""
-    ext_dir = Args.[Output Folder] + ""/external""
-    periods = RunMacro(""Get Unconverged Periods"", Args)
-
-    ee_mtx_file = ext_dir + ""/ee_trips.mtx""
-    ee_mtx = CreateObject(""Matrix"", ee_mtx_file)
-    ee_cores = ee_mtx.GetCores()
-    ee_core_names = ee_mtx.GetCoreNames()
-
-    ie_mtx_file = ext_dir + ""/ie_od_trips.mtx""
-    ie_mtx = CreateObject(""Matrix"", ie_mtx_file)
-    ie_cores = ie_mtx.GetCores()
-    ie_core_names = ie_mtx.GetCoreNames()
-
-    for i = 1 to ee_core_names.length do
-        ee_core_name = ee_core_names[i]
-        ie_core_name = ie_core_names[i]
-
-        // ee/ie core names look like ""EE_AUTO_AM"" or ""IEEI_CVMUT_MD""
-        parts = ParseString(ee_core_name, ""_"")
-        period = parts[3]
-        if parts[2] = ""AUTO"" then core_name = ""sov_VOT2""
-        if parts[2] = ""CVSUT"" then core_name = ""SUT_VOT2""
-        if parts[2] = ""CVMUT"" then core_name = ""MUT_VOT3""
-
-        trip_mtx_file = assn_dir + ""/od_veh_trips_"" + period + "".mtx""
-        trip_mtx = CreateObject(""Matrix"", trip_mtx_file)
-        trip_cores = trip_mtx.GetCores()
-        // The ee matrix only contains external centroids
-        trip_mtx.UpdateCore({CoreName: core_name, SourceCores: ee_cores.(ee_core_name)})
-        // The ie matrix contains all centroids
-        trip_cores.(core_name) := nz(trip_cores.(core_name)) + nz(ie_cores.(ie_core_name))
-    end
-
-    out_file = Args.[Output Folder] + ""/_summaries/trip_conservation/0 external trips.csv""
-    RunMacro(""Trip Conservation Snapshot"", ext_dir, out_file)
-    out_file = Args.[Output Folder] + ""/_summaries/trip_conservation/10 after Add Externals.csv""
-    RunMacro(""Trip Conservation Snapshot"", assn_dir, out_file)
-endmacro
-
 /*
 This borrows the NCSTM approach to split OD matrices into distinct values of
 time. This is based both on the distance of the trip and the average HH incomes
@@ -510,6 +467,9 @@ Macro ""VOT Split"" (Args)
 		cores.dtemp    := v_tothhinc
 		v_tothhinc.rowbased = true
 		cores.wgtinc    := (cores.otemp + cores.dtemp) / cores.hh
+        a_stats = MatrixStatistics(output.GetMatrixHandle(), {Tables: {""wgtinc""}})
+        mean_inc = a_stats.wgtinc.Mean
+        cores.wgtinc := if cores.wgtinc = null then mean_inc else cores.wgtinc
         output.DropCores({""hh"", ""otemp"", ""dtemp""})
 
         output.AddCores({""lognorm"", ""zscore""})
@@ -574,7 +534,7 @@ Macro ""VOT Split"" (Args)
 
     CloseView(se_vw)
 
-    out_file = Args.[Output Folder] + ""/_summaries/trip_conservation/11 after VOT Split.csv""
+    out_file = Args.[Output Folder] + ""/_summaries/trip_conservation/10 after VOT Split.csv""
     RunMacro(""Trip Conservation Snapshot"", assn_dir, out_file)
 endmacro
 
@@ -640,6 +600,53 @@ Macro ""VOT Aggregation"" (Args)
         end 
     end
 
-    out_file = Args.[Output Folder] + ""/_summaries/trip_conservation/12 after VOT Aggregation.csv""
+    out_file = Args.[Output Folder] + ""/_summaries/trip_conservation/11 after VOT Aggregation.csv""
+    RunMacro(""Trip Conservation Snapshot"", assn_dir, out_file)
+endmacro
+
+
+/*
+
+*/
+
+Macro ""Add Externals"" (Args)
+
+    assn_dir = Args.[Output Folder] + ""/assignment/roadway""
+    ext_dir = Args.[Output Folder] + ""/external""
+    periods = RunMacro(""Get Unconverged Periods"", Args)
+
+    ee_mtx_file = ext_dir + ""/ee_trips.mtx""
+    ee_mtx = CreateObject(""Matrix"", ee_mtx_file)
+    ee_cores = ee_mtx.GetCores()
+    ee_core_names = ee_mtx.GetCoreNames()
+
+    ie_mtx_file = ext_dir + ""/ie_od_trips.mtx""
+    ie_mtx = CreateObject(""Matrix"", ie_mtx_file)
+    ie_cores = ie_mtx.GetCores()
+    ie_core_names = ie_mtx.GetCoreNames()
+
+    for i = 1 to ee_core_names.length do
+        ee_core_name = ee_core_names[i]
+        ie_core_name = ie_core_names[i]
+
+        // ee/ie core names look like ""EE_AUTO_AM"" or ""IEEI_CVMUT_MD""
+        parts = ParseString(ee_core_name, ""_"")
+        period = parts[3]
+        if parts[2] = ""AUTO"" then core_name = ""sov_VOT2""
+        if parts[2] = ""CVSUT"" then core_name = ""SUT_VOT2""
+        if parts[2] = ""CVMUT"" then core_name = ""MUT_VOT3""
+
+        trip_mtx_file = assn_dir + ""/od_veh_trips_"" + period + "".mtx""
+        trip_mtx = CreateObject(""Matrix"", trip_mtx_file)
+        trip_cores = trip_mtx.GetCores()
+        // The ee matrix only contains external centroids
+        trip_mtx.UpdateCore({CoreName: core_name, SourceCores: ee_cores.(ee_core_name)})
+        // The ie matrix contains all centroids
+        trip_cores.(core_name) := nz(trip_cores.(core_name)) + nz(ie_cores.(ie_core_name))
+    end
+
+    out_file = Args.[Output Folder] + ""/_summaries/trip_conservation/0 external trips.csv""
+    RunMacro(""Trip Conservation Snapshot"", ext_dir, out_file)
+    out_file = Args.[Output Folder] + ""/_summaries/trip_conservation/12 after Add Externals.csv""
     RunMacro(""Trip Conservation Snapshot"", assn_dir, out_file)
 endmacro
\ No newline at end of file

---FILE: src/External Models.rsc---
@@ -57,6 +57,15 @@ Macro ""Convert EE CSV to MTX"" (Args)
   )
   
   mtx = null
+
+  // Remove any nulls
+  mtx = CreateObject(""Matrix"", ee_mtx_file)
+  core_names = mtx.GetCoreNames()
+  for core_name in core_names do
+    core = mtx.GetCore(core_name)
+    core := nz(core)
+  end
+
   CloseView(view)
   CloseMap(map)
 endmacro 

---FILE: src/NHB Models.rsc---
@@ -321,6 +321,14 @@ Macro ""Evaluate NHB DC""(Args, Spec)
             ret = obj.Evaluate()
             if !ret then
                 Throw(""Running '"" + tag + ""' destination choice model failed."")
+
+            // Convert any nulls to zero in the resulting trip matrix
+            mtx = CreateObject(""Matrix"", trips_folder + tag + "".mtx"")
+            core_names = mtx.GetCoreNames()
+            for core_name in core_names do
+                core = mtx.GetCore(core_name)
+                core := nz(core)
+            end
         end
     end
 endMacro

---FILE: src/utils/df.rsc---
@@ -578,7 +578,7 @@ Class ""df"" (tbl, desc, groups)
     // Create a view and export to csv
     vw = self.create_view()
     ExportView(vw + ""|"", ""CSV"", file, , {""CSV Header"": ""true""})
-    DeleteFile(Substitute(file, "".csv"", "".DCC""))
+    DeleteFile(Substitute(file, "".csv"", "".DCC"", ))
   EndItem
 
   /*doc"
Triangle-Modeling-and-Analytics,TRMG2,224b306789d5ed276f2511a9b1e302bda83db178,Kyle Ward,kyleward084@gmail.com,2021-10-13T10:42:45Z,Kyle Ward,kyleward084@gmail.com,2021-10-13T10:42:45Z,"Update link layer and networks with MSATime

Because only the hov nets are used for assignment, this change adds the MSATime values to the SOV networks, which need them for skimming. This also corrects an error in the ""Update Link Congested Speeds"" macro.",src/Roadway Assignment.rsc;src/Skimming.rsc,False,False,False,False,4,6,10,"---FILE: src/Roadway Assignment.rsc---
@@ -229,8 +229,8 @@ Macro ""Update Link Congested Times"" (Args)
         jv = JoinViews(""jv"", llyr + "".ID"", assn_vw + "".ID1"", )
 
         for dir in dirs do
-            old_field = llyr + "".AB"" + period + ""Time""
-            new_field = assn_vw + ""."" + dir + ""_Time""
+            old_field = llyr + ""."" + dir + period + ""Time""
+            new_field = assn_vw + ""."" + dir + ""_MSA_Time""
             v_old = GetDataVector(jv + ""|"", old_field, )
             v_new = GetDataVector(jv + ""|"", new_field, )
             // This check keeps TransitOnly links and any others not included

---FILE: src/Skimming.rsc---
@@ -8,9 +8,7 @@ Macro ""Skimming"" (Args)
 
     if feedback_iteration > 1 then do
         RunMacro(""Calculate Bus Speeds"", Args)
-        // TODO: decide if this is needed. Skimming after feedback is going to minimize MSA time anyway
-        // If not using, delete this and the macro.
-        // RunMacro(""Update Link Networks"", Args)
+        RunMacro(""Update Link Networks"", Args)
         RunMacro(""Create Route Networks"", Args)
     end
     RunMacro(""Roadway Skims"", Args)
@@ -38,7 +36,7 @@ Macro ""Update Link Networks"" (Args)
         obj = CreateObject(""Network.Update"")
         obj.LayerDB = hwy_dbd
         obj.Network = file
-        obj.UpdateLinkField({Name: ""CongTime"", Field: {""AB"" + period + ""Time"", ""BA"" + period + ""Time""}})
+        obj.UpdateLinkField({Name: ""MSATime"", Field: {""AB"" + period + ""Time"", ""BA"" + period + ""Time""}})
         obj.Run()
     end
 endmacro"
Triangle-Modeling-and-Analytics,TRMG2,7ae2fe99cba9e0e81b4b4e36446ccc79244d078a,Kyle Ward,kyle@caliper.com,2021-10-12T02:54:15Z,Kyle Ward,kyle@caliper.com,2021-10-12T02:54:15Z,Fix bug in aggregation script,src/07 - Aggregation.rsc,False,False,False,False,1,1,2,"---FILE: src/07 - Aggregation.rsc---
@@ -49,7 +49,7 @@ Macro ""Aggregate HB Moto Trips"" (Args)
     for name in names do
         if Left(name, 4) = ""sum_"" then do
             new_name = Substitute(name, ""sum_"", """", 1)
-            new_name = Substitute(name, ""_m"", """", 1)
+            new_name = Substitute(new_name, ""_m"", """", 1)
             df.rename(name, new_name)
         end
     end"
Triangle-Modeling-and-Analytics,TRMG2,72cf139de979b0fb6f889015d56e35146f059999,Kyle Ward,kyleward084@gmail.com,2021-10-09T18:23:21Z,Kyle Ward,kyleward084@gmail.com,2021-10-09T18:23:21Z,"Prevent master route file from changing

The ""Get RTS Roadway File"" macro no longer assumes you want to 'fix' the route system. This means it will no longer modify the master route system.",src/utils/utils.rsc,False,False,False,False,4,4,8,"---FILE: src/utils/utils.rsc---
@@ -735,10 +735,10 @@ Macro ""Get RTS Roadway File"" (MacroOpts)
   
   // If the right roadway file exists in the directory but the route system
   // is pointing elsewhere, fix it.
-  if GetFileInfo(hwy_dbd) <> null and hwy_dbd <> hwy_dbd1 then do
-    {nlyr, llyr} = GetDBLayers(hwy_dbd)
-    ModifyRouteSystem(rts_file, {{""Geography"", hwy_dbd, llyr}})
-  end
+  // if GetFileInfo(hwy_dbd) <> null and hwy_dbd <> hwy_dbd1 then do
+  //   {nlyr, llyr} = GetDBLayers(hwy_dbd)
+  //   ModifyRouteSystem(rts_file, {{""Geography"", hwy_dbd, llyr}})
+  // end
 
   // If the roadway file does not exist in the same folder as the rts_file,
   // use the original path returned by GetRouteSystemInfo()."
Triangle-Modeling-and-Analytics,TRMG2,388a16250561d69e3ec162841d63fe95ec6957f2,Kyle Ward,kyle@caliper.com,2021-10-06T15:14:39Z,Kyle Ward,kyle@caliper.com,2021-10-06T15:14:39Z,"Correct transit networks

My addition of the IVTT field to the mode table was done incorrectly
and led to incorrect walk times/distances. These changes correct
that.",master/networks/transit_mode_table.csv;src/02 - InitialProcessing.rsc;src/Skimming.rsc,False,False,False,False,17,10,27,"---FILE: master/networks/transit_mode_table.csv---
@@ -1,5 +1,5 @@
 Mode_Name,Mode_ID,Abbr,IVTT,DwellOn,DwellOff,net_defs,lb,eb,brt,cr,lr,all,description
-Non-Transit,1,nt,,0,0,.---->,1,1,1,1,1,1,The net_def fields specify
+Non-Transit,1,nt,WalkTime,0,0,.---->,1,1,1,1,1,1,The net_def fields specify
 Local Bus,2,lb,LBTime,0,0,.---->,2,1,1,1,1,1,1: mode is active in network
 Express Bus,3,eb,EBTime,0,0,.---->,,2,1,1,1,1,2: mode is required in the network
 Bus Rapid Transit,4,brt,FGTime,0.5,0.5,.---->,,,2,1,1,1,

---FILE: src/02 - InitialProcessing.rsc---
@@ -830,7 +830,7 @@ Macro ""Create Route Networks"" (Args)
 
     transit_modes = RunMacro(""Get Transit Modes"", TransModeTable)
     transit_modes = {""all""} + transit_modes
-
+    
     for period in periods do
         for transit_mode in transit_modes do
 
@@ -856,17 +856,22 @@ Macro ""Create Route Networks"" (Args)
                 o.AddLinkField({
                     Name: ""LBTime"",
                     TransitFields: {""AB"" + period + ""LBTime"", ""BA"" + period + ""LBTime""},
-                    NonTransitFields: {""WalkTime"", ""WalkTime""}
+                    NonTransitFields: ""WalkTime""
                 })
                 o.AddLinkField({
                     Name: ""EBTime"",
                     TransitFields: {""AB"" + period + ""EBTime"", ""BA"" + period + ""EBTime""},
-                    NonTransitFields: {""WalkTime"", ""WalkTime""}
+                    NonTransitFields: ""WalkTime""
                 })
                 o.AddLinkField({
                     Name: ""FGTime"",
                     TransitFields: {""AB"" + period + ""Time"", ""BA"" + period + ""Time""},
-                    NonTransitFields: {""WalkTime"", ""WalkTime""}
+                    NonTransitFields: ""WalkTime""
+                })
+                o.AddLinkField({
+                    Name: ""WalkTime"",
+                    TransitFields: ""WalkTime"",
+                    NonTransitFields: ""WalkTime""
                 })
                 o.AddStopField({Name: ""dwell_on"", Field: ""dwell_on""})
                 o.AddStopField({Name: ""dwell_off"", Field: ""dwell_off""})
@@ -893,11 +898,14 @@ Macro ""Create Route Networks"" (Args)
                 o.CentroidFilter = ""Centroid = 1""
                 // o.LinkImpedance = ""IVTT""
                 o.Parameters({
-                    MaxTripCost = 999,
+                    MaxTripCost = 240,
                     MaxTransfers = 4,
                     VOT = .1984 // $/min (40% of the median wage)
                 })
-                o.AccessControl({PermitWalkOnly: false})
+                o.AccessControl({
+                    PermitWalkOnly: false,
+                    MaxWalkAccessPaths: 10
+                })
                 o.Combination({CombinationFactor: .1})
                 o.StopTimeFields({
                     InitialPenalty: null,
@@ -916,7 +924,7 @@ Macro ""Create Route Networks"" (Args)
                     Layover: 5, 
                     MaxAccessWalk: 45,
                     MaxEgressWalk: 45,
-                    MaxModalTotal: 240
+                    MaxModalTotal: 120
                 })
                 o.RouteTimeFields({Headway: period + ""Headway""})
                 o.ModeTable({

---FILE: src/Skimming.rsc---
@@ -212,14 +212,13 @@ Macro ""Transit Skims"" (Args, overrides)
                     MatrixFile: out_file,
                     MatrixLabel : label, 
                     Compression: true, ColumnMajor: false
-                })   
+                })
                 obj.Run()
                 obj = null
 
                 // Flip to AP format in the PM period
                 if period = ""PM"" then do
                     label = label + "" transposed to AP""
-                    // TODO: replace this with new matrix object method
                     RunMacro(""Transpose Matrix"", out_file, label)
                 end
             end"
Triangle-Modeling-and-Analytics,TRMG2,bf21316bea7d66652b253c8008a6231bcdb4cc14,Kyle Ward,kyle@caliper.com,2021-09-30T16:27:08Z,Kyle Ward,kyle@caliper.com,2021-09-30T16:27:08Z,"Update transit network creation

These updates facilitate the inclusion of fixed guideways modes
in future year scenarios.",master/networks/transit_mode_table.csv;src/02 - InitialProcessing.rsc,False,False,False,False,49,58,107,"---FILE: master/networks/transit_mode_table.csv---
@@ -1,7 +1,7 @@
-Mode_Name,Mode_ID,Abbr,Impedance,net_defs,lb,eb,brt,cr,lr,description
-Non-Transit,1,nt,,.---->,1,1,1,1,1,The net_def fields specify
-Local Bus,2,lb,,.---->,2,1,1,1,1,1: mode is active in network
-Express Bus,3,eb,,.---->,,2,1,1,1,2: mode is required in the network
-Bus Rapid Transit,4,brt,,.---->,,,2,1,1,
-Commuter Rail,5,cr,,.---->,,,,2,1,
-Light Rail,6,lr,,.---->,,,,,2,
+Mode_Name,Mode_ID,Abbr,IVTT,DwellOn,DwellOff,net_defs,lb,eb,brt,cr,lr,all,description
+Non-Transit,1,nt,,0,0,.---->,1,1,1,1,1,1,The net_def fields specify
+Local Bus,2,lb,LBTime,0,0,.---->,2,1,1,1,1,1,1: mode is active in network
+Express Bus,3,eb,EBTime,0,0,.---->,,2,1,1,1,1,2: mode is required in the network
+Bus Rapid Transit,4,brt,FGTime,0.5,0.5,.---->,,,2,1,1,1,
+Commuter Rail,5,cr,FGTime,1,1,.---->,,,,2,1,1,
+Light Rail,6,lr,FGTime,0.5,0.5,.---->,,,,,2,1,

---FILE: src/02 - InitialProcessing.rsc---
@@ -4,16 +4,16 @@ Handle initial steps like capacity and speed calculations.
 
 Macro ""Initial Processing"" (Args)
     
-    created = RunMacro(""Is Scenario Created"", Args)
-    if !created then return(0)
-    RunMacro(""Create Output Copies"", Args)
-    RunMacro(""Determine Area Type"", Args)
-    RunMacro(""Capacity"", Args)
-    RunMacro(""Set CC Speeds"", Args)
-    RunMacro(""Other Attributes"", Args)
-    RunMacro(""Calculate Bus Speeds"", Args)
-    RunMacro(""Create Link Networks"", Args)
-    RunMacro(""Check Highway Networks"", Args)
+    // created = RunMacro(""Is Scenario Created"", Args)
+    // if !created then return(0)
+    // RunMacro(""Create Output Copies"", Args)
+    // RunMacro(""Determine Area Type"", Args)
+    // RunMacro(""Capacity"", Args)
+    // RunMacro(""Set CC Speeds"", Args)
+    // RunMacro(""Other Attributes"", Args)
+    // RunMacro(""Calculate Bus Speeds"", Args)
+    // RunMacro(""Create Link Networks"", Args)
+    // RunMacro(""Check Highway Networks"", Args)
     RunMacro(""Create Route Networks"", Args)
 
     return(1)
@@ -833,12 +833,6 @@ Macro ""Create Route Networks"" (Args)
     for period in periods do
         for transit_mode in transit_modes do
 
-            // Busses use the bus speed equations, but rail/brt will use
-            // auto times + stop dwell times.
-            if transit_mode = ""lb"" or transit_mode = ""eb"" 
-                then use_dwell = ""false""
-                else use_dwell = ""true""
-
             for access_mode in access_modes do
                 
                 // create transit network .tnw file
@@ -852,16 +846,25 @@ Macro ""Create Route Networks"" (Args)
                 o.WalkLinkFilter = ""W = 1""
                 o.AddRouteField({Name: period + ""Headway"", Field: period + ""Headway""})
                 o.AddRouteField({Name: ""Fare"", Field: ""Fare""})
-                if use_dwell then suffix = ""Time"" else suffix = Upper(transit_mode) + ""Time""
+                // Add IVTT fields for all modes regardless of which net is being built.
+                // The mode table and ModesUsedField will control which are allowed.
                 o.AddLinkField({
-                    Name: ""IVTT"", 
-                    TransitFields: {""AB"" + period + suffix, ""BA"" + period + suffix}, 
+                    Name: ""LBTime"",
+                    TransitFields: {""AB"" + period + ""LBTime"", ""BA"" + period + ""LBTime""},
                     NonTransitFields: {""WalkTime"", ""WalkTime""}
                 })
-                if use_dwell then do
-                    o.AddStopField({Name: ""dwell_on"", Field: ""dwell_on""})
-                    o.AddStopField({Name: ""dwell_off"", Field: ""dwell_off""})
-                end
+                o.AddLinkField({
+                    Name: ""EBTime"",
+                    TransitFields: {""AB"" + period + ""EBTime"", ""BA"" + period + ""EBTime""},
+                    NonTransitFields: {""WalkTime"", ""WalkTime""}
+                })
+                o.AddLinkField({
+                    Name: ""FGTime"",
+                    TransitFields: {""AB"" + period + ""Time"", ""BA"" + period + ""Time""},
+                    NonTransitFields: {""WalkTime"", ""WalkTime""}
+                })
+                o.AddStopField({Name: ""dwell_on"", Field: ""dwell_on""})
+                o.AddStopField({Name: ""dwell_off"", Field: ""dwell_off""})
                 o.AddStopField({Name: ""xfer_pen"", Field: ""xfer_pen""})
                 o.UseModes({
                     TransitModeField: ""Mode"",
@@ -883,20 +886,22 @@ Macro ""Create Route Networks"" (Args)
                 o = CreateObject(""Network.SetPublicPathFinder"", {RS: rts_file, NetworkName: file_name})
                 o.UserClasses = {""Class1""}
                 o.CentroidFilter = ""Centroid = 1""
-                o.LinkImpedance = ""IVTT""
+                // o.LinkImpedance = ""IVTT""
                 o.Parameters({
                     MaxTripCost = 999,
                     MaxTransfers = 4,
                     VOT = .1984 // $/min (40% of the median wage)
                 })
                 o.AccessControl({PermitWalkOnly: false})
                 o.Combination({CombinationFactor: .1})
-                stop_time_opts = {
+                o.StopTimeFields({
                     InitialPenalty: null,
-                    TransferPenalty: ""xfer_pen""
-                }
-                time_global_opts = {
-                    Headway: 14,
+                    TransferPenalty: ""xfer_pen"",
+                    DwellOn: ""dwell_on"",
+                    DwellOff: ""dwell_off""
+                })
+                o.TimeGlobals({
+                    // Headway: 14,
                     InitialPenalty: 0,
                     TransferPenalty: 3,
                     MaxInitialWait: 20,
@@ -907,30 +912,14 @@ Macro ""Create Route Networks"" (Args)
                     MaxAccessWalk: 45,
                     MaxEgressWalk: 45,
                     MaxModalTotal: 240
-                }
-                if use_dwell then do
-                    stop_time_opts = stop_time_opts + {
-                        DwellOn: ""dwell_on"",
-                        DwellOff: ""dwell_off""
-                    }
-                    if transit_mode = ""brt""
-                        then dwell_time = 1 // 1 minute stop time brt assumption
-                        else dwell_time = 5 // 5 minute stop time rail assumption
-                    time_global_opts = time_global_opts + {
-                        DwellOn: dwell_time / 2,
-                        DwellOff: dwell_time / 2
-                    }
-                end else do
-                    time_global_opts = time_global_opts + {
-                        DwellOn: 0,
-                        DwellOff: 0
-                    }
-                end
-                o.StopTimeFields(stop_time_opts)
-                o.TimeGlobals(time_global_opts)
+                })
                 o.RouteTimeFields({Headway: period + ""Headway""})
                 o.ModeTable({
                     TableName: TransModeTable,
+                    // A field in the mode table that contains a list of
+                    // link network field names. These network field names
+                    // in turn point to the AB/BA fields on the link layer.
+                    TimeByMode: ""IVTT"",
                     ModesUsedField: transit_mode,
                     OnlyCombineSameMode: true,
                     FreeTransfers: 0
@@ -958,7 +947,9 @@ Macro ""Create Route Networks"" (Args)
                 o.Fare({
                     Type: ""Flat"",
                     RouteFareField: ""Fare"",
-                    RouteXFareField: ""Fare""
+                    RouteXFareField: ""Fare"",
+                    FareValue: 0,
+                    TransferFareValue: 0
                 })
 
                 // Drive attributes for network settings"
Triangle-Modeling-and-Analytics,TRMG2,e203766ceb7b6325fd3ff8c9ea01c8079a875a05,Kyle Ward,kyle@caliper.com,2021-09-30T15:02:20Z,Kyle Ward,kyle@caliper.com,2021-09-30T15:02:20Z,"Update master transit dwell fields

Transit settings for dwell time are being simplified in the script,
which required clearing out all values in the dwell_on and dwell_off
fields. Also updated descriptions (see issue #108 for details).",master/networks/master_routes.rts;master/networks/master_routesS.DCB;master/networks/master_routesS.bin,False,False,False,False,2,2,4,"---FILE: master/networks/master_routesS.DCB---
@@ -2,6 +2,6 @@
 32
 ""STOP_ID"",I,1,4,0,9,0,,"""","""",,""Sum"",
 ""shape_stop"",I,5,4,0,8,0,,"""",""These are stops used to improve the transit project|manager, but are then removed so that boarding/|alighting is not possible."",,""Sum"",
-""dwell_on"",R,9,8,0,8,2,,"""",""Dwell time for people boardings (minutes)|.25 by default. Use this field to override."",,""Sum"",
-""dwell_off"",R,17,8,0,8,2,,"""",""Dwell time for people alighting (minutes)|.25 by default. Use this field to override."",,""Sum"",
+""dwell_on"",R,9,8,0,8,2,,"""",""Dwell time for people boardings (minutes)|Defaults are set in the transit mode table:|Bus: 0 minutes|Rail/BRT: .5 minutes|Use this field to override those defaults"",,""Sum"",
+""dwell_off"",R,17,8,0,8,2,,"""",""Dwell time for people alighting (minutes)|Defaults are set in the transit mode table:|Bus: 0 minutes|Rail/BRT: .5 minutes|Use this field to override those defaults"",,""Sum"",
 ""xfer_pen"",R,25,8,0,10,2,,"""",""Specifies the transfer penalty (in minutes) for the stop.|If null, the global penalty is used (currently 3 minutes).|If filled in, this is used instead. Use this to lower the transfer|penalty for major bus stops and transit centers where transfers|are scheduled to be shorter."",,""Sum"","
Triangle-Modeling-and-Analytics,TRMG2,702565e7884220f19e9f7c21a68cb2fe0572574e,Ashish Kulshrestha,ashish.kulshrestha@wsp.com,2021-09-29T20:47:15Z,Ashish Kulshrestha,ashish.kulshrestha@wsp.com,2021-09-29T20:47:15Z,bug fix for ieei productions,src/External Models.rsc,False,False,False,False,6,6,12,"---FILE: src/External Models.rsc---
@@ -256,13 +256,13 @@ Macro ""IEEI Productions"" (Args)
     {OptArray: TRUE}
   )
   
-  ieei_auto_prod_freeway = if data.Freeway_Stations = 1 then Nz(data.AWDT) * (Nz(data.PCT_AUTO_IEEI)/100) / 2 else 0
-  ieei_cvsut_prod_freeway = if data.Freeway_Stations = 1 then Nz(data.AWDT) * (Nz(data.PCT_CVSUT_IEEI)/100) / 2 else 0
-  ieei_cvmut_prod_freeway = if data.Freeway_Stations = 1 then Nz(data.AWDT) * (Nz(data.PCT_CVMUT_IEEI)/100) / 2 else 0
+  ieei_auto_prod_freeway = if data.Freeway_Stations = 1 then Nz(data.AWDT) * (Nz(data.PCT_AUTO_IEEI)/100) else 0
+  ieei_cvsut_prod_freeway = if data.Freeway_Stations = 1 then Nz(data.AWDT) * (Nz(data.PCT_CVSUT_IEEI)/100) else 0
+  ieei_cvmut_prod_freeway = if data.Freeway_Stations = 1 then Nz(data.AWDT) * (Nz(data.PCT_CVMUT_IEEI)/100) else 0
   
-  ieei_auto_prod_nonfreeway = if data.Freeway_Stations = 1 then 0 else Nz(data.AWDT) * (Nz(data.PCT_AUTO_IEEI)/100) / 2
-  ieei_cvsut_prod_nonfreeway = if data.Freeway_Stations = 1 then 0 else Nz(data.AWDT) * (Nz(data.PCT_CVSUT_IEEI)/100) / 2
-  ieei_cvmut_prod_nonfreeway = if data.Freeway_Stations = 1 then 0 else Nz(data.AWDT) * (Nz(data.PCT_CVMUT_IEEI)/100) / 2
+  ieei_auto_prod_nonfreeway = if data.Freeway_Stations = 1 then 0 else Nz(data.AWDT) * (Nz(data.PCT_AUTO_IEEI)/100)
+  ieei_cvsut_prod_nonfreeway = if data.Freeway_Stations = 1 then 0 else Nz(data.AWDT) * (Nz(data.PCT_CVSUT_IEEI)/100)
+  ieei_cvmut_prod_nonfreeway = if data.Freeway_Stations = 1 then 0 else Nz(data.AWDT) * (Nz(data.PCT_CVMUT_IEEI)/100)
 
   a_fields = {
     {""IEEI_AUTO_PROD_FREEWAY"", ""Real"", 10, 2, , , , ""ieei auto productions for freeway stations""},"
Triangle-Modeling-and-Analytics,TRMG2,2e746df8362181b00f71c84f6750278447c65cb5,Kyle Ward,kyle@caliper.com,2021-09-17T20:27:05Z,Kyle Ward,kyle@caliper.com,2021-09-17T20:27:05Z,Correct error in nhb generation script,src/NHB Models.rsc,False,False,False,False,2,2,4,"---FILE: src/NHB Models.rsc---
@@ -76,14 +76,14 @@ Macro ""NHB Generation"" (Args)
                     coef = params.(param)
 
                     {hb_trip_type, hb_mode} = RunMacro(""Separate type and mode"", param)
-                    if mode = ""walkbike"" then do
+                    if hb_mode = ""walkbike"" then do
                         hb_mtx_file = out_dir + ""/resident/nonmotorized/nm_gravity.mtx""
                         hb_core = hb_trip_type + ""_"" + period
                     end else do
                         hb_mtx_file = trip_dir + ""/pa_per_trips_"" + hb_trip_type + ""_"" + period + "".mtx""
                         hb_core = hb_mode
                     end
-                    if mode = ""t"" then hb_core = ""all_transit""
+                    if hb_mode = ""lb"" then hb_core = ""all_transit""
                     hb_mtx = CreateObject(""Matrix"", hb_mtx_file)
                     v = hb_mtx.GetVector(hb_core, {Marginal: ""Column Sum""})
                     v.rowbased = ""true"""
Triangle-Modeling-and-Analytics,TRMG2,7df013ddb6f36c54439b3a802760a5f0a7fc3564,Kyle Ward,kyle@caliper.com,2021-09-17T20:24:45Z,Kyle Ward,kyle@caliper.com,2021-09-17T20:26:57Z,"Remove any reference to W_HB_EK12_All_sov in NHB generation

W_HB_EK12_All does not include sov trips by definition. They did
show up in the survey (in small number) due to respondent error.",docs/data/output/nhb/W_NH_EK12_All_hov2.csv;docs/data/output/nhb/W_NH_O_All_sov.csv;docs/data/output/nhb/W_NH_WR_All_sov.csv;docs/nhb.Rmd;master/resident/nhb/generation/W_NH_EK12_All_hov2.csv;master/resident/nhb/generation/W_NH_O_All_sov.csv;master/resident/nhb/generation/W_NH_WR_All_sov.csv,True,False,True,False,44,53,97,"---FILE: docs/data/output/nhb/W_NH_EK12_All_hov2.csv---
@@ -1,9 +1,8 @@
 term,estimated_as,estimate,std.error,statistic,p.value
-W_HB_O_All_hov2,W_HB_O_All_auto,0.03416091677321911,0.004319831775780781,7.90792756438872,0
-W_HB_O_All_hov3,W_HB_O_All_auto,0.03416091677321911,0.004319831775780781,7.90792756438872,0
-W_HB_O_All_sov,W_HB_O_All_auto,0.03416091677321911,0.004319831775780781,7.90792756438872,0
-W_HB_EK12_All_hov2,W_HB_EK12_All_hov,0.24489303866767134,0.008387691969029316,29.196713419128113,0
-W_HB_EK12_All_hov3,W_HB_EK12_All_hov,0.24489303866767134,0.008387691969029316,29.196713419128113,0
-W_HB_EK12_All_sov,W_HB_EK12_All_sov,0.5120539173766778,0.06496152028454724,7.882418932527399,0
-W_HB_O_All_walkbike,W_HB_O_All_walkbike,0.057842864439836314,0.01947941354560491,2.969435620041408,0.003
-r_sq,NA,0.14791267561362542,NA,NA,NA
+W_HB_O_All_hov2,W_HB_O_All_auto,0.034967785965200546,0.004349618557875219,8.039276433076985,0
+W_HB_O_All_hov3,W_HB_O_All_auto,0.034967785965200546,0.004349618557875219,8.039276433076985,0
+W_HB_O_All_sov,W_HB_O_All_auto,0.034967785965200546,0.004349618557875219,8.039276433076985,0
+W_HB_EK12_All_hov2,W_HB_EK12_All_hov,0.24635336901121166,0.008445839238944855,29.168607410290793,0
+W_HB_EK12_All_hov3,W_HB_EK12_All_hov,0.24635336901121166,0.008445839238944855,29.168607410290793,0
+W_HB_O_All_walkbike,W_HB_O_All_walkbike,0.0578241910677958,0.019619239833647283,2.947320668797089,0.00322
+r_sq,NA,0.1526260952129465,NA,NA,NA

---FILE: docs/data/output/nhb/W_NH_O_All_sov.csv---
@@ -1,8 +1,7 @@
 term,estimated_as,estimate,std.error,statistic,p.value
-W_HB_EK12_All_hov2,W_HB_EK12_All_auto,0.22982863221272665,0.03814202954234356,6.025600498200581,0
-W_HB_EK12_All_hov3,W_HB_EK12_All_auto,0.22982863221272665,0.03814202954234356,6.025600498200581,0
-W_HB_EK12_All_sov,W_HB_EK12_All_auto,0.22982863221272665,0.03814202954234356,6.025600498200581,0
-W_HB_O_All_hov2,W_HB_O_All_hov,0.9202861575239843,0.03788886694141896,24.289091540976,0
-W_HB_O_All_hov3,W_HB_O_All_hov,0.9202861575239843,0.03788886694141896,24.289091540976,0
-W_HB_O_All_sov,W_HB_O_All_sov,1.385025624523912,0.023947786022802578,57.83522632134427,0
-r_sq,NA,0.4545723385637268,NA,NA,NA
+W_HB_EK12_All_hov2,W_HB_EK12_All_auto,0.2442785202325368,0.03856190072447436,6.334711610247438,0
+W_HB_EK12_All_hov3,W_HB_EK12_All_auto,0.2442785202325368,0.03856190072447436,6.334711610247438,0
+W_HB_O_All_hov2,W_HB_O_All_hov,0.9183437331327238,0.03788063454839853,24.24309265356666,0
+W_HB_O_All_hov3,W_HB_O_All_hov,0.9183437331327238,0.03788063454839853,24.24309265356666,0
+W_HB_O_All_sov,W_HB_O_All_sov,1.385407205116118,0.023934893152990154,57.88232252639243,0
+r_sq,NA,0.4549367543722849,NA,NA,NA

---FILE: docs/data/output/nhb/W_NH_WR_All_sov.csv---
@@ -1,11 +1,10 @@
 term,estimated_as,estimate,std.error,statistic,p.value
-W_HB_EK12_All_hov2,W_HB_EK12_All_auto,0.09361543851150765,0.015005156895445387,6.238884349148216,0
-W_HB_EK12_All_hov3,W_HB_EK12_All_auto,0.09361543851150765,0.015005156895445387,6.238884349148216,0
-W_HB_EK12_All_sov,W_HB_EK12_All_auto,0.09361543851150765,0.015005156895445387,6.238884349148216,0
-W_HB_O_All_hov2,W_HB_O_All_auto,0.07716859488530994,0.00808693040271684,9.542383950699614,0
-W_HB_O_All_hov3,W_HB_O_All_auto,0.07716859488530994,0.00808693040271684,9.542383950699614,0
-W_HB_O_All_sov,W_HB_O_All_auto,0.07716859488530994,0.00808693040271684,9.542383950699614,0
-W_HB_W_All_hov2,W_HB_W_All_auto,0.018575916588543157,0.005889219502456505,3.1542238459264067,0.00162
-W_HB_W_All_hov3,W_HB_W_All_auto,0.018575916588543157,0.005889219502456505,3.1542238459264067,0.00162
-W_HB_W_All_sov,W_HB_W_All_auto,0.018575916588543157,0.005889219502456505,3.1542238459264067,0.00162
-r_sq,NA,0.5200417565200125,NA,NA,NA
+W_HB_EK12_All_hov2,W_HB_EK12_All_auto,0.09625325345399562,0.015170375342798746,6.344816873610596,0
+W_HB_EK12_All_hov3,W_HB_EK12_All_auto,0.09625325345399562,0.015170375342798746,6.344816873610596,0
+W_HB_O_All_hov2,W_HB_O_All_auto,0.07722412120687236,0.008083980843442376,9.552734315237226,0
+W_HB_O_All_hov3,W_HB_O_All_auto,0.07722412120687236,0.008083980843442376,9.552734315237226,0
+W_HB_O_All_sov,W_HB_O_All_auto,0.07722412120687236,0.008083980843442376,9.552734315237226,0
+W_HB_W_All_hov2,W_HB_W_All_auto,0.01850925403943395,0.005888550007437046,3.143261756469312,0.00168
+W_HB_W_All_hov3,W_HB_W_All_auto,0.01850925403943395,0.005888550007437046,3.143261756469312,0.00168
+W_HB_W_All_sov,W_HB_W_All_auto,0.01850925403943395,0.005888550007437046,3.143261756469312,0.00168
+r_sq,NA,0.5170853310349969,NA,NA,NA

---FILE: docs/nhb.Rmd---
@@ -174,7 +174,6 @@ equiv <- list(
 dependent_vars <- c(
   ""W_HB_O_All_auto"",
   ""W_HB_EK12_All_hov"",
-  ""W_HB_EK12_All_sov"",
   ""W_HB_O_All_walkbike""
 )
 
@@ -302,7 +301,6 @@ type <- ""W_NH_WR_All_sov""
 equiv <- list(
   ""W_HB_EK12_All_hov2"" = ""W_HB_EK12_All_auto"",
   ""W_HB_EK12_All_hov3"" = ""W_HB_EK12_All_auto"",
-  ""W_HB_EK12_All_sov"" = ""W_HB_EK12_All_auto"",
   ""W_HB_W_All_hov2"" = ""W_HB_W_All_auto"",
   ""W_HB_W_All_hov3"" = ""W_HB_W_All_auto"",
   ""W_HB_W_All_sov"" = ""W_HB_W_All_auto"",
@@ -509,7 +507,6 @@ type <- ""W_NH_O_All_sov""
 equiv <- list(
   ""W_HB_EK12_All_hov2"" = ""W_HB_EK12_All_auto"",
   ""W_HB_EK12_All_hov3"" = ""W_HB_EK12_All_auto"",
-  ""W_HB_EK12_All_sov"" = ""W_HB_EK12_All_auto"",
   ""W_HB_O_All_hov2"" = ""W_HB_O_All_hov"",
   ""W_HB_O_All_hov3"" = ""W_HB_O_All_hov""
 )

---FILE: master/resident/nhb/generation/W_NH_EK12_All_hov2.csv---
@@ -1,9 +1,8 @@
 term,estimated_as,estimate,std.error,statistic,p.value
-W_HB_O_All_hov2,W_HB_O_All_auto,0.03416091677321911,0.004319831775780781,7.90792756438872,0
-W_HB_O_All_hov3,W_HB_O_All_auto,0.03416091677321911,0.004319831775780781,7.90792756438872,0
-W_HB_O_All_sov,W_HB_O_All_auto,0.03416091677321911,0.004319831775780781,7.90792756438872,0
-W_HB_EK12_All_hov2,W_HB_EK12_All_hov,0.24489303866767134,0.008387691969029316,29.196713419128113,0
-W_HB_EK12_All_hov3,W_HB_EK12_All_hov,0.24489303866767134,0.008387691969029316,29.196713419128113,0
-W_HB_EK12_All_sov,W_HB_EK12_All_sov,0.5120539173766778,0.06496152028454724,7.882418932527399,0
-W_HB_O_All_walkbike,W_HB_O_All_walkbike,0.057842864439836314,0.01947941354560491,2.969435620041408,0.003
-r_sq,NA,0.14791267561362542,NA,NA,NA
+W_HB_O_All_hov2,W_HB_O_All_auto,0.034967785965200546,0.004349618557875219,8.039276433076985,0
+W_HB_O_All_hov3,W_HB_O_All_auto,0.034967785965200546,0.004349618557875219,8.039276433076985,0
+W_HB_O_All_sov,W_HB_O_All_auto,0.034967785965200546,0.004349618557875219,8.039276433076985,0
+W_HB_EK12_All_hov2,W_HB_EK12_All_hov,0.24635336901121166,0.008445839238944855,29.168607410290793,0
+W_HB_EK12_All_hov3,W_HB_EK12_All_hov,0.24635336901121166,0.008445839238944855,29.168607410290793,0
+W_HB_O_All_walkbike,W_HB_O_All_walkbike,0.0578241910677958,0.019619239833647283,2.947320668797089,0.00322
+r_sq,NA,0.1526260952129465,NA,NA,NA

---FILE: master/resident/nhb/generation/W_NH_O_All_sov.csv---
@@ -1,8 +1,7 @@
 term,estimated_as,estimate,std.error,statistic,p.value
-W_HB_EK12_All_hov2,W_HB_EK12_All_auto,0.22982863221272665,0.03814202954234356,6.025600498200581,0
-W_HB_EK12_All_hov3,W_HB_EK12_All_auto,0.22982863221272665,0.03814202954234356,6.025600498200581,0
-W_HB_EK12_All_sov,W_HB_EK12_All_auto,0.22982863221272665,0.03814202954234356,6.025600498200581,0
-W_HB_O_All_hov2,W_HB_O_All_hov,0.9202861575239843,0.03788886694141896,24.289091540976,0
-W_HB_O_All_hov3,W_HB_O_All_hov,0.9202861575239843,0.03788886694141896,24.289091540976,0
-W_HB_O_All_sov,W_HB_O_All_sov,1.385025624523912,0.023947786022802578,57.83522632134427,0
-r_sq,NA,0.4545723385637268,NA,NA,NA
+W_HB_EK12_All_hov2,W_HB_EK12_All_auto,0.2442785202325368,0.03856190072447436,6.334711610247438,0
+W_HB_EK12_All_hov3,W_HB_EK12_All_auto,0.2442785202325368,0.03856190072447436,6.334711610247438,0
+W_HB_O_All_hov2,W_HB_O_All_hov,0.9183437331327238,0.03788063454839853,24.24309265356666,0
+W_HB_O_All_hov3,W_HB_O_All_hov,0.9183437331327238,0.03788063454839853,24.24309265356666,0
+W_HB_O_All_sov,W_HB_O_All_sov,1.385407205116118,0.023934893152990154,57.88232252639243,0
+r_sq,NA,0.4549367543722849,NA,NA,NA

---FILE: master/resident/nhb/generation/W_NH_WR_All_sov.csv---
@@ -1,11 +1,10 @@
 term,estimated_as,estimate,std.error,statistic,p.value
-W_HB_EK12_All_hov2,W_HB_EK12_All_auto,0.09361543851150765,0.015005156895445387,6.238884349148216,0
-W_HB_EK12_All_hov3,W_HB_EK12_All_auto,0.09361543851150765,0.015005156895445387,6.238884349148216,0
-W_HB_EK12_All_sov,W_HB_EK12_All_auto,0.09361543851150765,0.015005156895445387,6.238884349148216,0
-W_HB_O_All_hov2,W_HB_O_All_auto,0.07716859488530994,0.00808693040271684,9.542383950699614,0
-W_HB_O_All_hov3,W_HB_O_All_auto,0.07716859488530994,0.00808693040271684,9.542383950699614,0
-W_HB_O_All_sov,W_HB_O_All_auto,0.07716859488530994,0.00808693040271684,9.542383950699614,0
-W_HB_W_All_hov2,W_HB_W_All_auto,0.018575916588543157,0.005889219502456505,3.1542238459264067,0.00162
-W_HB_W_All_hov3,W_HB_W_All_auto,0.018575916588543157,0.005889219502456505,3.1542238459264067,0.00162
-W_HB_W_All_sov,W_HB_W_All_auto,0.018575916588543157,0.005889219502456505,3.1542238459264067,0.00162
-r_sq,NA,0.5200417565200125,NA,NA,NA
+W_HB_EK12_All_hov2,W_HB_EK12_All_auto,0.09625325345399562,0.015170375342798746,6.344816873610596,0
+W_HB_EK12_All_hov3,W_HB_EK12_All_auto,0.09625325345399562,0.015170375342798746,6.344816873610596,0
+W_HB_O_All_hov2,W_HB_O_All_auto,0.07722412120687236,0.008083980843442376,9.552734315237226,0
+W_HB_O_All_hov3,W_HB_O_All_auto,0.07722412120687236,0.008083980843442376,9.552734315237226,0
+W_HB_O_All_sov,W_HB_O_All_auto,0.07722412120687236,0.008083980843442376,9.552734315237226,0
+W_HB_W_All_hov2,W_HB_W_All_auto,0.01850925403943395,0.005888550007437046,3.143261756469312,0.00168
+W_HB_W_All_hov3,W_HB_W_All_auto,0.01850925403943395,0.005888550007437046,3.143261756469312,0.00168
+W_HB_W_All_sov,W_HB_W_All_auto,0.01850925403943395,0.005888550007437046,3.143261756469312,0.00168
+r_sq,NA,0.5170853310349969,NA,NA,NA"
Triangle-Modeling-and-Analytics,TRMG2,fdc40edf920a5ccad50902ceeb93dc93f92ac9f9,Kyle Ward,kyle@caliper.com,2021-09-17T02:49:28Z,Kyle Ward,kyle@caliper.com,2021-09-17T02:49:28Z,"Update TOD based on previous commit changes

Factor changes are relatively minor. I did find and fix several issues with
the HTML, though.",docs/data/output/tod/directionality_factors.csv;docs/data/output/tod/hov3_occ_factors.csv;docs/data/output/tod/other_shares.csv;docs/data/output/tod/period_capacity_factors.csv;docs/data/output/tod/time_of_day_factors.csv;docs/survey_processing_files/figure-html/unnamed-chunk-12-1.png;docs/time_of_day.Rmd;docs/time_of_day.html;master/networks/capacity_period_factors.csv;master/networks/period_capacity_factors.csv;master/resident/tod/directionality_factors.csv;master/resident/tod/hov3_occ_factors.csv;master/resident/tod/other_shares.csv;master/resident/tod/time_of_day_factors.csv,True,False,True,False,200,565,765,"---FILE: docs/data/output/tod/directionality_factors.csv---
@@ -2,32 +2,32 @@ trip_type,tod,pa_fac
 N_HB_K12_All,AM,0.8679429726517056
 N_HB_K12_All,MD,0.2560963734052302
 N_HB_K12_All,PM,0.19006895911145505
-N_HB_K12_All,NT,0.8172068570658283
-N_HB_OD_Long,AM,0.8432101247109498
-N_HB_OD_Long,MD,0.5643113661908536
-N_HB_OD_Long,PM,0.49832393319828333
-N_HB_OD_Long,NT,0.3720938252820547
+N_HB_K12_All,NT,0.8139969734538841
+N_HB_OD_Long,AM,0.842579904768488
+N_HB_OD_Long,MD,0.5620554727908423
+N_HB_OD_Long,PM,0.49833056723329605
+N_HB_OD_Long,NT,0.3699238807057316
 N_HB_OD_Short,AM,0.6492347849663067
-N_HB_OD_Short,MD,0.5477052753379956
+N_HB_OD_Short,MD,0.5486245073918471
 N_HB_OD_Short,PM,0.45300731976153563
-N_HB_OD_Short,NT,0.4516154599819663
-N_HB_OME_All,AM,0.6805388972365517
-N_HB_OME_All,MD,0.4669667276266846
-N_HB_OME_All,PM,0.44786557676112976
+N_HB_OD_Short,NT,0.44847589654473424
+N_HB_OME_All,AM,0.681127507364529
+N_HB_OME_All,MD,0.4669295256541704
+N_HB_OME_All,PM,0.4503328138778361
 N_HB_OME_All,NT,0.3231616880594509
-N_HB_OMED_All,AM,0.9158512357615005
-N_HB_OMED_All,MD,0.5993941149671077
-N_HB_OMED_All,PM,0.3169392247982402
+N_HB_OMED_All,AM,0.9139447697080656
+N_HB_OMED_All,MD,0.6013451821187071
+N_HB_OMED_All,PM,0.32498852882397755
 N_HB_OMED_All,NT,0.4209188279020048
 W_HB_EK12_All,AM,0.9843770251365579
 W_HB_EK12_All,MD,0.30978702521587975
 W_HB_EK12_All,PM,0.004246387128185591
 W_HB_EK12_All,NT,0.8361625825872685
 W_HB_O_All,AM,0.9969099965671543
 W_HB_O_All,MD,0.46657778982051235
-W_HB_O_All,PM,0.016895238491146585
-W_HB_O_All,NT,0.20381325139805676
-W_HB_W_All,AM,0.9960808281050005
+W_HB_O_All,PM,0.016914299741352473
+W_HB_O_All,NT,0.20483086136461387
+W_HB_W_All,AM,0.996073972295845
 W_HB_W_All,MD,0.6227906258910493
 W_HB_W_All,PM,0.06646751668078169
-W_HB_W_All,NT,0.6392112153475571
+W_HB_W_All,NT,0.6376292561712676

---FILE: docs/data/output/tod/hov3_occ_factors.csv---
@@ -47,11 +47,11 @@ W_NH_EK12_All,AM,3.21
 W_NH_EK12_All,MD,3.21
 W_NH_EK12_All,NT,3.21
 W_NH_EK12_All,PM,3.21
-W_NH_O_All,AM,3.237
+W_NH_O_All,AM,3.295
 W_NH_O_All,MD,3.237
-W_NH_O_All,NT,3.237
-W_NH_O_All,PM,3.195
-W_NH_WR_All,AM,3.526
-W_NH_WR_All,MD,3.423
-W_NH_WR_All,NT,3.526
-W_NH_WR_All,PM,3.338
+W_NH_O_All,NT,3.295
+W_NH_O_All,PM,3.175
+W_NH_WR_All,AM,3.85
+W_NH_WR_All,MD,3.85
+W_NH_WR_All,NT,3.85
+W_NH_WR_All,PM,3.85

---FILE: docs/data/output/tod/other_shares.csv---
@@ -11,5 +11,5 @@ W_HB_EK12_All,1,0,0
 W_HB_O_All,0.2791853971390368,0.19313261847796698,0.5276819843829963
 W_HB_W_All,0.2799257495859344,0.2455556694086407,0.4745185810054248
 W_NH_EK12_All,1,0,0
-W_NH_O_All,0.5322134763042827,0.3085093656217968,0.1592771580739205
-W_NH_WR_All,0.30278654977279984,0.25257229984786556,0.44464115037933455
+W_NH_O_All,0.3587204938108612,0.3071742940327908,0.3341052121563479
+W_NH_WR_All,0.24377364893280126,0.1351258485877058,0.621100502479493

---FILE: docs/data/output/tod/period_capacity_factors.csv---
@@ -1,5 +0,0 @@
-TOD,Value,Description
-AM,1.866,Hours of capacity in AM period
-MD,4.879,Hours of capacity in MD period
-PM,2.572,Hours of capacity in PM period
-NT,3.137,Hours of capacity in NT period

---FILE: docs/data/output/tod/time_of_day_factors.csv---
@@ -1,32 +1,32 @@
 trip_type,tod,factor,Description
-N_HB_K12_All,AM,0.395,Used to split daily resident productions
+N_HB_K12_All,AM,0.396,Used to split daily resident productions
 N_HB_K12_All,MD,0.251,into period-specific values
-N_HB_K12_All,NT,0.139,
+N_HB_K12_All,NT,0.138,
 N_HB_K12_All,PM,0.215,
-N_HB_OD_Long,AM,0.105,
-N_HB_OD_Long,MD,0.302,
-N_HB_OD_Long,NT,0.346,
-N_HB_OD_Long,PM,0.247,
-N_HB_OD_Short,AM,0.151,
+N_HB_OD_Long,AM,0.106,
+N_HB_OD_Long,MD,0.303,
+N_HB_OD_Long,NT,0.34199999999999997,
+N_HB_OD_Long,PM,0.249,
+N_HB_OD_Short,AM,0.152,
 N_HB_OD_Short,MD,0.302,
-N_HB_OD_Short,NT,0.268,
-N_HB_OD_Short,PM,0.279,
+N_HB_OD_Short,NT,0.266,
+N_HB_OD_Short,PM,0.28,
 N_HB_OME_All,AM,0.038,
 N_HB_OME_All,MD,0.473,
 N_HB_OME_All,NT,0.26,
 N_HB_OME_All,PM,0.229,
-N_HB_OMED_All,AM,0.154,
-N_HB_OMED_All,MD,0.608,
+N_HB_OMED_All,AM,0.155,
+N_HB_OMED_All,MD,0.607,
 N_HB_OMED_All,NT,0.06500000000000006,
 N_HB_OMED_All,PM,0.173,
 W_HB_EK12_All,AM,0.531,
 W_HB_EK12_All,MD,0.062,
 W_HB_EK12_All,NT,0.14300000000000002,
 W_HB_EK12_All,PM,0.264,
 W_HB_O_All,AM,0.154,
-W_HB_O_All,MD,0.151,
-W_HB_O_All,NT,0.395,
-W_HB_O_All,PM,0.3,
+W_HB_O_All,MD,0.152,
+W_HB_O_All,NT,0.393,
+W_HB_O_All,PM,0.301,
 W_HB_W_All,AM,0.288,
 W_HB_W_All,MD,0.193,
 W_HB_W_All,NT,0.2370000000000001,

---FILE: docs/time_of_day.Rmd---
@@ -572,7 +572,7 @@ skim_facs %>%
 ```
 
 
-# Vehicle occupancy factors {.tabset}
+# Vehicle occupancy factors
 In addition to applying directionality factors before assignment, the person 
 trip matrices are converted to vehicles using occupancy factors. These factors
 are calculated from the household survey, which includes information on the
@@ -584,9 +584,7 @@ used are defined as follows:
 - HOV3: 3+ person occupancy
 
 Vehicle occupancy for SOV and HOV2 modes are 1.0 and 2.0, respectively. The
-factors for HOV3, auto pay, and other auto are shown below. The chart provides
-a visual example for two trip types, while the following tables provide all
-the factors.
+factors for HOV3 are shown below.
 
 ```{r calculate veh occ factors}
 hov3_tbl <- tripTbl %>%
@@ -648,6 +646,7 @@ temp <- tripTbl %>%
   select(trip_type, tod, mode_final, mode2, party_size, weight = trip_weight_combined)
 
 oth_shares <- temp %>%
+  mutate(mode2 = factor(mode2, levels = c(""sov"", ""hov2"", ""hov3""), ordered = TRUE)) %>%
   group_by(trip_type, mode2) %>%
   summarize(weight = sum(weight)) %>%
   mutate(pct = weight / sum(weight)) %>%
@@ -656,39 +655,14 @@ oth_shares <- temp %>%
   replace_na(list(""sov"" = 0, ""hov2"" = 0, ""hov3"" = 0))
 ```
 
-```{r, fig.align=""center""}
-to_plot <- final_occ %>%
-  pivot_longer(hov3:other_auto, names_to = ""mode"", values_to = ""occ"") %>%
-  filter(trip_type %in% c(""N_HB_K12_All"", ""N_HB_OD_Long"")) %>%
-  mutate(
-    tod = factor(tod, levels = c(""AM"", ""MD"", ""PM"", ""NT""), ordered = TRUE),
-    mode = factor(mode, levels = c(""hov3"", ""other_auto"", ""auto_pay""), ordered = TRUE)
-  ) %>%
-  arrange(trip_type, tod, mode)
-
-ggplot(to_plot, aes(x = tod, y = occ, color = mode, group = mode)) +
-  geom_line() +
-  geom_point() +
-  facet_wrap(~trip_type) +
-  labs(
-    title = ""Occupancy by Time of Day and Mode"",
-    x = ""Time Period"",
-    y = ""Occupancy""
-  ) +
-  theme(plot.title = element_text(hjust = 0.5))
-```
-
-
-## HOV3
-
 ```{r}
-display_tbl <- final_occ %>%
+display_tbl <- hov3_tbl %>%
+  mutate(tod = factor(tod, levels = c(""AM"", ""MD"", ""PM"", ""NT""), ordered = TRUE)) %>%
+  arrange(trip_type, tod) %>%
   rename(
     `Trip Type` = trip_type,
     Period = tod,
-    HOV3 = hov3,
-    `Auto Pay` = auto_pay,
-    `Other Auto` = other_auto
+    HOV3 = hov3
   )
 
 display_tbl %>%
@@ -698,25 +672,16 @@ display_tbl %>%
   kable_styling(full_width = FALSE)
 ```
 
-## Auto Pay
+For Auto Pay and Other Auto modes, shares of sov, hov2, and hov3 were calculated.
+The model uses these to convert these modes into their respective assignment
+classes before highway assignment.
 
 ```{r}
-display_tbl %>%
-  select(`Trip Type`, Period, `Auto Pay`) %>%
-  pivot_wider(names_from = Period, values_from = `Auto Pay`) %>%
-  kable() %>%
+oth_shares %>%
+  kable(digits = 3) %>%
   kable_styling(full_width = FALSE)
 ```
 
-## Other Auto
-
-```{r}
-display_tbl %>%
-  select(`Trip Type`, Period, `Other Auto`) %>%
-  pivot_wider(names_from = Period, values_from = `Other Auto`) %>%
-  kable() %>%
-  kable_styling(full_width = FALSE)
-```
 
 
 # Period capacity factors
@@ -931,6 +896,6 @@ write_csv(
       Description = paste(""Hours of capacity in"", TOD, ""period"", sep = "" ""),
       Value = round(Value, 3)
     ),
-  ""data/output/tod/period_capacity_factors.csv""
+  ""data/output/tod/capacity_period_factors.csv""
 )
 ```

---FILE: docs/time_of_day.html---
@@ -37,8 +37,6 @@
 <script src=""site_libs/plotly-main-1.52.2/plotly-latest.min.js""></script>
 <script src=""site_libs/kePrint-0.0.1/kePrint.js""></script>
 <link href=""site_libs/lightable-0.0.1/lightable.css"" rel=""stylesheet"" />
-<link href=""site_libs/font-awesome-5.1.0/css/all.css"" rel=""stylesheet"" />
-<link href=""site_libs/font-awesome-5.1.0/css/v4-shims.css"" rel=""stylesheet"" />
 
 <style type=""text/css"">
   code{white-space: pre-wrap;}
@@ -437,10 +435,7 @@
       </ul>
       <ul class=""nav navbar-nav navbar-right"">
         <li>
-  <a href=""https://github.com/Caliper-Corporation/TRMG2"">
-    <span class=""fa fa-github fa-2x""></span>
-     
-  </a>
+  <a href=""https://github.com/Caliper-Corporation/TRMG2"">Github</a>
 </li>
       </ul>
     </div><!--/.nav-collapse -->
@@ -466,8 +461,8 @@ <h1>Introduction</h1>
 <h1>Peak period determination</h1>
 <p><em>(To skip to the final period definitions, click <a href=""#final_defs"">here</a>.)</em></p>
 <p>Peak period determination is based on an analysis of the trips in motion throughout the day. First, the day is broken up into 15-minute increments. A trip from the household survey is said to be in motion if any portion of the trip occurs within the 15-minute bin. As a result, a single trip can be counted in multiple bins. Determining the peak period considers the distribution of all trips as well as the distribution of trips on work tours individually. The chart below shows these two distributions, which look as expected with the AM peak being shorter and more condensed than the PM.</p>
-<div id=""htmlwidget-0a4e03e0a2a5c0ab2425"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
-<script type=""application/json"" data-for=""htmlwidget-0a4e03e0a2a5c0ab2425"">{""x"":{""visdat"":{""1634322dfa"":[""function () "",""plotlyVisDat""]},""cur_data"":""1634322dfa"",""attrs"":{""1634322dfa"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""All"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter""},""1634322dfa.1"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""Work"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Distribution of Trips in Motion by Purpose"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Time of Day""},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Trips in Motion""},""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75,24],""y"":[2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,6006.91633033752,3410.09362983704,4500.83061599731,4765.82431411743,8006.77574920654,6569.41974258423,7685.39112472534,8822.62908744812,13670.3632354736,19029.7920532227,30755.1913146973,39920.9330482483,73005.4471073151,93167.3357563019,152907.307727814,214949.553100586,337438.420101802,336102.567385737,360868.730823898,338909.257696533,375600.01715126,317963.929812177,324390.293670972,277819.02749602,304165.385853767,238720.6982282,211784.448801359,201598.047504425,261437.061003685,224179.39450868,240411.656651815,216316.87800916,258394.671279271,233479.573026657,241689.977338791,244000.05855751,314327.5847435,274645.207396825,261858.255025228,255500.890740713,302353.041838964,260254.874181112,247806.449596723,233514.178727468,284385.483388265,287609.348368009,336457.066494306,316149.00978597,384585.508785566,355704.032983144,388814.663953781,367504.416643524,451568.284702047,390884.834669813,402207.104516411,367950.996014659,458363.171119054,435887.117752393,461875.915699641,416503.391982079,446978.036206245,350113.10400486,340046.982152939,285602.246705691,292584.817763964,234046.789671898,222718.154975573,198955.189921061,202134.527949015,157585.30718867,152419.587581635,117983.69462204,137054.122617722,99612.0579586029,86675.2117328644,68056.894449234,55649.9656295776,42631.0930080414,39612.3422546387,30402.3474349976,34907.5340042114,28604.2598323822,25186.135099411,21243.2928848267,0],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  6,007"",""  3,410"",""  4,501"",""  4,766"",""  8,007"",""  6,569"",""  7,685"",""  8,823"","" 13,670"","" 19,030"","" 30,755"","" 39,921"","" 73,005"","" 93,167"",""152,907"",""214,950"",""337,438"",""336,103"",""360,869"",""338,909"",""375,600"",""317,964"",""324,390"",""277,819"",""304,165"",""238,721"",""211,784"",""201,598"",""261,437"",""224,179"",""240,412"",""216,317"",""258,395"",""233,480"",""241,690"",""244,000"",""314,328"",""274,645"",""261,858"",""255,501"",""302,353"",""260,255"",""247,806"",""233,514"",""284,385"",""287,609"",""336,457"",""316,149"",""384,586"",""355,704"",""388,815"",""367,504"",""451,568"",""390,885"",""402,207"",""367,951"",""458,363"",""435,887"",""461,876"",""416,503"",""446,978"",""350,113"",""340,047"",""285,602"",""292,585"",""234,047"",""222,718"",""198,955"",""202,135"",""157,585"",""152,420"",""117,984"",""137,054"","" 99,612"","" 86,675"","" 68,057"","" 55,650"","" 42,631"","" 39,612"","" 30,402"","" 34,908"","" 28,604"","" 25,186"","" 21,243"",""      0""],""name"":""All"",""type"":""scatter"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""line"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75],""y"":[193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,1044.11817932129,673.78125,1290.64489746094,1290.64489746094,3582.1994972229,2401.72974014282,2696.99674224854,3107.886510849,6593.75918197632,10495.2417373657,16177.1951370239,21337.3504562378,38714.4268798828,43514.4934501648,65666.2001285553,86489.1554737091,141025.194073359,149134.995801036,161429.576951091,144395.589840953,154607.089163844,126857.728663826,114486.740981102,93276.8254264196,82803.5459127426,54031.9008331299,46680.0662546158,40871.8711566925,44832.6411361694,37928.4909000397,41539.4283638001,37545.1418762207,41549.0018920899,36748.8684005737,48649.3619918823,51888.9503307343,86562.3391017914,73143.4974250794,73236.4439620972,69757.4209632874,79823.8787784577,64540.350063324,51388.7570552826,45252.1525268555,57877.5988750458,53590.1729049683,56697.467300415,54118.2288579941,64745.7610502243,58228.6229400635,76457.8760757446,73539.88387146,110964.418190384,114604.069358254,141527.684072558,134662.718091075,194375.002415021,183897.287487348,183724.700570742,148759.346390406,152983.076712926,114388.242678324,97863.8950659434,75776.4539200465,67947.3298298518,48919.5318994522,44579.5964078903,38554.1393985748,41244.9993591309,32195.8383808136,25442.4671154022,17983.6726665497,25867.90234375,18728.86211586,13486.4835357666,10726.4907131195,8487.2252292633,8756.64052391052,7938.54296684265,8202.9447593689,7960.69645500183,7266.09953689575,4765.4617061615,2970.16893196106],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""  1,044"",""    674"",""  1,291"",""  1,291"",""  3,582"",""  2,402"",""  2,697"",""  3,108"",""  6,594"","" 10,495"","" 16,177"","" 21,337"","" 38,714"","" 43,514"","" 65,666"","" 86,489"",""141,025"",""149,135"",""161,430"",""144,396"",""154,607"",""126,858"",""114,487"","" 93,277"","" 82,804"","" 54,032"","" 46,680"","" 40,872"","" 44,833"","" 37,928"","" 41,539"","" 37,545"","" 41,549"","" 36,749"","" 48,649"","" 51,889"","" 86,562"","" 73,143"","" 73,236"","" 69,757"","" 79,824"","" 64,540"","" 51,389"","" 45,252"","" 57,878"","" 53,590"","" 56,697"","" 54,118"","" 64,746"","" 58,229"","" 76,458"","" 73,540"",""110,964"",""114,604"",""141,528"",""134,663"",""194,375"",""183,897"",""183,725"",""148,759"",""152,983"",""114,388"","" 97,864"","" 75,776"","" 67,947"","" 48,920"","" 44,580"","" 38,554"","" 41,245"","" 32,196"","" 25,442"","" 17,984"","" 25,868"","" 18,729"","" 13,486"","" 10,726"",""  8,487"",""  8,757"",""  7,939"",""  8,203"",""  7,961"",""  7,266"",""  4,765"",""  2,970""],""name"":""Work"",""type"":""scatter"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""line"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
+<div id=""htmlwidget-465cda0dd8fa4bb8e3cb"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
+<script type=""application/json"" data-for=""htmlwidget-465cda0dd8fa4bb8e3cb"">{""x"":{""visdat"":{""3bf83c574b56"":[""function () "",""plotlyVisDat""]},""cur_data"":""3bf83c574b56"",""attrs"":{""3bf83c574b56"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""All"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter""},""3bf83c574b56.1"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""Work"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Distribution of Trips in Motion by Purpose"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Time of Day""},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Trips in Motion""},""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75,24],""y"":[2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,6006.91633033752,3410.09362983704,4500.83061599731,4765.82431411743,8006.77574920654,6569.41974258423,7685.39112472534,8822.62908744812,13670.3632354736,19029.7920532227,30755.1913146973,39920.9330482483,73005.4471073151,93167.3357563019,152907.307727814,214949.553100586,337438.420101802,336102.567385737,360868.730823898,338909.257696533,375600.01715126,317963.929812177,324390.293670972,277819.02749602,304165.385853767,238720.6982282,211784.448801359,201598.047504425,261437.061003685,224179.39450868,240411.656651815,216316.87800916,258394.671279271,233479.573026657,241689.977338791,244000.05855751,314327.5847435,274645.207396825,261858.255025228,255500.890740713,302353.041838964,260254.874181112,247806.449596723,233514.178727468,284385.483388265,287609.348368009,336457.066494306,316149.00978597,384585.508785566,355704.032983144,388814.663953781,367504.416643524,451568.284702047,390884.834669813,402207.104516411,367950.996014659,458363.171119054,435887.117752393,461875.915699641,416503.391982079,446978.036206245,350113.10400486,340046.982152939,285602.246705691,292584.817763964,234046.789671898,222718.154975573,198955.189921061,202134.527949015,157585.30718867,152419.587581635,117983.69462204,137054.122617722,99612.0579586029,86675.2117328644,68056.894449234,55649.9656295776,42631.0930080414,39612.3422546387,30402.3474349976,34907.5340042114,28604.2598323822,25186.135099411,21243.2928848267,0],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  6,007"",""  3,410"",""  4,501"",""  4,766"",""  8,007"",""  6,569"",""  7,685"",""  8,823"","" 13,670"","" 19,030"","" 30,755"","" 39,921"","" 73,005"","" 93,167"",""152,907"",""214,950"",""337,438"",""336,103"",""360,869"",""338,909"",""375,600"",""317,964"",""324,390"",""277,819"",""304,165"",""238,721"",""211,784"",""201,598"",""261,437"",""224,179"",""240,412"",""216,317"",""258,395"",""233,480"",""241,690"",""244,000"",""314,328"",""274,645"",""261,858"",""255,501"",""302,353"",""260,255"",""247,806"",""233,514"",""284,385"",""287,609"",""336,457"",""316,149"",""384,586"",""355,704"",""388,815"",""367,504"",""451,568"",""390,885"",""402,207"",""367,951"",""458,363"",""435,887"",""461,876"",""416,503"",""446,978"",""350,113"",""340,047"",""285,602"",""292,585"",""234,047"",""222,718"",""198,955"",""202,135"",""157,585"",""152,420"",""117,984"",""137,054"","" 99,612"","" 86,675"","" 68,057"","" 55,650"","" 42,631"","" 39,612"","" 30,402"","" 34,908"","" 28,604"","" 25,186"","" 21,243"",""      0""],""name"":""All"",""type"":""scatter"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""line"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75],""y"":[193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,1044.11817932129,673.78125,1290.64489746094,1290.64489746094,3582.1994972229,2401.72974014282,2696.99674224854,3107.886510849,6593.75918197632,10495.2417373657,16177.1951370239,21337.3504562378,38714.4268798828,43514.4934501648,65666.2001285553,86489.1554737091,141025.194073359,149134.995801036,161429.576951091,144395.589840953,154607.089163844,126857.728663826,114486.740981102,93276.8254264196,82803.5459127426,54031.9008331299,46680.0662546158,40871.8711566925,44832.6411361694,37928.4909000397,41539.4283638001,37545.1418762207,41549.0018920899,36748.8684005737,48649.3619918823,51888.9503307343,86562.3391017914,73143.4974250794,73236.4439620972,69757.4209632874,79823.8787784577,64540.350063324,51388.7570552826,45252.1525268555,57877.5988750458,53590.1729049683,56697.467300415,54118.2288579941,64745.7610502243,58228.6229400635,76457.8760757446,73539.88387146,110964.418190384,114604.069358254,141527.684072558,134662.718091075,194375.002415021,183897.287487348,183724.700570742,148759.346390406,152983.076712926,114388.242678324,97863.8950659434,75776.4539200465,67947.3298298518,48919.5318994522,44579.5964078903,38554.1393985748,41244.9993591309,32195.8383808136,25442.4671154022,17983.6726665497,25867.90234375,18728.86211586,13486.4835357666,10726.4907131195,8487.2252292633,8756.64052391052,7938.54296684265,8202.9447593689,7960.69645500183,7266.09953689575,4765.4617061615,2970.16893196106],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""  1,044"",""    674"",""  1,291"",""  1,291"",""  3,582"",""  2,402"",""  2,697"",""  3,108"",""  6,594"","" 10,495"","" 16,177"","" 21,337"","" 38,714"","" 43,514"","" 65,666"","" 86,489"",""141,025"",""149,135"",""161,430"",""144,396"",""154,607"",""126,858"",""114,487"","" 93,277"","" 82,804"","" 54,032"","" 46,680"","" 40,872"","" 44,833"","" 37,928"","" 41,539"","" 37,545"","" 41,549"","" 36,749"","" 48,649"","" 51,889"","" 86,562"","" 73,143"","" 73,236"","" 69,757"","" 79,824"","" 64,540"","" 51,389"","" 45,252"","" 57,878"","" 53,590"","" 56,697"","" 54,118"","" 64,746"","" 58,229"","" 76,458"","" 73,540"",""110,964"",""114,604"",""141,528"",""134,663"",""194,375"",""183,897"",""183,725"",""148,759"",""152,983"",""114,388"","" 97,864"","" 75,776"","" 67,947"","" 48,920"","" 44,580"","" 38,554"","" 41,245"","" 32,196"","" 25,442"","" 17,984"","" 25,868"","" 18,729"","" 13,486"","" 10,726"",""  8,487"",""  8,757"",""  7,939"",""  8,203"",""  7,961"",""  7,266"",""  4,765"",""  2,970""],""name"":""Work"",""type"":""scatter"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""line"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
 <p>The next step is to determine the peak hour for all trips and those on work tours. In the tables below, the AM and PM peak hours by type are presented. At a minimum, the AM and PM peak periods should contain the respective peak hour for work trips and all trips. The chart below shows that the peak hour for work and all trips are exactly the same in the Triangle region based on the surveys as is often, but not always, the case.</p>
 <table class=""table"" style=""width: auto !important; margin-left: auto; margin-right: auto;"">
 <thead>
@@ -547,8 +542,8 @@ <h1>Peak period determination</h1>
 </tr>
 </tbody>
 </table>
-<div id=""htmlwidget-b27a5f62ba084bd8e232"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
-<script type=""application/json"" data-for=""htmlwidget-b27a5f62ba084bd8e232"">{""x"":{""visdat"":{""1634250f7297"":[""function () "",""plotlyVisDat""]},""cur_data"":""1634250f7297"",""attrs"":{""1634250f7297"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""All"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter""},""1634250f7297.1"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""Work"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true},""1634250f7297.2"":{""x"":[7.83333333333333,17.1666666666667],""y"":[471113.434013634,471113.434013634],""mode"":""text"",""hoverinfo"":""x"",""text"":[""Work and All"",""Work and All""],""name"":""Peak Hours"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Peak Hours"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Time of Day""},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Trips in Motion""},""shapes"":[{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":16.75,""x1"":17.75,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":16.75,""x1"":17.75,""y0"":0,""y1"":461875.915699641}],""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75,24],""y"":[2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,6006.91633033752,3410.09362983704,4500.83061599731,4765.82431411743,8006.77574920654,6569.41974258423,7685.39112472534,8822.62908744812,13670.3632354736,19029.7920532227,30755.1913146973,39920.9330482483,73005.4471073151,93167.3357563019,152907.307727814,214949.553100586,337438.420101802,336102.567385737,360868.730823898,338909.257696533,375600.01715126,317963.929812177,324390.293670972,277819.02749602,304165.385853767,238720.6982282,211784.448801359,201598.047504425,261437.061003685,224179.39450868,240411.656651815,216316.87800916,258394.671279271,233479.573026657,241689.977338791,244000.05855751,314327.5847435,274645.207396825,261858.255025228,255500.890740713,302353.041838964,260254.874181112,247806.449596723,233514.178727468,284385.483388265,287609.348368009,336457.066494306,316149.00978597,384585.508785566,355704.032983144,388814.663953781,367504.416643524,451568.284702047,390884.834669813,402207.104516411,367950.996014659,458363.171119054,435887.117752393,461875.915699641,416503.391982079,446978.036206245,350113.10400486,340046.982152939,285602.246705691,292584.817763964,234046.789671898,222718.154975573,198955.189921061,202134.527949015,157585.30718867,152419.587581635,117983.69462204,137054.122617722,99612.0579586029,86675.2117328644,68056.894449234,55649.9656295776,42631.0930080414,39612.3422546387,30402.3474349976,34907.5340042114,28604.2598323822,25186.135099411,21243.2928848267,0],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  6,007"",""  3,410"",""  4,501"",""  4,766"",""  8,007"",""  6,569"",""  7,685"",""  8,823"","" 13,670"","" 19,030"","" 30,755"","" 39,921"","" 73,005"","" 93,167"",""152,907"",""214,950"",""337,438"",""336,103"",""360,869"",""338,909"",""375,600"",""317,964"",""324,390"",""277,819"",""304,165"",""238,721"",""211,784"",""201,598"",""261,437"",""224,179"",""240,412"",""216,317"",""258,395"",""233,480"",""241,690"",""244,000"",""314,328"",""274,645"",""261,858"",""255,501"",""302,353"",""260,255"",""247,806"",""233,514"",""284,385"",""287,609"",""336,457"",""316,149"",""384,586"",""355,704"",""388,815"",""367,504"",""451,568"",""390,885"",""402,207"",""367,951"",""458,363"",""435,887"",""461,876"",""416,503"",""446,978"",""350,113"",""340,047"",""285,602"",""292,585"",""234,047"",""222,718"",""198,955"",""202,135"",""157,585"",""152,420"",""117,984"",""137,054"","" 99,612"","" 86,675"","" 68,057"","" 55,650"","" 42,631"","" 39,612"","" 30,402"","" 34,908"","" 28,604"","" 25,186"","" 21,243"",""      0""],""name"":""All"",""type"":""scatter"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""line"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75],""y"":[193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,1044.11817932129,673.78125,1290.64489746094,1290.64489746094,3582.1994972229,2401.72974014282,2696.99674224854,3107.886510849,6593.75918197632,10495.2417373657,16177.1951370239,21337.3504562378,38714.4268798828,43514.4934501648,65666.2001285553,86489.1554737091,141025.194073359,149134.995801036,161429.576951091,144395.589840953,154607.089163844,126857.728663826,114486.740981102,93276.8254264196,82803.5459127426,54031.9008331299,46680.0662546158,40871.8711566925,44832.6411361694,37928.4909000397,41539.4283638001,37545.1418762207,41549.0018920899,36748.8684005737,48649.3619918823,51888.9503307343,86562.3391017914,73143.4974250794,73236.4439620972,69757.4209632874,79823.8787784577,64540.350063324,51388.7570552826,45252.1525268555,57877.5988750458,53590.1729049683,56697.467300415,54118.2288579941,64745.7610502243,58228.6229400635,76457.8760757446,73539.88387146,110964.418190384,114604.069358254,141527.684072558,134662.718091075,194375.002415021,183897.287487348,183724.700570742,148759.346390406,152983.076712926,114388.242678324,97863.8950659434,75776.4539200465,67947.3298298518,48919.5318994522,44579.5964078903,38554.1393985748,41244.9993591309,32195.8383808136,25442.4671154022,17983.6726665497,25867.90234375,18728.86211586,13486.4835357666,10726.4907131195,8487.2252292633,8756.64052391052,7938.54296684265,8202.9447593689,7960.69645500183,7266.09953689575,4765.4617061615,2970.16893196106],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""  1,044"",""    674"",""  1,291"",""  1,291"",""  3,582"",""  2,402"",""  2,697"",""  3,108"",""  6,594"","" 10,495"","" 16,177"","" 21,337"","" 38,714"","" 43,514"","" 65,666"","" 86,489"",""141,025"",""149,135"",""161,430"",""144,396"",""154,607"",""126,858"",""114,487"","" 93,277"","" 82,804"","" 54,032"","" 46,680"","" 40,872"","" 44,833"","" 37,928"","" 41,539"","" 37,545"","" 41,549"","" 36,749"","" 48,649"","" 51,889"","" 86,562"","" 73,143"","" 73,236"","" 69,757"","" 79,824"","" 64,540"","" 51,389"","" 45,252"","" 57,878"","" 53,590"","" 56,697"","" 54,118"","" 64,746"","" 58,229"","" 76,458"","" 73,540"",""110,964"",""114,604"",""141,528"",""134,663"",""194,375"",""183,897"",""183,725"",""148,759"",""152,983"",""114,388"","" 97,864"","" 75,776"","" 67,947"","" 48,920"","" 44,580"","" 38,554"","" 41,245"","" 32,196"","" 25,442"","" 17,984"","" 25,868"","" 18,729"","" 13,486"","" 10,726"",""  8,487"",""  8,757"",""  7,939"",""  8,203"",""  7,961"",""  7,266"",""  4,765"",""  2,970""],""name"":""Work"",""type"":""scatter"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""line"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[7.83333333333333,17.1666666666667],""y"":[471113.434013634,471113.434013634],""mode"":""text"",""hoverinfo"":[""x"",""x""],""text"":[""Work and All"",""Work and All""],""name"":""Peak Hours"",""type"":""scatter"",""marker"":{""color"":""rgba(44,160,44,1)"",""line"":{""color"":""rgba(44,160,44,1)""}},""error_y"":{""color"":""rgba(44,160,44,1)""},""error_x"":{""color"":""rgba(44,160,44,1)""},""line"":{""color"":""rgba(44,160,44,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
+<div id=""htmlwidget-5b36ef4c74a95482642f"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
+<script type=""application/json"" data-for=""htmlwidget-5b36ef4c74a95482642f"">{""x"":{""visdat"":{""3bf87ded3e8f"":[""function () "",""plotlyVisDat""]},""cur_data"":""3bf87ded3e8f"",""attrs"":{""3bf87ded3e8f"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""All"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter""},""3bf87ded3e8f.1"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""Work"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true},""3bf87ded3e8f.2"":{""x"":[7.83333333333333,17.1666666666667],""y"":[471113.434013634,471113.434013634],""mode"":""text"",""hoverinfo"":""x"",""text"":[""Work and All"",""Work and All""],""name"":""Peak Hours"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Peak Hours"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Time of Day""},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Trips in Motion""},""shapes"":[{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":16.75,""x1"":17.75,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":16.75,""x1"":17.75,""y0"":0,""y1"":461875.915699641}],""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75,24],""y"":[2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,6006.91633033752,3410.09362983704,4500.83061599731,4765.82431411743,8006.77574920654,6569.41974258423,7685.39112472534,8822.62908744812,13670.3632354736,19029.7920532227,30755.1913146973,39920.9330482483,73005.4471073151,93167.3357563019,152907.307727814,214949.553100586,337438.420101802,336102.567385737,360868.730823898,338909.257696533,375600.01715126,317963.929812177,324390.293670972,277819.02749602,304165.385853767,238720.6982282,211784.448801359,201598.047504425,261437.061003685,224179.39450868,240411.656651815,216316.87800916,258394.671279271,233479.573026657,241689.977338791,244000.05855751,314327.5847435,274645.207396825,261858.255025228,255500.890740713,302353.041838964,260254.874181112,247806.449596723,233514.178727468,284385.483388265,287609.348368009,336457.066494306,316149.00978597,384585.508785566,355704.032983144,388814.663953781,367504.416643524,451568.284702047,390884.834669813,402207.104516411,367950.996014659,458363.171119054,435887.117752393,461875.915699641,416503.391982079,446978.036206245,350113.10400486,340046.982152939,285602.246705691,292584.817763964,234046.789671898,222718.154975573,198955.189921061,202134.527949015,157585.30718867,152419.587581635,117983.69462204,137054.122617722,99612.0579586029,86675.2117328644,68056.894449234,55649.9656295776,42631.0930080414,39612.3422546387,30402.3474349976,34907.5340042114,28604.2598323822,25186.135099411,21243.2928848267,0],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  6,007"",""  3,410"",""  4,501"",""  4,766"",""  8,007"",""  6,569"",""  7,685"",""  8,823"","" 13,670"","" 19,030"","" 30,755"","" 39,921"","" 73,005"","" 93,167"",""152,907"",""214,950"",""337,438"",""336,103"",""360,869"",""338,909"",""375,600"",""317,964"",""324,390"",""277,819"",""304,165"",""238,721"",""211,784"",""201,598"",""261,437"",""224,179"",""240,412"",""216,317"",""258,395"",""233,480"",""241,690"",""244,000"",""314,328"",""274,645"",""261,858"",""255,501"",""302,353"",""260,255"",""247,806"",""233,514"",""284,385"",""287,609"",""336,457"",""316,149"",""384,586"",""355,704"",""388,815"",""367,504"",""451,568"",""390,885"",""402,207"",""367,951"",""458,363"",""435,887"",""461,876"",""416,503"",""446,978"",""350,113"",""340,047"",""285,602"",""292,585"",""234,047"",""222,718"",""198,955"",""202,135"",""157,585"",""152,420"",""117,984"",""137,054"","" 99,612"","" 86,675"","" 68,057"","" 55,650"","" 42,631"","" 39,612"","" 30,402"","" 34,908"","" 28,604"","" 25,186"","" 21,243"",""      0""],""name"":""All"",""type"":""scatter"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""line"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75],""y"":[193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,1044.11817932129,673.78125,1290.64489746094,1290.64489746094,3582.1994972229,2401.72974014282,2696.99674224854,3107.886510849,6593.75918197632,10495.2417373657,16177.1951370239,21337.3504562378,38714.4268798828,43514.4934501648,65666.2001285553,86489.1554737091,141025.194073359,149134.995801036,161429.576951091,144395.589840953,154607.089163844,126857.728663826,114486.740981102,93276.8254264196,82803.5459127426,54031.9008331299,46680.0662546158,40871.8711566925,44832.6411361694,37928.4909000397,41539.4283638001,37545.1418762207,41549.0018920899,36748.8684005737,48649.3619918823,51888.9503307343,86562.3391017914,73143.4974250794,73236.4439620972,69757.4209632874,79823.8787784577,64540.350063324,51388.7570552826,45252.1525268555,57877.5988750458,53590.1729049683,56697.467300415,54118.2288579941,64745.7610502243,58228.6229400635,76457.8760757446,73539.88387146,110964.418190384,114604.069358254,141527.684072558,134662.718091075,194375.002415021,183897.287487348,183724.700570742,148759.346390406,152983.076712926,114388.242678324,97863.8950659434,75776.4539200465,67947.3298298518,48919.5318994522,44579.5964078903,38554.1393985748,41244.9993591309,32195.8383808136,25442.4671154022,17983.6726665497,25867.90234375,18728.86211586,13486.4835357666,10726.4907131195,8487.2252292633,8756.64052391052,7938.54296684265,8202.9447593689,7960.69645500183,7266.09953689575,4765.4617061615,2970.16893196106],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""  1,044"",""    674"",""  1,291"",""  1,291"",""  3,582"",""  2,402"",""  2,697"",""  3,108"",""  6,594"","" 10,495"","" 16,177"","" 21,337"","" 38,714"","" 43,514"","" 65,666"","" 86,489"",""141,025"",""149,135"",""161,430"",""144,396"",""154,607"",""126,858"",""114,487"","" 93,277"","" 82,804"","" 54,032"","" 46,680"","" 40,872"","" 44,833"","" 37,928"","" 41,539"","" 37,545"","" 41,549"","" 36,749"","" 48,649"","" 51,889"","" 86,562"","" 73,143"","" 73,236"","" 69,757"","" 79,824"","" 64,540"","" 51,389"","" 45,252"","" 57,878"","" 53,590"","" 56,697"","" 54,118"","" 64,746"","" 58,229"","" 76,458"","" 73,540"",""110,964"",""114,604"",""141,528"",""134,663"",""194,375"",""183,897"",""183,725"",""148,759"",""152,983"",""114,388"","" 97,864"","" 75,776"","" 67,947"","" 48,920"","" 44,580"","" 38,554"","" 41,245"","" 32,196"","" 25,442"","" 17,984"","" 25,868"","" 18,729"","" 13,486"","" 10,726"",""  8,487"",""  8,757"",""  7,939"",""  8,203"",""  7,961"",""  7,266"",""  4,765"",""  2,970""],""name"":""Work"",""type"":""scatter"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""line"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[7.83333333333333,17.1666666666667],""y"":[471113.434013634,471113.434013634],""mode"":""text"",""hoverinfo"":[""x"",""x""],""text"":[""Work and All"",""Work and All""],""name"":""Peak Hours"",""type"":""scatter"",""marker"":{""color"":""rgba(44,160,44,1)"",""line"":{""color"":""rgba(44,160,44,1)""}},""error_y"":{""color"":""rgba(44,160,44,1)""},""error_x"":{""color"":""rgba(44,160,44,1)""},""line"":{""color"":""rgba(44,160,44,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
 <div id=""final_defs"" class=""section level2"">
 <h2>Final Period Definitions</h2>
 <p>Based on the trips in motion profile, there are four distinct periods of the day. AM and PM peaks have the highest intensity of trip making, followed by mid-day, with the overnight period containing the fewest trips in motion. Boundaries for these periods are defined such that the variance of trips in motion within periods is smallest while variance between periods is largest.</p>
@@ -629,8 +624,8 @@ <h2>Final Period Definitions</h2>
 </tr>
 </tbody>
 </table>
-<div id=""htmlwidget-b163ec21581830f32f8c"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
-<script type=""application/json"" data-for=""htmlwidget-b163ec21581830f32f8c"">{""x"":{""visdat"":{""16347ed6364c"":[""function () "",""plotlyVisDat""]},""cur_data"":""16347ed6364c"",""attrs"":{""16347ed6364c"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""All"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter""},""16347ed6364c.1"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""Work"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true},""16347ed6364c.2"":{""x"":[3.5,8,12.25,16.875,21.1248611111111],""y"":[489588.470641619,489588.470641619,489588.470641619,489588.470641619,489588.470641619],""mode"":""text"",""hoverinfo"":""x"",""text"":[""NT"",""AM"",""MD"",""PM"",""NT""],""name"":""Period"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Peak Periods"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Time of Day""},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Trips in Motion""},""shapes"":[{""type"":""rect"",""fillcolor"":""gray"",""line"":{""color"":""black""},""opacity"":0.3,""x0"":7,""x1"":9,""y0"":0,""y1"":480350.952327627},{""type"":""rect"",""fillcolor"":""gray"",""line"":{""color"":""black""},""opacity"":0.3,""x0"":15.5,""x1"":18.25,""y0"":0,""y1"":480350.952327627},{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":16.75,""x1"":17.75,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":16.75,""x1"":17.75,""y0"":0,""y1"":461875.915699641}],""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75,24],""y"":[2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,6006.91633033752,3410.09362983704,4500.83061599731,4765.82431411743,8006.77574920654,6569.41974258423,7685.39112472534,8822.62908744812,13670.3632354736,19029.7920532227,30755.1913146973,39920.9330482483,73005.4471073151,93167.3357563019,152907.307727814,214949.553100586,337438.420101802,336102.567385737,360868.730823898,338909.257696533,375600.01715126,317963.929812177,324390.293670972,277819.02749602,304165.385853767,238720.6982282,211784.448801359,201598.047504425,261437.061003685,224179.39450868,240411.656651815,216316.87800916,258394.671279271,233479.573026657,241689.977338791,244000.05855751,314327.5847435,274645.207396825,261858.255025228,255500.890740713,302353.041838964,260254.874181112,247806.449596723,233514.178727468,284385.483388265,287609.348368009,336457.066494306,316149.00978597,384585.508785566,355704.032983144,388814.663953781,367504.416643524,451568.284702047,390884.834669813,402207.104516411,367950.996014659,458363.171119054,435887.117752393,461875.915699641,416503.391982079,446978.036206245,350113.10400486,340046.982152939,285602.246705691,292584.817763964,234046.789671898,222718.154975573,198955.189921061,202134.527949015,157585.30718867,152419.587581635,117983.69462204,137054.122617722,99612.0579586029,86675.2117328644,68056.894449234,55649.9656295776,42631.0930080414,39612.3422546387,30402.3474349976,34907.5340042114,28604.2598323822,25186.135099411,21243.2928848267,0],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  6,007"",""  3,410"",""  4,501"",""  4,766"",""  8,007"",""  6,569"",""  7,685"",""  8,823"","" 13,670"","" 19,030"","" 30,755"","" 39,921"","" 73,005"","" 93,167"",""152,907"",""214,950"",""337,438"",""336,103"",""360,869"",""338,909"",""375,600"",""317,964"",""324,390"",""277,819"",""304,165"",""238,721"",""211,784"",""201,598"",""261,437"",""224,179"",""240,412"",""216,317"",""258,395"",""233,480"",""241,690"",""244,000"",""314,328"",""274,645"",""261,858"",""255,501"",""302,353"",""260,255"",""247,806"",""233,514"",""284,385"",""287,609"",""336,457"",""316,149"",""384,586"",""355,704"",""388,815"",""367,504"",""451,568"",""390,885"",""402,207"",""367,951"",""458,363"",""435,887"",""461,876"",""416,503"",""446,978"",""350,113"",""340,047"",""285,602"",""292,585"",""234,047"",""222,718"",""198,955"",""202,135"",""157,585"",""152,420"",""117,984"",""137,054"","" 99,612"","" 86,675"","" 68,057"","" 55,650"","" 42,631"","" 39,612"","" 30,402"","" 34,908"","" 28,604"","" 25,186"","" 21,243"",""      0""],""name"":""All"",""type"":""scatter"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""line"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75],""y"":[193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,1044.11817932129,673.78125,1290.64489746094,1290.64489746094,3582.1994972229,2401.72974014282,2696.99674224854,3107.886510849,6593.75918197632,10495.2417373657,16177.1951370239,21337.3504562378,38714.4268798828,43514.4934501648,65666.2001285553,86489.1554737091,141025.194073359,149134.995801036,161429.576951091,144395.589840953,154607.089163844,126857.728663826,114486.740981102,93276.8254264196,82803.5459127426,54031.9008331299,46680.0662546158,40871.8711566925,44832.6411361694,37928.4909000397,41539.4283638001,37545.1418762207,41549.0018920899,36748.8684005737,48649.3619918823,51888.9503307343,86562.3391017914,73143.4974250794,73236.4439620972,69757.4209632874,79823.8787784577,64540.350063324,51388.7570552826,45252.1525268555,57877.5988750458,53590.1729049683,56697.467300415,54118.2288579941,64745.7610502243,58228.6229400635,76457.8760757446,73539.88387146,110964.418190384,114604.069358254,141527.684072558,134662.718091075,194375.002415021,183897.287487348,183724.700570742,148759.346390406,152983.076712926,114388.242678324,97863.8950659434,75776.4539200465,67947.3298298518,48919.5318994522,44579.5964078903,38554.1393985748,41244.9993591309,32195.8383808136,25442.4671154022,17983.6726665497,25867.90234375,18728.86211586,13486.4835357666,10726.4907131195,8487.2252292633,8756.64052391052,7938.54296684265,8202.9447593689,7960.69645500183,7266.09953689575,4765.4617061615,2970.16893196106],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""  1,044"",""    674"",""  1,291"",""  1,291"",""  3,582"",""  2,402"",""  2,697"",""  3,108"",""  6,594"","" 10,495"","" 16,177"","" 21,337"","" 38,714"","" 43,514"","" 65,666"","" 86,489"",""141,025"",""149,135"",""161,430"",""144,396"",""154,607"",""126,858"",""114,487"","" 93,277"","" 82,804"","" 54,032"","" 46,680"","" 40,872"","" 44,833"","" 37,928"","" 41,539"","" 37,545"","" 41,549"","" 36,749"","" 48,649"","" 51,889"","" 86,562"","" 73,143"","" 73,236"","" 69,757"","" 79,824"","" 64,540"","" 51,389"","" 45,252"","" 57,878"","" 53,590"","" 56,697"","" 54,118"","" 64,746"","" 58,229"","" 76,458"","" 73,540"",""110,964"",""114,604"",""141,528"",""134,663"",""194,375"",""183,897"",""183,725"",""148,759"",""152,983"",""114,388"","" 97,864"","" 75,776"","" 67,947"","" 48,920"","" 44,580"","" 38,554"","" 41,245"","" 32,196"","" 25,442"","" 17,984"","" 25,868"","" 18,729"","" 13,486"","" 10,726"",""  8,487"",""  8,757"",""  7,939"",""  8,203"",""  7,961"",""  7,266"",""  4,765"",""  2,970""],""name"":""Work"",""type"":""scatter"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""line"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[3.5,8,12.25,16.875,21.1248611111111],""y"":[489588.470641619,489588.470641619,489588.470641619,489588.470641619,489588.470641619],""mode"":""text"",""hoverinfo"":[""x"",""x"",""x"",""x"",""x""],""text"":[""NT"",""AM"",""MD"",""PM"",""NT""],""name"":""Period"",""type"":""scatter"",""marker"":{""color"":""rgba(44,160,44,1)"",""line"":{""color"":""rgba(44,160,44,1)""}},""error_y"":{""color"":""rgba(44,160,44,1)""},""error_x"":{""color"":""rgba(44,160,44,1)""},""line"":{""color"":""rgba(44,160,44,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
+<div id=""htmlwidget-24490a9da09889ca0a9c"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
+<script type=""application/json"" data-for=""htmlwidget-24490a9da09889ca0a9c"">{""x"":{""visdat"":{""3bf863aa5d92"":[""function () "",""plotlyVisDat""]},""cur_data"":""3bf863aa5d92"",""attrs"":{""3bf863aa5d92"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""All"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter""},""3bf863aa5d92.1"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""Work"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true},""3bf863aa5d92.2"":{""x"":[3.5,8,12.25,16.875,21.1248611111111],""y"":[489588.470641619,489588.470641619,489588.470641619,489588.470641619,489588.470641619],""mode"":""text"",""hoverinfo"":""x"",""text"":[""NT"",""AM"",""MD"",""PM"",""NT""],""name"":""Period"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Peak Periods"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Time of Day""},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Trips in Motion""},""shapes"":[{""type"":""rect"",""fillcolor"":""gray"",""line"":{""color"":""black""},""opacity"":0.3,""x0"":7,""x1"":9,""y0"":0,""y1"":480350.952327627},{""type"":""rect"",""fillcolor"":""gray"",""line"":{""color"":""black""},""opacity"":0.3,""x0"":15.5,""x1"":18.25,""y0"":0,""y1"":480350.952327627},{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":16.75,""x1"":17.75,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":16.75,""x1"":17.75,""y0"":0,""y1"":461875.915699641}],""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75,24],""y"":[2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,6006.91633033752,3410.09362983704,4500.83061599731,4765.82431411743,8006.77574920654,6569.41974258423,7685.39112472534,8822.62908744812,13670.3632354736,19029.7920532227,30755.1913146973,39920.9330482483,73005.4471073151,93167.3357563019,152907.307727814,214949.553100586,337438.420101802,336102.567385737,360868.730823898,338909.257696533,375600.01715126,317963.929812177,324390.293670972,277819.02749602,304165.385853767,238720.6982282,211784.448801359,201598.047504425,261437.061003685,224179.39450868,240411.656651815,216316.87800916,258394.671279271,233479.573026657,241689.977338791,244000.05855751,314327.5847435,274645.207396825,261858.255025228,255500.890740713,302353.041838964,260254.874181112,247806.449596723,233514.178727468,284385.483388265,287609.348368009,336457.066494306,316149.00978597,384585.508785566,355704.032983144,388814.663953781,367504.416643524,451568.284702047,390884.834669813,402207.104516411,367950.996014659,458363.171119054,435887.117752393,461875.915699641,416503.391982079,446978.036206245,350113.10400486,340046.982152939,285602.246705691,292584.817763964,234046.789671898,222718.154975573,198955.189921061,202134.527949015,157585.30718867,152419.587581635,117983.69462204,137054.122617722,99612.0579586029,86675.2117328644,68056.894449234,55649.9656295776,42631.0930080414,39612.3422546387,30402.3474349976,34907.5340042114,28604.2598323822,25186.135099411,21243.2928848267,0],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  6,007"",""  3,410"",""  4,501"",""  4,766"",""  8,007"",""  6,569"",""  7,685"",""  8,823"","" 13,670"","" 19,030"","" 30,755"","" 39,921"","" 73,005"","" 93,167"",""152,907"",""214,950"",""337,438"",""336,103"",""360,869"",""338,909"",""375,600"",""317,964"",""324,390"",""277,819"",""304,165"",""238,721"",""211,784"",""201,598"",""261,437"",""224,179"",""240,412"",""216,317"",""258,395"",""233,480"",""241,690"",""244,000"",""314,328"",""274,645"",""261,858"",""255,501"",""302,353"",""260,255"",""247,806"",""233,514"",""284,385"",""287,609"",""336,457"",""316,149"",""384,586"",""355,704"",""388,815"",""367,504"",""451,568"",""390,885"",""402,207"",""367,951"",""458,363"",""435,887"",""461,876"",""416,503"",""446,978"",""350,113"",""340,047"",""285,602"",""292,585"",""234,047"",""222,718"",""198,955"",""202,135"",""157,585"",""152,420"",""117,984"",""137,054"","" 99,612"","" 86,675"","" 68,057"","" 55,650"","" 42,631"","" 39,612"","" 30,402"","" 34,908"","" 28,604"","" 25,186"","" 21,243"",""      0""],""name"":""All"",""type"":""scatter"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""line"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75],""y"":[193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,1044.11817932129,673.78125,1290.64489746094,1290.64489746094,3582.1994972229,2401.72974014282,2696.99674224854,3107.886510849,6593.75918197632,10495.2417373657,16177.1951370239,21337.3504562378,38714.4268798828,43514.4934501648,65666.2001285553,86489.1554737091,141025.194073359,149134.995801036,161429.576951091,144395.589840953,154607.089163844,126857.728663826,114486.740981102,93276.8254264196,82803.5459127426,54031.9008331299,46680.0662546158,40871.8711566925,44832.6411361694,37928.4909000397,41539.4283638001,37545.1418762207,41549.0018920899,36748.8684005737,48649.3619918823,51888.9503307343,86562.3391017914,73143.4974250794,73236.4439620972,69757.4209632874,79823.8787784577,64540.350063324,51388.7570552826,45252.1525268555,57877.5988750458,53590.1729049683,56697.467300415,54118.2288579941,64745.7610502243,58228.6229400635,76457.8760757446,73539.88387146,110964.418190384,114604.069358254,141527.684072558,134662.718091075,194375.002415021,183897.287487348,183724.700570742,148759.346390406,152983.076712926,114388.242678324,97863.8950659434,75776.4539200465,67947.3298298518,48919.5318994522,44579.5964078903,38554.1393985748,41244.9993591309,32195.8383808136,25442.4671154022,17983.6726665497,25867.90234375,18728.86211586,13486.4835357666,10726.4907131195,8487.2252292633,8756.64052391052,7938.54296684265,8202.9447593689,7960.69645500183,7266.09953689575,4765.4617061615,2970.16893196106],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""  1,044"",""    674"",""  1,291"",""  1,291"",""  3,582"",""  2,402"",""  2,697"",""  3,108"",""  6,594"","" 10,495"","" 16,177"","" 21,337"","" 38,714"","" 43,514"","" 65,666"","" 86,489"",""141,025"",""149,135"",""161,430"",""144,396"",""154,607"",""126,858"",""114,487"","" 93,277"","" 82,804"","" 54,032"","" 46,680"","" 40,872"","" 44,833"","" 37,928"","" 41,539"","" 37,545"","" 41,549"","" 36,749"","" 48,649"","" 51,889"","" 86,562"","" 73,143"","" 73,236"","" 69,757"","" 79,824"","" 64,540"","" 51,389"","" 45,252"","" 57,878"","" 53,590"","" 56,697"","" 54,118"","" 64,746"","" 58,229"","" 76,458"","" 73,540"",""110,964"",""114,604"",""141,528"",""134,663"",""194,375"",""183,897"",""183,725"",""148,759"",""152,983"",""114,388"","" 97,864"","" 75,776"","" 67,947"","" 48,920"","" 44,580"","" 38,554"","" 41,245"","" 32,196"","" 25,442"","" 17,984"","" 25,868"","" 18,729"","" 13,486"","" 10,726"",""  8,487"",""  8,757"",""  7,939"",""  8,203"",""  7,961"",""  7,266"",""  4,765"",""  2,970""],""name"":""Work"",""type"":""scatter"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""line"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[3.5,8,12.25,16.875,21.1248611111111],""y"":[489588.470641619,489588.470641619,489588.470641619,489588.470641619,489588.470641619],""mode"":""text"",""hoverinfo"":[""x"",""x"",""x"",""x"",""x""],""text"":[""NT"",""AM"",""MD"",""PM"",""NT""],""name"":""Period"",""type"":""scatter"",""marker"":{""color"":""rgba(44,160,44,1)"",""line"":{""color"":""rgba(44,160,44,1)""}},""error_y"":{""color"":""rgba(44,160,44,1)""},""error_x"":{""color"":""rgba(44,160,44,1)""},""line"":{""color"":""rgba(44,160,44,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
 <p>The table below shows the average 15-minute trips in motion during each period. These period definitions accurately capture the disparate characteristics of each.</p>
 <table class=""table"" style=""width: auto !important; margin-left: auto; margin-right: auto;"">
 <thead>
@@ -1256,18 +1251,15 @@ <h2>Treatment of skims</h2>
 </table>
 </div>
 </div>
-<div id=""vehicle-occupancy-factors"" class=""section level1 tabset"">
+<div id=""vehicle-occupancy-factors"" class=""section level1"">
 <h1>Vehicle occupancy factors</h1>
 <p>In addition to applying directionality factors before assignment, the person trip matrices are converted to vehicles using occupancy factors. These factors are calculated from the household survey, which includes information on the party size of each trip. The rates below meet expectations. The mode categories used are defined as follows:</p>
 <ul>
 <li>SOV: Single occupancy</li>
 <li>HOV2: 2-person occupancy</li>
 <li>HOV3: 3+ person occupancy</li>
 </ul>
-<p>Vehicle occupancy for SOV and HOV2 modes are 1.0 and 2.0, respectively. The factors for HOV3, auto pay, and other auto are shown below. The chart provides a visual example for two trip types, while the following tables provide all the factors.</p>
-<p><img src=""time_of_day_files/figure-html/unnamed-chunk-9-1.png"" width=""672"" style=""display: block; margin: auto;"" /></p>
-<div id=""hov3"" class=""section level2"">
-<h2>HOV3</h2>
+<p>Vehicle occupancy for SOV and HOV2 modes are 1.0 and 2.0, respectively. The factors for HOV3 are shown below.</p>
 <table class=""table"" style=""width: auto !important; margin-left: auto; margin-right: auto;"">
 <thead>
 <tr>
@@ -1281,10 +1273,10 @@ <h2>HOV3</h2>
 MD
 </th>
 <th style=""text-align:right;"">
-NT
+PM
 </th>
 <th style=""text-align:right;"">
-PM
+NT
 </th>
 </tr>
 </thead>
@@ -1294,33 +1286,33 @@ <h2>HOV3</h2>
 N_HB_K12_All
 </td>
 <td style=""text-align:right;"">
-3.563
+3.568
 </td>
 <td style=""text-align:right;"">
 3.763
 </td>
 <td style=""text-align:right;"">
-3.402
+3.649
 </td>
 <td style=""text-align:right;"">
-3.645
+3.402
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 N_HB_OD_Long
 </td>
 <td style=""text-align:right;"">
-3.477
+3.474
 </td>
 <td style=""text-align:right;"">
 3.837
 </td>
 <td style=""text-align:right;"">
-3.669
+3.400
 </td>
 <td style=""text-align:right;"">
-3.393
+3.671
 </td>
 </tr>
 <tr>
@@ -1331,47 +1323,47 @@ <h2>HOV3</h2>
 3.740
 </td>
 <td style=""text-align:right;"">
-3.621
+3.620
 </td>
 <td style=""text-align:right;"">
-3.786
+3.355
 </td>
 <td style=""text-align:right;"">
-3.355
+3.783
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 N_HB_OME_All
 </td>
 <td style=""text-align:right;"">
-3.651
+3.654
 </td>
 <td style=""text-align:right;"">
-3.620
+3.630
 </td>
 <td style=""text-align:right;"">
-3.615
+3.653
 </td>
 <td style=""text-align:right;"">
-3.655
+3.616
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 N_HB_OMED_All
 </td>
 <td style=""text-align:right;"">
-3.378
+3.545
 </td>
 <td style=""text-align:right;"">
-3.443
+3.714
 </td>
 <td style=""text-align:right;"">
-3.378
+3.545
 </td>
 <td style=""text-align:right;"">
-3.378
+3.545
 </td>
 </tr>
 <tr>
@@ -1382,47 +1374,47 @@ <h2>HOV3</h2>
 3.625
 </td>
 <td style=""text-align:right;"">
-3.552
+3.571
 </td>
 <td style=""text-align:right;"">
-3.552
+3.650
 </td>
 <td style=""text-align:right;"">
-3.608
+3.571
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 N_NH_O_All
 </td>
 <td style=""text-align:right;"">
-3.460
+3.482
 </td>
 <td style=""text-align:right;"">
-3.486
+3.491
 </td>
 <td style=""text-align:right;"">
-3.441
+3.677
 </td>
 <td style=""text-align:right;"">
-3.670
+3.438
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 N_NH_OME_All
 </td>
 <td style=""text-align:right;"">
-3.676
+3.683
 </td>
 <td style=""text-align:right;"">
-3.864
+3.865
 </td>
 <td style=""text-align:right;"">
-3.649
+3.400
 </td>
 <td style=""text-align:right;"">
-3.393
+3.672
 </td>
 </tr>
 <tr>
@@ -1436,10 +1428,10 @@ <h2>HOV3</h2>
 3.415
 </td>
 <td style=""text-align:right;"">
-3.415
+3.557
 </td>
 <td style=""text-align:right;"">
-3.557
+3.415
 </td>
 </tr>
 <tr>
@@ -1453,10 +1445,10 @@ <h2>HOV3</h2>
 3.334
 </td>
 <td style=""text-align:right;"">
-3.480
+3.166
 </td>
 <td style=""text-align:right;"">
-3.166
+3.480
 </td>
 </tr>
 <tr>
@@ -1498,57 +1490,52 @@ <h2>HOV3</h2>
 W_NH_O_All
 </td>
 <td style=""text-align:right;"">
-3.237
+3.295
 </td>
 <td style=""text-align:right;"">
 3.237
 </td>
 <td style=""text-align:right;"">
-3.237
+3.175
 </td>
 <td style=""text-align:right;"">
-3.195
+3.295
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 W_NH_WR_All
 </td>
 <td style=""text-align:right;"">
-3.269
+3.850
 </td>
 <td style=""text-align:right;"">
-3.423
+3.850
 </td>
 <td style=""text-align:right;"">
-3.269
+3.850
 </td>
 <td style=""text-align:right;"">
-3.269
+3.850
 </td>
 </tr>
 </tbody>
 </table>
-</div>
-<div id=""auto-pay"" class=""section level2"">
-<h2>Auto Pay</h2>
+<p>For Auto Pay and Other Auto modes, shares of sov, hov2, and hov3 were calculated. The model uses these to convert these modes into their respective assignment classes before highway assignment.</p>
 <table class=""table"" style=""width: auto !important; margin-left: auto; margin-right: auto;"">
 <thead>
 <tr>
 <th style=""text-align:left;"">
-Trip Type
+trip_type
 </th>
 <th style=""text-align:right;"">
-AM
-</th>
-<th style=""text-align:right;"">
-MD
+sov
 </th>
 <th style=""text-align:right;"">
-NT
+hov2
 </th>
 <th style=""text-align:right;"">
-PM
+hov3
 </th>
 </tr>
 </thead>
@@ -1558,507 +1545,200 @@ <h2>Auto Pay</h2>
 N_HB_K12_All
 </td>
 <td style=""text-align:right;"">
-3.082
-</td>
-<td style=""text-align:right;"">
-3.395
+0.035
 </td>
 <td style=""text-align:right;"">
-3.395
+0.334
 </td>
 <td style=""text-align:right;"">
-3.082
+0.632
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 N_HB_OD_Long
 </td>
 <td style=""text-align:right;"">
-1.819
+0.147
 </td>
 <td style=""text-align:right;"">
-1.819
+0.452
 </td>
 <td style=""text-align:right;"">
-1.819
-</td>
-<td style=""text-align:right;"">
-1.819
+0.401
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 N_HB_OD_Short
 </td>
 <td style=""text-align:right;"">
-2.596
+0.204
 </td>
 <td style=""text-align:right;"">
-2.491
+0.259
 </td>
 <td style=""text-align:right;"">
-2.491
-</td>
-<td style=""text-align:right;"">
-2.491
+0.537
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 N_HB_OME_All
 </td>
 <td style=""text-align:right;"">
-2.048
+0.125
 </td>
 <td style=""text-align:right;"">
-2.048
+0.597
 </td>
 <td style=""text-align:right;"">
-2.048
-</td>
-<td style=""text-align:right;"">
-2.048
+0.278
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 N_HB_OMED_All
 </td>
 <td style=""text-align:right;"">
-2.462
-</td>
-<td style=""text-align:right;"">
-2.462
+0.065
 </td>
 <td style=""text-align:right;"">
-2.462
+0.760
 </td>
 <td style=""text-align:right;"">
-2.462
+0.174
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 N_NH_K12_All
 </td>
 <td style=""text-align:right;"">
-3.269
+0.022
 </td>
 <td style=""text-align:right;"">
-3.269
+0.384
 </td>
 <td style=""text-align:right;"">
-3.269
-</td>
-<td style=""text-align:right;"">
-3.269
+0.594
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 N_NH_O_All
 </td>
 <td style=""text-align:right;"">
-1.805
-</td>
-<td style=""text-align:right;"">
-1.805
+0.166
 </td>
 <td style=""text-align:right;"">
-1.805
+0.259
 </td>
 <td style=""text-align:right;"">
-1.805
+0.574
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 N_NH_OME_All
 </td>
 <td style=""text-align:right;"">
-3.853
-</td>
-<td style=""text-align:right;"">
-2.233
+0.093
 </td>
 <td style=""text-align:right;"">
-2.233
+0.297
 </td>
 <td style=""text-align:right;"">
-2.233
+0.609
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 W_HB_EK12_All
 </td>
 <td style=""text-align:right;"">
-2.000
-</td>
-<td style=""text-align:right;"">
-2.000
+0.000
 </td>
 <td style=""text-align:right;"">
-2.000
+1.000
 </td>
 <td style=""text-align:right;"">
-2.000
+0.000
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 W_HB_O_All
 </td>
 <td style=""text-align:right;"">
-1.665
+0.528
 </td>
 <td style=""text-align:right;"">
-1.665
+0.279
 </td>
 <td style=""text-align:right;"">
-1.665
-</td>
-<td style=""text-align:right;"">
-1.665
+0.193
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 W_HB_W_All
 </td>
 <td style=""text-align:right;"">
-1.785
-</td>
-<td style=""text-align:right;"">
-1.785
+0.475
 </td>
 <td style=""text-align:right;"">
-1.785
+0.280
 </td>
 <td style=""text-align:right;"">
-1.785
+0.246
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 W_NH_EK12_All
 </td>
 <td style=""text-align:right;"">
-2.000
-</td>
-<td style=""text-align:right;"">
-2.000
+0.000
 </td>
 <td style=""text-align:right;"">
-2.000
+1.000
 </td>
 <td style=""text-align:right;"">
-2.000
+0.000
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 W_NH_O_All
 </td>
 <td style=""text-align:right;"">
-2.343
-</td>
-<td style=""text-align:right;"">
-2.343
+0.334
 </td>
 <td style=""text-align:right;"">
-2.280
+0.359
 </td>
 <td style=""text-align:right;"">
-2.343
+0.307
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 W_NH_WR_All
 </td>
 <td style=""text-align:right;"">
-2.908
-</td>
-<td style=""text-align:right;"">
-2.908
+0.621
 </td>
 <td style=""text-align:right;"">
-2.908
+0.244
 </td>
 <td style=""text-align:right;"">
-2.908
+0.135
 </td>
 </tr>
 </tbody>
 </table>
 </div>
-<div id=""other-auto"" class=""section level2"">
-<h2>Other Auto</h2>
-<table class=""table"" style=""width: auto !important; margin-left: auto; margin-right: auto;"">
-<thead>
-<tr>
-<th style=""text-align:left;"">
-Trip Type
-</th>
-<th style=""text-align:right;"">
-AM
-</th>
-<th style=""text-align:right;"">
-MD
-</th>
-<th style=""text-align:right;"">
-NT
-</th>
-<th style=""text-align:right;"">
-PM
-</th>
-</tr>
-</thead>
-<tbody>
-<tr>
-<td style=""text-align:left;"">
-N_HB_K12_All
-</td>
-<td style=""text-align:right;"">
-3.395
-</td>
-<td style=""text-align:right;"">
-3.019
-</td>
-<td style=""text-align:right;"">
-3.050
-</td>
-<td style=""text-align:right;"">
-3.050
-</td>
-</tr>
-<tr>
-<td style=""text-align:left;"">
-N_HB_OD_Long
-</td>
-<td style=""text-align:right;"">
-2.611
-</td>
-<td style=""text-align:right;"">
-2.429
-</td>
-<td style=""text-align:right;"">
-2.546
-</td>
-<td style=""text-align:right;"">
-2.953
-</td>
-</tr>
-<tr>
-<td style=""text-align:left;"">
-N_HB_OD_Short
-</td>
-<td style=""text-align:right;"">
-2.596
-</td>
-<td style=""text-align:right;"">
-2.596
-</td>
-<td style=""text-align:right;"">
-2.596
-</td>
-<td style=""text-align:right;"">
-2.596
-</td>
-</tr>
-<tr>
-<td style=""text-align:left;"">
-N_HB_OME_All
-</td>
-<td style=""text-align:right;"">
-2.389
-</td>
-<td style=""text-align:right;"">
-2.500
-</td>
-<td style=""text-align:right;"">
-2.278
-</td>
-<td style=""text-align:right;"">
-2.156
-</td>
-</tr>
-<tr>
-<td style=""text-align:left;"">
-N_HB_OMED_All
-</td>
-<td style=""text-align:right;"">
-2.462
-</td>
-<td style=""text-align:right;"">
-2.462
-</td>
-<td style=""text-align:right;"">
-2.462
-</td>
-<td style=""text-align:right;"">
-2.462
-</td>
-</tr>
-<tr>
-<td style=""text-align:left;"">
-N_NH_K12_All
-</td>
-<td style=""text-align:right;"">
-3.222
-</td>
-<td style=""text-align:right;"">
-3.222
-</td>
-<td style=""text-align:right;"">
-3.222
-</td>
-<td style=""text-align:right;"">
-3.222
-</td>
-</tr>
-<tr>
-<td style=""text-align:left;"">
-N_NH_O_All
-</td>
-<td style=""text-align:right;"">
-3.230
-</td>
-<td style=""text-align:right;"">
-3.388
-</td>
-<td style=""text-align:right;"">
-3.226
-</td>
-<td style=""text-align:right;"">
-2.796
-</td>
-</tr>
-<tr>
-<td style=""text-align:left;"">
-N_NH_OME_All
-</td>
-<td style=""text-align:right;"">
-3.418
-</td>
-<td style=""text-align:right;"">
-3.173
-</td>
-<td style=""text-align:right;"">
-3.853
-</td>
-<td style=""text-align:right;"">
-3.691
-</td>
-</tr>
-<tr>
-<td style=""text-align:left;"">
-W_HB_EK12_All
-</td>
-<td style=""text-align:right;"">
-2.000
-</td>
-<td style=""text-align:right;"">
-2.000
-</td>
-<td style=""text-align:right;"">
-2.000
-</td>
-<td style=""text-align:right;"">
-2.000
-</td>
-</tr>
-<tr>
-<td style=""text-align:left;"">
-W_HB_O_All
-</td>
-<td style=""text-align:right;"">
-1.665
-</td>
-<td style=""text-align:right;"">
-1.665
-</td>
-<td style=""text-align:right;"">
-1.665
-</td>
-<td style=""text-align:right;"">
-1.665
-</td>
-</tr>
-<tr>
-<td style=""text-align:left;"">
-W_HB_W_All
-</td>
-<td style=""text-align:right;"">
-1.912
-</td>
-<td style=""text-align:right;"">
-1.912
-</td>
-<td style=""text-align:right;"">
-1.912
-</td>
-<td style=""text-align:right;"">
-1.912
-</td>
-</tr>
-<tr>
-<td style=""text-align:left;"">
-W_NH_EK12_All
-</td>
-<td style=""text-align:right;"">
-2.000
-</td>
-<td style=""text-align:right;"">
-2.000
-</td>
-<td style=""text-align:right;"">
-2.000
-</td>
-<td style=""text-align:right;"">
-2.000
-</td>
-</tr>
-<tr>
-<td style=""text-align:left;"">
-W_NH_O_All
-</td>
-<td style=""text-align:right;"">
-2.343
-</td>
-<td style=""text-align:right;"">
-2.343
-</td>
-<td style=""text-align:right;"">
-2.343
-</td>
-<td style=""text-align:right;"">
-2.343
-</td>
-</tr>
-<tr>
-<td style=""text-align:left;"">
-W_NH_WR_All
-</td>
-<td style=""text-align:right;"">
-1.935
-</td>
-<td style=""text-align:right;"">
-2.049
-</td>
-<td style=""text-align:right;"">
-1.935
-</td>
-<td style=""text-align:right;"">
-1.694
-</td>
-</tr>
-</tbody>
-</table>
-</div>
-</div>
 <div id=""period-capacity-factors"" class=""section level1"">
 <h1>Period capacity factors</h1>
 <p>In aggregate period assignment regimes, hourly capacities must be converted to period capacities in a manner that accurately captures the balance of congestion. In the real world, the hourly capacity of a road is generally the same throughout the day; it is the demand that changes. This change in demand causes congestion levels to change over time. Consider the stylized example below of a real world street segment.</p>
@@ -2127,8 +1807,8 @@ <h2>Qualitative example</h2>
 </tr>
 </tbody>
 </table>
-<div id=""htmlwidget-418c9e6608e8ef085594"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
-<script type=""application/json"" data-for=""htmlwidget-418c9e6608e8ef085594"">{""x"":{""visdat"":{""1634467a548"":[""function () "",""plotlyVisDat""]},""cur_data"":""1634467a548"",""attrs"":{""1634467a548"":{""x"":{},""y"":{},""name"":""Capacity"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar""},""1634467a548.1"":{""x"":{},""y"":{},""name"":""Demand"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Hour of Day"",""type"":""category"",""categoryorder"":""array"",""categoryarray"":[""6-7"",""7-8"",""8-9""]},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Veh per Hour""},""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[""6-7"",""7-8"",""8-9""],""y"":[1050,1050,1050],""name"":""Capacity"",""type"":""bar"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[""6-7"",""7-8"",""8-9""],""y"":[500,900,500],""name"":""Demand"",""type"":""bar"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
+<div id=""htmlwidget-5afd238f952da5dd0224"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
+<script type=""application/json"" data-for=""htmlwidget-5afd238f952da5dd0224"">{""x"":{""visdat"":{""3bf82018733e"":[""function () "",""plotlyVisDat""]},""cur_data"":""3bf82018733e"",""attrs"":{""3bf82018733e"":{""x"":{},""y"":{},""name"":""Capacity"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar""},""3bf82018733e.1"":{""x"":{},""y"":{},""name"":""Demand"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Hour of Day"",""type"":""category"",""categoryorder"":""array"",""categoryarray"":[""6-7"",""7-8"",""8-9""]},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Veh per Hour""},""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[""6-7"",""7-8"",""8-9""],""y"":[1050,1050,1050],""name"":""Capacity"",""type"":""bar"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[""6-7"",""7-8"",""8-9""],""y"":[500,900,500],""name"":""Demand"",""type"":""bar"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
 <p>The easiest way to represent this in a period assignment would be to add up the total capacity and total demand from each hour.</p>
 <table class=""table"" style=""width: auto !important; margin-left: auto; margin-right: auto;"">
 <thead>
@@ -2158,8 +1838,8 @@ <h2>Qualitative example</h2>
 </tr>
 </tbody>
 </table>
-<div id=""htmlwidget-81056fbc0c1c9cfda455"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
-<script type=""application/json"" data-for=""htmlwidget-81056fbc0c1c9cfda455"">{""x"":{""visdat"":{""1634255a6764"":[""function () "",""plotlyVisDat""]},""cur_data"":""1634255a6764"",""attrs"":{""1634255a6764"":{""x"":{},""y"":{},""name"":""Capacity"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar""},""1634255a6764.1"":{""x"":{},""y"":{},""name"":""Demand"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Hour of Day"",""type"":""category"",""categoryorder"":""array"",""categoryarray"":[""6-9""]},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Veh per Hour""},""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[""6-9""],""y"":[3150],""name"":""Capacity"",""type"":""bar"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[""6-9""],""y"":[1900],""name"":""Demand"",""type"":""bar"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
+<div id=""htmlwidget-e1ef13eefdb28c1aa676"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
+<script type=""application/json"" data-for=""htmlwidget-e1ef13eefdb28c1aa676"">{""x"":{""visdat"":{""3bf87292e18"":[""function () "",""plotlyVisDat""]},""cur_data"":""3bf87292e18"",""attrs"":{""3bf87292e18"":{""x"":{},""y"":{},""name"":""Capacity"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar""},""3bf87292e18.1"":{""x"":{},""y"":{},""name"":""Demand"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Hour of Day"",""type"":""category"",""categoryorder"":""array"",""categoryarray"":[""6-9""]},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Veh per Hour""},""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[""6-9""],""y"":[3150],""name"":""Capacity"",""type"":""bar"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[""6-9""],""y"":[1900],""name"":""Demand"",""type"":""bar"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
 <p>In this simple representation, no one experiences congestion. This does not match the real world graph, which shows that nearly half the vehicles in the period experience congested conditions. This occurs between 7:00 am and 8:00 am. This discrepancy between the real world and a naive period representation can cause numerous errors in the model, including:</p>
 <ul>
 <li>Longer trip lengths</li>
@@ -2175,8 +1855,8 @@ <h2>Qualitative example</h2>
 <p>The period capacity that most-accurately reflects congestion would be:</p>
 <p><br /><span class=""math display""><em>P</em><em>e</em><em>r</em><em>i</em><em>o</em><em>d</em><em>C</em><em>a</em><em>p</em><em>a</em><em>c</em><em>i</em><em>t</em><em>y</em>=1050*2.11=2215</span><br /></p>
 <p>That capacity is shown relative to the period demand in the chart below. This relationship is a better representation of real world conditions.</p>
-<div id=""htmlwidget-f97f6c0d5f655071b6c2"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
-<script type=""application/json"" data-for=""htmlwidget-f97f6c0d5f655071b6c2"">{""x"":{""visdat"":{""16342931479f"":[""function () "",""plotlyVisDat""]},""cur_data"":""16342931479f"",""attrs"":{""16342931479f"":{""x"":{},""y"":{},""marker"":{""color"":""ff7f0e""},""name"":""Demand"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar""},""16342931479f.1"":{""x"":{},""y"":{},""marker"":{""color"":""1f77b4""},""name"":""Capacity"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Final Model Representation"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":"""",""type"":""category"",""categoryorder"":""array"",""categoryarray"":[""PCF = 2.11"",""PCF = 3.00""]},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Veh per Period""},""barmode"":""stack"",""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[""PCF = 3.00"",""PCF = 2.11""],""y"":[1900,1900],""marker"":{""color"":""ff7f0e"",""line"":{""color"":""rgba(31,119,180,1)""}},""name"":""Demand"",""type"":""bar"",""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[""PCF = 3.00"",""PCF = 2.11""],""y"":[1250,316],""marker"":{""color"":""1f77b4"",""line"":{""color"":""rgba(255,127,14,1)""}},""name"":""Capacity"",""type"":""bar"",""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
+<div id=""htmlwidget-f6f3f1987e558bfdd0f4"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
+<script type=""application/json"" data-for=""htmlwidget-f6f3f1987e558bfdd0f4"">{""x"":{""visdat"":{""3bf85f1a2575"":[""function () "",""plotlyVisDat""]},""cur_data"":""3bf85f1a2575"",""attrs"":{""3bf85f1a2575"":{""x"":{},""y"":{},""marker"":{""color"":""ff7f0e""},""name"":""Demand"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar""},""3bf85f1a2575.1"":{""x"":{},""y"":{},""marker"":{""color"":""1f77b4""},""name"":""Capacity"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Final Model Representation"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":"""",""type"":""category"",""categoryorder"":""array"",""categoryarray"":[""PCF = 2.11"",""PCF = 3.00""]},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Veh per Period""},""barmode"":""stack"",""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[""PCF = 3.00"",""PCF = 2.11""],""y"":[1900,1900],""marker"":{""color"":""ff7f0e"",""line"":{""color"":""rgba(31,119,180,1)""}},""name"":""Demand"",""type"":""bar"",""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[""PCF = 3.00"",""PCF = 2.11""],""y"":[1250,316],""marker"":{""color"":""1f77b4"",""line"":{""color"":""rgba(255,127,14,1)""}},""name"":""Capacity"",""type"":""bar"",""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
 <table class=""table"" style=""width: auto !important; margin-left: auto; margin-right: auto;"">
 <thead>
 <tr>

---FILE: master/networks/capacity_period_factors.csv---
@@ -1,5 +1,5 @@
 TOD,Value,Description
-AM,1.866,Hours of capacity in AM period
-MD,4.879,Hours of capacity in MD period
-PM,2.572,Hours of capacity in PM period
-NT,3.137,Hours of capacity in NT period
+AM,1.867,Hours of capacity in AM period
+MD,4.896,Hours of capacity in MD period
+PM,2.567,Hours of capacity in PM period
+NT,3.125,Hours of capacity in NT period

---FILE: master/networks/period_capacity_factors.csv---
@@ -1,5 +0,0 @@
-TOD,Value,Description
-AM,1.866,Hours of capacity in AM period
-MD,4.879,Hours of capacity in MD period
-PM,2.572,Hours of capacity in PM period
-NT,3.137,Hours of capacity in NT period

---FILE: master/resident/tod/directionality_factors.csv---
@@ -2,32 +2,32 @@ trip_type,tod,pa_fac
 N_HB_K12_All,AM,0.8679429726517056
 N_HB_K12_All,MD,0.2560963734052302
 N_HB_K12_All,PM,0.19006895911145505
-N_HB_K12_All,NT,0.8172068570658283
-N_HB_OD_Long,AM,0.8432101247109498
-N_HB_OD_Long,MD,0.5643113661908536
-N_HB_OD_Long,PM,0.49832393319828333
-N_HB_OD_Long,NT,0.3720938252820547
+N_HB_K12_All,NT,0.8139969734538841
+N_HB_OD_Long,AM,0.842579904768488
+N_HB_OD_Long,MD,0.5620554727908423
+N_HB_OD_Long,PM,0.49833056723329605
+N_HB_OD_Long,NT,0.3699238807057316
 N_HB_OD_Short,AM,0.6492347849663067
-N_HB_OD_Short,MD,0.5477052753379956
+N_HB_OD_Short,MD,0.5486245073918471
 N_HB_OD_Short,PM,0.45300731976153563
-N_HB_OD_Short,NT,0.4516154599819663
-N_HB_OME_All,AM,0.6805388972365517
-N_HB_OME_All,MD,0.4669667276266846
-N_HB_OME_All,PM,0.44786557676112976
+N_HB_OD_Short,NT,0.44847589654473424
+N_HB_OME_All,AM,0.681127507364529
+N_HB_OME_All,MD,0.4669295256541704
+N_HB_OME_All,PM,0.4503328138778361
 N_HB_OME_All,NT,0.3231616880594509
-N_HB_OMED_All,AM,0.9158512357615005
-N_HB_OMED_All,MD,0.5993941149671077
-N_HB_OMED_All,PM,0.3169392247982402
+N_HB_OMED_All,AM,0.9139447697080656
+N_HB_OMED_All,MD,0.6013451821187071
+N_HB_OMED_All,PM,0.32498852882397755
 N_HB_OMED_All,NT,0.4209188279020048
 W_HB_EK12_All,AM,0.9843770251365579
 W_HB_EK12_All,MD,0.30978702521587975
 W_HB_EK12_All,PM,0.004246387128185591
 W_HB_EK12_All,NT,0.8361625825872685
 W_HB_O_All,AM,0.9969099965671543
 W_HB_O_All,MD,0.46657778982051235
-W_HB_O_All,PM,0.016895238491146585
-W_HB_O_All,NT,0.20381325139805676
-W_HB_W_All,AM,0.9960808281050005
+W_HB_O_All,PM,0.016914299741352473
+W_HB_O_All,NT,0.20483086136461387
+W_HB_W_All,AM,0.996073972295845
 W_HB_W_All,MD,0.6227906258910493
 W_HB_W_All,PM,0.06646751668078169
-W_HB_W_All,NT,0.6392112153475571
+W_HB_W_All,NT,0.6376292561712676

---FILE: master/resident/tod/hov3_occ_factors.csv---
@@ -47,11 +47,11 @@ W_NH_EK12_All,AM,3.21
 W_NH_EK12_All,MD,3.21
 W_NH_EK12_All,NT,3.21
 W_NH_EK12_All,PM,3.21
-W_NH_O_All,AM,3.237
+W_NH_O_All,AM,3.295
 W_NH_O_All,MD,3.237
-W_NH_O_All,NT,3.237
-W_NH_O_All,PM,3.195
-W_NH_WR_All,AM,3.526
-W_NH_WR_All,MD,3.423
-W_NH_WR_All,NT,3.526
-W_NH_WR_All,PM,3.338
+W_NH_O_All,NT,3.295
+W_NH_O_All,PM,3.175
+W_NH_WR_All,AM,3.85
+W_NH_WR_All,MD,3.85
+W_NH_WR_All,NT,3.85
+W_NH_WR_All,PM,3.85

---FILE: master/resident/tod/other_shares.csv---
@@ -11,5 +11,5 @@ W_HB_EK12_All,1,0,0
 W_HB_O_All,0.2791853971390368,0.19313261847796698,0.5276819843829963
 W_HB_W_All,0.2799257495859344,0.2455556694086407,0.4745185810054248
 W_NH_EK12_All,1,0,0
-W_NH_O_All,0.5322134763042827,0.3085093656217968,0.1592771580739205
-W_NH_WR_All,0.30278654977279984,0.25257229984786556,0.44464115037933455
+W_NH_O_All,0.3587204938108612,0.3071742940327908,0.3341052121563479
+W_NH_WR_All,0.24377364893280126,0.1351258485877058,0.621100502479493

---FILE: master/resident/tod/time_of_day_factors.csv---
@@ -1,32 +1,32 @@
 trip_type,tod,factor,Description
-N_HB_K12_All,AM,0.395,Used to split daily resident productions
+N_HB_K12_All,AM,0.396,Used to split daily resident productions
 N_HB_K12_All,MD,0.251,into period-specific values
-N_HB_K12_All,NT,0.139,
+N_HB_K12_All,NT,0.138,
 N_HB_K12_All,PM,0.215,
-N_HB_OD_Long,AM,0.105,
-N_HB_OD_Long,MD,0.302,
-N_HB_OD_Long,NT,0.346,
-N_HB_OD_Long,PM,0.247,
-N_HB_OD_Short,AM,0.151,
+N_HB_OD_Long,AM,0.106,
+N_HB_OD_Long,MD,0.303,
+N_HB_OD_Long,NT,0.34199999999999997,
+N_HB_OD_Long,PM,0.249,
+N_HB_OD_Short,AM,0.152,
 N_HB_OD_Short,MD,0.302,
-N_HB_OD_Short,NT,0.268,
-N_HB_OD_Short,PM,0.279,
+N_HB_OD_Short,NT,0.266,
+N_HB_OD_Short,PM,0.28,
 N_HB_OME_All,AM,0.038,
 N_HB_OME_All,MD,0.473,
 N_HB_OME_All,NT,0.26,
 N_HB_OME_All,PM,0.229,
-N_HB_OMED_All,AM,0.154,
-N_HB_OMED_All,MD,0.608,
+N_HB_OMED_All,AM,0.155,
+N_HB_OMED_All,MD,0.607,
 N_HB_OMED_All,NT,0.06500000000000006,
 N_HB_OMED_All,PM,0.173,
 W_HB_EK12_All,AM,0.531,
 W_HB_EK12_All,MD,0.062,
 W_HB_EK12_All,NT,0.14300000000000002,
 W_HB_EK12_All,PM,0.264,
 W_HB_O_All,AM,0.154,
-W_HB_O_All,MD,0.151,
-W_HB_O_All,NT,0.395,
-W_HB_O_All,PM,0.3,
+W_HB_O_All,MD,0.152,
+W_HB_O_All,NT,0.393,
+W_HB_O_All,PM,0.301,
 W_HB_W_All,AM,0.288,
 W_HB_W_All,MD,0.193,
 W_HB_W_All,NT,0.2370000000000001,"
Triangle-Modeling-and-Analytics,TRMG2,290f745019fc7449c18c88a7c670db128e320755,Kyle Ward,kyle@caliper.com,2021-09-15T21:25:02Z,Kyle Ward,kyle@caliper.com,2021-09-15T21:25:02Z,Correct a few bugs and clean up testing code,docs/data/input/ieei/External Station Cross Reference v62tovG2.xlsx;master/external/ieei_gravity.csv;src/External Models.rsc;trmg2.model,False,False,False,False,29,68,97,"---FILE: master/external/ieei_gravity.csv---
@@ -1,25 +1,25 @@
 purpose,p_field,a_field,constraint,imp_core,a,b,c
-IEEI_AUTO_FREEWAY_AM,IEEI_AUTO_PROD_FREEWAY_AM,IEEI_AUTO_ATTR_FREEWAY_AM,Production,CongTime,5,1,0.1
-IEEI_AUTO_FREEWAY_MD,IEEI_AUTO_PROD_FREEWAY_MD,IEEI_AUTO_ATTR_FREEWAY_MD,Production,CongTime,5,1,0.1
-IEEI_AUTO_FREEWAY_PM,IEEI_AUTO_PROD_FREEWAY_PM,IEEI_AUTO_ATTR_FREEWAY_PM,Production,CongTime,5,1,0.1
-IEEI_AUTO_FREEWAY_NT,IEEI_AUTO_PROD_FREEWAY_NT,IEEI_AUTO_ATTR_FREEWAY_NT,Production,CongTime,5,1,0.1
-IEEI_AUTO_NONFREEWAY_AM,IEEI_AUTO_PROD_NONFREEWAY_AM,IEEI_AUTO_ATTR_NONFREEWAY_AM,Production,CongTime,5,1,0.1
-IEEI_AUTO_NONFREEWAY_MD,IEEI_AUTO_PROD_NONFREEWAY_MD,IEEI_AUTO_ATTR_NONFREEWAY_MD,Production,CongTime,5,1,0.1
-IEEI_AUTO_NONFREEWAY_PM,IEEI_AUTO_PROD_NONFREEWAY_PM,IEEI_AUTO_ATTR_NONFREEWAY_PM,Production,CongTime,5,1,0.1
-IEEI_AUTO_NONFREEWAY_NT,IEEI_AUTO_PROD_NONFREEWAY_NT,IEEI_AUTO_ATTR_NONFREEWAY_NT,Production,CongTime,5,1,0.1
-IEEI_CVSUT_FREEWAY_AM,IEEI_CVSUT_PROD_FREEWAY_AM,IEEI_CVSUT_ATTR_FREEWAY_AM,Production,CongTime,5,1,0.1
-IEEI_CVSUT_FREEWAY_MD,IEEI_CVSUT_PROD_FREEWAY_MD,IEEI_CVSUT_ATTR_FREEWAY_MD,Production,CongTime,5,1,0.1
-IEEI_CVSUT_FREEWAY_PM,IEEI_CVSUT_PROD_FREEWAY_PM,IEEI_CVSUT_ATTR_FREEWAY_PM,Production,CongTime,5,1,0.1
-IEEI_CVSUT_FREEWAY_NT,IEEI_CVSUT_PROD_FREEWAY_NT,IEEI_CVSUT_ATTR_FREEWAY_NT,Production,CongTime,5,1,0.1
-IEEI_CVSUT_NONFREEWAY_AM,IEEI_CVSUT_PROD_NONFREEWAY_AM,IEEI_CVSUT_ATTR_NONFREEWAY_AM,Production,CongTime,5,1,0.1
-IEEI_CVSUT_NONFREEWAY_MD,IEEI_CVSUT_PROD_NONFREEWAY_MD,IEEI_CVSUT_ATTR_NONFREEWAY_MD,Production,CongTime,5,1,0.1
-IEEI_CVSUT_NONFREEWAY_PM,IEEI_CVSUT_PROD_NONFREEWAY_PM,IEEI_CVSUT_ATTR_NONFREEWAY_PM,Production,CongTime,5,1,0.1
-IEEI_CVSUT_NONFREEWAY_NT,IEEI_CVSUT_PROD_NONFREEWAY_NT,IEEI_CVSUT_ATTR_NONFREEWAY_NT,Production,CongTime,5,1,0.1
-IEEI_CVMUT_FREEWAY_AM,IEEI_CVMUT_PROD_FREEWAY_AM,IEEI_CVMUT_ATTR_FREEWAY_AM,Production,CongTime,5,1,0.1
-IEEI_CVMUT_FREEWAY_MD,IEEI_CVMUT_PROD_FREEWAY_MD,IEEI_CVMUT_ATTR_FREEWAY_MD,Production,CongTime,5,1,0.1
-IEEI_CVMUT_FREEWAY_PM,IEEI_CVMUT_PROD_FREEWAY_PM,IEEI_CVMUT_ATTR_FREEWAY_PM,Production,CongTime,5,1,0.1
-IEEI_CVMUT_FREEWAY_NT,IEEI_CVMUT_PROD_FREEWAY_NT,IEEI_CVMUT_ATTR_FREEWAY_NT,Production,CongTime,5,1,0.1
-IEEI_CVMUT_NONFREEWAY_AM,IEEI_CVMUT_PROD_NONFREEWAY_AM,IEEI_CVMUT_ATTR_NONFREEWAY_AM,Production,CongTime,5,1,0.1
-IEEI_CVMUT_NONFREEWAY_MD,IEEI_CVMUT_PROD_NONFREEWAY_MD,IEEI_CVMUT_ATTR_NONFREEWAY_MD,Production,CongTime,5,1,0.1
-IEEI_CVMUT_NONFREEWAY_PM,IEEI_CVMUT_PROD_NONFREEWAY_PM,IEEI_CVMUT_ATTR_NONFREEWAY_PM,Production,CongTime,5,1,0.1
-IEEI_CVMUT_NONFREEWAY_NT,IEEI_CVMUT_PROD_NONFREEWAY_NT,IEEI_CVMUT_ATTR_NONFREEWAY_NT,Production,CongTime,5,1,0.1
+IEEI_AUTO_FREEWAY_AM,IEEI_AUTO_PROD_FREEWAY_AM,IEEI_AUTO_ATTR_FREEWAY_AM,Production,FFTime,5,1,0.1
+IEEI_AUTO_FREEWAY_MD,IEEI_AUTO_PROD_FREEWAY_MD,IEEI_AUTO_ATTR_FREEWAY_MD,Production,FFTime,5,1,0.1
+IEEI_AUTO_FREEWAY_PM,IEEI_AUTO_PROD_FREEWAY_PM,IEEI_AUTO_ATTR_FREEWAY_PM,Production,FFTime,5,1,0.1
+IEEI_AUTO_FREEWAY_NT,IEEI_AUTO_PROD_FREEWAY_NT,IEEI_AUTO_ATTR_FREEWAY_NT,Production,FFTime,5,1,0.1
+IEEI_AUTO_NONFREEWAY_AM,IEEI_AUTO_PROD_NONFREEWAY_AM,IEEI_AUTO_ATTR_NONFREEWAY_AM,Production,FFTime,5,1,0.1
+IEEI_AUTO_NONFREEWAY_MD,IEEI_AUTO_PROD_NONFREEWAY_MD,IEEI_AUTO_ATTR_NONFREEWAY_MD,Production,FFTime,5,1,0.1
+IEEI_AUTO_NONFREEWAY_PM,IEEI_AUTO_PROD_NONFREEWAY_PM,IEEI_AUTO_ATTR_NONFREEWAY_PM,Production,FFTime,5,1,0.1
+IEEI_AUTO_NONFREEWAY_NT,IEEI_AUTO_PROD_NONFREEWAY_NT,IEEI_AUTO_ATTR_NONFREEWAY_NT,Production,FFTime,5,1,0.1
+IEEI_CVSUT_FREEWAY_AM,IEEI_CVSUT_PROD_FREEWAY_AM,IEEI_CVSUT_ATTR_FREEWAY_AM,Production,FFTime,5,1,0.1
+IEEI_CVSUT_FREEWAY_MD,IEEI_CVSUT_PROD_FREEWAY_MD,IEEI_CVSUT_ATTR_FREEWAY_MD,Production,FFTime,5,1,0.1
+IEEI_CVSUT_FREEWAY_PM,IEEI_CVSUT_PROD_FREEWAY_PM,IEEI_CVSUT_ATTR_FREEWAY_PM,Production,FFTime,5,1,0.1
+IEEI_CVSUT_FREEWAY_NT,IEEI_CVSUT_PROD_FREEWAY_NT,IEEI_CVSUT_ATTR_FREEWAY_NT,Production,FFTime,5,1,0.1
+IEEI_CVSUT_NONFREEWAY_AM,IEEI_CVSUT_PROD_NONFREEWAY_AM,IEEI_CVSUT_ATTR_NONFREEWAY_AM,Production,FFTime,5,1,0.1
+IEEI_CVSUT_NONFREEWAY_MD,IEEI_CVSUT_PROD_NONFREEWAY_MD,IEEI_CVSUT_ATTR_NONFREEWAY_MD,Production,FFTime,5,1,0.1
+IEEI_CVSUT_NONFREEWAY_PM,IEEI_CVSUT_PROD_NONFREEWAY_PM,IEEI_CVSUT_ATTR_NONFREEWAY_PM,Production,FFTime,5,1,0.1
+IEEI_CVSUT_NONFREEWAY_NT,IEEI_CVSUT_PROD_NONFREEWAY_NT,IEEI_CVSUT_ATTR_NONFREEWAY_NT,Production,FFTime,5,1,0.1
+IEEI_CVMUT_FREEWAY_AM,IEEI_CVMUT_PROD_FREEWAY_AM,IEEI_CVMUT_ATTR_FREEWAY_AM,Production,FFTime,5,1,0.1
+IEEI_CVMUT_FREEWAY_MD,IEEI_CVMUT_PROD_FREEWAY_MD,IEEI_CVMUT_ATTR_FREEWAY_MD,Production,FFTime,5,1,0.1
+IEEI_CVMUT_FREEWAY_PM,IEEI_CVMUT_PROD_FREEWAY_PM,IEEI_CVMUT_ATTR_FREEWAY_PM,Production,FFTime,5,1,0.1
+IEEI_CVMUT_FREEWAY_NT,IEEI_CVMUT_PROD_FREEWAY_NT,IEEI_CVMUT_ATTR_FREEWAY_NT,Production,FFTime,5,1,0.1
+IEEI_CVMUT_NONFREEWAY_AM,IEEI_CVMUT_PROD_NONFREEWAY_AM,IEEI_CVMUT_ATTR_NONFREEWAY_AM,Production,FFTime,5,1,0.1
+IEEI_CVMUT_NONFREEWAY_MD,IEEI_CVMUT_PROD_NONFREEWAY_MD,IEEI_CVMUT_ATTR_NONFREEWAY_MD,Production,FFTime,5,1,0.1
+IEEI_CVMUT_NONFREEWAY_PM,IEEI_CVMUT_PROD_NONFREEWAY_PM,IEEI_CVMUT_ATTR_NONFREEWAY_PM,Production,FFTime,5,1,0.1
+IEEI_CVMUT_NONFREEWAY_NT,IEEI_CVMUT_PROD_NONFREEWAY_NT,IEEI_CVMUT_ATTR_NONFREEWAY_NT,Production,FFTime,5,1,0.1

---FILE: src/External Models.rsc---
@@ -31,11 +31,6 @@ Macro ""Convert EE CSV to MTX"" (Args)
   ee_csv_file = Args.[Input Folder] + ""\\external\\ee-seed.csv""
   ee_mtx_file = Args.[Output Folder] + ""\\external\\base_ee_table.mtx""
   
-  // TODO-AK: Delete after testing
-  hwy_dbd = ""D:\\Models\\TRMG2\\scenarios\\base_2016\\output\\networks\\scenario_links.dbd""
-  ee_csv_file = ""D:\\Models\\TRMG2\\scenarios\\base_2016\\input\\external\\ee-seed.csv""
-  ee_mtx_file = ""D:\\Models\\TRMG2\\scenarios\\base_2016\\output\\external\\base_ee_table.mtx""
-  
   // create empty EE matrix from node layer
   {map, {nlyr, llyr}} = RunMacro(""Create Map"", {file: hwy_dbd})
   
@@ -80,9 +75,6 @@ Calculate the production and attraction marginals at each external station.
 Macro ""Calculate EE IPF Marginals"" (Args)
   se_file = Args.SE
   
-  // TODO-AK: Delete after testing
-  se_file = ""D:\\Models\\TRMG2\\scenarios\\base_2016\\output\\sedata\\scenario_se.bin""
-  
   se_vw = OpenTable(""se"", ""FFB"", {se_file})
   SetView(se_vw)
 
@@ -129,11 +121,6 @@ Macro ""IPF EE Seed Table"" (Args)
   ee_mtx_file = Args.[Output Folder] + ""\\external\\ee_trips.mtx""
   se_file = Args.SE
   
-  // TODO-AK: Delete after testing
-  base_mtx_file = ""D:\\Models\\TRMG2\\scenarios\\base_2016\\output\\external\\base_ee_table.mtx""
-  ee_mtx_file = ""D:\\Models\\TRMG2\\scenarios\\base_2016\\output\\external\\ee_trips.mtx""
-  se_file = ""D:\\Models\\TRMG2\\scenarios\\base_2016\\output\\sedata\\scenario_se.bin""
-  
   mtx = OpenMatrix(base_mtx_file, )
   core_names = GetMatrixCoreNames(mtx)
   {ri, ci} = GetMatrixIndex(mtx)
@@ -172,12 +159,9 @@ endmacro
 This macro enforces symmetry on the EE matrix.
 */
 
-Macro ""EE Symmetry""
+Macro ""EE Symmetry"" (Args)
   ee_mtx_file = Args.[Output Folder] + ""\\external\\ee_trips.mtx""
   
-  // TODO-AK: Delete after testing
-  ee_mtx_file = ""D:\\Models\\TRMG2\\scenarios\\base_2016\\output\\external\\ee_trips.mtx""
-  
   // Open the IPFd EE mtx
   mtx = OpenMatrix(ee_mtx_file, )
   a_corenames = GetMatrixCoreNames(mtx)
@@ -225,9 +209,6 @@ Calculate IEEI productions
 Macro ""IEEI Productions"" (Args)
   se_file = Args.SE
   
-  // TODO-AK: Delete after testing
-  se_file = ""D:\\Models\\TRMG2\\scenarios\\base_2016\\output\\sedata\\scenario_se.bin""
-  
   se_vw = OpenTable(""se"", ""FFB"", {se_file})
   SetView(se_vw)
 
@@ -280,11 +261,7 @@ Calculate IEEI Attractions
 
 Macro ""IEEI Attractions"" (Args)
   se_file = Args.SE
-  ieei_model_file = Args.[Input Folder] + ""\\external\\airport_model.csv""
-  
-  // TODO-AK: Delete after testing
-  se_file = ""D:\\Models\\TRMG2\\scenarios\\base_2016\\output\\sedata\\scenario_se.bin""
-  ieei_model_file = ""D:\\Models\\TRMG2\\scenarios\\base_2016\\input\\external\\ieei_model.csv""
+  ieei_model_file = Args.[Input Folder] + ""\\external\\ieei_model.csv""
   
   se_vw = OpenTable(""se"", ""FFB"", {se_file})
   
@@ -337,9 +314,6 @@ Balance IEEI production and attraction
 Macro ""IEEI Balance Ps and As"" (Args)
   se_file = Args.SE
   
-  // TODO-AK: Delete after testing
-  se_file = ""D:\\Models\\TRMG2\\scenarios\\base_2016\\output\\sedata\\scenario_se.bin""
-  
   se_vw = OpenTable(""se"", ""FFB"", {se_file})
 
   ieei_auto_prod_freeway = GetDataVector(se_vw + ""|"", ""IEEI_AUTO_PROD_FREEWAY"", )
@@ -404,10 +378,6 @@ Macro ""IEEI TOD"" (Args)
   se_file = Args.SE
   tod_file = Args.[Input Folder] + ""\\external\\ieei_tod.csv""
 
-  // TODO-AK: Delete after testing
-  se_file = ""D:\\Models\\TRMG2\\scenarios\\base_2016\\output\\sedata\\scenario_se.bin""
-  tod_file = ""D:\\Models\\TRMG2\\scenarios\\base_2016\\input\\external\\ieei_tod.csv""
-  
   se_vw = OpenTable(""se"", ""FFB"", {se_file})
   
   {drive, folder, name, ext} = SplitPath(tod_file)
@@ -427,15 +397,9 @@ IEEI Gravity Distribution
 Macro ""IEEI Gravity"" (Args)
   se_file = Args.SE
   param_file = Args.[Input Folder] + ""\\external\\ieei_gravity.csv""
-  skim_file =  Args.[Output Folder] + ""\\skims\\roadway\\skim_sov_NT.mtx""
+  skim_file =  Args.[Output Folder] + ""\\skims\\roadway\\accessibility_sov_AM.mtx""
   ieei_matrix_file = Args.[Output Folder] + ""\\external\\ie_trips.mtx""
   
-  // TODO-AK: Delete after testing
-  se_file = ""D:\\Models\\TRMG2\\scenarios\\base_2016\\output\\sedata\\scenario_se.bin""
-  param_file = ""D:\\Models\\TRMG2\\scenarios\\base_2016\\input\\external\\ieei_gravity.csv""
-  skim_file = ""D:\\Models\\TRMG2\\scenarios\\base_2016\\output\\skims\\roadway\\skim_sov_NT.mtx""
-  ieei_matrix_file = ""D:\\Models\\TRMG2\\scenarios\\base_2016\\output\\external\\ie_trips.mtx""
-  
   opts = null
   opts.se_file = se_file
   opts.param_file = param_file
@@ -453,10 +417,6 @@ Macro ""IEEI Combine Matrix"" (Args)
   ieei_matrix_file = Args.[Output Folder] + ""\\external\\ie_trips.mtx""
   periods = Args.periods
   
-  // TODO-AK: Delete after testing
-  ieei_matrix_file = ""D:\\Models\\TRMG2\\scenarios\\base_2016\\output\\external\\ie_trips.mtx""
-  periods = {""AM"", ""MD"", ""PM"", ""NT""}
-
   ieei_mtx = OpenMatrix(ieei_matrix_file, )
   mc = CreateMatrixCurrency(ieei_mtx,,,,)
   

---FILE: trmg2.model---
@@ -217,12 +217,13 @@ Body:
     Return(True)
 EndMacro
 
-
 Macro ""External Models"" (Args,Result)
     Attributes = {{""Class"",{""GISDK""}},
                   {""MacroNames"",{""External Models""}}}
 Body:
     ShowMessage('Running: External Models')
+EndMacro
+
 Macro ""NonHomeBased"" (Args,Result)
     Attributes = {{""Class"",{""GISDK""}},
                   {""MacroNames"",{""NonHomeBased""}}}"
Triangle-Modeling-and-Analytics,TRMG2,58e9b20821d3d5972e9bee7f90e567b604ce1da4,Kyle Ward,kyle@caliper.com,2021-09-14T12:34:24Z,Kyle Ward,kyle@caliper.com,2021-09-14T12:34:24Z,Fix variable name,src/nested_dc.rsc,False,False,False,False,2,2,4,"---FILE: src/nested_dc.rsc---
@@ -237,7 +237,7 @@ Class ""NestedDC"" (ClassOpts)
         util_dir = self.ClassOpts.util_dir
         logsum_dir = self.ClassOpts.logsum_dir
         cluster_data = self.ClassOpts.cluster_data
-        cluster_util = self.ClassOpts.cluster_util
+        cluster_utils = self.ClassOpts.cluster_utils
 
         // Collect vectors of cluster names, IDs, and theta values
         theta_vw = OpenTable(""thetas"", ""CSV"", {cluster_data})
@@ -319,7 +319,7 @@ Class ""NestedDC"" (ClassOpts)
             {""mtx.ic"", 1},
             {""mtx.final"", 1}
         }, )
-        ExportView(util_vw + ""|"", ""CSV"", cluster_util, , {""CSV Header"": ""true""})
+        ExportView(util_vw + ""|"", ""CSV"", cluster_utils, , {""CSV Header"": ""true""})
         CloseView(util_vw)
     enditem
 "
Triangle-Modeling-and-Analytics,TRMG2,4a90d44dd74e88e2887c600afe23d1072ed96ef9,Kyle Ward,kyle@caliper.com,2021-09-14T03:38:51Z,Kyle Ward,kyle@caliper.com,2021-09-14T03:38:51Z,Make minor updates and corrections,master/resident/dc/dc_size_terms.csv;master/resident/dc/shadow_prices.DCB;master/resident/dc/shadow_prices.bin;master/resident/dc/w_hb_w_all_zone.csv;src/11 - Destination Choice.rsc,False,False,False,False,8,11,19,"---FILE: master/resident/dc/dc_size_terms.csv---
@@ -15,6 +15,6 @@ Office,0,0,1.210459452,0,0.000710174,0,1.394171037,14.0553,0,
 Industry,0,0,0,0,0,0,0,3.687689094,0,
 Retail,0,0,12.42859666,0,1,0.203111539,1.133148453,7.885297898,0,
 HH,0,0,0.0721,0,0,0,0,0,0,
-HHPOP,0,0,0,0,0,0,1,1,0,
+HH_POP,0,0,0,0,0,0,1,1,0,
 K12,0,0,0,1,0,0,4.132985388,6.807330185,1,
 Hosp_Service,0,0,0,0,0,0.2395,0,0,0,

---FILE: master/resident/dc/shadow_prices.DCB---
@@ -1,5 +1,4 @@
 
-20
+12
 ""TAZ"",I,1,4,0,11,0,,"""","""",,""Sum"",
-""hbw_il"",R,5,8,0,10,2,,"""",""Work trip shadow price for low-income markets"",,""Copy"",
-""hbw_ih"",R,13,8,0,10,2,,"""",""Work trip shadow price for high-income markets"",,""Sum"",
+""hbw"",R,5,8,0,10,2,,"""",""Work trip shadow price"",,""Copy"",

---FILE: master/resident/dc/w_hb_w_all_zone.csv---
@@ -6,14 +6,10 @@ se.w_hbw_size_L.D,ilvs,0.6416,Size term for low income workers
 se.w_hbw_size_L.D,v0,0.6416,Size term for low income workers
 nz(mc_logsums.nonhh_auto_vi),vi,0.7184,
 nz(mc_logsums.transit),,0.3237,
-sov_skim.IZ,,2.4630,
+sov_skim.IZ,,2.463,
 sov_skim.CongTime,,-0.0992,
 se.EmpDensity.D / 1000,,0.0018,
 se.access_hospital_sov.D,,0.3094,
 se.access_transit.D,,0.0737,
 se.access_walk.D,v0,0.3248,
-sp.hbw_il.D,ilvi,1,
-sp.hbw_il.D,ilvs,1,
-sp.hbw_il.D,v0,1,
-sp.hbw_ih.D,ihvi,1,
-sp.hbw_ih.D,ihvs,1,
+sp.hbw.D,,1,

---FILE: src/11 - Destination Choice.rsc---
@@ -138,6 +138,7 @@ Macro ""Calculate Destination Choice"" (Args)
     input_dc_dir = input_dir + ""/resident/dc""
     output_dir = Args.[Output Folder] + ""/resident/dc""
     periods = Args.periods
+    sp_file = Args.ShadowPrices
 
     // Determine trip purposes
     trip_types = RunMacro(""Get HB Trip Types"", Args)
@@ -173,7 +174,8 @@ trip_types = {""W_HB_W_All""} // TODO: remove after testing
             se_file = scen_dir + ""/output/sedata/scenario_se.bin""
             opts.tables = {
                 se: {File: se_file, IDField: ""TAZ""},
-                parking: {File: scen_dir + ""/output/resident/parking/ParkingLogsums.bin"", IDField: ""TAZ""}
+                parking: {File: scen_dir + ""/output/resident/parking/ParkingLogsums.bin"", IDField: ""TAZ""},
+                sp: {File: sp_file, IDField: ""TAZ""}
             }
             opts.cluster_equiv_spec = {File: se_file, ZoneIDField: ""TAZ"", ClusterIDField: ""Cluster""}
             opts.dc_spec = {DestinationsSource: ""sov_skim"", DestinationsIndex: ""Destination""}"
Triangle-Modeling-and-Analytics,TRMG2,3e91faa8d709c4ef583497ef1ac3b86c0153d665,Kyle Ward,kyle@caliper.com,2021-09-13T21:17:57Z,Kyle Ward,kyle@caliper.com,2021-09-13T21:17:57Z,More external corrections,master/networks/master_links.BIN,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,dcb3bee32546c2cd85ee06fb790c8b6dc1875db2,Kyle Ward,kyle@caliper.com,2021-09-09T19:54:09Z,Kyle Ward,kyle@caliper.com,2021-09-09T19:54:21Z,"Create ""Check Highway Networks"" macro

#70
This does a test assignment right after net creation to check for missing
attributes or other errors that would cause assignment to crash. This way,
the model will crash much earlier in the process and save time.",src/02 - InitialProcessing.rsc;src/Roadway Assignment.rsc,False,False,False,False,112,34,146,"---FILE: src/02 - InitialProcessing.rsc---
@@ -13,6 +13,7 @@ Macro ""Initial Processing"" (Args)
     RunMacro(""Other Attributes"", Args)
     RunMacro(""Calculate Bus Speeds"", Args)
     RunMacro(""Create Link Networks"", Args)
+    RunMacro(""Check Highway Networks"", Args)
     RunMacro(""Create Route Networks"", Args)
 
     return(1)
@@ -788,6 +789,32 @@ Macro ""Create Link Networks"" (Args)
     end
 endmacro
 
+/*
+The first time through the model, check the networks by running a 
+dummy assignment. This will catch any issues with missing capacities
+or speeds.
+*/
+
+Macro ""Check Highway Networks"" (Args)
+    feedback_iter = Args.FeedbackIteration
+    se_file = Args.SE
+
+    if feedback_iter = 1 then do
+        se_vw = OpenTable(""se"", ""FFB"", {se_file})
+        mtx_file = GetTempFileName("".mtx"")
+        mh = CreateMatrixFromView(""tmep"", se_vw + ""|"", ""TAZ"", ""TAZ"", {""TAZ""}, {""File Name"": mtx_file})
+        mtx = CreateObject(""Matrix"", mh)
+        mtx.AddCores({""SOV""})
+        cores = mtx.GetCores()
+        cores.SOV := cores.TAZ
+        mtx = null
+        mh = null
+        CloseView(se_vw)
+        test_opts.od_mtx = mtx_file
+        RunMacro(""Run Roadway Assignment"", Args, test_opts)
+    end
+endmacro
+
 /*
 
 */

---FILE: src/Roadway Assignment.rsc---
@@ -159,15 +159,19 @@ Macro ""erf_normdist"" (matrix, out_corename)
 endMacro
 
 /*
+Runs highway assignment.
 
+Early in the model run, this macro is called in testing mode to check the
+validity of the highway network and prevent wasted run time.
 */
 
-Macro ""Run Roadway Assignment"" (Args)
+Macro ""Run Roadway Assignment"" (Args, test_opts)
 
     hwy_dbd = Args.Links
     net_dir = Args.[Output Folder] + ""\\networks\\""
     periods = Args.periods
     feedback_iter = Args.FeedbackIteration
+    assign_iters = Args.AssignIterations
     prev_assn_dir = Args.[Output Folder] + ""\\assignment\\roadway\\iter_"" + String(feedback_iter - 1)
     assn_dir = Args.[Output Folder] + ""\\assignment\\roadway\\iter_"" + String(feedback_iter)
     RunMacro(""Create Directory"", assn_dir)
@@ -185,15 +189,21 @@ Macro ""Run Roadway Assignment"" (Args)
     if n > 0 then hov_exists = ""true""
     CloseMap(map)
 
+
     for period in periods do
         od_mtx = od_dir + ""\\TOT"" + period + ""_OD_conv_tod.mtx""
         net_file = net_dir + ""net_"" + period + ""_hov.net""
 
+        if test_opts <> null then do
+            od_mtx = test_opts.od_mtx
+            assign_iters = 1
+        end
+
         o = CreateObject(""Network.Assignment"")
         o.Network = net_file
         o.LayerDB = hwy_dbd
         o.ResetClasses()
-        o.Iterations = Args.AssignIterations
+        o.Iterations = assign_iters
         // TODO: move back to the official number (10e-5)
         // o.Convergence = Args.AssignConvergence
         o.Convergence = .0003
@@ -216,36 +226,79 @@ Macro ""Run Roadway Assignment"" (Args)
             Iteration: feedback_iter
         })
         o.FlowTable = assn_dir + ""\\roadway_assignment_"" + period + "".bin""
-        class_opts = {
-            Demand: ""SOV"",
-            PCE: 1,
-            VOI: 1,
-            LinkTollField: ""TollCostSOV""
-        }
-        if hov_exists then class_opts = class_opts + {ExclusionFilter: ""HOV <> 'None'""}
-        o.AddClass(class_opts)
-        o.AddClass({
-            Demand: ""HOV"",
-            PCE: 1,
-            VOI: 1,
-            LinkTollField: ""TollCostHOV""
-        })
-        class_opts = {
-            Demand: ""SUT"",
-            PCE: 1,
-            VOI: 1,
-            LinkTollField: ""TollCostSUT""
-        }
-        if hov_exists then class_opts = class_opts + {ExclusionFilter: ""HOV <> 'None'""}
-        o.AddClass(class_opts)
-        class_opts = {
-            Demand: ""MUT"",
-            PCE: 1,
-            VOI: 1,
-            LinkTollField: ""TollCostMUT""
-        }
-        if hov_exists then class_opts = class_opts + {ExclusionFilter: ""HOV <> 'None'""}
-        o.AddClass(class_opts)
+        // Add classes for each combination of vehicle type and VOT
+        // If doing a test assignment, just create a single class from the
+        // dummy matrix
+        if test_opts <> null then do
+            o.AddClass({
+                Demand: ""TAZ"",
+                PCE: 1,
+                VOI: 1
+            })
+        end else do
+            // sov
+            for i = 1 to 5 do
+                sov_opts = {
+                    Demand: ""sov_VOT"" + String(i),
+                    PCE: 1,
+                    VOI: 1,
+                    LinkTollField: ""TollCostSOV""
+                }
+                if hov_exists then sov_opts = sov_opts + {ExclusionFilter: ""HOV <> 'None'""}
+                o.AddClass(sov_opts)
+            end
+            // hov2
+            for i = 1 to 5 do
+                o.AddClass({
+                    Demand: ""hov2_VOT"" + String(i),
+                    PCE: 1,
+                    VOI: 1,
+                    LinkTollField: ""TollCostHOV""
+                })
+            end
+            // hov3
+            for i = 1 to 5 do
+                o.AddClass({
+                    Demand: ""hov3_VOT"" + String(i),
+                    PCE: 1,
+                    VOI: 1,
+                    LinkTollField: ""TollCostHOV""
+                })
+            end
+            // CV
+            for i = 1 to 5 do
+                cv_opts = {
+                    Demand: ""SUT_VOT"" + String(i),
+                    PCE: 1,
+                    VOI: 1,
+                    LinkTollField: ""TollCostSUT""
+                }
+                if hov_exists then cv_opts = cv_opts + {ExclusionFilter: ""HOV <> 'None'""}
+                o.AddClass(cv_opts)
+            end
+            // SUT
+            for i = 1 to 3 do
+                sut_opts = {
+                    Demand: ""SUT_VOT"" + String(i),
+                    PCE: 1,
+                    VOI: 1,
+                    LinkTollField: ""TollCostSUT""
+                }
+                if hov_exists then sut_opts = sut_opts + {ExclusionFilter: ""HOV <> 'None'""}
+                o.AddClass(sut_opts)
+            end
+            // MUT
+            for i = 1 to 5 do
+                mut_opts = {
+                    Demand: ""MUT_VOT"" + String(i),
+                    PCE: 1,
+                    VOI: 1,
+                    LinkTollField: ""TollCostMUT""
+                }
+                if hov_exists then mut_opts = mut_opts + {ExclusionFilter: ""HOV <> 'None'""}
+                o.AddClass(mut_opts)
+            end
+        end
         ret_value = o.Run()
         results = o.GetResults()
         /*
@@ -256,8 +309,6 @@ Macro ""Run Roadway Assignment"" (Args)
         etc.
         */
     end
-
-    
 endmacro
 
 /*"
Triangle-Modeling-and-Analytics,TRMG2,9661cd391013037ae109460be430d6c4c42da607,Kyle Ward,kyle@caliper.com,2021-09-03T13:04:23Z,Kyle Ward,kyle@caliper.com,2021-09-03T13:04:23Z,"Correct table formatting

Last row of a table was ovelapping with text. Fixed.",docs/nhb.html;docs/styles.css,False,False,False,False,15,2,17,"---FILE: docs/nhb.html---
@@ -30,6 +30,8 @@
 <script src=""site_libs/anchor-sections-1.0/anchor-sections.js""></script>
 <script src=""site_libs/kePrint-0.0.1/kePrint.js""></script>
 <link href=""site_libs/lightable-0.0.1/lightable.css"" rel=""stylesheet"" />
+<link href=""site_libs/font-awesome-5.1.0/css/all.css"" rel=""stylesheet"" />
+<link href=""site_libs/font-awesome-5.1.0/css/v4-shims.css"" rel=""stylesheet"" />
 
 <style type=""text/css"">
   code{white-space: pre-wrap;}
@@ -372,6 +374,9 @@
     <li>
       <a href=""survey_processing.html"">Household Survey</a>
     </li>
+    <li>
+      <a href=""obs_processing.html"">On-Board Survey</a>
+    </li>
   </ul>
 </li>
 <li class=""dropdown"">
@@ -396,6 +401,9 @@
     <li>
       <a href=""resident_nonmotorized.html"">Non-motorized</a>
     </li>
+    <li>
+      <a href=""parking.html"">Parking</a>
+    </li>
     <li>
       <a href=""nhb.html"">Non-homebased</a>
     </li>
@@ -421,7 +429,12 @@
 </li>
       </ul>
       <ul class=""nav navbar-nav navbar-right"">
-        
+        <li>
+  <a href=""https://github.com/Caliper-Corporation/TRMG2"">
+    <span class=""fa fa-github fa-2x""></span>
+     
+  </a>
+</li>
       </ul>
     </div><!--/.nav-collapse -->
   </div><!--/.container -->

---FILE: docs/styles.css---
@@ -29,7 +29,7 @@ th, td {
 }
 
 .N_NH_O_All .tab-content {
-  height: 39em;
+  height: 41em;
 }
 
 .W_NH_EK12_All .tab-content {"
Triangle-Modeling-and-Analytics,TRMG2,afe62f7c4a5774dfc640e8168a44f0d3be126856,Kyle Ward,kyle@caliper.com,2021-08-31T18:43:43Z,Kyle Ward,kyle@caliper.com,2021-08-31T18:43:43Z,"Correct chart_time() in the tod documentation

The original function was screwing the drawing of the
charts. This one fixes the charting. The change does
not impact results - only the visuals of the charts.",docs/time_of_day.Rmd;docs/time_of_day.html,True,False,True,False,14,14,28,"---FILE: docs/time_of_day.Rmd---
@@ -92,9 +92,9 @@ timTbl <- tibble(
 ```
 
 ```{r time_conv_formula}
-# Formula for converting minutes to chart format (e.g. 1000 for 10:00 am)
+# Formula for converting minutes to chart format (e.g. 5.25 for 5:15 am)
 chart_time <- function(minutes){
-  ((minutes %/% 60) * 100 + (minutes %% 60)) / 100
+  ((minutes %/% 60) + (minutes %% 60) / 60)
 }
 ```
 

---FILE: docs/time_of_day.html---
@@ -466,8 +466,8 @@ <h1>Introduction</h1>
 <h1>Peak period determination</h1>
 <p><em>(To skip to the final period definitions, click <a href=""#final_defs"">here</a>.)</em></p>
 <p>Peak period determination is based on an analysis of the trips in motion throughout the day. First, the day is broken up into 15-minute increments. A trip from the household survey is said to be in motion if any portion of the trip occurs within the 15-minute bin. As a result, a single trip can be counted in multiple bins. Determining the peak period considers the distribution of all trips as well as the distribution of trips on work tours individually. The chart below shows these two distributions, which look as expected with the AM peak being shorter and more condensed than the PM.</p>
-<div id=""htmlwidget-d883f550efbdada172e5"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
-<script type=""application/json"" data-for=""htmlwidget-d883f550efbdada172e5"">{""x"":{""visdat"":{""73505de528cc"":[""function () "",""plotlyVisDat""]},""cur_data"":""73505de528cc"",""attrs"":{""73505de528cc"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""All"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter""},""73505de528cc.1"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""Work"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Distribution of Trips in Motion by Purpose"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Time of Day""},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Trips in Motion""},""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[0,0.15,0.3,0.45,1,1.15,1.3,1.45,2,2.15,2.3,2.45,3,3.15,3.3,3.45,4,4.15,4.3,4.45,5,5.15,5.3,5.45,6,6.15,6.3,6.45,7,7.15,7.3,7.45,8,8.15,8.3,8.45,9,9.15,9.3,9.45,10,10.15,10.3,10.45,11,11.15,11.3,11.45,12,12.15,12.3,12.45,13,13.15,13.3,13.45,14,14.15,14.3,14.45,15,15.15,15.3,15.45,16,16.15,16.3,16.45,17,17.15,17.3,17.45,18,18.15,18.3,18.45,19,19.15,19.3,19.45,20,20.15,20.3,20.45,21,21.15,21.3,21.45,22,22.15,22.3,22.45,23,23.15,23.3,23.45,24],""y"":[2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,6006.91633033752,3410.09362983704,4500.83061599731,4765.82431411743,8006.77574920654,6569.41974258423,7685.39112472534,8822.62908744812,13670.3632354736,19029.7920532227,30755.1913146973,39920.9330482483,73005.4471073151,93167.3357563019,152907.307727814,214949.553100586,337438.420101802,336102.567385737,360868.730823898,338909.257696533,375600.01715126,317963.929812177,324390.293670972,277819.02749602,304165.385853767,238720.6982282,211784.448801359,201598.047504425,261437.061003685,224179.39450868,240411.656651815,216316.87800916,258394.671279271,233479.573026657,241689.977338791,244000.05855751,314327.5847435,274645.207396825,261858.255025228,255500.890740713,302353.041838964,260254.874181112,247806.449596723,233514.178727468,284385.483388265,287609.348368009,336457.066494306,316149.00978597,384585.508785566,355704.032983144,388814.663953781,367504.416643524,451568.284702047,390884.834669813,402207.104516411,367950.996014659,458363.171119054,435887.117752393,461875.915699641,416503.391982079,446978.036206245,350113.10400486,340046.982152939,285602.246705691,292584.817763964,234046.789671898,222718.154975573,198955.189921061,202134.527949015,157585.30718867,152419.587581635,117983.69462204,137054.122617722,99612.0579586029,86675.2117328644,68056.894449234,55649.9656295776,42631.0930080414,39612.3422546387,30402.3474349976,34907.5340042114,28604.2598323822,25186.135099411,21243.2928848267,0],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  6,007"",""  3,410"",""  4,501"",""  4,766"",""  8,007"",""  6,569"",""  7,685"",""  8,823"","" 13,670"","" 19,030"","" 30,755"","" 39,921"","" 73,005"","" 93,167"",""152,907"",""214,950"",""337,438"",""336,103"",""360,869"",""338,909"",""375,600"",""317,964"",""324,390"",""277,819"",""304,165"",""238,721"",""211,784"",""201,598"",""261,437"",""224,179"",""240,412"",""216,317"",""258,395"",""233,480"",""241,690"",""244,000"",""314,328"",""274,645"",""261,858"",""255,501"",""302,353"",""260,255"",""247,806"",""233,514"",""284,385"",""287,609"",""336,457"",""316,149"",""384,586"",""355,704"",""388,815"",""367,504"",""451,568"",""390,885"",""402,207"",""367,951"",""458,363"",""435,887"",""461,876"",""416,503"",""446,978"",""350,113"",""340,047"",""285,602"",""292,585"",""234,047"",""222,718"",""198,955"",""202,135"",""157,585"",""152,420"",""117,984"",""137,054"","" 99,612"","" 86,675"","" 68,057"","" 55,650"","" 42,631"","" 39,612"","" 30,402"","" 34,908"","" 28,604"","" 25,186"","" 21,243"",""      0""],""name"":""All"",""type"":""scatter"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""line"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[0,0.15,0.3,0.45,1,1.15,1.3,1.45,2,2.15,2.3,2.45,3,3.15,3.3,3.45,4,4.15,4.3,4.45,5,5.15,5.3,5.45,6,6.15,6.3,6.45,7,7.15,7.3,7.45,8,8.15,8.3,8.45,9,9.15,9.3,9.45,10,10.15,10.3,10.45,11,11.15,11.3,11.45,12,12.15,12.3,12.45,13,13.15,13.3,13.45,14,14.15,14.3,14.45,15,15.15,15.3,15.45,16,16.15,16.3,16.45,17,17.15,17.3,17.45,18,18.15,18.3,18.45,19,19.15,19.3,19.45,20,20.15,20.3,20.45,21,21.15,21.3,21.45,22,22.15,22.3,22.45,23,23.15,23.3,23.45],""y"":[193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,1044.11817932129,673.78125,1290.64489746094,1290.64489746094,3582.1994972229,2401.72974014282,2696.99674224854,3107.886510849,6593.75918197632,10495.2417373657,16177.1951370239,21337.3504562378,38714.4268798828,43514.4934501648,65666.2001285553,86489.1554737091,141025.194073359,149134.995801036,161429.576951091,144395.589840953,154607.089163844,126857.728663826,114486.740981102,93276.8254264196,82803.5459127426,54031.9008331299,46680.0662546158,40871.8711566925,44832.6411361694,37928.4909000397,41539.4283638001,37545.1418762207,41549.0018920899,36748.8684005737,48649.3619918823,51888.9503307343,86562.3391017914,73143.4974250794,73236.4439620972,69757.4209632874,79823.8787784577,64540.350063324,51388.7570552826,45252.1525268555,57877.5988750458,53590.1729049683,56697.467300415,54118.2288579941,64745.7610502243,58228.6229400635,76457.8760757446,73539.88387146,110964.418190384,114604.069358254,141527.684072558,134662.718091075,194375.002415021,183897.287487348,183724.700570742,148759.346390406,152983.076712926,114388.242678324,97863.8950659434,75776.4539200465,67947.3298298518,48919.5318994522,44579.5964078903,38554.1393985748,41244.9993591309,32195.8383808136,25442.4671154022,17983.6726665497,25867.90234375,18728.86211586,13486.4835357666,10726.4907131195,8487.2252292633,8756.64052391052,7938.54296684265,8202.9447593689,7960.69645500183,7266.09953689575,4765.4617061615,2970.16893196106],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""  1,044"",""    674"",""  1,291"",""  1,291"",""  3,582"",""  2,402"",""  2,697"",""  3,108"",""  6,594"","" 10,495"","" 16,177"","" 21,337"","" 38,714"","" 43,514"","" 65,666"","" 86,489"",""141,025"",""149,135"",""161,430"",""144,396"",""154,607"",""126,858"",""114,487"","" 93,277"","" 82,804"","" 54,032"","" 46,680"","" 40,872"","" 44,833"","" 37,928"","" 41,539"","" 37,545"","" 41,549"","" 36,749"","" 48,649"","" 51,889"","" 86,562"","" 73,143"","" 73,236"","" 69,757"","" 79,824"","" 64,540"","" 51,389"","" 45,252"","" 57,878"","" 53,590"","" 56,697"","" 54,118"","" 64,746"","" 58,229"","" 76,458"","" 73,540"",""110,964"",""114,604"",""141,528"",""134,663"",""194,375"",""183,897"",""183,725"",""148,759"",""152,983"",""114,388"","" 97,864"","" 75,776"","" 67,947"","" 48,920"","" 44,580"","" 38,554"","" 41,245"","" 32,196"","" 25,442"","" 17,984"","" 25,868"","" 18,729"","" 13,486"","" 10,726"",""  8,487"",""  8,757"",""  7,939"",""  8,203"",""  7,961"",""  7,266"",""  4,765"",""  2,970""],""name"":""Work"",""type"":""scatter"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""line"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
+<div id=""htmlwidget-0a4e03e0a2a5c0ab2425"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
+<script type=""application/json"" data-for=""htmlwidget-0a4e03e0a2a5c0ab2425"">{""x"":{""visdat"":{""1634322dfa"":[""function () "",""plotlyVisDat""]},""cur_data"":""1634322dfa"",""attrs"":{""1634322dfa"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""All"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter""},""1634322dfa.1"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""Work"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Distribution of Trips in Motion by Purpose"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Time of Day""},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Trips in Motion""},""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75,24],""y"":[2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,6006.91633033752,3410.09362983704,4500.83061599731,4765.82431411743,8006.77574920654,6569.41974258423,7685.39112472534,8822.62908744812,13670.3632354736,19029.7920532227,30755.1913146973,39920.9330482483,73005.4471073151,93167.3357563019,152907.307727814,214949.553100586,337438.420101802,336102.567385737,360868.730823898,338909.257696533,375600.01715126,317963.929812177,324390.293670972,277819.02749602,304165.385853767,238720.6982282,211784.448801359,201598.047504425,261437.061003685,224179.39450868,240411.656651815,216316.87800916,258394.671279271,233479.573026657,241689.977338791,244000.05855751,314327.5847435,274645.207396825,261858.255025228,255500.890740713,302353.041838964,260254.874181112,247806.449596723,233514.178727468,284385.483388265,287609.348368009,336457.066494306,316149.00978597,384585.508785566,355704.032983144,388814.663953781,367504.416643524,451568.284702047,390884.834669813,402207.104516411,367950.996014659,458363.171119054,435887.117752393,461875.915699641,416503.391982079,446978.036206245,350113.10400486,340046.982152939,285602.246705691,292584.817763964,234046.789671898,222718.154975573,198955.189921061,202134.527949015,157585.30718867,152419.587581635,117983.69462204,137054.122617722,99612.0579586029,86675.2117328644,68056.894449234,55649.9656295776,42631.0930080414,39612.3422546387,30402.3474349976,34907.5340042114,28604.2598323822,25186.135099411,21243.2928848267,0],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  6,007"",""  3,410"",""  4,501"",""  4,766"",""  8,007"",""  6,569"",""  7,685"",""  8,823"","" 13,670"","" 19,030"","" 30,755"","" 39,921"","" 73,005"","" 93,167"",""152,907"",""214,950"",""337,438"",""336,103"",""360,869"",""338,909"",""375,600"",""317,964"",""324,390"",""277,819"",""304,165"",""238,721"",""211,784"",""201,598"",""261,437"",""224,179"",""240,412"",""216,317"",""258,395"",""233,480"",""241,690"",""244,000"",""314,328"",""274,645"",""261,858"",""255,501"",""302,353"",""260,255"",""247,806"",""233,514"",""284,385"",""287,609"",""336,457"",""316,149"",""384,586"",""355,704"",""388,815"",""367,504"",""451,568"",""390,885"",""402,207"",""367,951"",""458,363"",""435,887"",""461,876"",""416,503"",""446,978"",""350,113"",""340,047"",""285,602"",""292,585"",""234,047"",""222,718"",""198,955"",""202,135"",""157,585"",""152,420"",""117,984"",""137,054"","" 99,612"","" 86,675"","" 68,057"","" 55,650"","" 42,631"","" 39,612"","" 30,402"","" 34,908"","" 28,604"","" 25,186"","" 21,243"",""      0""],""name"":""All"",""type"":""scatter"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""line"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75],""y"":[193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,1044.11817932129,673.78125,1290.64489746094,1290.64489746094,3582.1994972229,2401.72974014282,2696.99674224854,3107.886510849,6593.75918197632,10495.2417373657,16177.1951370239,21337.3504562378,38714.4268798828,43514.4934501648,65666.2001285553,86489.1554737091,141025.194073359,149134.995801036,161429.576951091,144395.589840953,154607.089163844,126857.728663826,114486.740981102,93276.8254264196,82803.5459127426,54031.9008331299,46680.0662546158,40871.8711566925,44832.6411361694,37928.4909000397,41539.4283638001,37545.1418762207,41549.0018920899,36748.8684005737,48649.3619918823,51888.9503307343,86562.3391017914,73143.4974250794,73236.4439620972,69757.4209632874,79823.8787784577,64540.350063324,51388.7570552826,45252.1525268555,57877.5988750458,53590.1729049683,56697.467300415,54118.2288579941,64745.7610502243,58228.6229400635,76457.8760757446,73539.88387146,110964.418190384,114604.069358254,141527.684072558,134662.718091075,194375.002415021,183897.287487348,183724.700570742,148759.346390406,152983.076712926,114388.242678324,97863.8950659434,75776.4539200465,67947.3298298518,48919.5318994522,44579.5964078903,38554.1393985748,41244.9993591309,32195.8383808136,25442.4671154022,17983.6726665497,25867.90234375,18728.86211586,13486.4835357666,10726.4907131195,8487.2252292633,8756.64052391052,7938.54296684265,8202.9447593689,7960.69645500183,7266.09953689575,4765.4617061615,2970.16893196106],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""  1,044"",""    674"",""  1,291"",""  1,291"",""  3,582"",""  2,402"",""  2,697"",""  3,108"",""  6,594"","" 10,495"","" 16,177"","" 21,337"","" 38,714"","" 43,514"","" 65,666"","" 86,489"",""141,025"",""149,135"",""161,430"",""144,396"",""154,607"",""126,858"",""114,487"","" 93,277"","" 82,804"","" 54,032"","" 46,680"","" 40,872"","" 44,833"","" 37,928"","" 41,539"","" 37,545"","" 41,549"","" 36,749"","" 48,649"","" 51,889"","" 86,562"","" 73,143"","" 73,236"","" 69,757"","" 79,824"","" 64,540"","" 51,389"","" 45,252"","" 57,878"","" 53,590"","" 56,697"","" 54,118"","" 64,746"","" 58,229"","" 76,458"","" 73,540"",""110,964"",""114,604"",""141,528"",""134,663"",""194,375"",""183,897"",""183,725"",""148,759"",""152,983"",""114,388"","" 97,864"","" 75,776"","" 67,947"","" 48,920"","" 44,580"","" 38,554"","" 41,245"","" 32,196"","" 25,442"","" 17,984"","" 25,868"","" 18,729"","" 13,486"","" 10,726"",""  8,487"",""  8,757"",""  7,939"",""  8,203"",""  7,961"",""  7,266"",""  4,765"",""  2,970""],""name"":""Work"",""type"":""scatter"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""line"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
 <p>The next step is to determine the peak hour for all trips and those on work tours. In the tables below, the AM and PM peak hours by type are presented. At a minimum, the AM and PM peak periods should contain the respective peak hour for work trips and all trips. The chart below shows that the peak hour for work and all trips are exactly the same in the Triangle region based on the surveys as is often, but not always, the case.</p>
 <table class=""table"" style=""width: auto !important; margin-left: auto; margin-right: auto;"">
 <thead>
@@ -547,8 +547,8 @@ <h1>Peak period determination</h1>
 </tr>
 </tbody>
 </table>
-<div id=""htmlwidget-83546dcd448c132e08c3"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
-<script type=""application/json"" data-for=""htmlwidget-83546dcd448c132e08c3"">{""x"":{""visdat"":{""7350fea3124"":[""function () "",""plotlyVisDat""]},""cur_data"":""7350fea3124"",""attrs"":{""7350fea3124"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""All"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter""},""7350fea3124.1"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""Work"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true},""7350fea3124.2"":{""x"":[7.5,17.1],""y"":[471113.434013634,471113.434013634],""mode"":""text"",""hoverinfo"":""x"",""text"":[""Work and All"",""Work and All""],""name"":""Peak Hours"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Peak Hours"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Time of Day""},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Trips in Motion""},""shapes"":[{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":16.45,""x1"":17.45,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":16.45,""x1"":17.45,""y0"":0,""y1"":461875.915699641}],""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[0,0.15,0.3,0.45,1,1.15,1.3,1.45,2,2.15,2.3,2.45,3,3.15,3.3,3.45,4,4.15,4.3,4.45,5,5.15,5.3,5.45,6,6.15,6.3,6.45,7,7.15,7.3,7.45,8,8.15,8.3,8.45,9,9.15,9.3,9.45,10,10.15,10.3,10.45,11,11.15,11.3,11.45,12,12.15,12.3,12.45,13,13.15,13.3,13.45,14,14.15,14.3,14.45,15,15.15,15.3,15.45,16,16.15,16.3,16.45,17,17.15,17.3,17.45,18,18.15,18.3,18.45,19,19.15,19.3,19.45,20,20.15,20.3,20.45,21,21.15,21.3,21.45,22,22.15,22.3,22.45,23,23.15,23.3,23.45,24],""y"":[2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,6006.91633033752,3410.09362983704,4500.83061599731,4765.82431411743,8006.77574920654,6569.41974258423,7685.39112472534,8822.62908744812,13670.3632354736,19029.7920532227,30755.1913146973,39920.9330482483,73005.4471073151,93167.3357563019,152907.307727814,214949.553100586,337438.420101802,336102.567385737,360868.730823898,338909.257696533,375600.01715126,317963.929812177,324390.293670972,277819.02749602,304165.385853767,238720.6982282,211784.448801359,201598.047504425,261437.061003685,224179.39450868,240411.656651815,216316.87800916,258394.671279271,233479.573026657,241689.977338791,244000.05855751,314327.5847435,274645.207396825,261858.255025228,255500.890740713,302353.041838964,260254.874181112,247806.449596723,233514.178727468,284385.483388265,287609.348368009,336457.066494306,316149.00978597,384585.508785566,355704.032983144,388814.663953781,367504.416643524,451568.284702047,390884.834669813,402207.104516411,367950.996014659,458363.171119054,435887.117752393,461875.915699641,416503.391982079,446978.036206245,350113.10400486,340046.982152939,285602.246705691,292584.817763964,234046.789671898,222718.154975573,198955.189921061,202134.527949015,157585.30718867,152419.587581635,117983.69462204,137054.122617722,99612.0579586029,86675.2117328644,68056.894449234,55649.9656295776,42631.0930080414,39612.3422546387,30402.3474349976,34907.5340042114,28604.2598323822,25186.135099411,21243.2928848267,0],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  6,007"",""  3,410"",""  4,501"",""  4,766"",""  8,007"",""  6,569"",""  7,685"",""  8,823"","" 13,670"","" 19,030"","" 30,755"","" 39,921"","" 73,005"","" 93,167"",""152,907"",""214,950"",""337,438"",""336,103"",""360,869"",""338,909"",""375,600"",""317,964"",""324,390"",""277,819"",""304,165"",""238,721"",""211,784"",""201,598"",""261,437"",""224,179"",""240,412"",""216,317"",""258,395"",""233,480"",""241,690"",""244,000"",""314,328"",""274,645"",""261,858"",""255,501"",""302,353"",""260,255"",""247,806"",""233,514"",""284,385"",""287,609"",""336,457"",""316,149"",""384,586"",""355,704"",""388,815"",""367,504"",""451,568"",""390,885"",""402,207"",""367,951"",""458,363"",""435,887"",""461,876"",""416,503"",""446,978"",""350,113"",""340,047"",""285,602"",""292,585"",""234,047"",""222,718"",""198,955"",""202,135"",""157,585"",""152,420"",""117,984"",""137,054"","" 99,612"","" 86,675"","" 68,057"","" 55,650"","" 42,631"","" 39,612"","" 30,402"","" 34,908"","" 28,604"","" 25,186"","" 21,243"",""      0""],""name"":""All"",""type"":""scatter"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""line"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[0,0.15,0.3,0.45,1,1.15,1.3,1.45,2,2.15,2.3,2.45,3,3.15,3.3,3.45,4,4.15,4.3,4.45,5,5.15,5.3,5.45,6,6.15,6.3,6.45,7,7.15,7.3,7.45,8,8.15,8.3,8.45,9,9.15,9.3,9.45,10,10.15,10.3,10.45,11,11.15,11.3,11.45,12,12.15,12.3,12.45,13,13.15,13.3,13.45,14,14.15,14.3,14.45,15,15.15,15.3,15.45,16,16.15,16.3,16.45,17,17.15,17.3,17.45,18,18.15,18.3,18.45,19,19.15,19.3,19.45,20,20.15,20.3,20.45,21,21.15,21.3,21.45,22,22.15,22.3,22.45,23,23.15,23.3,23.45],""y"":[193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,1044.11817932129,673.78125,1290.64489746094,1290.64489746094,3582.1994972229,2401.72974014282,2696.99674224854,3107.886510849,6593.75918197632,10495.2417373657,16177.1951370239,21337.3504562378,38714.4268798828,43514.4934501648,65666.2001285553,86489.1554737091,141025.194073359,149134.995801036,161429.576951091,144395.589840953,154607.089163844,126857.728663826,114486.740981102,93276.8254264196,82803.5459127426,54031.9008331299,46680.0662546158,40871.8711566925,44832.6411361694,37928.4909000397,41539.4283638001,37545.1418762207,41549.0018920899,36748.8684005737,48649.3619918823,51888.9503307343,86562.3391017914,73143.4974250794,73236.4439620972,69757.4209632874,79823.8787784577,64540.350063324,51388.7570552826,45252.1525268555,57877.5988750458,53590.1729049683,56697.467300415,54118.2288579941,64745.7610502243,58228.6229400635,76457.8760757446,73539.88387146,110964.418190384,114604.069358254,141527.684072558,134662.718091075,194375.002415021,183897.287487348,183724.700570742,148759.346390406,152983.076712926,114388.242678324,97863.8950659434,75776.4539200465,67947.3298298518,48919.5318994522,44579.5964078903,38554.1393985748,41244.9993591309,32195.8383808136,25442.4671154022,17983.6726665497,25867.90234375,18728.86211586,13486.4835357666,10726.4907131195,8487.2252292633,8756.64052391052,7938.54296684265,8202.9447593689,7960.69645500183,7266.09953689575,4765.4617061615,2970.16893196106],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""  1,044"",""    674"",""  1,291"",""  1,291"",""  3,582"",""  2,402"",""  2,697"",""  3,108"",""  6,594"","" 10,495"","" 16,177"","" 21,337"","" 38,714"","" 43,514"","" 65,666"","" 86,489"",""141,025"",""149,135"",""161,430"",""144,396"",""154,607"",""126,858"",""114,487"","" 93,277"","" 82,804"","" 54,032"","" 46,680"","" 40,872"","" 44,833"","" 37,928"","" 41,539"","" 37,545"","" 41,549"","" 36,749"","" 48,649"","" 51,889"","" 86,562"","" 73,143"","" 73,236"","" 69,757"","" 79,824"","" 64,540"","" 51,389"","" 45,252"","" 57,878"","" 53,590"","" 56,697"","" 54,118"","" 64,746"","" 58,229"","" 76,458"","" 73,540"",""110,964"",""114,604"",""141,528"",""134,663"",""194,375"",""183,897"",""183,725"",""148,759"",""152,983"",""114,388"","" 97,864"","" 75,776"","" 67,947"","" 48,920"","" 44,580"","" 38,554"","" 41,245"","" 32,196"","" 25,442"","" 17,984"","" 25,868"","" 18,729"","" 13,486"","" 10,726"",""  8,487"",""  8,757"",""  7,939"",""  8,203"",""  7,961"",""  7,266"",""  4,765"",""  2,970""],""name"":""Work"",""type"":""scatter"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""line"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[7.5,17.1],""y"":[471113.434013634,471113.434013634],""mode"":""text"",""hoverinfo"":[""x"",""x""],""text"":[""Work and All"",""Work and All""],""name"":""Peak Hours"",""type"":""scatter"",""marker"":{""color"":""rgba(44,160,44,1)"",""line"":{""color"":""rgba(44,160,44,1)""}},""error_y"":{""color"":""rgba(44,160,44,1)""},""error_x"":{""color"":""rgba(44,160,44,1)""},""line"":{""color"":""rgba(44,160,44,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
+<div id=""htmlwidget-b27a5f62ba084bd8e232"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
+<script type=""application/json"" data-for=""htmlwidget-b27a5f62ba084bd8e232"">{""x"":{""visdat"":{""1634250f7297"":[""function () "",""plotlyVisDat""]},""cur_data"":""1634250f7297"",""attrs"":{""1634250f7297"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""All"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter""},""1634250f7297.1"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""Work"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true},""1634250f7297.2"":{""x"":[7.83333333333333,17.1666666666667],""y"":[471113.434013634,471113.434013634],""mode"":""text"",""hoverinfo"":""x"",""text"":[""Work and All"",""Work and All""],""name"":""Peak Hours"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Peak Hours"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Time of Day""},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Trips in Motion""},""shapes"":[{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":16.75,""x1"":17.75,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":16.75,""x1"":17.75,""y0"":0,""y1"":461875.915699641}],""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75,24],""y"":[2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,6006.91633033752,3410.09362983704,4500.83061599731,4765.82431411743,8006.77574920654,6569.41974258423,7685.39112472534,8822.62908744812,13670.3632354736,19029.7920532227,30755.1913146973,39920.9330482483,73005.4471073151,93167.3357563019,152907.307727814,214949.553100586,337438.420101802,336102.567385737,360868.730823898,338909.257696533,375600.01715126,317963.929812177,324390.293670972,277819.02749602,304165.385853767,238720.6982282,211784.448801359,201598.047504425,261437.061003685,224179.39450868,240411.656651815,216316.87800916,258394.671279271,233479.573026657,241689.977338791,244000.05855751,314327.5847435,274645.207396825,261858.255025228,255500.890740713,302353.041838964,260254.874181112,247806.449596723,233514.178727468,284385.483388265,287609.348368009,336457.066494306,316149.00978597,384585.508785566,355704.032983144,388814.663953781,367504.416643524,451568.284702047,390884.834669813,402207.104516411,367950.996014659,458363.171119054,435887.117752393,461875.915699641,416503.391982079,446978.036206245,350113.10400486,340046.982152939,285602.246705691,292584.817763964,234046.789671898,222718.154975573,198955.189921061,202134.527949015,157585.30718867,152419.587581635,117983.69462204,137054.122617722,99612.0579586029,86675.2117328644,68056.894449234,55649.9656295776,42631.0930080414,39612.3422546387,30402.3474349976,34907.5340042114,28604.2598323822,25186.135099411,21243.2928848267,0],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  6,007"",""  3,410"",""  4,501"",""  4,766"",""  8,007"",""  6,569"",""  7,685"",""  8,823"","" 13,670"","" 19,030"","" 30,755"","" 39,921"","" 73,005"","" 93,167"",""152,907"",""214,950"",""337,438"",""336,103"",""360,869"",""338,909"",""375,600"",""317,964"",""324,390"",""277,819"",""304,165"",""238,721"",""211,784"",""201,598"",""261,437"",""224,179"",""240,412"",""216,317"",""258,395"",""233,480"",""241,690"",""244,000"",""314,328"",""274,645"",""261,858"",""255,501"",""302,353"",""260,255"",""247,806"",""233,514"",""284,385"",""287,609"",""336,457"",""316,149"",""384,586"",""355,704"",""388,815"",""367,504"",""451,568"",""390,885"",""402,207"",""367,951"",""458,363"",""435,887"",""461,876"",""416,503"",""446,978"",""350,113"",""340,047"",""285,602"",""292,585"",""234,047"",""222,718"",""198,955"",""202,135"",""157,585"",""152,420"",""117,984"",""137,054"","" 99,612"","" 86,675"","" 68,057"","" 55,650"","" 42,631"","" 39,612"","" 30,402"","" 34,908"","" 28,604"","" 25,186"","" 21,243"",""      0""],""name"":""All"",""type"":""scatter"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""line"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75],""y"":[193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,1044.11817932129,673.78125,1290.64489746094,1290.64489746094,3582.1994972229,2401.72974014282,2696.99674224854,3107.886510849,6593.75918197632,10495.2417373657,16177.1951370239,21337.3504562378,38714.4268798828,43514.4934501648,65666.2001285553,86489.1554737091,141025.194073359,149134.995801036,161429.576951091,144395.589840953,154607.089163844,126857.728663826,114486.740981102,93276.8254264196,82803.5459127426,54031.9008331299,46680.0662546158,40871.8711566925,44832.6411361694,37928.4909000397,41539.4283638001,37545.1418762207,41549.0018920899,36748.8684005737,48649.3619918823,51888.9503307343,86562.3391017914,73143.4974250794,73236.4439620972,69757.4209632874,79823.8787784577,64540.350063324,51388.7570552826,45252.1525268555,57877.5988750458,53590.1729049683,56697.467300415,54118.2288579941,64745.7610502243,58228.6229400635,76457.8760757446,73539.88387146,110964.418190384,114604.069358254,141527.684072558,134662.718091075,194375.002415021,183897.287487348,183724.700570742,148759.346390406,152983.076712926,114388.242678324,97863.8950659434,75776.4539200465,67947.3298298518,48919.5318994522,44579.5964078903,38554.1393985748,41244.9993591309,32195.8383808136,25442.4671154022,17983.6726665497,25867.90234375,18728.86211586,13486.4835357666,10726.4907131195,8487.2252292633,8756.64052391052,7938.54296684265,8202.9447593689,7960.69645500183,7266.09953689575,4765.4617061615,2970.16893196106],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""  1,044"",""    674"",""  1,291"",""  1,291"",""  3,582"",""  2,402"",""  2,697"",""  3,108"",""  6,594"","" 10,495"","" 16,177"","" 21,337"","" 38,714"","" 43,514"","" 65,666"","" 86,489"",""141,025"",""149,135"",""161,430"",""144,396"",""154,607"",""126,858"",""114,487"","" 93,277"","" 82,804"","" 54,032"","" 46,680"","" 40,872"","" 44,833"","" 37,928"","" 41,539"","" 37,545"","" 41,549"","" 36,749"","" 48,649"","" 51,889"","" 86,562"","" 73,143"","" 73,236"","" 69,757"","" 79,824"","" 64,540"","" 51,389"","" 45,252"","" 57,878"","" 53,590"","" 56,697"","" 54,118"","" 64,746"","" 58,229"","" 76,458"","" 73,540"",""110,964"",""114,604"",""141,528"",""134,663"",""194,375"",""183,897"",""183,725"",""148,759"",""152,983"",""114,388"","" 97,864"","" 75,776"","" 67,947"","" 48,920"","" 44,580"","" 38,554"","" 41,245"","" 32,196"","" 25,442"","" 17,984"","" 25,868"","" 18,729"","" 13,486"","" 10,726"",""  8,487"",""  8,757"",""  7,939"",""  8,203"",""  7,961"",""  7,266"",""  4,765"",""  2,970""],""name"":""Work"",""type"":""scatter"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""line"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[7.83333333333333,17.1666666666667],""y"":[471113.434013634,471113.434013634],""mode"":""text"",""hoverinfo"":[""x"",""x""],""text"":[""Work and All"",""Work and All""],""name"":""Peak Hours"",""type"":""scatter"",""marker"":{""color"":""rgba(44,160,44,1)"",""line"":{""color"":""rgba(44,160,44,1)""}},""error_y"":{""color"":""rgba(44,160,44,1)""},""error_x"":{""color"":""rgba(44,160,44,1)""},""line"":{""color"":""rgba(44,160,44,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
 <div id=""final_defs"" class=""section level2"">
 <h2>Final Period Definitions</h2>
 <p>Based on the trips in motion profile, there are four distinct periods of the day. AM and PM peaks have the highest intensity of trip making, followed by mid-day, with the overnight period containing the fewest trips in motion. Boundaries for these periods are defined such that the variance of trips in motion within periods is smallest while variance between periods is largest.</p>
@@ -629,8 +629,8 @@ <h2>Final Period Definitions</h2>
 </tr>
 </tbody>
 </table>
-<div id=""htmlwidget-e97cce0378a48c56272c"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
-<script type=""application/json"" data-for=""htmlwidget-e97cce0378a48c56272c"">{""x"":{""visdat"":{""73504872637e"":[""function () "",""plotlyVisDat""]},""cur_data"":""73504872637e"",""attrs"":{""73504872637e"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""All"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter""},""73504872637e.1"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""Work"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true},""73504872637e.2"":{""x"":[3.3,8,12.15,16.525,21.0749166666667],""y"":[489588.470641619,489588.470641619,489588.470641619,489588.470641619,489588.470641619],""mode"":""text"",""hoverinfo"":""x"",""text"":[""NT"",""AM"",""MD"",""PM"",""NT""],""name"":""Period"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Peak Periods"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Time of Day""},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Trips in Motion""},""shapes"":[{""type"":""rect"",""fillcolor"":""gray"",""line"":{""color"":""black""},""opacity"":0.3,""x0"":7,""x1"":9,""y0"":0,""y1"":480350.952327627},{""type"":""rect"",""fillcolor"":""gray"",""line"":{""color"":""black""},""opacity"":0.3,""x0"":15.3,""x1"":18.15,""y0"":0,""y1"":480350.952327627},{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":16.45,""x1"":17.45,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":16.45,""x1"":17.45,""y0"":0,""y1"":461875.915699641}],""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[0,0.15,0.3,0.45,1,1.15,1.3,1.45,2,2.15,2.3,2.45,3,3.15,3.3,3.45,4,4.15,4.3,4.45,5,5.15,5.3,5.45,6,6.15,6.3,6.45,7,7.15,7.3,7.45,8,8.15,8.3,8.45,9,9.15,9.3,9.45,10,10.15,10.3,10.45,11,11.15,11.3,11.45,12,12.15,12.3,12.45,13,13.15,13.3,13.45,14,14.15,14.3,14.45,15,15.15,15.3,15.45,16,16.15,16.3,16.45,17,17.15,17.3,17.45,18,18.15,18.3,18.45,19,19.15,19.3,19.45,20,20.15,20.3,20.45,21,21.15,21.3,21.45,22,22.15,22.3,22.45,23,23.15,23.3,23.45,24],""y"":[2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,6006.91633033752,3410.09362983704,4500.83061599731,4765.82431411743,8006.77574920654,6569.41974258423,7685.39112472534,8822.62908744812,13670.3632354736,19029.7920532227,30755.1913146973,39920.9330482483,73005.4471073151,93167.3357563019,152907.307727814,214949.553100586,337438.420101802,336102.567385737,360868.730823898,338909.257696533,375600.01715126,317963.929812177,324390.293670972,277819.02749602,304165.385853767,238720.6982282,211784.448801359,201598.047504425,261437.061003685,224179.39450868,240411.656651815,216316.87800916,258394.671279271,233479.573026657,241689.977338791,244000.05855751,314327.5847435,274645.207396825,261858.255025228,255500.890740713,302353.041838964,260254.874181112,247806.449596723,233514.178727468,284385.483388265,287609.348368009,336457.066494306,316149.00978597,384585.508785566,355704.032983144,388814.663953781,367504.416643524,451568.284702047,390884.834669813,402207.104516411,367950.996014659,458363.171119054,435887.117752393,461875.915699641,416503.391982079,446978.036206245,350113.10400486,340046.982152939,285602.246705691,292584.817763964,234046.789671898,222718.154975573,198955.189921061,202134.527949015,157585.30718867,152419.587581635,117983.69462204,137054.122617722,99612.0579586029,86675.2117328644,68056.894449234,55649.9656295776,42631.0930080414,39612.3422546387,30402.3474349976,34907.5340042114,28604.2598323822,25186.135099411,21243.2928848267,0],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  6,007"",""  3,410"",""  4,501"",""  4,766"",""  8,007"",""  6,569"",""  7,685"",""  8,823"","" 13,670"","" 19,030"","" 30,755"","" 39,921"","" 73,005"","" 93,167"",""152,907"",""214,950"",""337,438"",""336,103"",""360,869"",""338,909"",""375,600"",""317,964"",""324,390"",""277,819"",""304,165"",""238,721"",""211,784"",""201,598"",""261,437"",""224,179"",""240,412"",""216,317"",""258,395"",""233,480"",""241,690"",""244,000"",""314,328"",""274,645"",""261,858"",""255,501"",""302,353"",""260,255"",""247,806"",""233,514"",""284,385"",""287,609"",""336,457"",""316,149"",""384,586"",""355,704"",""388,815"",""367,504"",""451,568"",""390,885"",""402,207"",""367,951"",""458,363"",""435,887"",""461,876"",""416,503"",""446,978"",""350,113"",""340,047"",""285,602"",""292,585"",""234,047"",""222,718"",""198,955"",""202,135"",""157,585"",""152,420"",""117,984"",""137,054"","" 99,612"","" 86,675"","" 68,057"","" 55,650"","" 42,631"","" 39,612"","" 30,402"","" 34,908"","" 28,604"","" 25,186"","" 21,243"",""      0""],""name"":""All"",""type"":""scatter"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""line"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[0,0.15,0.3,0.45,1,1.15,1.3,1.45,2,2.15,2.3,2.45,3,3.15,3.3,3.45,4,4.15,4.3,4.45,5,5.15,5.3,5.45,6,6.15,6.3,6.45,7,7.15,7.3,7.45,8,8.15,8.3,8.45,9,9.15,9.3,9.45,10,10.15,10.3,10.45,11,11.15,11.3,11.45,12,12.15,12.3,12.45,13,13.15,13.3,13.45,14,14.15,14.3,14.45,15,15.15,15.3,15.45,16,16.15,16.3,16.45,17,17.15,17.3,17.45,18,18.15,18.3,18.45,19,19.15,19.3,19.45,20,20.15,20.3,20.45,21,21.15,21.3,21.45,22,22.15,22.3,22.45,23,23.15,23.3,23.45],""y"":[193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,1044.11817932129,673.78125,1290.64489746094,1290.64489746094,3582.1994972229,2401.72974014282,2696.99674224854,3107.886510849,6593.75918197632,10495.2417373657,16177.1951370239,21337.3504562378,38714.4268798828,43514.4934501648,65666.2001285553,86489.1554737091,141025.194073359,149134.995801036,161429.576951091,144395.589840953,154607.089163844,126857.728663826,114486.740981102,93276.8254264196,82803.5459127426,54031.9008331299,46680.0662546158,40871.8711566925,44832.6411361694,37928.4909000397,41539.4283638001,37545.1418762207,41549.0018920899,36748.8684005737,48649.3619918823,51888.9503307343,86562.3391017914,73143.4974250794,73236.4439620972,69757.4209632874,79823.8787784577,64540.350063324,51388.7570552826,45252.1525268555,57877.5988750458,53590.1729049683,56697.467300415,54118.2288579941,64745.7610502243,58228.6229400635,76457.8760757446,73539.88387146,110964.418190384,114604.069358254,141527.684072558,134662.718091075,194375.002415021,183897.287487348,183724.700570742,148759.346390406,152983.076712926,114388.242678324,97863.8950659434,75776.4539200465,67947.3298298518,48919.5318994522,44579.5964078903,38554.1393985748,41244.9993591309,32195.8383808136,25442.4671154022,17983.6726665497,25867.90234375,18728.86211586,13486.4835357666,10726.4907131195,8487.2252292633,8756.64052391052,7938.54296684265,8202.9447593689,7960.69645500183,7266.09953689575,4765.4617061615,2970.16893196106],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""  1,044"",""    674"",""  1,291"",""  1,291"",""  3,582"",""  2,402"",""  2,697"",""  3,108"",""  6,594"","" 10,495"","" 16,177"","" 21,337"","" 38,714"","" 43,514"","" 65,666"","" 86,489"",""141,025"",""149,135"",""161,430"",""144,396"",""154,607"",""126,858"",""114,487"","" 93,277"","" 82,804"","" 54,032"","" 46,680"","" 40,872"","" 44,833"","" 37,928"","" 41,539"","" 37,545"","" 41,549"","" 36,749"","" 48,649"","" 51,889"","" 86,562"","" 73,143"","" 73,236"","" 69,757"","" 79,824"","" 64,540"","" 51,389"","" 45,252"","" 57,878"","" 53,590"","" 56,697"","" 54,118"","" 64,746"","" 58,229"","" 76,458"","" 73,540"",""110,964"",""114,604"",""141,528"",""134,663"",""194,375"",""183,897"",""183,725"",""148,759"",""152,983"",""114,388"","" 97,864"","" 75,776"","" 67,947"","" 48,920"","" 44,580"","" 38,554"","" 41,245"","" 32,196"","" 25,442"","" 17,984"","" 25,868"","" 18,729"","" 13,486"","" 10,726"",""  8,487"",""  8,757"",""  7,939"",""  8,203"",""  7,961"",""  7,266"",""  4,765"",""  2,970""],""name"":""Work"",""type"":""scatter"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""line"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[3.3,8,12.15,16.525,21.0749166666667],""y"":[489588.470641619,489588.470641619,489588.470641619,489588.470641619,489588.470641619],""mode"":""text"",""hoverinfo"":[""x"",""x"",""x"",""x"",""x""],""text"":[""NT"",""AM"",""MD"",""PM"",""NT""],""name"":""Period"",""type"":""scatter"",""marker"":{""color"":""rgba(44,160,44,1)"",""line"":{""color"":""rgba(44,160,44,1)""}},""error_y"":{""color"":""rgba(44,160,44,1)""},""error_x"":{""color"":""rgba(44,160,44,1)""},""line"":{""color"":""rgba(44,160,44,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
+<div id=""htmlwidget-b163ec21581830f32f8c"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
+<script type=""application/json"" data-for=""htmlwidget-b163ec21581830f32f8c"">{""x"":{""visdat"":{""16347ed6364c"":[""function () "",""plotlyVisDat""]},""cur_data"":""16347ed6364c"",""attrs"":{""16347ed6364c"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""All"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter""},""16347ed6364c.1"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""Work"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true},""16347ed6364c.2"":{""x"":[3.5,8,12.25,16.875,21.1248611111111],""y"":[489588.470641619,489588.470641619,489588.470641619,489588.470641619,489588.470641619],""mode"":""text"",""hoverinfo"":""x"",""text"":[""NT"",""AM"",""MD"",""PM"",""NT""],""name"":""Period"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Peak Periods"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Time of Day""},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Trips in Motion""},""shapes"":[{""type"":""rect"",""fillcolor"":""gray"",""line"":{""color"":""black""},""opacity"":0.3,""x0"":7,""x1"":9,""y0"":0,""y1"":480350.952327627},{""type"":""rect"",""fillcolor"":""gray"",""line"":{""color"":""black""},""opacity"":0.3,""x0"":15.5,""x1"":18.25,""y0"":0,""y1"":480350.952327627},{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":16.75,""x1"":17.75,""y0"":0,""y1"":461875.915699641},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":16.75,""x1"":17.75,""y0"":0,""y1"":461875.915699641}],""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75,24],""y"":[2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,6006.91633033752,3410.09362983704,4500.83061599731,4765.82431411743,8006.77574920654,6569.41974258423,7685.39112472534,8822.62908744812,13670.3632354736,19029.7920532227,30755.1913146973,39920.9330482483,73005.4471073151,93167.3357563019,152907.307727814,214949.553100586,337438.420101802,336102.567385737,360868.730823898,338909.257696533,375600.01715126,317963.929812177,324390.293670972,277819.02749602,304165.385853767,238720.6982282,211784.448801359,201598.047504425,261437.061003685,224179.39450868,240411.656651815,216316.87800916,258394.671279271,233479.573026657,241689.977338791,244000.05855751,314327.5847435,274645.207396825,261858.255025228,255500.890740713,302353.041838964,260254.874181112,247806.449596723,233514.178727468,284385.483388265,287609.348368009,336457.066494306,316149.00978597,384585.508785566,355704.032983144,388814.663953781,367504.416643524,451568.284702047,390884.834669813,402207.104516411,367950.996014659,458363.171119054,435887.117752393,461875.915699641,416503.391982079,446978.036206245,350113.10400486,340046.982152939,285602.246705691,292584.817763964,234046.789671898,222718.154975573,198955.189921061,202134.527949015,157585.30718867,152419.587581635,117983.69462204,137054.122617722,99612.0579586029,86675.2117328644,68056.894449234,55649.9656295776,42631.0930080414,39612.3422546387,30402.3474349976,34907.5340042114,28604.2598323822,25186.135099411,21243.2928848267,0],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  6,007"",""  3,410"",""  4,501"",""  4,766"",""  8,007"",""  6,569"",""  7,685"",""  8,823"","" 13,670"","" 19,030"","" 30,755"","" 39,921"","" 73,005"","" 93,167"",""152,907"",""214,950"",""337,438"",""336,103"",""360,869"",""338,909"",""375,600"",""317,964"",""324,390"",""277,819"",""304,165"",""238,721"",""211,784"",""201,598"",""261,437"",""224,179"",""240,412"",""216,317"",""258,395"",""233,480"",""241,690"",""244,000"",""314,328"",""274,645"",""261,858"",""255,501"",""302,353"",""260,255"",""247,806"",""233,514"",""284,385"",""287,609"",""336,457"",""316,149"",""384,586"",""355,704"",""388,815"",""367,504"",""451,568"",""390,885"",""402,207"",""367,951"",""458,363"",""435,887"",""461,876"",""416,503"",""446,978"",""350,113"",""340,047"",""285,602"",""292,585"",""234,047"",""222,718"",""198,955"",""202,135"",""157,585"",""152,420"",""117,984"",""137,054"","" 99,612"","" 86,675"","" 68,057"","" 55,650"","" 42,631"","" 39,612"","" 30,402"","" 34,908"","" 28,604"","" 25,186"","" 21,243"",""      0""],""name"":""All"",""type"":""scatter"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""line"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[0,0.25,0.5,0.75,1,1.25,1.5,1.75,2,2.25,2.5,2.75,3,3.25,3.5,3.75,4,4.25,4.5,4.75,5,5.25,5.5,5.75,6,6.25,6.5,6.75,7,7.25,7.5,7.75,8,8.25,8.5,8.75,9,9.25,9.5,9.75,10,10.25,10.5,10.75,11,11.25,11.5,11.75,12,12.25,12.5,12.75,13,13.25,13.5,13.75,14,14.25,14.5,14.75,15,15.25,15.5,15.75,16,16.25,16.5,16.75,17,17.25,17.5,17.75,18,18.25,18.5,18.75,19,19.25,19.5,19.75,20,20.25,20.5,20.75,21,21.25,21.5,21.75,22,22.25,22.5,22.75,23,23.25,23.5,23.75],""y"":[193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,193.561111450195,1044.11817932129,673.78125,1290.64489746094,1290.64489746094,3582.1994972229,2401.72974014282,2696.99674224854,3107.886510849,6593.75918197632,10495.2417373657,16177.1951370239,21337.3504562378,38714.4268798828,43514.4934501648,65666.2001285553,86489.1554737091,141025.194073359,149134.995801036,161429.576951091,144395.589840953,154607.089163844,126857.728663826,114486.740981102,93276.8254264196,82803.5459127426,54031.9008331299,46680.0662546158,40871.8711566925,44832.6411361694,37928.4909000397,41539.4283638001,37545.1418762207,41549.0018920899,36748.8684005737,48649.3619918823,51888.9503307343,86562.3391017914,73143.4974250794,73236.4439620972,69757.4209632874,79823.8787784577,64540.350063324,51388.7570552826,45252.1525268555,57877.5988750458,53590.1729049683,56697.467300415,54118.2288579941,64745.7610502243,58228.6229400635,76457.8760757446,73539.88387146,110964.418190384,114604.069358254,141527.684072558,134662.718091075,194375.002415021,183897.287487348,183724.700570742,148759.346390406,152983.076712926,114388.242678324,97863.8950659434,75776.4539200465,67947.3298298518,48919.5318994522,44579.5964078903,38554.1393985748,41244.9993591309,32195.8383808136,25442.4671154022,17983.6726665497,25867.90234375,18728.86211586,13486.4835357666,10726.4907131195,8487.2252292633,8756.64052391052,7938.54296684265,8202.9447593689,7960.69645500183,7266.09953689575,4765.4617061615,2970.16893196106],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""    194"",""  1,044"",""    674"",""  1,291"",""  1,291"",""  3,582"",""  2,402"",""  2,697"",""  3,108"",""  6,594"","" 10,495"","" 16,177"","" 21,337"","" 38,714"","" 43,514"","" 65,666"","" 86,489"",""141,025"",""149,135"",""161,430"",""144,396"",""154,607"",""126,858"",""114,487"","" 93,277"","" 82,804"","" 54,032"","" 46,680"","" 40,872"","" 44,833"","" 37,928"","" 41,539"","" 37,545"","" 41,549"","" 36,749"","" 48,649"","" 51,889"","" 86,562"","" 73,143"","" 73,236"","" 69,757"","" 79,824"","" 64,540"","" 51,389"","" 45,252"","" 57,878"","" 53,590"","" 56,697"","" 54,118"","" 64,746"","" 58,229"","" 76,458"","" 73,540"",""110,964"",""114,604"",""141,528"",""134,663"",""194,375"",""183,897"",""183,725"",""148,759"",""152,983"",""114,388"","" 97,864"","" 75,776"","" 67,947"","" 48,920"","" 44,580"","" 38,554"","" 41,245"","" 32,196"","" 25,442"","" 17,984"","" 25,868"","" 18,729"","" 13,486"","" 10,726"",""  8,487"",""  8,757"",""  7,939"",""  8,203"",""  7,961"",""  7,266"",""  4,765"",""  2,970""],""name"":""Work"",""type"":""scatter"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""line"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[3.5,8,12.25,16.875,21.1248611111111],""y"":[489588.470641619,489588.470641619,489588.470641619,489588.470641619,489588.470641619],""mode"":""text"",""hoverinfo"":[""x"",""x"",""x"",""x"",""x""],""text"":[""NT"",""AM"",""MD"",""PM"",""NT""],""name"":""Period"",""type"":""scatter"",""marker"":{""color"":""rgba(44,160,44,1)"",""line"":{""color"":""rgba(44,160,44,1)""}},""error_y"":{""color"":""rgba(44,160,44,1)""},""error_x"":{""color"":""rgba(44,160,44,1)""},""line"":{""color"":""rgba(44,160,44,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
 <p>The table below shows the average 15-minute trips in motion during each period. These period definitions accurately capture the disparate characteristics of each.</p>
 <table class=""table"" style=""width: auto !important; margin-left: auto; margin-right: auto;"">
 <thead>
@@ -2127,8 +2127,8 @@ <h2>Qualitative example</h2>
 </tr>
 </tbody>
 </table>
-<div id=""htmlwidget-bceddeed198dc3627970"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
-<script type=""application/json"" data-for=""htmlwidget-bceddeed198dc3627970"">{""x"":{""visdat"":{""73505ab355a4"":[""function () "",""plotlyVisDat""]},""cur_data"":""73505ab355a4"",""attrs"":{""73505ab355a4"":{""x"":{},""y"":{},""name"":""Capacity"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar""},""73505ab355a4.1"":{""x"":{},""y"":{},""name"":""Demand"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Hour of Day"",""type"":""category"",""categoryorder"":""array"",""categoryarray"":[""6-7"",""7-8"",""8-9""]},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Veh per Hour""},""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[""6-7"",""7-8"",""8-9""],""y"":[1050,1050,1050],""name"":""Capacity"",""type"":""bar"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[""6-7"",""7-8"",""8-9""],""y"":[500,900,500],""name"":""Demand"",""type"":""bar"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
+<div id=""htmlwidget-418c9e6608e8ef085594"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
+<script type=""application/json"" data-for=""htmlwidget-418c9e6608e8ef085594"">{""x"":{""visdat"":{""1634467a548"":[""function () "",""plotlyVisDat""]},""cur_data"":""1634467a548"",""attrs"":{""1634467a548"":{""x"":{},""y"":{},""name"":""Capacity"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar""},""1634467a548.1"":{""x"":{},""y"":{},""name"":""Demand"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Hour of Day"",""type"":""category"",""categoryorder"":""array"",""categoryarray"":[""6-7"",""7-8"",""8-9""]},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Veh per Hour""},""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[""6-7"",""7-8"",""8-9""],""y"":[1050,1050,1050],""name"":""Capacity"",""type"":""bar"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[""6-7"",""7-8"",""8-9""],""y"":[500,900,500],""name"":""Demand"",""type"":""bar"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
 <p>The easiest way to represent this in a period assignment would be to add up the total capacity and total demand from each hour.</p>
 <table class=""table"" style=""width: auto !important; margin-left: auto; margin-right: auto;"">
 <thead>
@@ -2158,8 +2158,8 @@ <h2>Qualitative example</h2>
 </tr>
 </tbody>
 </table>
-<div id=""htmlwidget-d0b7b807ee80ed7d0397"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
-<script type=""application/json"" data-for=""htmlwidget-d0b7b807ee80ed7d0397"">{""x"":{""visdat"":{""73505aaa7fbd"":[""function () "",""plotlyVisDat""]},""cur_data"":""73505aaa7fbd"",""attrs"":{""73505aaa7fbd"":{""x"":{},""y"":{},""name"":""Capacity"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar""},""73505aaa7fbd.1"":{""x"":{},""y"":{},""name"":""Demand"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Hour of Day"",""type"":""category"",""categoryorder"":""array"",""categoryarray"":[""6-9""]},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Veh per Hour""},""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[""6-9""],""y"":[3150],""name"":""Capacity"",""type"":""bar"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[""6-9""],""y"":[1900],""name"":""Demand"",""type"":""bar"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
+<div id=""htmlwidget-81056fbc0c1c9cfda455"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
+<script type=""application/json"" data-for=""htmlwidget-81056fbc0c1c9cfda455"">{""x"":{""visdat"":{""1634255a6764"":[""function () "",""plotlyVisDat""]},""cur_data"":""1634255a6764"",""attrs"":{""1634255a6764"":{""x"":{},""y"":{},""name"":""Capacity"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar""},""1634255a6764.1"":{""x"":{},""y"":{},""name"":""Demand"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Hour of Day"",""type"":""category"",""categoryorder"":""array"",""categoryarray"":[""6-9""]},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Veh per Hour""},""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[""6-9""],""y"":[3150],""name"":""Capacity"",""type"":""bar"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[""6-9""],""y"":[1900],""name"":""Demand"",""type"":""bar"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
 <p>In this simple representation, no one experiences congestion. This does not match the real world graph, which shows that nearly half the vehicles in the period experience congested conditions. This occurs between 7:00 am and 8:00 am. This discrepancy between the real world and a naive period representation can cause numerous errors in the model, including:</p>
 <ul>
 <li>Longer trip lengths</li>
@@ -2175,8 +2175,8 @@ <h2>Qualitative example</h2>
 <p>The period capacity that most-accurately reflects congestion would be:</p>
 <p><br /><span class=""math display""><em>P</em><em>e</em><em>r</em><em>i</em><em>o</em><em>d</em><em>C</em><em>a</em><em>p</em><em>a</em><em>c</em><em>i</em><em>t</em><em>y</em>=1050*2.11=2215</span><br /></p>
 <p>That capacity is shown relative to the period demand in the chart below. This relationship is a better representation of real world conditions.</p>
-<div id=""htmlwidget-95983e9ef4a0a6c0c046"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
-<script type=""application/json"" data-for=""htmlwidget-95983e9ef4a0a6c0c046"">{""x"":{""visdat"":{""7350d1141b1"":[""function () "",""plotlyVisDat""]},""cur_data"":""7350d1141b1"",""attrs"":{""7350d1141b1"":{""x"":{},""y"":{},""marker"":{""color"":""ff7f0e""},""name"":""Demand"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar""},""7350d1141b1.1"":{""x"":{},""y"":{},""marker"":{""color"":""1f77b4""},""name"":""Capacity"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Final Model Representation"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":"""",""type"":""category"",""categoryorder"":""array"",""categoryarray"":[""PCF = 2.11"",""PCF = 3.00""]},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Veh per Period""},""barmode"":""stack"",""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[""PCF = 3.00"",""PCF = 2.11""],""y"":[1900,1900],""marker"":{""color"":""ff7f0e"",""line"":{""color"":""rgba(31,119,180,1)""}},""name"":""Demand"",""type"":""bar"",""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[""PCF = 3.00"",""PCF = 2.11""],""y"":[1250,316],""marker"":{""color"":""1f77b4"",""line"":{""color"":""rgba(255,127,14,1)""}},""name"":""Capacity"",""type"":""bar"",""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
+<div id=""htmlwidget-f97f6c0d5f655071b6c2"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
+<script type=""application/json"" data-for=""htmlwidget-f97f6c0d5f655071b6c2"">{""x"":{""visdat"":{""16342931479f"":[""function () "",""plotlyVisDat""]},""cur_data"":""16342931479f"",""attrs"":{""16342931479f"":{""x"":{},""y"":{},""marker"":{""color"":""ff7f0e""},""name"":""Demand"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar""},""16342931479f.1"":{""x"":{},""y"":{},""marker"":{""color"":""1f77b4""},""name"":""Capacity"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""bar"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Final Model Representation"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":"""",""type"":""category"",""categoryorder"":""array"",""categoryarray"":[""PCF = 2.11"",""PCF = 3.00""]},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Veh per Period""},""barmode"":""stack"",""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[""PCF = 3.00"",""PCF = 2.11""],""y"":[1900,1900],""marker"":{""color"":""ff7f0e"",""line"":{""color"":""rgba(31,119,180,1)""}},""name"":""Demand"",""type"":""bar"",""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[""PCF = 3.00"",""PCF = 2.11""],""y"":[1250,316],""marker"":{""color"":""1f77b4"",""line"":{""color"":""rgba(255,127,14,1)""}},""name"":""Capacity"",""type"":""bar"",""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
 <table class=""table"" style=""width: auto !important; margin-left: auto; margin-right: auto;"">
 <thead>
 <tr>"
Triangle-Modeling-and-Analytics,TRMG2,ee0391402a6d3deb464aa0296d4782e3efcddcd6,Ashish Kulshrestha,ashish.kulshrestha@wsp.com,2021-08-17T18:11:51Z,Ashish Kulshrestha,ashish.kulshrestha@wsp.com,2021-08-17T18:11:51Z,corrections for #88,master/airport/airport_model.csv;src/Airport.rsc,False,False,False,False,47,47,94,"---FILE: master/airport/airport_model.csv---
@@ -1,5 +1,5 @@
 variable,coefficient
-intercept,5.4539
-employment,0.0133
-high_earn_distance,-0.0051
-high_earner,0.1315
+employment,0.0148
+high_paying_jobs,0.0479
+high_paying_jobs_distance,-0.0037
+workers,0.0281

---FILE: src/Airport.rsc---
@@ -4,8 +4,8 @@
 
 Macro ""Airport"" (Args)
     RunMacro(""Airport Production"", Args)
-    RunMacro(""Airport Distribution and TOD"", Args)	
-	
+    RunMacro(""Airport Distribution and TOD"", Args)
+
     return(1)
 endmacro
 
@@ -14,35 +14,35 @@ Calculate airport productions
 */
 
 Macro ""Airport Production"" (Args)
-    
+
 	se_file = Args.SE
 	skim_dir = Args.[Output Folder] + ""\\skims\\roadway\\""
 	airport_model_file = Args.[Input Folder] + ""\\airport\\airport_model.csv""
-	
+
 	se_vw = OpenTable(""se"", ""FFB"", {se_file})
-	
+
 	data = GetDataVectors(
-	    se_vw + ""|"",
+    se_vw + ""|"",
 		{
-		    ""TAZ"", 
+      ""TAZ"",
 			""HH_POP"",
 			""Pct_Worker"",
 			""PctHighPay"",
 			""TotalEmp""
 		},
 		{OptArray: TRUE}
 	)
-	
+
 	// find airport taz (one with positive enplanement field)
 	SetView(se_vw)
 	n = SelectByQuery(""airport_taz"", ""Several"", ""Select * where Enplanements > 0"",)
 	airport_zone = GetDataVector(se_vw + ""|airport_taz"", ""TAZ"", )
 	airport_zone = airport_zone[1]
 	airport_enplanement = GetDataVector(se_vw + ""|airport_taz"", ""Enplanements"", )
 	airport_enplanement = airport_enplanement[1]
-	
+
 	taz_vec = data.TAZ
-	
+
 	// get distance to airport zone
 	skim_mat = skim_dir + ""skim_sov_MD.mtx""
 	mat = CreateObject(""Matrix"")
@@ -51,40 +51,40 @@ Macro ""Airport Production"" (Args)
 	distance_array = GetMatrixValues(cores.[Length (Skim)], V2A(taz_vec), {airport_zone})
 	cores = null
 	mat = null
-	
+
 	for i = 1 to distance_array.length do
 	    dist_to_airport_miles = dist_to_airport_miles + {distance_array[i][1]}
 	end
-	
+
 	dist_to_airport_miles = A2V(dist_to_airport_miles)
-	
+
 	// get variables for regression
 	workers = data.HH_POP * data.Pct_Worker/100
-	high_earners = workers * data.PctHighPay/100
-	high_earn_distance = high_earners * dist_to_airport_miles
-	
+	high_paying_jobs = TotalEmp * data.PctHighPay/100
+	high_paying_jobs_distance = high_paying_jobs * dist_to_airport_miles
+
 	// read airport model file for coefficients
 	coeffs = RunMacro(""Read Parameter File"", {
 		file: airport_model_file,
 		names: ""variable"",
 		values: ""coefficient""
 	})
-	
+
 	// compute airport productions
-	airport_productions = coeffs.intercept + 
-		coeffs.employment * data.TotalEmp + 
-		coeffs.high_earn_distance * high_earn_distance +
-		coeffs.high_earner * high_earners
-	
+	airport_productions = coeffs.employment * data.TotalEmp +
+		coeffs.high_paying_jobs * high_paying_jobs +
+    coeffs.high_paying_jobs_distance * high_paying_jobs_distance +
+    coeffs.workers * workers
+
 	airport_productions = if (airport_productions < 0) then 0 else airport_productions
 	airport_productions = airport_productions * airport_enplanement / airport_productions.sum()
-	
+
 	a_fields = {{""AirportProd"", ""Real"", 10, 2, , , , ""airport productions""}}
 	RunMacro(""Add Fields"", {view: se_vw, a_fields: a_fields})
-	
+
 	SetView(se_vw)
 	SetDataVector(se_vw + ""|"", ""AirportProd"", airport_productions, )
-	
+
 	CloseView(se_vw)
 endmacro
 
@@ -93,36 +93,36 @@ There is only one airport zone, so distribution is very simple
 */
 
 Macro ""Airport Distribution and TOD"" (Args)
-    
+
 	se_file = Args.SE
 	hwy_dbd = Args.Links
 	trips_dir = Args.[Output Folder] + ""\\airport\\""
 	airport_tod_factor_file = Args.[Input Folder] + ""\\airport\\airport_diurnals.csv""
 	periods = Args.periods
-	
+
 	airport_matrix = trips_dir + ""Airport_Trips.mtx""
 	airport_transpose_matrix = trips_dir + ""Airport_Transpose_Trips.mtx""
-	
+
 	se_vw = OpenTable(""se"", ""FFB"", {se_file})
 
 	SetView(se_vw)
 	n = SelectByQuery(""airport_taz"", ""Several"", ""Select * where Enplanements > 0"",)
 	airport_zone = GetDataVector(se_vw + ""|airport_taz"", ""TAZ"", )
 	airport_zone = airport_zone[1]
-	
+
 	airport_productions = GetDataVector(se_vw + ""|"", ""AirportProd"", )
 
 	// create empty matrix from node layer
 	{map, {nlyr, llyr}} = RunMacro(""Create Map"", {file: hwy_dbd})
-    
+
 	SetLayer(nlyr)
 	qry = ""Select * where Centroid = 1""
 	n = SelectByQuery(""centroids"", ""several"", qry)
 	centroid_ids = GetDataVector(nlyr + ""|centroids"", ""ID"", {{""Sort Order"", {{""ID"", ""Ascending""}}}})
-	
+
 	obj = CreateObject(""Matrix"")
 	obj.SetMatrixOptions({
-	    FileName: airport_matrix,
+	  FileName: airport_matrix,
 		MatrixLabel: ""Airport Trips"",
 		Compressed: 1,
 		DataType: ""Float""})
@@ -137,43 +137,43 @@ Macro ""Airport Distribution and TOD"" (Args)
 	// PA Trips
 	rows = V2A(centroid_ids)
 	cols = {airport_zone}
-	for i = 1 to centroid_ids.length do 
+	for i = 1 to centroid_ids.length do
 	    pa_trips = pa_trips + {{airport_productions[i]}}
 	end
 	SetMatrixValues(mc, rows, cols, {""Copy"", pa_trips}, )
-	
+
 	tmat = TransposeMatrix(mat, {
 		{""File Name"", airport_transpose_matrix},
-		{""Label"", ""Airport Transposed Trips""}, 
+		{""Label"", ""Airport Transposed Trips""},
 		{""Type"", ""Double""}}
 	)
-	
+
 	mc = null
 	mat = null
 	tmat = null
 	CloseView(se_vw)
 	CloseMap(map)
-	
+
 	mat = CreateObject(""Matrix"")
 	mat.LoadMatrix(airport_matrix)
 	tmat = CreateObject(""Matrix"")
 	tmat.LoadMatrix(airport_transpose_matrix)
-	
+
 	fac_vw = OpenTable(""tod_fac"", ""CSV"", {airport_tod_factor_file})
 	v_pa_fac = GetDataVector(fac_vw + ""|"", ""PA_Factor"", )
 	v_ap_fac = GetDataVector(fac_vw + ""|"", ""AP_Factor"", )
-	
-	for p = 1 to periods.length do 
-	    period = periods[p]
+
+	for p = 1 to periods.length do
+    period = periods[p]
 		pa_factor = v_pa_fac[p]
 		ap_factor = v_ap_fac[p]
-	    
+
 		mat.AddCores({""Trips_"" + period})
 		cores = mat.data.cores
 		tcores = tmat.data.cores
 		cores.(""Trips_"" + period) := Nz(cores.Trips) * pa_factor + Nz(tcores.Trips) * ap_factor
 	end
-	
+
 	CloseView(fac_vw)
 	mat.DropCores({""Trips""})
 	tmat = null"
Triangle-Modeling-and-Analytics,TRMG2,effadde22282a9276ae4ec4732ef22b206d12375,David Ory,david.ory@gmail.com,2021-08-10T17:42:53Z,David Ory,david.ory@gmail.com,2021-08-10T17:42:53Z,Corrections for #88,.gitignore;docs/R/airport.R;docs/airport.Rmd;docs/airport.html;docs/data/output/airport/airport-productions.csv;docs/data/output/airport/airport-productions.twb;docs/img/airport/estimated_productions.png;docs/img/airport/scatter_plot.png;docs/img/airport/trip_length_frequency.png,True,True,True,False,5835,7977,13812,"---FILE: .gitignore---
@@ -8,3 +8,4 @@
 .DS_Store
 docs/data/_PRIVATE/*
 docs/site_libs/*
+docs/data/input/ieei/AMSOVDistanceSkim.csv

---FILE: docs/R/airport.R---
@@ -1,20 +1,3 @@
-# Packages ---------------------------------------------------------------------
-packages_vector <- c(""tidyverse"",
-                     ""sf"",
-                     ""corrr"",
-                     ""geosphere"",
-                     ""measurements"",
-                     ""kableExtra"",
-                     ""knitr"")
-
-need_to_install <- packages_vector[!(packages_vector %in% installed.packages()[,""Package""])]
-
-if (length(need_to_install)) install.packages(need_to_install)
-
-for (package in packages_vector) {
-  library(package, character.only = TRUE)
-}
-
 # Remote I/O -------------------------------------------------------------------
 private_dir <- ""data/_PRIVATE/""
 data_dir <- ""data/input/""
@@ -131,16 +114,16 @@ productions_df <- working_df %>%
   filter(Type == ""Internal"") %>%
   mutate(employment = Industry + Office + Service_RateLow + Service_RateHigh + Retail) %>%
   mutate(workers = Pct_Worker/100.0 * HH_POP) %>%
-  mutate(high_earners = PctHighEarn/100.0 * workers) %>%
-  mutate(high_earn_distance = high_earners * dist_to_airport_miles)
+  mutate(high_paying_jobs = PctHighEarn/100.0 * employment) %>%
+  mutate(high_paying_jobs_distance = high_paying_jobs * dist_to_airport_miles)
 
 # Correlations -----------------------------------------------------------------
 correlations_df <- productions_df %>%
   select(airport_productions,
          workers,
          employment,
-         high_earners,
-         high_earn_distance,
+         high_paying_jobs,
+         high_paying_jobs_distance,
          hotel_rooms,
          dist_to_airport_miles,
          HH,
@@ -174,24 +157,31 @@ model_df <- model_df %>%
 model_01 <- lm(y ~ employment + workers,
                data = model_df)
 
-model_02 <- lm(y ~ workers + high_earners + Service_RateHigh + Industry + Office + Retail + high_earn_distance + hotel_rooms,
+model_02 <- lm(y ~ workers + 
+                 high_paying_jobs + 
+                 high_paying_jobs_distance + 
+                 Service_RateHigh + 
+                 Industry + 
+                 Office + 
+                 Retail + 
+                 hotel_rooms,
                data = model_df)
 
-model_03 <- lm(y ~ high_earners + high_earn_distance + employment,
+model_03 <- lm(y ~ workers + employment + high_paying_jobs + high_paying_jobs_distance + hotel_rooms,
                data = model_df)
 
-model_04 <- lm(y ~ high_earners + high_earn_distance + Industry + Office + Service_RateHigh + Retail,
+model_04 <- lm(y ~ 0 + workers + employment + high_paying_jobs + high_paying_jobs_distance,
                data = model_df)
 
 # Model Application ------------------------------------------------------------
 output_df <- productions_df %>%
   mutate(observed_productions = if_else(airport_productions < OUTLIER_MIN,
                                         airport_productions * adjust_factor,
                                         OUTLIER_MIN * adjust_factor)) %>%
-  mutate(estimated_productions = model_03$coefficients[""(Intercept)""] +
-           model_03$coefficients[""high_earners""] * high_earners +
-           model_03$coefficients[""high_earn_distance""] * high_earn_distance +
-           model_03$coefficients[""employment""] * employment) %>%
+  mutate(estimated_productions = model_04$coefficients[""workers""] * workers +
+           model_04$coefficients[""employment""] * employment +
+           model_04$coefficients[""high_paying_jobs""] * high_paying_jobs +
+           model_04$coefficients[""high_paying_jobs_distance""] * high_paying_jobs_distance) %>%
   mutate(estimated_productions = if_else(estimated_productions < 0.0, 
                                          0.0,
                                          estimated_productions))

---FILE: docs/airport.Rmd---
@@ -1,14 +1,22 @@
 ---
 title: ""Airport""
 author: ""Caliper Corporation""
-date: ""May 18, 2021""
+date: ""`r format(Sys.time(), '%B %d, %Y')`""
 output: html_document
 editor_options: 
   chunk_output_type: console
 ---
 
 
 ```{r setup, include=FALSE}
+# renv::restore()
+library(tidyverse)
+library(sf)
+library(corrr)
+library(geosphere)
+library(measurements)
+library(kableExtra)
+library(knitr)
 source(""R/airport.R"")
 
 knitr::opts_chunk$set(echo = FALSE)
@@ -21,7 +29,7 @@ options(scipen = 999)
 
 Air passenger travel to/from the Raleigh-Durham International Airport (RDU) is captured by the air passenger model. 
 
-A limited amount of data on air passengers is available and the modeling approach is therefore straightforward and requires a handful of assumptions. The available data is passive movements recordedfrom StreetLight Data. The benefits of this data is they provide a reasonable signal of movements to/from the airport. The drawbacks of this data include the following: *It does not distinguish between airport employees and air passengers.* It cannot distinguish between trip legs, for example the movement from home to an off-airport parking location and the movement from the off-airport parking location to the airport terminal. And it cannot distinguish between residents of the Triangle region and visitors to the Triangle region. 
+A limited amount of data on air passengers is available. The modeling approach is therefore straightforward and requires a handful of assumptions. The available data is passive movements recorded from StreetLight Data. The benefits of this data is they provide a reasonable signal of movements to/from the airport. The drawbacks of this data are as follows: *It does not distinguish between airport employees and air passengers.* It cannot distinguish between trip legs, for example the movement from home to an off-airport parking location and the movement from the off-airport parking location to the airport terminal. And it cannot distinguish between residents of the Triangle region and visitors to the Triangle region. 
 
 ## StreetLight Data Summaries
 The map below shows the distribution of trip productions to RDU per the StreetLight data. As expected, the data shows large amounts of activity in the zones surrounding the airport. For an air passenger model, we are less interested in the movement from, say, the off-airport parking facility to the airport, than we are the movement from a home or workplace to the off-airport parking facility. Ideally, an airport model would explicitly represent each movement. For the simple model being developed here, we want to focus on the primary (and longer) movement.
@@ -52,21 +60,25 @@ correlations_df %>%
   kable_styling(full_width = FALSE)
 ```
 
-The above table shows correlations between airport productions and the variables we would expect and like to be correlated with airport productions, including workers,high income persons, and employment. 
+The above table shows correlations between airport productions and the variables we would expect and like to be correlated with airport productions, including workers, employment, and high income employment. 
 
 Using the correlations as a guide, we estimate a series of linear regression models in a search for a parsimonious balance between model fit and logical coefficients. 
 
 ### Model Estimation Results {.tabset .MODEL}
-Numerous model estimations were conducted to find the preferred specification shown below. The preferred specification includes `high earners`, which is the number of high earners in each TAZ. A second term that interacts high earners with distance to the airport is included as well, which reduces the number of productions for high earners at greater distances from the airport.
+Numerous model estimations were conducted to find the preferred specification shown below. The preferred specification includes `high paying jobs`, which is the number of high paying jobs in each TAZ. A second term that interacts high paying jobs with distance to the airport is included as well, which reduces the number of productions for high earners at greater distances from the airport.
 
 The preferred specification includes `employment` which captures movements to/from work locations to the airport. The preferred specification collapses the employment categories. Specifications with employment separated by industry did not always reveal logical coefficients (e.g., a larger coefficient on industrial employment than office employment). 
 
 Other, non-preferred specifications are included in the tabs below. 
 
-
 ```{r}
-print_model <- function(model) {
-  df <- tibble(variable = colnames(model$model),
+print_model <- function(model, includes_intercept) {
+
+  variable_vector <- colnames(model$model)
+  
+  if (!includes_intercept) variable_vector = tail(variable_vector, n = -1)
+  
+  df <- tibble(variable = variable_vector,
                estimate = model$coefficients,
                statistic = coef(summary(model))[, ""t value""],
                p.value = coef(summary(model))[, ""Pr(>|t|)""]) %>%
@@ -86,26 +98,26 @@ print_model <- function(model) {
 
 #### Preferred
 ```{r, MODEL_PREFERRED}
-print_model(model_03)
+print_model(model_04, FALSE)
 ```
 
 #### Model 01
 ```{r, MODEL_01}
-print_model(model_01)
+print_model(model_01, TRUE)
 ```
 
 #### Model 02
 ```{r, MODEL_02}
-print_model(model_02)
+print_model(model_02, TRUE)
 ```
 
 #### Model 03
 ```{r, MODEL_03}
-print_model(model_04)
+print_model(model_03, TRUE)
 ```
 
 ### Predicted Productions
-The map below plots the predicted airport productions. In model application, the calculated productions will be scaled to airport attractions, which is the number of enplanements at RDU entered by the model user. The current chart assumes `r rdu_enplanements` daily enplanements. It is also possible for the regression model to return a negative number of enplanements due to the negative coefficient on the high earner and distance interaction term. These productions have been censored at zero and will need to be similarly censored in model application. 
+The map below plots the predicted airport productions. In model application, the calculated productions will be scaled to airport attractions, which is the number of enplanements at RDU entered by the model user. The current chart assumes `r rdu_enplanements` daily enplanements. It is also possible for the regression model to return a negative number of enplanements due to the negative coefficient on the high paying jobs and distance interaction term. These productions have been censored at zero and will need to be similarly censored in model application. 
 
 ```{r, out.width=""100%"", fig.show='hold',fig.align='center'}
 knitr::include_graphics(""img/airport/estimated_productions.png"")

---FILE: docs/airport.html---
@@ -11,30 +11,23 @@
 
 <meta name=""author"" content=""Caliper Corporation"" />
 
-<meta name=""date"" content=""2021-05-18"" />
+<meta name=""date"" content=""2021-08-10"" />
 
 <title>Airport</title>
 
-<script src=""site_libs/header-attrs-2.7/header-attrs.js""></script>
+<script src=""site_libs/header-attrs-2.5/header-attrs.js""></script>
 <script src=""site_libs/jquery-1.11.3/jquery.min.js""></script>
 <meta name=""viewport"" content=""width=device-width, initial-scale=1"" />
 <link href=""site_libs/bootstrap-3.3.5/css/flatly.min.css"" rel=""stylesheet"" />
 <script src=""site_libs/bootstrap-3.3.5/js/bootstrap.min.js""></script>
 <script src=""site_libs/bootstrap-3.3.5/shim/html5shiv.min.js""></script>
 <script src=""site_libs/bootstrap-3.3.5/shim/respond.min.js""></script>
-<style>h1 {font-size: 34px;}
-       h1.title {font-size: 38px;}
-       h2 {font-size: 30px;}
-       h3 {font-size: 24px;}
-       h4 {font-size: 18px;}
-       h5 {font-size: 16px;}
-       h6 {font-size: 12px;}
-       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
-       pre:not([class]) { background-color: white }</style>
 <script src=""site_libs/jqueryui-1.11.4/jquery-ui.min.js""></script>
 <link href=""site_libs/tocify-1.9.1/jquery.tocify.css"" rel=""stylesheet"" />
 <script src=""site_libs/tocify-1.9.1/jquery.tocify.js""></script>
 <script src=""site_libs/navigation-1.1/tabsets.js""></script>
+<link href=""site_libs/anchor-sections-1.0/anchor-sections.css"" rel=""stylesheet"" />
+<script src=""site_libs/anchor-sections-1.0/anchor-sections.js""></script>
 <script src=""site_libs/kePrint-0.0.1/kePrint.js""></script>
 <link href=""site_libs/lightable-0.0.1/lightable.css"" rel=""stylesheet"" />
 
@@ -51,7 +44,32 @@
 
 
 
-
+<style type=""text/css"">
+h1 {
+  font-size: 34px;
+}
+h1.title {
+  font-size: 38px;
+}
+h2 {
+  font-size: 30px;
+}
+h3 {
+  font-size: 24px;
+}
+h4 {
+  font-size: 18px;
+}
+h5 {
+  font-size: 16px;
+}
+h6 {
+  font-size: 12px;
+}
+.table th:not([align]) {
+  text-align: left;
+}
+</style>
 
 <link rel=""stylesheet"" href=""styles.css"" type=""text/css"" />
 
@@ -63,6 +81,10 @@
   margin-left: auto;
   margin-right: auto;
 }
+code {
+  color: inherit;
+  background-color: rgba(0, 0, 0, 0.04);
+}
 img {
   max-width:100%;
 }
@@ -78,13 +100,40 @@
 summary {
   display: list-item;
 }
-pre code {
-  padding: 0;
-}
 </style>
 
 
 <style type=""text/css"">
+/* padding for bootstrap navbar */
+body {
+  padding-top: 60px;
+  padding-bottom: 40px;
+}
+/* offset scroll position for anchor links (for fixed navbar)  */
+.section h1 {
+  padding-top: 65px;
+  margin-top: -65px;
+}
+.section h2 {
+  padding-top: 65px;
+  margin-top: -65px;
+}
+.section h3 {
+  padding-top: 65px;
+  margin-top: -65px;
+}
+.section h4 {
+  padding-top: 65px;
+  margin-top: -65px;
+}
+.section h5 {
+  padding-top: 65px;
+  margin-top: -65px;
+}
+.section h6 {
+  padding-top: 65px;
+  margin-top: -65px;
+}
 .dropdown-submenu {
   position: relative;
 }
@@ -112,7 +161,7 @@
   margin-right: -10px;
 }
 .dropdown-submenu:hover>a:after {
-  border-left-color: #adb5bd;
+  border-left-color: #ffffff;
 }
 .dropdown-submenu.pull-left {
   float: none;
@@ -124,7 +173,7 @@
 }
 </style>
 
-<script type=""text/javascript"">
+<script>
 // manage active state of menu based on current page
 $(document).ready(function () {
   // active menu anchor
@@ -135,23 +184,10 @@
   var menuAnchor = $('a[href=""' + href + '""]');
 
   // mark it active
-  menuAnchor.tab('show');
+  menuAnchor.parent().addClass('active');
 
   // if it's got a parent navbar menu mark it active as well
   menuAnchor.closest('li.dropdown').addClass('active');
-
-  // Navbar adjustments
-  var navHeight = $("".navbar"").first().height() + 15;
-  var style = document.createElement('style');
-  var pt = ""padding-top: "" + navHeight + ""px; "";
-  var mt = ""margin-top: -"" + navHeight + ""px; "";
-  var css = """";
-  // offset scroll position for anchor links (for fixed navbar)
-  for (var i = 1; i <= 6; i++) {
-    css += "".section h"" + i + ""{ "" + pt + mt + ""}\n"";
-  }
-  style.innerHTML = ""body {"" + pt + ""padding-bottom: 40px; }\n"" + css;
-  document.head.appendChild(style);
 });
 </script>
 
@@ -163,6 +199,7 @@
   max-height: 500px;
   min-height: 44px;
   overflow-y: auto;
+  background: white;
   border: 1px solid #ddd;
   border-radius: 4px;
 }
@@ -288,13 +325,13 @@
 
 
 <!-- setup 3col/9col grid for toc_float and main content  -->
-<div class=""row"">
-<div class=""col-sm-12 col-md-4 col-lg-3"">
+<div class=""row-fluid"">
+<div class=""col-xs-12 col-sm-4 col-md-3"">
 <div id=""TOC"" class=""tocify"">
 </div>
 </div>
 
-<div class=""toc-content col-sm-12 col-md-8 col-lg-9"">
+<div class=""toc-content col-xs-12 col-sm-8 col-md-9"">
 
 
 
@@ -340,29 +377,47 @@
 </li>
 <li class=""dropdown"">
   <a href=""#"" class=""dropdown-toggle"" data-toggle=""dropdown"" role=""button"" aria-expanded=""false"">
-    Models
+    Resident Models
      
     <span class=""caret""></span>
   </a>
   <ul class=""dropdown-menu"" role=""menu"">
     <li>
-      <a href=""accessibility.html"">Accessibility</a>
+      <a href=""population_synthesis.html"">Synthesis</a>
     </li>
     <li>
-      <a href=""generation_disaggregation.html"">Dissaggregation</a>
+      <a href=""auto_ownership.html"">Auto Ownership</a>
     </li>
     <li>
-      <a href=""population_synthesis.html"">Synthesis</a>
+      <a href=""resident_production.html"">Production</a>
     </li>
     <li>
       <a href=""time_of_day.html"">Time of Day</a>
     </li>
     <li>
-      <a href=""nhb.html"">Non-home-based</a>
+      <a href=""resident_nonmotorized.html"">Non-motorized</a>
+    </li>
+    <li>
+      <a href=""nhb.html"">Non-homebased</a>
+    </li>
+  </ul>
+</li>
+<li class=""dropdown"">
+  <a href=""#"" class=""dropdown-toggle"" data-toggle=""dropdown"" role=""button"" aria-expanded=""false"">
+    Other Models
+     
+    <span class=""caret""></span>
+  </a>
+  <ul class=""dropdown-menu"" role=""menu"">
+    <li>
+      <a href=""accessibility.html"">Accessibility</a>
     </li>
     <li>
       <a href=""airport.html"">Airport</a>
     </li>
+    <li>
+      <a href=""commercial_vehicles.html"">Commercial Vehicles</a>
+    </li>
   </ul>
 </li>
       </ul>
@@ -373,21 +428,21 @@
   </div><!--/.container -->
 </div><!--/.navbar -->
 
-<div id=""header"">
+<div class=""fluid-row"" id=""header"">
 
 
 
 <h1 class=""title toc-ignore"">Airport</h1>
 <h4 class=""author"">Caliper Corporation</h4>
-<h4 class=""date"">May 18, 2021</h4>
+<h4 class=""date"">August 10, 2021</h4>
 
 </div>
 
 
 <div id=""introduction"" class=""section level2"">
 <h2>Introduction</h2>
 <p>Air passenger travel to/from the Raleigh-Durham International Airport (RDU) is captured by the air passenger model.</p>
-<p>A limited amount of data on air passengers is available and the modeling approach is therefore straightforward and requires a handful of assumptions. The available data is passive movements recordedfrom StreetLight Data. The benefits of this data is they provide a reasonable signal of movements to/from the airport. The drawbacks of this data include the following: <em>It does not distinguish between airport employees and air passengers.</em> It cannot distinguish between trip legs, for example the movement from home to an off-airport parking location and the movement from the off-airport parking location to the airport terminal. And it cannot distinguish between residents of the Triangle region and visitors to the Triangle region.</p>
+<p>A limited amount of data on air passengers is available. The modeling approach is therefore straightforward and requires a handful of assumptions. The available data is passive movements recorded from StreetLight Data. The benefits of this data is they provide a reasonable signal of movements to/from the airport. The drawbacks of this data are as follows: <em>It does not distinguish between airport employees and air passengers.</em> It cannot distinguish between trip legs, for example the movement from home to an off-airport parking location and the movement from the off-airport parking location to the airport terminal. And it cannot distinguish between residents of the Triangle region and visitors to the Triangle region.</p>
 </div>
 <div id=""streetlight-data-summaries"" class=""section level2"">
 <h2>StreetLight Data Summaries</h2>
@@ -430,6 +485,14 @@ <h3>Correlations</h3>
 </tr>
 <tr>
 <td style=""text-align:left;"">
+high_paying_jobs
+</td>
+<td style=""text-align:right;"">
+0.238
+</td>
+</tr>
+<tr>
+<td style=""text-align:left;"">
 Industry
 </td>
 <td style=""text-align:right;"">
@@ -470,14 +533,6 @@ <h3>Correlations</h3>
 </tr>
 <tr>
 <td style=""text-align:left;"">
-high_earners
-</td>
-<td style=""text-align:right;"">
-0.126
-</td>
-</tr>
-<tr>
-<td style=""text-align:left;"">
 workers
 </td>
 <td style=""text-align:right;"">
@@ -518,6 +573,14 @@ <h3>Correlations</h3>
 </tr>
 <tr>
 <td style=""text-align:left;"">
+high_paying_jobs_distance
+</td>
+<td style=""text-align:right;"">
+0.069
+</td>
+</tr>
+<tr>
+<td style=""text-align:left;"">
 Median_Inc
 </td>
 <td style=""text-align:right;"">
@@ -558,14 +621,6 @@ <h3>Correlations</h3>
 </tr>
 <tr>
 <td style=""text-align:left;"">
-high_earn_distance
-</td>
-<td style=""text-align:right;"">
--0.018
-</td>
-</tr>
-<tr>
-<td style=""text-align:left;"">
 Stud_GQ
 </td>
 <td style=""text-align:right;"">
@@ -590,12 +645,12 @@ <h3>Correlations</h3>
 </tr>
 </tbody>
 </table>
-<p>The above table shows correlations between airport productions and the variables we would expect and like to be correlated with airport productions, including workers,high income persons, and employment.</p>
+<p>The above table shows correlations between airport productions and the variables we would expect and like to be correlated with airport productions, including workers, employment, and high income employment.</p>
 <p>Using the correlations as a guide, we estimate a series of linear regression models in a search for a parsimonious balance between model fit and logical coefficients.</p>
 </div>
 <div id=""model-estimation-results"" class=""section level3 tabset MODEL"">
 <h3 class=""tabset MODEL"">Model Estimation Results</h3>
-<p>Numerous model estimations were conducted to find the preferred specification shown below. The preferred specification includes <code>high earners</code>, which is the number of high earners in each TAZ. A second term that interacts high earners with distance to the airport is included as well, which reduces the number of productions for high earners at greater distances from the airport.</p>
+<p>Numerous model estimations were conducted to find the preferred specification shown below. The preferred specification includes <code>high paying jobs</code>, which is the number of high paying jobs in each TAZ. A second term that interacts high paying jobs with distance to the airport is included as well, which reduces the number of productions for high earners at greater distances from the airport.</p>
 <p>The preferred specification includes <code>employment</code> which captures movements to/from work locations to the airport. The preferred specification collapses the employment categories. Specifications with employment separated by industry did not always reveal logical coefficients (e.g., a larger coefficient on industrial employment than office employment).</p>
 <p>Other, non-preferred specifications are included in the tabs below.</p>
 <div id=""preferred"" class=""section level4"">
@@ -620,55 +675,55 @@ <h4>Preferred</h4>
 <tbody>
 <tr>
 <td style=""text-align:left;"">
-<em>intercept</em>
+employment
 </td>
 <td style=""text-align:right;"">
-5.4539
+0.0148
 </td>
 <td style=""text-align:right;"">
-6.1304
+9.7474
 </td>
 <td style=""text-align:right;"">
 0
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
-employment
+high_paying_jobs
 </td>
 <td style=""text-align:right;"">
-0.0133
+0.0479
 </td>
 <td style=""text-align:right;"">
-15.7455
+13.7852
 </td>
 <td style=""text-align:right;"">
 0
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
-high_earn_distance
+high_paying_jobs_distance
 </td>
 <td style=""text-align:right;"">
--0.0051
+-0.0037
 </td>
 <td style=""text-align:right;"">
--14.7273
+-16.7011
 </td>
 <td style=""text-align:right;"">
 0
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
-high_earners
+workers
 </td>
 <td style=""text-align:right;"">
-0.1315
+0.0281
 </td>
 <td style=""text-align:right;"">
-20.2635
+22.0796
 </td>
 <td style=""text-align:right;"">
 0
@@ -679,7 +734,7 @@ <h4>Preferred</h4>
 Adjusted R-squared
 </td>
 <td style=""text-align:right;"">
-0.2686
+0.4410
 </td>
 <td style=""text-align:right;"">
 NA
@@ -795,38 +850,38 @@ <h4>Model 02</h4>
 <em>intercept</em>
 </td>
 <td style=""text-align:right;"">
-1.4671
+1.1720
 </td>
 <td style=""text-align:right;"">
-1.5752
+1.3157
 </td>
 <td style=""text-align:right;"">
-0.1154
+0.1884
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
-high_earn_distance
+high_paying_jobs
 </td>
 <td style=""text-align:right;"">
--0.0053
+0.0795
 </td>
 <td style=""text-align:right;"">
--16.0683
+18.1739
 </td>
 <td style=""text-align:right;"">
 0.0000
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
-high_earners
+high_paying_jobs_distance
 </td>
 <td style=""text-align:right;"">
-0.1027
+-0.0046
 </td>
 <td style=""text-align:right;"">
-12.1976
+-20.9730
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -837,24 +892,24 @@ <h4>Model 02</h4>
 hotel_rooms
 </td>
 <td style=""text-align:right;"">
--0.0071
+0.0187
 </td>
 <td style=""text-align:right;"">
--0.0969
+0.2639
 </td>
 <td style=""text-align:right;"">
-0.9228
+0.7919
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 Industry
 </td>
 <td style=""text-align:right;"">
-0.0344
+0.0368
 </td>
 <td style=""text-align:right;"">
-8.4089
+8.0544
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -865,10 +920,10 @@ <h4>Model 02</h4>
 Office
 </td>
 <td style=""text-align:right;"">
-0.0126
+-0.0135
 </td>
 <td style=""text-align:right;"">
-8.5698
+-4.6289
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -879,10 +934,10 @@ <h4>Model 02</h4>
 Retail
 </td>
 <td style=""text-align:right;"">
-0.0336
+0.0319
 </td>
 <td style=""text-align:right;"">
-11.0723
+10.8343
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -893,10 +948,10 @@ <h4>Model 02</h4>
 Service_RateHigh
 </td>
 <td style=""text-align:right;"">
-0.0559
+0.0785
 </td>
 <td style=""text-align:right;"">
-5.9880
+8.5147
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -907,10 +962,10 @@ <h4>Model 02</h4>
 workers
 </td>
 <td style=""text-align:right;"">
-0.0183
+0.0243
 </td>
 <td style=""text-align:right;"">
-5.3790
+14.8929
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -921,7 +976,7 @@ <h4>Model 02</h4>
 Adjusted R-squared
 </td>
 <td style=""text-align:right;"">
-0.3339
+0.3834
 </td>
 <td style=""text-align:right;"">
 NA
@@ -958,94 +1013,80 @@ <h4>Model 03</h4>
 <em>intercept</em>
 </td>
 <td style=""text-align:right;"">
-3.3970
-</td>
-<td style=""text-align:right;"">
-3.9278
-</td>
-<td style=""text-align:right;"">
-0.0001
-</td>
-</tr>
-<tr>
-<td style=""text-align:left;"">
-high_earn_distance
-</td>
-<td style=""text-align:right;"">
--0.0051
+2.4434
 </td>
 <td style=""text-align:right;"">
--15.3203
+2.5874
 </td>
 <td style=""text-align:right;"">
-0.0000
+0.0097
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
-high_earners
+employment
 </td>
 <td style=""text-align:right;"">
-0.1335
+0.0138
 </td>
 <td style=""text-align:right;"">
-21.4401
+8.7945
 </td>
 <td style=""text-align:right;"">
 0.0000
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
-Industry
+high_paying_jobs
 </td>
 <td style=""text-align:right;"">
-0.0317
+0.0488
 </td>
 <td style=""text-align:right;"">
-7.7504
+13.9853
 </td>
 <td style=""text-align:right;"">
 0.0000
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
-Office
+high_paying_jobs_distance
 </td>
 <td style=""text-align:right;"">
-0.0117
+-0.0037
 </td>
 <td style=""text-align:right;"">
-7.9367
+-16.8790
 </td>
 <td style=""text-align:right;"">
 0.0000
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
-Retail
+hotel_rooms
 </td>
 <td style=""text-align:right;"">
-0.0357
+-0.0041
 </td>
 <td style=""text-align:right;"">
-11.7986
+-0.0536
 </td>
 <td style=""text-align:right;"">
-0.0000
+0.9573
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
-Service_RateHigh
+workers
 </td>
 <td style=""text-align:right;"">
-0.0577
+0.0251
 </td>
 <td style=""text-align:right;"">
-6.1372
+14.4132
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -1056,7 +1097,7 @@ <h4>Model 03</h4>
 Adjusted R-squared
 </td>
 <td style=""text-align:right;"">
-0.3245
+0.2953
 </td>
 <td style=""text-align:right;"">
 NA
@@ -1071,7 +1112,7 @@ <h4>Model 03</h4>
 </div>
 <div id=""predicted-productions"" class=""section level3"">
 <h3>Predicted Productions</h3>
-<p>The map below plots the predicted airport productions. In model application, the calculated productions will be scaled to airport attractions, which is the number of enplanements at RDU entered by the model user. The current chart assumes 15343 daily enplanements. It is also possible for the regression model to return a negative number of enplanements due to the negative coefficient on the high earner and distance interaction term. These productions have been censored at zero and will need to be similarly censored in model application.</p>
+<p>The map below plots the predicted airport productions. In model application, the calculated productions will be scaled to airport attractions, which is the number of enplanements at RDU entered by the model user. The current chart assumes 15343 daily enplanements. It is also possible for the regression model to return a negative number of enplanements due to the negative coefficient on the high paying jobs and distance interaction term. These productions have been censored at zero and will need to be similarly censored in model application.</p>
 <p><img src=""img/airport/estimated_productions.png"" width=""100%"" style=""display: block; margin: auto;"" /></p>
 <p>The chart below plots the adjusted observed productions (truncated at 200 times the scaling necessary to matche the target attractions) against the estimated productions.</p>
 <p><img src=""img/airport/scatter_plot.png"" width=""80%"" style=""display: block; margin: auto;"" /></p>
@@ -1481,7 +1522,7 @@ <h2>Mode Choice</h2>
 
 $(document).ready(function () {
   $('.tabset-dropdown > .nav-tabs > li').click(function () {
-    $(this).parent().toggleClass('nav-tabs-open');
+    $(this).parent().toggleClass('nav-tabs-open')
   });
 });
 </script>"
Triangle-Modeling-and-Analytics,TRMG2,2d9c51250fc828b38f86445230a50d33604b0e79,CALIPER\srini,srinsund@gmail.com,2021-07-14T17:03:54Z,CALIPER\srini,srinsund@gmail.com,2021-07-14T17:03:54Z,Update mode choice model specification after fixing minor errors,master/resident/mode/n_hb_k12_all.csv;master/resident/mode/n_hb_od_long.csv;master/resident/mode/n_hb_od_short.csv;master/resident/mode/n_hb_ome_all.csv;master/resident/mode/n_hb_ome_all_nest.csv;master/resident/mode/n_hb_omed_all.csv;master/resident/mode/w_hb_o_all.csv;master/resident/mode/w_hb_o_all_nest.csv,False,False,False,False,32,40,72,"---FILE: master/resident/mode/n_hb_k12_all.csv---
@@ -1,20 +1,20 @@
 Alternative,Expression,Segment,Coefficient,Description
 sov,Constant,,-0.6283,Constant
 sov,sov_skim.CongTime,,-0.0138,Travel time
+sov,Constant,v0,-99,Auto Availability
 hov2,Constant,,-0.7337,Constant
 hov2,hov_skim.CongTime,,-0.0138,Travel time
 hov2,se.LargeHHPct.O,,0.4442,Large household percentage
 hov2,Constant,vi,-0.5049,Vehicle-insufficient households
-hov2,Constant,v0,-0.5049,Zero-vehicle households
+hov2,Constant,v0,-99,Auto Availability
 hov3,Constant,,-0.4809,Constant
 hov3,hov_skim.CongTime,,-0.0138,Travel time
 hov3,se.LargeHHPct.O,,0.4442,Large household percentage
-hov2,Constant,vi,-0.5049,Vehicle-insufficient households
-hov2,Constant,v0,-0.5049,Zero-vehicle households
+hov3,Constant,vi,-0.5049,Vehicle-insufficient households
+hov3,Constant,v0,-99,Auto Availability
 other_auto,Constant,,-1.8365,Constant
 other_auto,sov_skim.CongTime,,-0.0247,Travel time
 transit,se.HiIncomePct.O,,-0.5282,High income household percentage
-w_lb,w_lb_skim.[Generalized Cost] = null,,-9999,Availablility
 w_lb,w_lb_skim.[In-Vehicle Time] + w_lb_skim.Fare/.1983,,-0.02129,IVTT and Fare
 w_lb,w_lb_skim.[Access Walk Time],,-0.09,Access walk time
 w_lb,w_lb_skim.[Initial Wait Time],,-0.0826,Initial wait time

---FILE: master/resident/mode/n_hb_od_long.csv---
@@ -1,16 +1,17 @@
 Alternative,Expression,Segment,Coefficient,Description
 auto,parking.MC_LS_Work.D,,0.3041,Parking
 auto,se.HiIncomePct.O,,-0.4572,High income
+auto,Constant,v0,-99,Auto Availability
 sov,Constant,,2.729,Constant
 sov,sov_skim.CongTime,,-0.036625,Travel time
 sov,sov_skim.[TollCostSOV (Skim)],,-0.184695,Toll cost
 hov2,Constant,,2.4534,Constant
 hov2,hov_skim.CongTime,,-0.036625,Travel time
-hov2,hov_skim.[TollCostSOV (Skim)],,-0.184695,Toll cost
+hov2,hov_skim.[TollCostHOV (Skim)],,-0.184695,Toll cost
 hov2,se.HHSize1Pct.O,,-2.4073,Percent of 1-person HHs
 hov3,Constant,,2.4781,Constant
 hov3,hov_skim.CongTime,,-0.036625,Travel time
-hov3,hov_skim.[TollCostSOV (Skim)],,-0.184695,Toll cost
+hov3,hov_skim.[TollCostHOV (Skim)],,-0.184695,Toll cost
 hov3,se.HHSize1Pct.O,,-2.4073,Percent of 1-person HHs
 nonhh_auto,Constant,vi,1.7575,Vehicle insufficient households
 nonhh_auto,Constant,v0,1.7575,Zero-vehicle households
@@ -24,7 +25,6 @@ auto_pay,se.Enplanements.O > 0 or se.Enplanements.D > 0,,3.93,Airport related
 transit,Constant,vi,1.7575,Vehicle insufficient households
 transit,Constant,v0,1.7575,Zero-vehicle households
 w_lb,Constant,,5.8837,Constant
-w_lb,w_lb_skim.[Generalized Cost] = null,,-9999,Availablility
 w_lb,w_lb_skim.[In-Vehicle Time] + w_lb_skim.Fare/.1983,,-0.02129,IVTT and Fare
 w_lb,w_lb_skim.[Access Walk Time],,-0.09,Access walk time
 w_lb,w_lb_skim.[Initial Wait Time],,-0.0826,Initial wait time
@@ -33,7 +33,6 @@ w_lb,w_lb_skim.[Egress Walk Time],,-0.062,Egress walk time
 w_lb,w_lb_skim.[Number of Transfers] > 1,,-0.3018,High transfers
 w_lb,Constant,v0,0.58,Zero-vehicle households
 w_eb,Constant,,4.6188,Constant
-w_eb,w_eb_skim.[Generalized Cost] = null,,-9999,Availablility
 w_eb,w_eb_skim.[In-Vehicle Time] + w_eb_skim.Fare/.1983,,-0.02129,IVTT and Fare
 w_eb,w_eb_skim.[Access Walk Time],,-0.09,Access walk time
 w_eb,w_eb_skim.[Initial Wait Time],,-0.0826,Initial wait time
@@ -42,37 +41,33 @@ w_eb,w_eb_skim.[Egress Walk Time],,-0.062,Egress walk time
 w_eb,w_eb_skim.[Number of Transfers] > 1,,-0.3018,High transfers
 w_eb,Constant,v0,0.58,Zero-vehicle households
 knr_lb,Constant,,-0.095,Constant
-knr_lb,knr_lb_skim.[Generalized Cost] = null,,-9999,Availablility
 knr_lb,knr_lb_skim.[In-Vehicle Time] + knr_lb_skim.Fare/.1983,,-0.02129,IVTT and Fare
 knr_lb,knr_lb_skim.[Access Walk Time],,-0.09,Access walk time
 knr_lb,knr_lb_skim.[Initial Wait Time],,-0.0826,Initial wait time
 knr_lb,knr_lb_skim.[Transfer Wait Time],,-0.0631,Transfer wait time
 knr_lb,knr_lb_skim.[Egress Walk Time],,-0.062,Egress walk time
 knr_lb,knr_lb_skim.[Number of Transfers] > 1,,-0.3018,High transfers
-knr_eb,knr_eb_skim.[Generalized Cost] = null,,-9999,Availablility
 knr_eb,knr_eb_skim.[In-Vehicle Time] + knr_eb_skim.Fare/.1983,,-0.02129,IVTT and Fare
 knr_eb,knr_eb_skim.[Access Walk Time],,-0.09,Access walk time
 knr_eb,knr_eb_skim.[Initial Wait Time],,-0.0826,Initial wait time
 knr_eb,knr_eb_skim.[Transfer Wait Time],,-0.0631,Transfer wait time
 knr_eb,knr_eb_skim.[Egress Walk Time],,-0.062,Egress walk time
 knr_eb,knr_eb_skim.[Number of Transfers] > 1,,-0.3018,High transfers
 pnr_lb,Constant,,2.69,Constant
-pnr_lb,pnr_lb_skim.[Generalized Cost] = null,,-9999,Availablility
 pnr_lb,pnr_lb_skim.[In-Vehicle Time] + pnr_lb_skim.Fare/.1983,,-0.02129,IVTT and Fare
 pnr_lb,pnr_lb_skim.[Access Walk Time],,-0.09,Access walk time
 pnr_lb,pnr_lb_skim.[Initial Wait Time],,-0.0826,Initial wait time
 pnr_lb,pnr_lb_skim.[Transfer Wait Time],,-0.0631,Transfer wait time
 pnr_lb,pnr_lb_skim.[Egress Walk Time],,-0.062,Egress walk time
 pnr_lb,pnr_lb_skim.[Number of Transfers] > 1,,-0.3018,High transfers
 pnr_lb,Constant,vi,-1.4118,Vehicle insufficient households
-pnr_lb,Constant,v0,-1.4118,Zero-vehicle households
+pnr_lb,Constant,v0,-99,Zero-vehicle households
 pnr_eb,Constant,,2.63,Constant
-pnr_eb,pnr_eb_skim.[Generalized Cost] = null,,-9999,Availablility
 pnr_eb,pnr_eb_skim.[In-Vehicle Time] + pnr_eb_skim.Fare/.1983,,-0.02129,IVTT and Fare
 pnr_eb,pnr_eb_skim.[Access Walk Time],,-0.09,Access walk time
 pnr_eb,pnr_eb_skim.[Initial Wait Time],,-0.0826,Initial wait time
 pnr_eb,pnr_eb_skim.[Transfer Wait Time],,-0.0631,Transfer wait time
 pnr_eb,pnr_eb_skim.[Egress Walk Time],,-0.062,Egress walk time
 pnr_eb,pnr_eb_skim.[Number of Transfers] > 1,,-0.3018,High transfers
 pnr_eb,Constant,vi,-1.4118,Vehicle insufficient households
-pnr_eb,Constant,v0,-1.4118,Zero-vehicle households
+pnr_eb,Constant,v0,-99,Zero-vehicle households

---FILE: master/resident/mode/n_hb_od_short.csv---
@@ -1,17 +1,18 @@
 Alternative,Expression,Segment,Coefficient,Description
 auto,parking.MC_LS_Work.D,,0.1584,Parking
 auto,se.HiIncomePct.O,,0.6067,High income
+auto,Constant,v0,-99,Auto Availability
 sov,Constant,,4.5218,Constant
 sov,sov_skim.CongTime,,-0.086735,Travel time
 sov,sov_skim.[TollCostSOV (Skim)],,-0.437392,Toll cost
 hov2,Constant,,4.288,Constant
 hov2,hov_skim.CongTime,,-0.086735,Travel time
-hov2,hov_skim.[TollCostSOV (Skim)],,-0.437392,Toll cost
+hov2,hov_skim.[TollCostHOV (Skim)],,-0.437392,Toll cost
 hov2,Constant,vi,0.7501,Vehicle insufficient households
 hov2,Constant,v0,0.7501,Zero-vehicle households
 hov3,Constant,,4.179,Constant
 hov3,hov_skim.CongTime,,-0.086735,Travel time
-hov3,hov_skim.[TollCostSOV (Skim)],,-0.437392,Toll cost
+hov3,hov_skim.[TollCostHOV (Skim)],,-0.437392,Toll cost
 hov3,Constant,vi,0.7501,Vehicle insufficient households
 hov3,Constant,v0,0.7501,Zero-vehicle households
 nonhh_auto,Constant,vi,1.4154,Vehicle insufficient households
@@ -26,7 +27,6 @@ auto_pay,se.Enplanements.O > 0 or se.Enplanements.D > 0,,3.93,Airport related
 transit,Constant,vi,1.4154,Vehicle insufficient households
 transit,Constant,v0,1.4154,Zero-vehicle households
 w_lb,Constant,,5.8837,Constant
-w_lb,w_lb_skim.[Generalized Cost] = null,,-9999,Availablility
 w_lb,w_lb_skim.[In-Vehicle Time] + w_lb_skim.Fare/.1983,,-0.02129,IVTT and Fare
 w_lb,w_lb_skim.[Access Walk Time],,-0.09,Access walk time
 w_lb,w_lb_skim.[Initial Wait Time],,-0.0826,Initial wait time
@@ -35,7 +35,6 @@ w_lb,w_lb_skim.[Egress Walk Time],,-0.062,Egress walk time
 w_lb,w_lb_skim.[Number of Transfers] > 1,,-0.3018,High transfers
 w_lb,Constant,v0,0.58,Zero-vehicle households
 w_eb,Constant,,4.6188,Constant
-w_eb,w_eb_skim.[Generalized Cost] = null,,-9999,Availablility
 w_eb,w_eb_skim.[In-Vehicle Time] + w_eb_skim.Fare/.1983,,-0.02129,IVTT and Fare
 w_eb,w_eb_skim.[Access Walk Time],,-0.09,Access walk time
 w_eb,w_eb_skim.[Initial Wait Time],,-0.0826,Initial wait time
@@ -44,37 +43,33 @@ w_eb,w_eb_skim.[Egress Walk Time],,-0.062,Egress walk time
 w_eb,w_eb_skim.[Number of Transfers] > 1,,-0.3018,High transfers
 w_eb,Constant,v0,0.58,Zero-vehicle households
 knr_lb,Constant,,-0.095,Constant
-knr_lb,knr_lb_skim.[Generalized Cost] = null,,-9999,Availablility
 knr_lb,knr_lb_skim.[In-Vehicle Time] + knr_lb_skim.Fare/.1983,,-0.02129,IVTT and Fare
 knr_lb,knr_lb_skim.[Access Walk Time],,-0.09,Access walk time
 knr_lb,knr_lb_skim.[Initial Wait Time],,-0.0826,Initial wait time
 knr_lb,knr_lb_skim.[Transfer Wait Time],,-0.0631,Transfer wait time
 knr_lb,knr_lb_skim.[Egress Walk Time],,-0.062,Egress walk time
 knr_lb,knr_lb_skim.[Number of Transfers] > 1,,-0.3018,High transfers
-knr_eb,knr_eb_skim.[Generalized Cost] = null,,-9999,Availablility
 knr_eb,knr_eb_skim.[In-Vehicle Time] + knr_eb_skim.Fare/.1983,,-0.02129,IVTT and Fare
 knr_eb,knr_eb_skim.[Access Walk Time],,-0.09,Access walk time
 knr_eb,knr_eb_skim.[Initial Wait Time],,-0.0826,Initial wait time
 knr_eb,knr_eb_skim.[Transfer Wait Time],,-0.0631,Transfer wait time
 knr_eb,knr_eb_skim.[Egress Walk Time],,-0.062,Egress walk time
 knr_eb,knr_eb_skim.[Number of Transfers] > 1,,-0.3018,High transfers
 pnr_lb,Constant,,2.69,Constant
-pnr_lb,pnr_lb_skim.[Generalized Cost] = null,,-9999,Availablility
 pnr_lb,pnr_lb_skim.[In-Vehicle Time] + pnr_lb_skim.Fare/.1983,,-0.02129,IVTT and Fare
 pnr_lb,pnr_lb_skim.[Access Walk Time],,-0.09,Access walk time
 pnr_lb,pnr_lb_skim.[Initial Wait Time],,-0.0826,Initial wait time
 pnr_lb,pnr_lb_skim.[Transfer Wait Time],,-0.0631,Transfer wait time
 pnr_lb,pnr_lb_skim.[Egress Walk Time],,-0.062,Egress walk time
 pnr_lb,pnr_lb_skim.[Number of Transfers] > 1,,-0.3018,High transfers
 pnr_lb,Constant,vi,-1.4118,Vehicle insufficient households
-pnr_lb,Constant,v0,-1.4118,Zero-vehicle households
+pnr_lb,Constant,v0,-99,Zero-vehicle households
 pnr_eb,Constant,,2.63,Constant
-pnr_eb,pnr_eb_skim.[Generalized Cost] = null,,-9999,Availablility
 pnr_eb,pnr_eb_skim.[In-Vehicle Time] + pnr_eb_skim.Fare/.1983,,-0.02129,IVTT and Fare
 pnr_eb,pnr_eb_skim.[Access Walk Time],,-0.09,Access walk time
 pnr_eb,pnr_eb_skim.[Initial Wait Time],,-0.0826,Initial wait time
 pnr_eb,pnr_eb_skim.[Transfer Wait Time],,-0.0631,Transfer wait time
 pnr_eb,pnr_eb_skim.[Egress Walk Time],,-0.062,Egress walk time
 pnr_eb,pnr_eb_skim.[Number of Transfers] > 1,,-0.3018,High transfers
 pnr_eb,Constant,vi,-1.4118,Vehicle insufficient households
-pnr_eb,Constant,v0,-1.4118,Zero-vehicle households
+pnr_eb,Constant,v0,-99,Zero-vehicle households

---FILE: master/resident/mode/n_hb_ome_all.csv---
@@ -1,18 +1,19 @@
 Alternative,Expression,Segment,Coefficient,Description
 auto,parking.MC_LS_NonWork.D,,0.1204,Parking
 auto,se.HiIncomePct.O,,1.6693,High income
+auto,Constant,v0,-99,Auto Availability
 sov,Constant,,-2.102,Constant
 sov,sov_skim.CongTime,,-0.03,Travel time
 sov,sov_skim.[TollCostSOV (Skim)],,-0.15,Toll cost
 hov2,Constant,,-2.296,Constant
 hov2,hov_skim.CongTime,,-0.03,Travel time
-hov2,hov_skim.[TollCostSOV (Skim)],,-0.15,Toll cost
+hov2,hov_skim.[TollCostHOV (Skim)],,-0.15,Toll cost
 hov2,se.HHSize1Pct.O,,-2.98,Percent of 1-person HHs
 hov2,Constant,vi,0.7117,Vehicle insufficient households
 hov2,Constant,v0,0.7117,Zero-vehicle households
 hov3,Constant,,-2.66,Constant
 hov3,hov_skim.CongTime,,-0.03,Travel time
-hov3,hov_skim.[TollCostSOV (Skim)],,-0.15,Toll cost
+hov3,hov_skim.[TollCostHOV (Skim)],,-0.15,Toll cost
 hov3,se.HHSize1Pct.O,,-2.98,Percent of 1-person HHs
 hov3,Constant,vi,0.7117,Vehicle insufficient households
 hov3,Constant,v0,0.7117,Zero-vehicle households
@@ -28,13 +29,13 @@ auto_pay,hov_skim.auto_pay_fare,,-0.00675,Auto fare
 auto_pay,se.Enplanements.O > 0 or se.Enplanements.D > 0,,3.93,Airport related
 transit,Constant,vi,3.177,Vehicle insufficient households
 transit,Constant,v0,3.177,Zero-vehicle households
-w_lb,w_lb_skim.IVTT + w_lb_skim.Fare/0.1983,,-0.046,IVTT and Fare (converted by VOT)
+w_lb,w_lb_skim.[In-Vehicle Time] + w_lb_skim.Fare/0.1983,,-0.046,IVTT and Fare (converted by VOT)
 w_lb,w_lb_skim.[Access Walk Time],,-0.1138,Access walk time
 w_lb,w_lb_skim.[Initial Wait Time],,-0.123,Initial wait time
 w_lb,w_lb_skim.[Egress Walk Time],,-0.1972,Egress walk time
 w_lb,w_lb_skim.[Number of Transfers] > 1,,-1.4619,High transfers
 w_eb,Constant,,-0.296,Constant
-w_eb,w_eb_skim.IVTT + w_eb_skim.Fare/0.1983,,-0.046,IVTT and Fare (converted by VOT)
+w_eb,w_eb_skim.[In-Vehicle Time] + w_eb_skim.Fare/0.1983,,-0.046,IVTT and Fare (converted by VOT)
 w_eb,w_eb_skim.[Access Walk Time],,-0.1138,Access walk time
 w_eb,w_eb_skim.[Initial Wait Time],,-0.123,Initial wait time
 w_eb,w_eb_skim.[Egress Walk Time],,-0.1972,Egress walk time

---FILE: master/resident/mode/n_hb_ome_all_nest.csv---
@@ -2,4 +2,4 @@ Parent,Alternatives,ParentNestCoeff
 Root,""auto, nonhh_auto, transit"",1
 auto,""sov, hov2, hov3"",1
 nonhh_auto,""auto_pay, other_auto"",0.186
-transit,""walk_lb, walk_eb"",0.416
+transit,""w_lb, w_eb"",0.416

---FILE: master/resident/mode/n_hb_omed_all.csv---
@@ -1,23 +1,24 @@
 Alternative,Expression,Segment,Coefficient,Description
 auto,parking.MC_LS_Work.D,,0.714,Parking
 auto,se.HiIncomePct.O,,1.529,High income
+auto,Constant,v0,-99,Auto Availability
 sov,Constant,,-10.668,Constant
 sov,sov_skim.CongTime,,-0.036625,Travel time
 sov,sov_skim.[TollCostSOV (Skim)],,-0.184695,Toll cost
 hov2,Constant,,-10.791,Constant
 hov2,hov_skim.CongTime,,-0.036625,Travel time
-hov2,hov_skim.[TollCostSOV (Skim)],,-0.184695,Toll cost
+hov2,hov_skim.[TollCostHOV (Skim)],,-0.184695,Toll cost
 hov2,se.HHSize1Pct.O,,-2.2933,Percent of 1-person HHs
 hov2,Constant,vi,0.824,Vehicle insufficient households
-hov2,Constant,vo,0.824,Zero-vehicle households
+hov2,Constant,v0,0.824,Zero-vehicle households
 hov3,Constant,,-11.54,Constant
 hov3,hov_skim.CongTime,,-0.036625,Travel time
-hov3,hov_skim.[TollCostSOV (Skim)],,-0.184695,Toll cost
+hov3,hov_skim.[TollCostHOV (Skim)],,-0.184695,Toll cost
 hov3,se.HHSize1Pct.O,,-2.2933,Percent of 1-person HHs
 hov3,Constant,vi,0.824,Vehicle insufficient households
-hov3,Constant,vo,0.824,Zero-vehicle households
+hov3,Constant,v0,0.824,Zero-vehicle households
 nonhh_auto,Constant,vi,3.735,Vehicle insufficient households
-nonhh_auto,Constant,vo,3.735,Zero-vehicle households
+nonhh_auto,Constant,v0,3.735,Zero-vehicle households
 other_auto,Constant,,-7.287,Constant
 other_auto,sov_skim.CongTime,,-0.0247,Travel time
 auto_pay,Constant,,-5.51,Constant
@@ -26,14 +27,14 @@ auto_pay,se.PKTNCWait.O,,-0.0247,Auto wait time
 auto_pay,hov_skim.auto_pay_fare,,-0.00675,Auto fare
 auto_pay,se.Enplanements.O > 0 or se.Enplanements.D > 0,,3.93,Airport related
 transit,Constant,vi,3.735,Vehicle insufficient households
-transit,Constant,vo,3.735,Zero-vehicle households
-w_lb,w_lb_skim.IVTT + w_lb_skim.Fare/0.1983,,-0.046,IVTT and Fare (converted by VOT)
+transit,Constant,v0,3.735,Zero-vehicle households
+w_lb,w_lb_skim.[In-Vehicle Time] + w_lb_skim.Fare/0.1983,,-0.046,IVTT and Fare (converted by VOT)
 w_lb,w_lb_skim.[Access Walk Time],,-0.1138,Access walk time
 w_lb,w_lb_skim.[Initial Wait Time],,-0.123,Initial wait time
 w_lb,w_lb_skim.[Egress Walk Time],,-0.1972,Egress walk time
 w_lb,w_lb_skim.[Number of Transfers] > 1,,-1.4619,High transfers
 w_eb,Constant,,-1.519,Constant
-w_eb,w_eb_skim.IVTT + w_eb_skim.Fare/0.1983,,-0.046,IVTT and Fare (converted by VOT)
+w_eb,w_eb_skim.[In-Vehicle Time] + w_eb_skim.Fare/0.1983,,-0.046,IVTT and Fare (converted by VOT)
 w_eb,w_eb_skim.[Access Walk Time],,-0.1138,Access walk time
 w_eb,w_eb_skim.[Initial Wait Time],,-0.123,Initial wait time
 w_eb,w_eb_skim.[Egress Walk Time],,-0.1972,Egress walk time

---FILE: master/resident/mode/w_hb_o_all.csv---
@@ -1,5 +1,5 @@
 Alternative,Expression,Segment,Coefficient,Description
-auto,se.HiIncomePct.O,,0.94614,High income
+auto,se.HiIncomePct.O,,0.7322,High income
 auto,Constant,v0,-99,Auto Availability
 sov,Constant,,4.88,Constant
 sov,sov_skim.CongTime,,-0.065,Travel time

---FILE: master/resident/mode/w_hb_o_all_nest.csv---
@@ -1,5 +1,5 @@
 Parent,Alternatives,ParentNestCoeff
 Root,""auto, nonhh_auto, transit"",1
-auto,""sov, hov2, hov3"",0.35
+auto,""sov, hov2, hov3"",0.348
 nonhh_auto,""auto_pay, other_auto"",1
-transit,""walk_lb, walk_eb"",0.52
+transit,""w_lb, w_eb"",0.5197"
Triangle-Modeling-and-Analytics,TRMG2,724af48cb637a9be39a4e6eae0c89714ec90dfc9,Kyle Ward,kyle@caliper.com,2021-06-30T12:13:53Z,Kyle Ward,kyle@caliper.com,2021-06-30T12:13:53Z,"Use weights from CV survey

This still led to poor results, and issues with the survey were identified
years back. Will wind up borrowing rates for a first draft.",docs/commercial_vehicles.Rmd,True,False,True,False,17,26,43,"---FILE: docs/commercial_vehicles.Rmd---
@@ -31,6 +31,7 @@ re-estimated were possible using the Triangle's 2010 Commercial Vehicle survey.
 ```{r, include=FALSE}
 veh_raw <- read_csv(""data/input/_PRIVATE/survey_data/SurveyData_Caliper/2010 Commercial Vehicle Travel/1_Data - Original/vehicles_exported.csv"")
 trips_raw <- read_csv(""data/input/_PRIVATE/survey_data/SurveyData_Caliper/2010 Commercial Vehicle Travel/1_Data - Original/trips_exported.csv"")
+est_raw <- read_csv(""data/input/_PRIVATE/survey_data/SurveyData_Caliper/2010 Commercial Vehicle Travel/1_Data - Original/establishment_export.csv"")
 ```
 
 ```{r}
@@ -44,7 +45,8 @@ veh_types <- veh_raw %>%
   select(SAMPN, veh_type)
 
 add_veh_types <- trips_raw %>%
-  left_join(veh_types, by = ""SAMPN"")
+  left_join(veh_types, by = ""SAMPN"") %>%
+  left_join(est_raw %>% select(SAMPN, EXPWGT), by = ""SAMPN"")
 ```
 
 ```{r, include=FALSE}
@@ -109,7 +111,7 @@ used as both production and attraction rates.
 
 ```{r}
 rate_est_tbl <- add_tazs %>%
-  select(TAZ, district, veh_type) %>%
+  select(TAZ, district, veh_type, EXPWGT) %>%
   left_join(
     se %>% select(
       TAZ,
@@ -122,47 +124,36 @@ rate_est_tbl <- add_tazs %>%
     ),
     by = ""TAZ""
   ) %>%
-  mutate(
-    Service = Service_RateHigh + Service_RateLow
-  ) %>%
-  select(-Service_RateHigh, -Service_RateLow) %>%
   group_by(veh_type, district) %>%
-  summarize(across(HH:Service, sum), trips = n())
-
-# models <- rate_est_tbl %>%
-#   select(-district) %>%
-#   group_by(veh_type) %>%
-#   nest() %>%
-#   mutate(
-#     fit = map(data, ~lm(trips ~ ., data = .))
-#   )
-# 
-# summary(models$fit[[1]])
-# summary(models$fit[[2]])
-# summary(models$fit[[3]])
+  # group_by(veh_type, TAZ) %>%
+  summarize(across(EXPWGT:Service_RateLow, sum)) %>%
+  rename(trips = EXPWGT)
 
 cv_model <- lm(
-  trips ~ HH + Industry + Retail + OffServ,
+  trips ~ HH + Industry + Retail + Office + Service_RateHigh + Service_RateLow,
   data = rate_est_tbl %>%
     filter(veh_type == ""CV"") %>%
-    mutate(OffServ = Office + Service)
+    mutate(OtherEmp = Retail + Office + Service_RateHigh)
 )
 cv_rsq <- round(summary(cv_model)$r.squared, 2)
 
-
 sut_model <- lm(
-  trips ~ HH + Industry + OffRet + Service,
+  trips ~ HH + Retail + OtherEmp + 0,
   data = rate_est_tbl %>%
     filter(veh_type == ""SUT"") %>%
-    mutate(OffRet = Retail + Office)
+    mutate(
+      OtherEmp = Industry + Office + Service_RateHigh + Service_RateLow
+    )
 )
 sut_rsq <- round(summary(sut_model)$r.squared, 2)
 
 mut_model <- lm(
-  trips ~ Industry + NonIndustry,
+  trips ~ HH + Industry + OtherEmp + 0,
   data = rate_est_tbl %>%
     filter(veh_type == ""MUT"") %>%
-    mutate(NonIndustry = Retail + Office + Service)
+    mutate(
+      OtherEmp = Retail + Office + Service_RateHigh + Service_RateLow
+    )
 )
 mut_rsq <- round(summary(mut_model)$r.squared, 2)
 ```"
Triangle-Modeling-and-Analytics,TRMG2,b5cba02efdf5518e0c2138e65c90f91938d4702e,CALIPER\srini,srinsund@gmail.com,2021-06-10T13:40:49Z,CALIPER\srini,srinsund@gmail.com,2021-06-10T13:40:49Z,"Parking.rsc: Use transit skim headway for shuttle times in ParkAndShuttle model. Postprocess to combine logsum and probability fields.
Update ParkandShuttle dcm file as necessary.
Fix size variable coefficient in ParkAndWalk dcm file.",master/resident/parking/ParkandShuttle.dcm;master/resident/parking/ParkandWalk.dcm;src/08 - Parking.rsc,False,False,False,False,82,12,94,"---FILE: master/resident/parking/ParkandShuttle.dcm---
@@ -1,17 +1,23 @@
 model version=1.5
   field name=BetaTime
   field name=BetaCost
+  field name=BetaHeadway
   field name=BetaSize
   source name=ParkingZones type=Matrix primary=True origins=True destinations=True file=C:\projects\TRM\Repo\scenarios\base_2016\output\resident\parking\ParkAvailability.mtx filelabel=ParkingAvailability rowindex=CBD colindex=CBD
   source name=WalkSkim type=Matrix file=C:\projects\TRM\Repo\scenarios\base_2016\output\accessibility\walk_skim.mtx filelabel=""Walk Accessiblity Skim"" rowindex=Origin colindex=Destination
   source name=SE type=Zonal view=scenario_se idfield=TAZ
+  source name=TransitSkim type=Matrix file=C:\projects\TRM\Repo\scenarios\base_2016\output\skims\transit\skim_AM_w_lb.mtx filelabel=""Transit skim AM_w_lb"" rowindex=RCIndex colindex=RCIndex
   source name=WalkTimeForShuttle label=WalkTimeForShuttle type=Expression expression=WalkSkim.WalkTime/4
+  source name=TransitHeadway label=TransitHeadway type=Expression expression=""TransitSkim.[Initial Wait Time] * 2""
   segment name=*
     term name=BetaTime coefficient=-0.02625
     term name=BetaCost coefficient=-0.125
+    term name=BetaHeadway coefficient=-0.0075
     term name=BetaSize coefficient=1
     alternative name=ParkingZones destsource=ParkingZones destindex=CBD
       available source=ParkingZones spec=Availability
       data source=SE spec=ParkCost term=BetaCost type=Destination
       data source=WalkTimeForShuttle term=BetaTime type=Expression
       data source=SE spec=ParkSize term=BetaSize type=Destination
+      data source=TransitHeadway term=BetaHeadway type=Expression
+

---FILE: master/resident/parking/ParkandWalk.dcm---
@@ -8,7 +8,7 @@ model version=1.5
   segment name=*
     term name=BetaTime coefficient=-0.03
     term name=BetaCost coefficient=-0.21
-    term name=BetaSize coefficient=0
+    term name=BetaSize coefficient=1.00
     alternative name=ParkingZones destsource=ParkingZones destindex=CBD
       available source=ParkingZones spec=Availability
       data source=WalkSkim spec=WalkTime term=BetaTime type=Matrix

---FILE: src/08 - Parking.rsc---
@@ -143,16 +143,16 @@ endMacro
     Macro that fill the appropriate park cost field into the common field called 'ParkCost' before running the destination choice model
 */
 Macro ""Parking: Fill Fields""(spec)
-    // Get approprioate parking cost field
-    if spec.TourType = 'Work' then do// 'CBD' and 'Work' or 'Univ' and 'Work'
+    // Get appropriate parking cost field
+    if spec.TourType = 'Work' then do// 'CBD' + 'Work' or 'Univ' + 'Work'
         parkCost = 'ParkCostW'
         spacesFld = 'EmpSpaces'
     end
-    else if spec.DestType = 'Univ' then do     // 'Univ' and 'NonWork')
+    else if spec.DestType = 'Univ' then do     // 'Univ' + 'NonWork')
         parkCost = 'ParkCostU'
         spacesFld = 'StudSpaces'
     end
-    else do                               // 'CBD' and 'NonWork'
+    else do                               // 'CBD' + 'NonWork'
         parkCost = 'ParkCostO'
         spacesFld = 'OtherSpaces'
     end
@@ -162,9 +162,9 @@ Macro ""Parking: Fill Fields""(spec)
     vecs = GetDataVectors(se_vw + ""|"", {parkCost, spacesFld},)
 
     vecsSet = null
-    vecsSet.ParkCost = vecs[1]/100
+    vecsSet.ParkCost = i2r(vecs[1])/100
     vecsSet.ParkSize = if vecs[2] > 0 then log(vecs[2]) else -99
-    SetDataVectors(se_vw + ""|"", vecsSet,)    
+    SetDataVectors(se_vw + ""|"", vecsSet,)
 endMacro
 
 
@@ -234,6 +234,22 @@ Macro ""Parking: Create DCM File""(Args, spec)
     primarySrc.RowIdx = destType // ""CBD"" or ""Univ""
     primarySrc.ColIdx = destType
 
+    // Change label of transit Skim Source (only for park and shuttle)
+    if tourType = ""Work"" then
+        tSkim = Args.[Output Folder] + ""\\skims\\transit\\skim_AM_w_lb.mtx""
+    else
+        tSkim = Args.[Output Folder] + ""\\skims\\transit\\skim_MD_w_lb.mtx""
+    
+    m = OpenMatrix(tSkim,)
+    label = GetMatrixName(m)
+    m = null
+
+    tSkimSrc = model.GetDataSource(""TransitSkim"")
+    if tSkimSrc <> null then do     // Note tSkimSrc = null for the Park and Walk model
+        tSkimSrc.FileName = tSkim
+        tSkimSrc.FileLabel = label
+    end
+
     // Change destination index of the composite alternative
     seg = model.GetSegment(""*"")
     alt = seg.GetAlternative(""ParkingZones"")
@@ -246,10 +262,8 @@ Macro ""Parking: Create DCM File""(Args, spec)
     coeffs = parkingCoeffs.(coeffCol)
     for i = 1 to coeffNames.length do
         coeffName = coeffNames[i]
-        if coeffName contains ""Time"" or coeffName contains ""Cost"" then do
-            term = seg.GetTerm(coeffName)
-            term.Coeff = coeffs[i]
-        end
+        term = seg.GetTerm(coeffName)
+        term.Coeff = coeffs[i]
     end
     model.Write(dcmFile)
     model.Clear()
@@ -396,6 +410,56 @@ Macro ""Parking Mode Choice""(Args)
 
     // Add fields and fill output vector
     modify.Apply()
-    SetDataVectors(vwOut + ""|"", vecsSet,)     
+    SetDataVectors(vwOut + ""|"", vecsSet,)
+
+    // Post process
+    RunMacro(""PostProcess Logsum Table"", vwOut)
     CloseView(vwOut)
 endMacro
+
+
+/*
+Collapse logsum and probabilty fields
+E.g. Merge logsum fields 'Walk_CBD_Work' and 'Walk_Univ_Work' into new fields 'LS_Walk_Work'
+Note that univ and CBD zones are mutually exclusive. 
+Therefore at least one of the fields 'Walk_CBD_Work' and 'Walk_Univ_Work' is always null
+*/
+Macro ""PostProcess Logsum Table""(vwOut)
+    modes = {'Walk', 'Shuttle'}
+    tourTypes = {'Work', 'NonWork'}
+    vecsSet = null
+    // LS Fields
+    modify = CreateObject(""CC.ModifyTableOperation"", vwOut)
+    for mode in modes do
+        for tourType in tourTypes do
+            outFld = ""LS_"" + mode + ""_"" + tourType
+            cbdFld = mode + ""_CBD_"" + tourType
+            univFld = mode + ""_Univ_"" + tourType
+            vecs = GetDataVectors(vwOut + ""|"", {cbdFld, univFld},)
+            vecsSet.(outFld) = if vecs[1] <> null then vecs[1]
+                               else if vecs[2] <> null then vecs[2]
+                               else null
+            
+            modify.FindOrAddField(outFld, ""Real"", 12, 2, )
+            modify.DropField(cbdFld)
+            modify.DropField(univFld)
+        end
+    end
+
+    // Prob Fields
+    for tourType in tourTypes do
+        outFld = ""Prob_Shuttle_"" + tourType
+        cbdFld = ""Prob_Shuttle_CBD_"" + tourType
+        univFld = ""Prob_Shuttle_Univ_"" + tourType
+        vecs = GetDataVectors(vwOut + ""|"", {cbdFld, univFld},)
+        vecsSet.(outFld) = if vecs[1] <> null then vecs[1]
+                           else if vecs[2] <> null then vecs[2]
+                           else null
+        
+        modify.FindOrAddField(outFld, ""Real"", 12, 2, )
+        modify.DropField(cbdFld)
+        modify.DropField(univFld)
+    end 
+    modify.Apply()
+    SetDataVectors(vwOut + ""|"", vecsSet,)
+endMacro"
Triangle-Modeling-and-Analytics,TRMG2,22dd9d85c1c85aa2124eecca8009911c5b441857,Kyle Ward,kyle@caliper.com,2021-05-20T00:29:11Z,Kyle Ward,kyle@caliper.com,2021-05-20T00:29:11Z,Correct small error in substitute,src/01 - CreateScenario.rsc,False,False,False,False,1,1,2,"---FILE: src/01 - CreateScenario.rsc---
@@ -216,7 +216,7 @@ Macro ""Create Scenario Transit"" (Args)
   DeleteRecordsInSet(del_set)
   ExportView(mode_vw + ""|"", ""CSV"", Args.TransModeTable, , {""CSV Header"": ""true""})
   CloseView(mode_vw)
-  DeleteFile(Substitute(Args.TransModeTable, "".csv"", "".dcc""))
+  DeleteFile(Substitute(Args.TransModeTable, "".csv"", "".dcc"", ))
 
   CloseMap(map)
 EndMacro"
Triangle-Modeling-and-Analytics,TRMG2,c568f871c6f21294d241a85d347619c76dff072b,Kyle Ward,kyle@caliper.com,2021-05-18T22:37:22Z,Kyle Ward,kyle@caliper.com,2021-05-18T22:37:22Z,Correct file name error,src/03 - Accessibility.rsc,False,False,False,False,1,1,2,"---FILE: src/03 - Accessibility.rsc---
@@ -326,7 +326,7 @@ Macro ""Access Logsums"" (Args)
     // Bike Skim
     obj.Network = output_dir + ""/networks/net_bike.net""
     obj.Minimize = ""BikeTime""
-    out_files.bike = output_dir + ""/skims/nonmotorized/walk_skim.mtx""
+    out_files.bike = output_dir + ""/skims/nonmotorized/bike_skim.mtx""
     obj.OutputMatrix({MatrixFile: out_files.bike, Matrix: ""Bike Skim""})
     ret_value = obj.Run()
 "
Triangle-Modeling-and-Analytics,TRMG2,9943f22490c230ff761fca30e2f08ad281328124,David Ory,david.ory@gmail.com,2021-05-18T18:53:51Z,David Ory,david.ory@gmail.com,2021-05-18T18:53:51Z,"correct airport TAZ error, enplane from soc-ec",docs/R/airport.R;docs/R/make_airport_distance_skim.R;docs/airport.Rmd;docs/airport.html;docs/data/input/airport/distance-skim.RDS;docs/data/output/airport/airport-productions.csv;docs/data/output/airport/airport-productions.twb;docs/img/airport/estimated_productions.png;docs/img/airport/scatter_plot.png;docs/img/airport/streetlight_productions.png;docs/img/airport/streetlight_productions_censored.png;docs/img/airport/trip_length_frequency.png,True,True,True,False,13381,8928,22309,"---FILE: docs/R/airport.R---
@@ -33,9 +33,8 @@ output_production_filename <- paste0(output_dir, ""airport/airport-productions.cs
 
 # Parameters -------------------------------------------------------------------
 SL_AIRPORT_ZONE <- 1261
-AIRPORT_TAZ <- 1261
+AIRPORT_TAZ <- 2369
 LAT_LNG_EPSG <- 4326
-RDU_ENPLANEMENTS <- 15343
 OUTLIER_MIN <- 200
 
 # Data Reads -------------------------------------------------------------------
@@ -54,6 +53,9 @@ durham_sf <- st_read(durham_sl_shape, crs = LAT_LNG_EPSG)
 
 hotels_df <- readRDS(hotel_filename)
 
+# Enplanements -----------------------------------------------------------------
+rdu_enplanements <- filter(socec_df, TAZ == AIRPORT_TAZ)$RDU_ENPLANE
+
 # TAZ Coordinates --------------------------------------------------------------
 centroids_sf <- select(taz_sf, taz = ID, geometry) %>%
   st_centroid()
@@ -163,7 +165,7 @@ correlations_df <- productions_df %>%
 model_df <- productions_df %>%
   mutate(y = if_else(airport_productions > OUTLIER_MIN, OUTLIER_MIN, airport_productions))
 
-adjust_factor <- (RDU_ENPLANEMENTS * 2.0)/sum(model_df$y)
+adjust_factor <- (rdu_enplanements * 2.0)/sum(model_df$y)
 
 model_df <- model_df %>%
   mutate(y = y * adjust_factor)

---FILE: docs/R/make_airport_distance_skim.R---
@@ -17,7 +17,7 @@ input_filename <- paste0(private_dir, ""AMSOVDistanceSkim.csv"")
 output_filename <- paste0(output_dir, ""airport/distance-skim.RDS"")
 
 # Parameters -------------------------------------------------------------------
-AIRPORT_TAZ <- 1261
+AIRPORT_TAZ <- 2369
 
 # Data Reads -------------------------------------------------------------------
 skim_df <- read_csv(input_filename, 

---FILE: docs/airport.Rmd---
@@ -1,7 +1,7 @@
 ---
 title: ""Airport""
 author: ""Caliper Corporation""
-date: ""April 26, 2021""
+date: ""May 18, 2021""
 output: html_document
 editor_options: 
   chunk_output_type: console
@@ -19,38 +19,20 @@ options(scipen = 999)
 
 ## Introduction
 
-Air passenger travel to/from the Raleigh-Durham International Airport (RDU) is captured
-by the air passenger model. 
+Air passenger travel to/from the Raleigh-Durham International Airport (RDU) is captured by the air passenger model. 
 
-A limited amount of data on air passengers is available and the modeling approach 
-is therefore straightforward and requires a handful of assumptions. 
-The available data is passive movements recordedfrom StreetLight Data. The benefits
-of this data is they provide a reasonable signal of movements to/from the airport. 
-The drawbacks of this data include the following:
-* It does not distinguish between airport employees and air passengers. 
-* It cannot distinguish between trip legs, for example the movement from home to
-an off-airport parking location and the movement from the off-airport parking location
-to the airport terminal. 
+A limited amount of data on air passengers is available and the modeling approach is therefore straightforward and requires a handful of assumptions. The available data is passive movements recordedfrom StreetLight Data. The benefits of this data is they provide a reasonable signal of movements to/from the airport. The drawbacks of this data include the following: *It does not distinguish between airport employees and air passengers.* It cannot distinguish between trip legs, for example the movement from home to an off-airport parking location and the movement from the off-airport parking location to the airport terminal. And it cannot distinguish between residents of the Triangle region and visitors to the Triangle region. 
 
 ## StreetLight Data Summaries
-The map below shows the distribution of trip productions to RDU per the StreetLight
-data. As expected, the data shows large amounts of activity in the zones surrounding
-the airport. For an air passenger model, we are less interested in the movement 
-from, say, the off-airport parking facility to the airport, than we are the movement
-from a home or workplace to the off-airport parking facility. Ideally, an airport
-model would explicitly represent each movement. For the simple model being developed
-here, we want to focus on the primary (and longer) movement.
+The map below shows the distribution of trip productions to RDU per the StreetLight data. As expected, the data shows large amounts of activity in the zones surrounding the airport. For an air passenger model, we are less interested in the movement from, say, the off-airport parking facility to the airport, than we are the movement from a home or workplace to the off-airport parking facility. Ideally, an airport model would explicitly represent each movement. For the simple model being developed here, we want to focus on the primary (and longer) movement.
 
 ### StreetLight ""Raw"" Productions
 
 ```{r, out.width=""100%"", fig.show='hold',fig.align='center'}
 knitr::include_graphics(""img/airport/streetlight_productions.png"")
 ```
 
-To ameliorate the impact of near-airport movements on the estimation of production
-models intended to locate the ""true"" origin of air passenger movements, we censor
-the StreetLight productions to a maximum value of `r OUTLIER_MIN`. The map of 
-truncated productions is shown in the map below. 
+To ameliorate the impact of near-airport movements on the estimation of production models intended to locate the ""true"" origin of air passenger movements, we censor the ""raw"" StreetLight productions to a maximum value of `r OUTLIER_MIN`. The map of truncated productions is shown in the map below. (Because the ""raw"" values are scaled to match the RDU enplanements, the map below shows some locations with a value larger than `r OUTLIER_MIN`). 
 
 ### StreetLight Censored Productions
 
@@ -59,15 +41,9 @@ knitr::include_graphics(""img/airport/streetlight_productions_censored.png"")
 ```
 
 ## Production Modeling
-The goal of the air passenger production model is to generate travel from home and
-employment locations to the airport. Because all trips are destined to RDU, the 
-production model acts as both a trip generation and trip distribution model. 
+The goal of the air passenger production model is to generate travel from home and employment locations to the airport. Because all trips are destined to RDU, the production model acts as both a trip generation and trip distribution model. 
 
-To begin the data exploration and model estimation stage, we summarize the correlations
-between the socio-economic data expected to be relevant and airport productions. These
-correlations are shown in the table below. Note that a number of variables that would
-be useful to the production model, such as hotel rooms, are not available in the
-socio-economic data.
+To begin the data exploration and model estimation stage, we summarize the correlations between the socio-economic data expected to be relevant and airport productions. These correlations are shown in the table below.
 
 ### Correlations
 ```{r}
@@ -76,25 +52,14 @@ correlations_df %>%
   kable_styling(full_width = FALSE)
 ```
 
-The above table shows correlations between airport productions and the variables
-we would expect and like to be correlated with airport productions, including workers,
-high income persons, and employment. 
+The above table shows correlations between airport productions and the variables we would expect and like to be correlated with airport productions, including workers,high income persons, and employment. 
 
-Using the correlations as a guide, we estimate a series of linear regression models 
-in a search for a parsimonious balance between model fit and logical coefficients. 
+Using the correlations as a guide, we estimate a series of linear regression models in a search for a parsimonious balance between model fit and logical coefficients. 
 
 ### Model Estimation Results {.tabset .MODEL}
-Numerous model estimations were conducted to find the preferred specification shown
-below. The preferred specification includes `high earners`, which is the number of
-high earners in each TAZ. A second term that interacts high earners with distance 
-to the airport is included as well, which reduces the number of productions for 
-high earners at greater distances from the airport.
-
-The preferred specification includes `employment` which captures movements to/from
-work locations to the airport. The preferred specification collapses the employment
-categories. Specifications with employment separated by industry did not always 
-reveal logical coefficients (e.g., a larger coefficient on industrial employment
-than office employment). 
+Numerous model estimations were conducted to find the preferred specification shown below. The preferred specification includes `high earners`, which is the number of high earners in each TAZ. A second term that interacts high earners with distance to the airport is included as well, which reduces the number of productions for high earners at greater distances from the airport.
+
+The preferred specification includes `employment` which captures movements to/from work locations to the airport. The preferred specification collapses the employment categories. Specifications with employment separated by industry did not always reveal logical coefficients (e.g., a larger coefficient on industrial employment than office employment). 
 
 Other, non-preferred specifications are included in the tabs below. 
 
@@ -140,39 +105,26 @@ print_model(model_04)
 ```
 
 ### Predicted Productions
-The map below plots the predicted airport productions. In model application, the
-calculated productions will be scaled to airport attractions, which is the number
-of enplanements at RDU entered by the model user. The current chart assumes `r RDU_ENPLANEMENTS`
-enplanements. It is also possible for the regression model to return a negative
-number of enplanements due to the negative coefficient on the high earner and distance
-interaction term. These productions have been censored at zero and will need to 
-be similarly censored in model application. 
+The map below plots the predicted airport productions. In model application, the calculated productions will be scaled to airport attractions, which is the number of enplanements at RDU entered by the model user. The current chart assumes `r rdu_enplanements` daily enplanements. It is also possible for the regression model to return a negative number of enplanements due to the negative coefficient on the high earner and distance interaction term. These productions have been censored at zero and will need to be similarly censored in model application. 
 
 ```{r, out.width=""100%"", fig.show='hold',fig.align='center'}
 knitr::include_graphics(""img/airport/estimated_productions.png"")
 ```
 
-The chart below plots the adjusted observed productions (truncated at `r OUTLIER_MIN`
-times the scaling necessary to matche the target attractions) against the estimated 
-productions.
+The chart below plots the adjusted observed productions (truncated at `r OUTLIER_MIN` times the scaling necessary to matche the target attractions) against the estimated productions.
 
 ```{r, out.width=""80%"", fig.show='hold',fig.align='center'}
 knitr::include_graphics(""img/airport/scatter_plot.png"")
 ```
 
-The chart below shows the adjusted observed and estimated trip length frequency
-distributions for movements to the airport. The model estimates slightly
-longer trips than the StreetLight data. This is expected because the StreetLight
-data will, in many cases, fail to capture the true origin of the movement, misunderstanding
-stops at gas stations, cell phone lots, rental car facilities, etc, as the origin.
+The chart below shows the adjusted observed and estimated trip length frequency distributions for movements to the airport. The model estimates longer trips than the StreetLight data. This is expected because the StreetLight data will, in many cases, fail to capture the true origin of the movement, misunderstanding stops at gas stations, cell phone lots, rental car facilities, etc, as the origin.
 
 ```{r, out.width=""80%"", fig.show='hold',fig.align='center'}
 knitr::include_graphics(""img/airport/trip_length_frequency.png"")
 ```
 
 ## Diurnal Factors
-The table below summarizes the production to airport and airport to production
-trips by time of day, based on the StreetLight data. 
+The table below summarizes the production to airport and airport to production trips by time of day, based on the StreetLight data. 
 
 ### P to A Diurnal Factors from StreetLight
 ```{r}
@@ -208,10 +160,7 @@ df %>%
   
 ```
 
-The time periods used for the StreetLight extraction do not directly align with
-the time periods used for the updated travel model. By assuming a uniform distribution
-across the StreetLight time periods, we can create the below diurnal factors using
-the StreetLight data and model time periods. 
+The time periods used for the StreetLight extraction do not directly align with the time periods used for the updated travel model. By assuming a uniform distribution across the StreetLight time periods, we can create the below diurnal factors using the StreetLight data and model time periods. 
 
 ### P to A Travel Model Diurnal Factors
 ```{r}
@@ -249,13 +198,7 @@ df %>%
 
 
 ## Mode Choice
-The StreetLight Data does not provide insight to the mode choice decision made
-by air passengers. As such, no information is available to base a mode choice model
-on. We therefore will add the airport trips to the home-based other trip purpose
-prior to mode choice and use the home-based other model to simulate the mode choice
-decision for air passengers.
-
-###
+The StreetLight Data does not provide insight to the mode choice decision made by air passengers. As such, no information is available to base a mode choice model on. We therefore will add the airport trips to the home-based other trip purpose prior to mode choice and use the home-based other model to simulate the mode choice decision for air passengers.
 
 
 

---FILE: docs/airport.html---
@@ -11,7 +11,7 @@
 
 <meta name=""author"" content=""Caliper Corporation"" />
 
-<meta name=""date"" content=""2021-04-26"" />
+<meta name=""date"" content=""2021-05-18"" />
 
 <title>Airport</title>
 
@@ -379,23 +379,23 @@
 
 <h1 class=""title toc-ignore"">Airport</h1>
 <h4 class=""author"">Caliper Corporation</h4>
-<h4 class=""date"">April 26, 2021</h4>
+<h4 class=""date"">May 18, 2021</h4>
 
 </div>
 
 
 <div id=""introduction"" class=""section level2"">
 <h2>Introduction</h2>
 <p>Air passenger travel to/from the Raleigh-Durham International Airport (RDU) is captured by the air passenger model.</p>
-<p>A limited amount of data on air passengers is available and the modeling approach is therefore straightforward and requires a handful of assumptions. The available data is passive movements recordedfrom StreetLight Data. The benefits of this data is they provide a reasonable signal of movements to/from the airport. The drawbacks of this data include the following: * It does not distinguish between airport employees and air passengers. * It cannot distinguish between trip legs, for example the movement from home to an off-airport parking location and the movement from the off-airport parking location to the airport terminal.</p>
+<p>A limited amount of data on air passengers is available and the modeling approach is therefore straightforward and requires a handful of assumptions. The available data is passive movements recordedfrom StreetLight Data. The benefits of this data is they provide a reasonable signal of movements to/from the airport. The drawbacks of this data include the following: <em>It does not distinguish between airport employees and air passengers.</em> It cannot distinguish between trip legs, for example the movement from home to an off-airport parking location and the movement from the off-airport parking location to the airport terminal. And it cannot distinguish between residents of the Triangle region and visitors to the Triangle region.</p>
 </div>
 <div id=""streetlight-data-summaries"" class=""section level2"">
 <h2>StreetLight Data Summaries</h2>
 <p>The map below shows the distribution of trip productions to RDU per the StreetLight data. As expected, the data shows large amounts of activity in the zones surrounding the airport. For an air passenger model, we are less interested in the movement from, say, the off-airport parking facility to the airport, than we are the movement from a home or workplace to the off-airport parking facility. Ideally, an airport model would explicitly represent each movement. For the simple model being developed here, we want to focus on the primary (and longer) movement.</p>
 <div id=""streetlight-raw-productions"" class=""section level3"">
 <h3>StreetLight Raw Productions</h3>
 <p><img src=""img/airport/streetlight_productions.png"" width=""100%"" style=""display: block; margin: auto;"" /></p>
-<p>To ameliorate the impact of near-airport movements on the estimation of production models intended to locate the true origin of air passenger movements, we censor the StreetLight productions to a maximum value of 200. The map of truncated productions is shown in the map below.</p>
+<p>To ameliorate the impact of near-airport movements on the estimation of production models intended to locate the true origin of air passenger movements, we censor the raw StreetLight productions to a maximum value of 200. The map of truncated productions is shown in the map below. (Because the raw values are scaled to match the RDU enplanements, the map below shows some locations with a value larger than 200).</p>
 </div>
 <div id=""streetlight-censored-productions"" class=""section level3"">
 <h3>StreetLight Censored Productions</h3>
@@ -405,7 +405,7 @@ <h3>StreetLight Censored Productions</h3>
 <div id=""production-modeling"" class=""section level2"">
 <h2>Production Modeling</h2>
 <p>The goal of the air passenger production model is to generate travel from home and employment locations to the airport. Because all trips are destined to RDU, the production model acts as both a trip generation and trip distribution model.</p>
-<p>To begin the data exploration and model estimation stage, we summarize the correlations between the socio-economic data expected to be relevant and airport productions. These correlations are shown in the table below. Note that a number of variables that would be useful to the production model, such as hotel rooms, are not available in the socio-economic data.</p>
+<p>To begin the data exploration and model estimation stage, we summarize the correlations between the socio-economic data expected to be relevant and airport productions. These correlations are shown in the table below.</p>
 <div id=""correlations"" class=""section level3"">
 <h3>Correlations</h3>
 <table class=""table"" style=""width: auto !important; margin-left: auto; margin-right: auto;"">
@@ -518,14 +518,6 @@ <h3>Correlations</h3>
 </tr>
 <tr>
 <td style=""text-align:left;"">
-high_earn_distance
-</td>
-<td style=""text-align:right;"">
-0.071
-</td>
-</tr>
-<tr>
-<td style=""text-align:left;"">
 Median_Inc
 </td>
 <td style=""text-align:right;"">
@@ -566,6 +558,14 @@ <h3>Correlations</h3>
 </tr>
 <tr>
 <td style=""text-align:left;"">
+high_earn_distance
+</td>
+<td style=""text-align:right;"">
+-0.018
+</td>
+</tr>
+<tr>
+<td style=""text-align:left;"">
 Stud_GQ
 </td>
 <td style=""text-align:right;"">
@@ -577,7 +577,7 @@ <h3>Correlations</h3>
 dist_to_airport_miles
 </td>
 <td style=""text-align:right;"">
--0.135
+-0.234
 </td>
 </tr>
 <tr>
@@ -590,7 +590,7 @@ <h3>Correlations</h3>
 </tr>
 </tbody>
 </table>
-<p>The above table shows correlations between airport productions and the variables we would expect and like to be correlated with airport productions, including workers, high income persons, and employment.</p>
+<p>The above table shows correlations between airport productions and the variables we would expect and like to be correlated with airport productions, including workers,high income persons, and employment.</p>
 <p>Using the correlations as a guide, we estimate a series of linear regression models in a search for a parsimonious balance between model fit and logical coefficients.</p>
 </div>
 <div id=""model-estimation-results"" class=""section level3 tabset MODEL"">
@@ -623,10 +623,10 @@ <h4>Preferred</h4>
 <em>intercept</em>
 </td>
 <td style=""text-align:right;"">
-4.0319
+5.4539
 </td>
 <td style=""text-align:right;"">
-4.4617
+6.1304
 </td>
 <td style=""text-align:right;"">
 0
@@ -637,10 +637,10 @@ <h4>Preferred</h4>
 employment
 </td>
 <td style=""text-align:right;"">
-0.0142
+0.0133
 </td>
 <td style=""text-align:right;"">
-16.4178
+15.7455
 </td>
 <td style=""text-align:right;"">
 0
@@ -651,10 +651,10 @@ <h4>Preferred</h4>
 high_earn_distance
 </td>
 <td style=""text-align:right;"">
--0.0027
+-0.0051
 </td>
 <td style=""text-align:right;"">
--10.1157
+-14.7273
 </td>
 <td style=""text-align:right;"">
 0
@@ -665,10 +665,10 @@ <h4>Preferred</h4>
 high_earners
 </td>
 <td style=""text-align:right;"">
-0.1611
+0.1315
 </td>
 <td style=""text-align:right;"">
-14.3533
+20.2635
 </td>
 <td style=""text-align:right;"">
 0
@@ -679,7 +679,7 @@ <h4>Preferred</h4>
 Adjusted R-squared
 </td>
 <td style=""text-align:right;"">
-0.2272
+0.2686
 </td>
 <td style=""text-align:right;"">
 NA
@@ -795,24 +795,24 @@ <h4>Model 02</h4>
 <em>intercept</em>
 </td>
 <td style=""text-align:right;"">
-0.4955
+1.4671
 </td>
 <td style=""text-align:right;"">
-0.5168
+1.5752
 </td>
 <td style=""text-align:right;"">
-0.6054
+0.1154
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 high_earn_distance
 </td>
 <td style=""text-align:right;"">
--0.0029
+-0.0053
 </td>
 <td style=""text-align:right;"">
--10.8953
+-16.0683
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -823,10 +823,10 @@ <h4>Model 02</h4>
 high_earners
 </td>
 <td style=""text-align:right;"">
-0.1405
+0.1027
 </td>
 <td style=""text-align:right;"">
-11.6115
+12.1976
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -837,24 +837,24 @@ <h4>Model 02</h4>
 hotel_rooms
 </td>
 <td style=""text-align:right;"">
--0.0407
+-0.0071
 </td>
 <td style=""text-align:right;"">
--0.5344
+-0.0969
 </td>
 <td style=""text-align:right;"">
-0.5932
+0.9228
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 Industry
 </td>
 <td style=""text-align:right;"">
-0.0341
+0.0344
 </td>
 <td style=""text-align:right;"">
-8.0535
+8.4089
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -865,10 +865,10 @@ <h4>Model 02</h4>
 Office
 </td>
 <td style=""text-align:right;"">
-0.0135
+0.0126
 </td>
 <td style=""text-align:right;"">
-8.9028
+8.5698
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -879,10 +879,10 @@ <h4>Model 02</h4>
 Retail
 </td>
 <td style=""text-align:right;"">
-0.0350
+0.0336
 </td>
 <td style=""text-align:right;"">
-11.1705
+11.0723
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -893,10 +893,10 @@ <h4>Model 02</h4>
 Service_RateHigh
 </td>
 <td style=""text-align:right;"">
-0.0594
+0.0559
 </td>
 <td style=""text-align:right;"">
-6.1565
+5.9880
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -907,10 +907,10 @@ <h4>Model 02</h4>
 workers
 </td>
 <td style=""text-align:right;"">
-0.0143
+0.0183
 </td>
 <td style=""text-align:right;"">
-4.0896
+5.3790
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -921,7 +921,7 @@ <h4>Model 02</h4>
 Adjusted R-squared
 </td>
 <td style=""text-align:right;"">
-0.2883
+0.3339
 </td>
 <td style=""text-align:right;"">
 NA
@@ -958,24 +958,24 @@ <h4>Model 03</h4>
 <em>intercept</em>
 </td>
 <td style=""text-align:right;"">
-2.0344
+3.3970
 </td>
 <td style=""text-align:right;"">
-2.3070
+3.9278
 </td>
 <td style=""text-align:right;"">
-0.0212
+0.0001
 </td>
 </tr>
 <tr>
 <td style=""text-align:left;"">
 high_earn_distance
 </td>
 <td style=""text-align:right;"">
--0.0027
+-0.0051
 </td>
 <td style=""text-align:right;"">
--10.4521
+-15.3203
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -986,10 +986,10 @@ <h4>Model 03</h4>
 high_earners
 </td>
 <td style=""text-align:right;"">
-0.1629
+0.1335
 </td>
 <td style=""text-align:right;"">
-15.0695
+21.4401
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -1000,10 +1000,10 @@ <h4>Model 03</h4>
 Industry
 </td>
 <td style=""text-align:right;"">
-0.0320
+0.0317
 </td>
 <td style=""text-align:right;"">
-7.5841
+7.7504
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -1014,10 +1014,10 @@ <h4>Model 03</h4>
 Office
 </td>
 <td style=""text-align:right;"">
-0.0127
+0.0117
 </td>
 <td style=""text-align:right;"">
-8.4280
+7.9367
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -1028,10 +1028,10 @@ <h4>Model 03</h4>
 Retail
 </td>
 <td style=""text-align:right;"">
-0.0366
+0.0357
 </td>
 <td style=""text-align:right;"">
-11.7341
+11.7986
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -1042,10 +1042,10 @@ <h4>Model 03</h4>
 Service_RateHigh
 </td>
 <td style=""text-align:right;"">
-0.0607
+0.0577
 </td>
 <td style=""text-align:right;"">
-6.2719
+6.1372
 </td>
 <td style=""text-align:right;"">
 0.0000
@@ -1056,7 +1056,7 @@ <h4>Model 03</h4>
 Adjusted R-squared
 </td>
 <td style=""text-align:right;"">
-0.2828
+0.3245
 </td>
 <td style=""text-align:right;"">
 NA
@@ -1071,11 +1071,11 @@ <h4>Model 03</h4>
 </div>
 <div id=""predicted-productions"" class=""section level3"">
 <h3>Predicted Productions</h3>
-<p>The map below plots the predicted airport productions. In model application, the calculated productions will be scaled to airport attractions, which is the number of enplanements at RDU entered by the model user. The current chart assumes 15343 enplanements. It is also possible for the regression model to return a negative number of enplanements due to the negative coefficient on the high earner and distance interaction term. These productions have been censored at zero and will need to be similarly censored in model application.</p>
+<p>The map below plots the predicted airport productions. In model application, the calculated productions will be scaled to airport attractions, which is the number of enplanements at RDU entered by the model user. The current chart assumes 15343 daily enplanements. It is also possible for the regression model to return a negative number of enplanements due to the negative coefficient on the high earner and distance interaction term. These productions have been censored at zero and will need to be similarly censored in model application.</p>
 <p><img src=""img/airport/estimated_productions.png"" width=""100%"" style=""display: block; margin: auto;"" /></p>
 <p>The chart below plots the adjusted observed productions (truncated at 200 times the scaling necessary to matche the target attractions) against the estimated productions.</p>
 <p><img src=""img/airport/scatter_plot.png"" width=""80%"" style=""display: block; margin: auto;"" /></p>
-<p>The chart below shows the adjusted observed and estimated trip length frequency distributions for movements to the airport. The model estimates slightly longer trips than the StreetLight data. This is expected because the StreetLight data will, in many cases, fail to capture the true origin of the movement, misunderstanding stops at gas stations, cell phone lots, rental car facilities, etc, as the origin.</p>
+<p>The chart below shows the adjusted observed and estimated trip length frequency distributions for movements to the airport. The model estimates longer trips than the StreetLight data. This is expected because the StreetLight data will, in many cases, fail to capture the true origin of the movement, misunderstanding stops at gas stations, cell phone lots, rental car facilities, etc, as the origin.</p>
 <p><img src=""img/airport/trip_length_frequency.png"" width=""80%"" style=""display: block; margin: auto;"" /></p>
 </div>
 </div>
@@ -1445,9 +1445,6 @@ <h3>A to P Travel Model Diurnal Factors</h3>
 <div id=""mode-choice"" class=""section level2"">
 <h2>Mode Choice</h2>
 <p>The StreetLight Data does not provide insight to the mode choice decision made by air passengers. As such, no information is available to base a mode choice model on. We therefore will add the airport trips to the home-based other trip purpose prior to mode choice and use the home-based other model to simulate the mode choice decision for air passengers.</p>
-<div id=""section"" class=""section level3"">
-<h3></h3>
-</div>
 </div>
 
 <br>"
Triangle-Modeling-and-Analytics,TRMG2,916d0dc376901af890e3e31fb38a6162a505bca1,Kyle Ward,kyle@caliper.com,2021-05-17T17:00:38Z,Kyle Ward,kyle@caliper.com,2021-05-17T17:00:38Z,"Check if the current scenario is created before running the model

The current implementation isn't perfect given a few unresolved issues
with the flowchart, but it will stop the run if not created and give clear
messaging about how to proceed.",src/flow_chart/trmg2_plugin_macros.rsc,False,False,False,False,57,1,58,"---FILE: src/flow_chart/trmg2_plugin_macros.rsc---
@@ -83,7 +83,11 @@ Body:
             mail.ResetCredentials() // every time the model is launched, reset the credentials. If credentials are needed a dbox will popup
             end
         end
-skipemails:
+    skipemails:
+    on error default
+
+    scenario_created = RunMacro(""Check Scenario Creation"", Args)
+    if !scenario_created then Throw(""Scenario not created"")
 
     Return(Runtime_Args)
 EndMacro
@@ -113,3 +117,55 @@ Body:
     Return()
 EndMacro
 
+/*
+This macro checks that the current scenario is created. If not, it prompts the
+user to create it. As a special case, the base scenario (""base_2016"") is simply
+created without prompting.
+
+Returns true if the scenario is already created or is created by the macro.
+Returns false otherwise.
+*/
+
+Macro ""Check Scenario Creation"" (Args)
+
+    mr = CreateObject(""Model.Runtime"")
+    Args = mr.GetValues()
+    scen_dir = Args.[Scenario Folder]
+    {, scen_name} = mr.GetScenario()
+    files_to_check = {
+        Args.[Input Links],
+        Args.[Input Routes],
+        Args.[Input SE]
+    }
+
+    scenario_created = ""true""
+    for file in files_to_check do
+        if GetFileInfo(file) = null then scenario_created = ""false""
+    end
+    if scenario_created then return(""true"")
+
+    // Ensure the minimum files are present
+    if GetDirectoryInfo(scen_dir, ""All"") = null then Throw(
+        ""The scenario directory does not exist.\n"" +
+        ""Scenario Directory: \n"" +
+        scen_dir
+    )
+    else if GetFileInfo(scen_dir + ""/RoadwayProjectList.csv"") = null then Throw(
+        ""The scenario directory is missing RoadwayProjectList.csv""
+    )
+    else if GetFileInfo(scen_dir + ""/TransitProjectList.csv"") = null then Throw(
+        ""The scenario directory is missing TransitProjectList.csv""
+    )
+
+    // Ask to create scenario. If it's the base scenario, just create it.
+    yesno = MessageBox(
+        ""The scenario has not been created\n(TRMG2 Menu -> Create Scenario)\n"" +
+        ""Would you like to create the scenario? After creation, you will be "" +
+        ""prompted to continue running the model."",
+        {Buttons: ""YesNo""}
+    )
+    if yesno = ""Yes"" then do
+        mr.RunCode(""Create Scenario"", Args)
+        return(""true"")
+    end else return(""false"")
+endmacro
\ No newline at end of file"
Triangle-Modeling-and-Analytics,TRMG2,9bbf24594d6c428de10f8087f7478d8df60316f1,Kyle Ward,kyle@caliper.com,2021-05-10T14:18:32Z,Kyle Ward,kyle@caliper.com,2021-05-10T14:18:32Z,"Delete transit mode table dictionary file

When this file is first modified during the model run, the dcc no longer
accurately describes the file structure. Deleteing it prevents errors
during run time later in the model run.",src/01 - CreateScenario.rsc,False,False,False,False,1,0,1,"---FILE: src/01 - CreateScenario.rsc---
@@ -200,6 +200,7 @@ Macro ""Create Scenario Transit"" (Args)
   SetView(mode_vw)
   del_set = CreateSet(""to_delete"")
   CloseView(temp_vw)
+  DeleteFile(Substitute(Args.tmode_table, "".csv"", "".dcc"", ))
   v_mode_ids = GetDataVector(mode_vw + ""|"", ""mode_id"", )
   for mode_id in v_mode_ids do
     if mode_id = 1 then continue"
Triangle-Modeling-and-Analytics,TRMG2,1efe3459b6e82461575ad56594731627299306c5,David Ory,david.ory@gmail.com,2021-04-15T16:40:13Z,David Ory,david.ory@gmail.com,2021-04-15T16:40:13Z,fix closest bug,docs/data/input/airport/airport-productions.csv;docs/data/input/airport/airport-productions.twb;src/r_scripts/airport-model.Rmd;src/r_scripts/airport-model.nb.html,True,False,True,False,8784,10361,19145,"---FILE: src/r_scripts/airport-model.Rmd---
@@ -37,7 +37,7 @@ output_production_filename <- paste0(data_dir, ""airport/airport-productions.csv""
 
 # Parameters
 ```{r parameters}
-AIRPORT_ZONE <- 1261
+SL_AIRPORT_ZONE <- 1261
 LAT_LNG_EPSG <- 4326
 RDU_ENPLANEMENTS <- 45000
 OUTLIER_MIN <- 200
@@ -63,13 +63,11 @@ durham_sf <- st_read(durham_sl_shape, crs = LAT_LNG_EPSG)
 
 # Get Coordinates for Master Zones
 ```{r get-coords}
-centroids_sf <- select(taz_sf, taz = ID, county = COUNTY, orig_zone = ORIG_ID, geometry) %>%
+centroids_sf <- select(taz_sf, taz = ID, geometry) %>%
   st_centroid()
 
 centroids_df <- as_tibble(st_coordinates(centroids_sf)) %>%
-  bind_cols(., tibble(taz = centroids_sf$taz,
-                      county = centroids_sf$county,
-                      orig_zone = centroids_sf$orig_zone)) %>%
+  bind_cols(., tibble(taz = centroids_sf$taz)) %>%
   rename(lat = Y, lng = X)
 
 ```
@@ -109,15 +107,15 @@ working_df <- centroids_df %>%
   mutate(distance = sqrt((master_lat - lat)**2 + (master_lng - lng)**2))
 
 closest_df <- working_df %>%
-  group_by(master_taz, source) %>%
+  group_by(zone, source) %>%
   summarise(min_dist = min(distance), .groups = ""drop"") %>%
-  left_join(working_df, closest_df, by = c(""master_taz"", ""source"")) %>%
+  left_join(working_df, closest_df, by = c(""zone"", ""source"")) %>%
   filter(distance <= min_dist) %>%
   select(taz = master_taz,
-         lat = master_lat,
-         lng = master_lng,
          sl_zone = zone,
-         sl_source = source)
+         sl_source = source,
+         distance)
+
 ```
 
 # Reductions
@@ -126,22 +124,20 @@ working_df <- clean_sl_df %>%
   filter(type == ""Personal"") %>%
   filter(day_type == ""1: Weekday (M-Th)"") %>%
   filter(orig_pass_through == ""no"" & dest_pass_through == ""no"") %>%
-  filter(orig_zone == AIRPORT_ZONE | dest_zone == AIRPORT_ZONE) %>%
+  filter(orig_zone == SL_AIRPORT_ZONE | dest_zone == SL_AIRPORT_ZONE) %>%
   filter(orig_zone != dest_zone) %>%
   filter(day_part == ""0: All Day (12am-12am)"") %>%
   filter(!is.na(duration_sec)) %>%
-  mutate(production_taz = if_else(orig_zone == AIRPORT_ZONE, dest_zone, orig_zone)) %>%
+  mutate(production_sl_zone = if_else(orig_zone == AIRPORT_ZONE, dest_zone, orig_zone)) %>%
   mutate(purpose = if_else(orig_zone == AIRPORT_ZONE, ""From Airport"", ""To Airport""))
 
 productions_df <- working_df %>%
-  group_by(production_taz, source) %>%
+  group_by(production_sl_zone, source) %>%
   summarize(airport_productions = sum(flow), duration_min = mean(duration_sec)/60.0, .groups = ""drop"") %>%
-  left_join(., closest_df, by = c(""production_taz"" = ""sl_zone"", ""source"" = ""sl_source"")) %>%
+  left_join(., closest_df, by = c(""production_sl_zone"" = ""sl_zone"", ""source"" = ""sl_source"")) %>%
   group_by(taz) %>%
-  summarise(airport_productions = sum(airport_productions),
-            lat = first(lat),
-            lng = first(lng),
-            .groups = ""drop"") %>%
+  summarise(airport_productions = sum(airport_productions), .groups = ""drop"") %>%
+  left_join(., centroids_df, by = c(""taz"")) %>%
   left_join(., socec_df, by = c(""taz"" = ""TAZ_NG"")) %>%
   left_join(., select(socec_other_df, TAZ, Pct_Worker, PctHighEarn), by = c(""taz"" = ""TAZ"")) %>%
   filter(County != ""External"") %>%

---FILE: src/r_scripts/airport-model.nb.html---
@@ -267,8 +267,8 @@ <h1>Remote I/O</h1>
 <h1>Parameters</h1>
 <!-- rnb-text-end -->
 <!-- rnb-chunk-begin -->
-<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuQUlSUE9SVF9aT05FIDwtIDEyNjFcbkxBVF9MTkdfRVBTRyA8LSA0MzI2XG5SRFVfRU5QTEFORU1FTlRTIDwtIDQ1MDAwXG5PVVRMSUVSX01JTiA8LSAyMDBcbmBgYCJ9 -->
-<pre class=""r""><code>AIRPORT_ZONE &lt;- 1261
+<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuU0xfQUlSUE9SVF9aT05FIDwtIDEyNjFcbkxBVF9MTkdfRVBTRyA8LSA0MzI2XG5SRFVfRU5QTEFORU1FTlRTIDwtIDQ1MDAwXG5PVVRMSUVSX01JTiA8LSAyMDBcbmBgYCJ9 -->
+<pre class=""r""><code>SL_AIRPORT_ZONE &lt;- 1261
 LAT_LNG_EPSG &lt;- 4326
 RDU_ENPLANEMENTS &lt;- 45000
 OUTLIER_MIN &lt;- 200</code></pre>
@@ -280,12 +280,16 @@ <h1>Parameters</h1>
 <h1>Data Reads</h1>
 <!-- rnb-text-end -->
 <!-- rnb-chunk-begin -->
-<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuY2xlYW5fc2xfZGYgPC0gcmVhZFJEUyhjbGVhbl9zdHJlZXRsaWdodF9maWxlbmFtZSlcbnNvY2VjX2RmIDwtIHJlYWRfY3N2KHNvY2VjX2ZpbGVuYW1lLCBjb2xfdHlwZXMgPSBjb2xzKC5kZWZhdWx0ID0gY29sX2RvdWJsZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVEFaX05HID0gY29sX2ludGVnZXIoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvdW50eSA9IGNvbF9jaGFyYWN0ZXIoKSkpXG5cbnRhel9zZiA8LSBzdF9yZWFkKHRhel9zaGFwZV9maWxlbmFtZSkgJT4lXG4gIHN0X3RyYW5zZm9ybShMQVRfTE5HX0VQU0cpXG5gYGAifQ== -->
+<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuY2xlYW5fc2xfZGYgPC0gcmVhZFJEUyhjbGVhbl9zdHJlZXRsaWdodF9maWxlbmFtZSlcbnNvY2VjX2RmIDwtIHJlYWRfY3N2KHNvY2VjX2ZpbGVuYW1lLCBjb2xfdHlwZXMgPSBjb2xzKC5kZWZhdWx0ID0gY29sX2RvdWJsZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVEFaX05HID0gY29sX2ludGVnZXIoKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENvdW50eSA9IGNvbF9jaGFyYWN0ZXIoKSkpXG5cbnNvY2VjX290aGVyX2RmIDwtIHJlYWRfY3N2KHNvY2VjX290aGVyX3ZhcnNfZmlsZW5hbWUsIGNvbF90eXBlcyA9IGNvbHMoLmRlZmF1bHQgPSBjb2xfZG91YmxlKCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBUQVogPSBjb2xfaW50ZWdlcigpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVHlwZSA9IGNvbF9jaGFyYWN0ZXIoKSkpXG5cbnRhel9zZiA8LSBzdF9yZWFkKHRhel9zaGFwZV9maWxlbmFtZSkgJT4lXG4gIHN0X3RyYW5zZm9ybShMQVRfTE5HX0VQU0cpXG5gYGAifQ== -->
 <pre class=""r""><code>clean_sl_df &lt;- readRDS(clean_streetlight_filename)
 socec_df &lt;- read_csv(socec_filename, col_types = cols(.default = col_double(),
                                                       TAZ_NG = col_integer(),
                                                       County = col_character()))
 
+socec_other_df &lt;- read_csv(socec_other_vars_filename, col_types = cols(.default = col_double(),
+                                                      TAZ = col_integer(),
+                                                      Type = col_character()))
+
 taz_sf &lt;- st_read(taz_shape_filename) %&gt;%
   st_transform(LAT_LNG_EPSG)</code></pre>
 <!-- rnb-source-end -->
@@ -326,18 +330,16 @@ <h1>Data Reads</h1>
 <h1>Get Coordinates for Master Zones</h1>
 <!-- rnb-text-end -->
 <!-- rnb-chunk-begin -->
-<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuY2VudHJvaWRzX3NmIDwtIHNlbGVjdCh0YXpfc2YsIHRheiA9IElELCBjb3VudHkgPSBDT1VOVFksIG9yaWdfem9uZSA9IE9SSUdfSUQsIGdlb21ldHJ5KSAlPiVcbiAgc3RfY2VudHJvaWQoKVxuYGBgIn0= -->
-<pre class=""r""><code>centroids_sf &lt;- select(taz_sf, taz = ID, county = COUNTY, orig_zone = ORIG_ID, geometry) %&gt;%
+<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuY2VudHJvaWRzX3NmIDwtIHNlbGVjdCh0YXpfc2YsIHRheiA9IElELCBnZW9tZXRyeSkgJT4lXG4gIHN0X2NlbnRyb2lkKClcbmBgYCJ9 -->
+<pre class=""r""><code>centroids_sf &lt;- select(taz_sf, taz = ID, geometry) %&gt;%
   st_centroid()</code></pre>
 <!-- rnb-source-end -->
 <!-- rnb-output-begin eyJkYXRhIjoic3RfY2VudHJvaWQgYXNzdW1lcyBhdHRyaWJ1dGVzIGFyZSBjb25zdGFudCBvdmVyIGdlb21ldHJpZXMgb2YgeHN0X2NlbnRyb2lkIGRvZXMgbm90IGdpdmUgY29ycmVjdCBjZW50cm9pZHMgZm9yIGxvbmdpdHVkZS9sYXRpdHVkZSBkYXRhXG4ifQ== -->
 <pre><code>st_centroid assumes attributes are constant over geometries of xst_centroid does not give correct centroids for longitude/latitude data</code></pre>
 <!-- rnb-output-end -->
-<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuY2VudHJvaWRzX2RmIDwtIGFzX3RpYmJsZShzdF9jb29yZGluYXRlcyhjZW50cm9pZHNfc2YpKSAlPiVcbiAgYmluZF9jb2xzKC4sIHRpYmJsZSh0YXogPSBjZW50cm9pZHNfc2YkdGF6LFxuICAgICAgICAgICAgICAgICAgICAgIGNvdW50eSA9IGNlbnRyb2lkc19zZiRjb3VudHksXG4gICAgICAgICAgICAgICAgICAgICAgb3JpZ196b25lID0gY2VudHJvaWRzX3NmJG9yaWdfem9uZSkpICU+JVxuICByZW5hbWUobGF0ID0gWSwgbG5nID0gWClcblxuYGBgIn0= -->
+<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuY2VudHJvaWRzX2RmIDwtIGFzX3RpYmJsZShzdF9jb29yZGluYXRlcyhjZW50cm9pZHNfc2YpKSAlPiVcbiAgYmluZF9jb2xzKC4sIHRpYmJsZSh0YXogPSBjZW50cm9pZHNfc2YkdGF6KSkgJT4lXG4gIHJlbmFtZShsYXQgPSBZLCBsbmcgPSBYKVxuXG5gYGAifQ== -->
 <pre class=""r""><code>centroids_df &lt;- as_tibble(st_coordinates(centroids_sf)) %&gt;%
-  bind_cols(., tibble(taz = centroids_sf$taz,
-                      county = centroids_sf$county,
-                      orig_zone = centroids_sf$orig_zone)) %&gt;%
+  bind_cols(., tibble(taz = centroids_sf$taz)) %&gt;%
   rename(lat = Y, lng = X)
 </code></pre>
 <!-- rnb-source-end -->
@@ -388,38 +390,51 @@ <h1>Get Coordinates for StreetLight TAZs</h1>
 <h1>Find Closest Master TAZ to StreetLight TAZ</h1>
 <!-- rnb-text-end -->
 <!-- rnb-chunk-begin -->
-<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxud29ya2luZ19kZiA8LSBjZW50cm9pZHNfZGYgJT4lXG4gIHNlbGVjdChtYXN0ZXJfdGF6ID0gdGF6LCBtYXN0ZXJfbGF0ID0gbGF0LCBtYXN0ZXJfbG5nID0gbG5nKSAlPiVcbiAgZnVsbF9qb2luKC4sIHNsX2NlbnRyb2lkc19kZiwgYnkgPSBjaGFyYWN0ZXIoKSkgJT4lXG4gIG11dGF0ZShkaXN0YW5jZSA9IHNxcnQoKG1hc3Rlcl9sYXQgLSBsYXQpKioyICsgKG1hc3Rlcl9sbmcgLSBsbmcpKioyKSlcblxuY2xvc2VzdF9kZiA8LSB3b3JraW5nX2RmICU+JVxuICBncm91cF9ieShtYXN0ZXJfdGF6LCBzb3VyY2UpICU+JVxuICBzdW1tYXJpc2UobWluX2Rpc3QgPSBtaW4oZGlzdGFuY2UpLCAuZ3JvdXBzID0gXCJkcm9wXCIpICU+JVxuICBsZWZ0X2pvaW4od29ya2luZ19kZiwgY2xvc2VzdF9kZiwgYnkgPSBjKFwibWFzdGVyX3RhelwiLCBcInNvdXJjZVwiKSkgJT4lXG4gIGZpbHRlcihkaXN0YW5jZSA8PSBtaW5fZGlzdCkgJT4lXG4gIHNlbGVjdCh0YXogPSBtYXN0ZXJfdGF6LFxuICAgICAgICAgbGF0ID0gbWFzdGVyX2xhdCxcbiAgICAgICAgIGxuZyA9IG1hc3Rlcl9sbmcsXG4gICAgICAgICBzbF96b25lID0gem9uZSxcbiAgICAgICAgIHNsX3NvdXJjZSA9IHNvdXJjZSlcbmBgYCJ9 -->
-<pre class=""r""><code>working_df &lt;- centroids_df %&gt;%
-  select(master_taz = taz, master_lat = lat, master_lng = lng) %&gt;%
-  full_join(., sl_centroids_df, by = character()) %&gt;%
-  mutate(distance = sqrt((master_lat - lat)**2 + (master_lng - lng)**2))
-
-closest_df &lt;- working_df %&gt;%
-  group_by(master_taz, source) %&gt;%
-  summarise(min_dist = min(distance), .groups = &quot;drop&quot;) %&gt;%
-  left_join(working_df, closest_df, by = c(&quot;master_taz&quot;, &quot;source&quot;)) %&gt;%
-  filter(distance &lt;= min_dist) %&gt;%
-  select(taz = master_taz,
-         lat = master_lat,
-         lng = master_lng,
-         sl_zone = zone,
-         sl_source = source)</code></pre>
+<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuY2hlY2tfZGYgPC0gY2xvc2VzdF9kZiAlPiVcbiAgZ3JvdXBfYnkoc2xfem9uZSwgc291cmNlKSAlPiVcbiAgc3VtbWFyaXNlKGNvdW50ID0gbigpLCAuZ3JvdXBzID0gXCJkcm9wXCIpICU+JVxuICBmaWx0ZXIoY291bnQ+MSlcblxuYGBgIn0= -->
+<pre class=""r""><code>check_df &lt;- closest_df %&gt;%
+  group_by(sl_zone, source) %&gt;%
+  summarise(count = n(), .groups = &quot;drop&quot;) %&gt;%
+  filter(count&gt;1)
+</code></pre>
 <!-- rnb-source-end -->
+<!-- rnb-output-begin eyJkYXRhIjoiRXJyb3I6IE11c3QgZ3JvdXAgYnkgdmFyaWFibGVzIGZvdW5kIGluIGAuZGF0YWAuXG4qIENvbHVtbiBgc291cmNlYCBpcyBub3QgZm91bmQuXG4ifQ== -->
+<pre><code>Error: Must group by variables found in `.data`.
+* Column `source` is not found.</code></pre>
+<!-- rnb-output-end -->
 <!-- rnb-chunk-end -->
 <!-- rnb-text-begin -->
 </div>
 <div id=""reductions"" class=""section level1"">
 <h1>Reductions</h1>
 <!-- rnb-text-end -->
 <!-- rnb-chunk-begin -->
-<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxuICBtdXRhdGUocHVycG9zZSA9IGlmX2Vsc2Uob3JpZ196b25lID09IEFJUlBPUlRfWk9ORSwgXCJGcm9tIEFpcnBvcnRcIiwgXCJUbyBBaXJwb3J0XCIpKVxuXG5gYGAifQ== -->
-<pre class=""r""><code>  mutate(purpose = if_else(orig_zone == AIRPORT_ZONE, &quot;From Airport&quot;, &quot;To Airport&quot;))
+<!-- rnb-source-begin eyJkYXRhIjoiYGBgclxud29ya2luZ19kZiA8LSBjbGVhbl9zbF9kZiAlPiVcbiAgZmlsdGVyKHR5cGUgPT0gXCJQZXJzb25hbFwiKSAlPiVcbiAgZmlsdGVyKGRheV90eXBlID09IFwiMTogV2Vla2RheSAoTS1UaClcIikgJT4lXG4gIGZpbHRlcihvcmlnX3Bhc3NfdGhyb3VnaCA9PSBcIm5vXCIgJiBkZXN0X3Bhc3NfdGhyb3VnaCA9PSBcIm5vXCIpICU+JVxuICBmaWx0ZXIob3JpZ196b25lID09IFNMX0FJUlBPUlRfWk9ORSB8IGRlc3Rfem9uZSA9PSBTTF9BSVJQT1JUX1pPTkUpICU+JVxuICBmaWx0ZXIob3JpZ196b25lICE9IGRlc3Rfem9uZSkgJT4lXG4gIGZpbHRlcihkYXlfcGFydCA9PSBcIjA6IEFsbCBEYXkgKDEyYW0tMTJhbSlcIikgJT4lXG4gIGZpbHRlcighaXMubmEoZHVyYXRpb25fc2VjKSkgJT4lXG4gIG11dGF0ZShwcm9kdWN0aW9uX3NsX3pvbmUgPSBpZl9lbHNlKG9yaWdfem9uZSA9PSBBSVJQT1JUX1pPTkUsIGRlc3Rfem9uZSwgb3JpZ196b25lKSkgJT4lXG4gIG11dGF0ZShwdXJwb3NlID0gaWZfZWxzZShvcmlnX3pvbmUgPT0gQUlSUE9SVF9aT05FLCBcIkZyb20gQWlycG9ydFwiLCBcIlRvIEFpcnBvcnRcIikpXG5cbnByb2R1Y3Rpb25zX2RmIDwtIHdvcmtpbmdfZGYgJT4lXG4gIGdyb3VwX2J5KHByb2R1Y3Rpb25fc2xfem9uZSwgc291cmNlKSAlPiVcbiAgc3VtbWFyaXplKGFpcnBvcnRfcHJvZHVjdGlvbnMgPSBzdW0oZmxvdyksIGR1cmF0aW9uX21pbiA9IG1lYW4oZHVyYXRpb25fc2VjKS82MC4wLCAuZ3JvdXBzID0gXCJkcm9wXCIpICU+JVxuICBsZWZ0X2pvaW4oLiwgY2xvc2VzdF9kZiwgYnkgPSBjKFwicHJvZHVjdGlvbl9zbF96b25lXCIgPSBcInNsX3pvbmVcIiwgXCJzb3VyY2VcIiA9IFwic2xfc291cmNlXCIpKSAlPiVcbiAgZ3JvdXBfYnkodGF6KSAlPiVcbiAgc3VtbWFyaXNlKGFpcnBvcnRfcHJvZHVjdGlvbnMgPSBzdW0oYWlycG9ydF9wcm9kdWN0aW9ucyksIC5ncm91cHMgPSBcImRyb3BcIikgJT4lXG4gIGxlZnRfam9pbiguLCBjZW50cm9pZHNfZGYsIGJ5ID0gYyhcInRhelwiKSkgJT4lXG4gIGxlZnRfam9pbiguLCBzb2NlY19kZiwgYnkgPSBjKFwidGF6XCIgPSBcIlRBWl9OR1wiKSkgJT4lXG4gIGxlZnRfam9pbiguLCBzZWxlY3Qoc29jZWNfb3RoZXJfZGYsIFRBWiwgUGN0X1dvcmtlciwgUGN0SGlnaEVhcm4pLCBieSA9IGMoXCJ0YXpcIiA9IFwiVEFaXCIpKSAlPiVcbiAgZmlsdGVyKENvdW50eSAhPSBcIkV4dGVybmFsXCIpICU+JVxuICBtdXRhdGUoZW1wbG95bWVudCA9IEluZHVzdHJ5ICsgT2ZmaWNlICsgU2VydmljZV9SYXRlTG93ICsgU2VydmljZV9SYXRlSGlnaCArIFJldGFpbCkgJT4lXG4gIG11dGF0ZSh3b3JrZXJzID0gUGN0X1dvcmtlci8xMDAuMCAqIEhIX1BPUCkgJT4lXG4gIG11dGF0ZShoaWdoX2Vhcm5lcnMgPSBQY3RIaWdoRWFybi8xMDAuMCAqIHdvcmtlcnMpXG5cbmBgYCJ9 -->
+<pre class=""r""><code>working_df &lt;- clean_sl_df %&gt;%
+  filter(type == &quot;Personal&quot;) %&gt;%
+  filter(day_type == &quot;1: Weekday (M-Th)&quot;) %&gt;%
+  filter(orig_pass_through == &quot;no&quot; &amp; dest_pass_through == &quot;no&quot;) %&gt;%
+  filter(orig_zone == SL_AIRPORT_ZONE | dest_zone == SL_AIRPORT_ZONE) %&gt;%
+  filter(orig_zone != dest_zone) %&gt;%
+  filter(day_part == &quot;0: All Day (12am-12am)&quot;) %&gt;%
+  filter(!is.na(duration_sec)) %&gt;%
+  mutate(production_sl_zone = if_else(orig_zone == AIRPORT_ZONE, dest_zone, orig_zone)) %&gt;%
+  mutate(purpose = if_else(orig_zone == AIRPORT_ZONE, &quot;From Airport&quot;, &quot;To Airport&quot;))
+
+productions_df &lt;- working_df %&gt;%
+  group_by(production_sl_zone, source) %&gt;%
+  summarize(airport_productions = sum(flow), duration_min = mean(duration_sec)/60.0, .groups = &quot;drop&quot;) %&gt;%
+  left_join(., closest_df, by = c(&quot;production_sl_zone&quot; = &quot;sl_zone&quot;, &quot;source&quot; = &quot;sl_source&quot;)) %&gt;%
+  group_by(taz) %&gt;%
+  summarise(airport_productions = sum(airport_productions), .groups = &quot;drop&quot;) %&gt;%
+  left_join(., centroids_df, by = c(&quot;taz&quot;)) %&gt;%
+  left_join(., socec_df, by = c(&quot;taz&quot; = &quot;TAZ_NG&quot;)) %&gt;%
+  left_join(., select(socec_other_df, TAZ, Pct_Worker, PctHighEarn), by = c(&quot;taz&quot; = &quot;TAZ&quot;)) %&gt;%
+  filter(County != &quot;External&quot;) %&gt;%
+  mutate(employment = Industry + Office + Service_RateLow + Service_RateHigh + Retail) %&gt;%
+  mutate(workers = Pct_Worker/100.0 * HH_POP) %&gt;%
+  mutate(high_earners = PctHighEarn/100.0 * workers)
 </code></pre>
 <!-- rnb-source-end -->
-<!-- rnb-output-begin eyJkYXRhIjoiRXJyb3IgaW4gaWZfZWxzZShvcmlnX3pvbmUgPT0gQUlSUE9SVF9aT05FLCBcIkZyb20gQWlycG9ydFwiLCBcIlRvIEFpcnBvcnRcIikgOiBcbiAgb2JqZWN0ICdvcmlnX3pvbmUnIG5vdCBmb3VuZFxuIn0= -->
-<pre><code>Error in if_else(orig_zone == AIRPORT_ZONE, &quot;From Airport&quot;, &quot;To Airport&quot;) : 
-  object &#39;orig_zone&#39; not found</code></pre>
-<!-- rnb-output-end -->
 <!-- rnb-chunk-end -->
 <!-- rnb-text-begin -->
 </div>
@@ -482,27 +497,27 @@ <h1>Model 01</h1>
 
 summary(model_01)</code></pre>
 <!-- rnb-source-end -->
-<!-- rnb-output-begin eyJkYXRhIjoiXG5DYWxsOlxubG0oZm9ybXVsYSA9IHkgfiBlbXBsb3ltZW50ICsgd29ya2VycywgZGF0YSA9IG1vZGVsX2RmKVxuXG5SZXNpZHVhbHM6XG4gICAgIE1pbiAgICAgICAxUSAgIE1lZGlhbiAgICAgICAzUSAgICAgIE1heCBcbi0xMzEuODQzICAtMTEuODc2ICAgLTYuMTA4ICAgLTAuMDY0ICAyMzUuMTg2IFxuXG5Db2VmZmljaWVudHM6XG4gICAgICAgICAgICBFc3RpbWF0ZSBTdGQuIEVycm9yIHQgdmFsdWUgUHIoPnx0fCkgICAgXG4oSW50ZXJjZXB0KSAzLjMzNzc4NSAgIDAuOTc3NjI0ICAgMy40MTQgIDAuMDAwNjUgKioqXG5lbXBsb3ltZW50ICAwLjAxOTI3NiAgIDAuMDAxMDUzICAxOC4zMDMgIDwgMmUtMTYgKioqXG53b3JrZXJzICAgICAwLjAyNDIzNyAgIDAuMDAxOTU5ICAxMi4zNzIgIDwgMmUtMTYgKioqXG4tLS1cblNpZ25pZi4gY29kZXM6ICAwIOKAmCoqKuKAmSAwLjAwMSDigJgqKuKAmSAwLjAxIOKAmCrigJkgMC4wNSDigJgu4oCZIDAuMSDigJgg4oCZIDFcblxuUmVzaWR1YWwgc3RhbmRhcmQgZXJyb3I6IDMyLjA4IG9uIDI1MDUgZGVncmVlcyBvZiBmcmVlZG9tXG4gICg1MiBvYnNlcnZhdGlvbnMgZGVsZXRlZCBkdWUgdG8gbWlzc2luZ25lc3MpXG5NdWx0aXBsZSBSLXNxdWFyZWQ6ICAwLjE2MDQsXHRBZGp1c3RlZCBSLXNxdWFyZWQ6ICAwLjE1OTcgXG5GLXN0YXRpc3RpYzogMjM5LjIgb24gMiBhbmQgMjUwNSBERiwgIHAtdmFsdWU6IDwgMi4yZS0xNlxuIn0= -->
+<!-- rnb-output-begin eyJkYXRhIjoiXG5DYWxsOlxubG0oZm9ybXVsYSA9IHkgfiBlbXBsb3ltZW50ICsgd29ya2VycywgZGF0YSA9IG1vZGVsX2RmKVxuXG5SZXNpZHVhbHM6XG4gICAgIE1pbiAgICAgICAxUSAgIE1lZGlhbiAgICAgICAzUSAgICAgIE1heCBcbi0xNzYuNTE0ICAtMTUuMjUzICAgLTcuMjQwICAgIDEuMDAzICAzMDcuMjU5IFxuXG5Db2VmZmljaWVudHM6XG4gICAgICAgICAgICBFc3RpbWF0ZSBTdGQuIEVycm9yIHQgdmFsdWUgUHIoPnx0fCkgICAgXG4oSW50ZXJjZXB0KSAwLjQ4MjM1NSAgIDEuNTQ4Njg3ICAgMC4zMTEgICAgMC43NTUgICAgXG5lbXBsb3ltZW50ICAwLjAyNjI5NiAgIDAuMDAxNDUwICAxOC4xMzcgICA8MmUtMTYgKioqXG53b3JrZXJzICAgICAwLjAzNjU4OCAgIDAuMDAyODM1ICAxMi45MDcgICA8MmUtMTYgKioqXG4tLS1cblNpZ25pZi4gY29kZXM6ICAwIOKAmCoqKuKAmSAwLjAwMSDigJgqKuKAmSAwLjAxIOKAmCrigJkgMC4wNSDigJgu4oCZIDAuMSDigJgg4oCZIDFcblxuUmVzaWR1YWwgc3RhbmRhcmQgZXJyb3I6IDQxLjk0IG9uIDE4NjAgZGVncmVlcyBvZiBmcmVlZG9tXG4gICgyMiBvYnNlcnZhdGlvbnMgZGVsZXRlZCBkdWUgdG8gbWlzc2luZ25lc3MpXG5NdWx0aXBsZSBSLXNxdWFyZWQ6ICAwLjIwMTMsXHRBZGp1c3RlZCBSLXNxdWFyZWQ6ICAwLjIwMDQgXG5GLXN0YXRpc3RpYzogMjM0LjQgb24gMiBhbmQgMTg2MCBERiwgIHAtdmFsdWU6IDwgMi4yZS0xNlxuIn0= -->
 <pre><code>
 Call:
 lm(formula = y ~ employment + workers, data = model_df)
 
 Residuals:
      Min       1Q   Median       3Q      Max 
--131.843  -11.876   -6.108   -0.064  235.186 
+-176.514  -15.253   -7.240    1.003  307.259 
 
 Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
-(Intercept) 3.337785   0.977624   3.414  0.00065 ***
-employment  0.019276   0.001053  18.303  &lt; 2e-16 ***
-workers     0.024237   0.001959  12.372  &lt; 2e-16 ***
+(Intercept) 0.482355   1.548687   0.311    0.755    
+employment  0.026296   0.001450  18.137   &lt;2e-16 ***
+workers     0.036588   0.002835  12.907   &lt;2e-16 ***
 ---
 Signif. codes:  0 *** 0.001 ** 0.01 * 0.05 . 0.1   1
 
-Residual standard error: 32.08 on 2505 degrees of freedom
-  (52 observations deleted due to missingness)
-Multiple R-squared:  0.1604,    Adjusted R-squared:  0.1597 
-F-statistic: 239.2 on 2 and 2505 DF,  p-value: &lt; 2.2e-16</code></pre>
+Residual standard error: 41.94 on 1860 degrees of freedom
+  (22 observations deleted due to missingness)
+Multiple R-squared:  0.2013,    Adjusted R-squared:  0.2004 
+F-statistic: 234.4 on 2 and 1860 DF,  p-value: &lt; 2.2e-16</code></pre>
 <!-- rnb-output-end -->
 <!-- rnb-chunk-end -->
 <!-- rnb-text-begin -->
@@ -517,32 +532,32 @@ <h1>Model 02</h1>
 
 summary(model_02)</code></pre>
 <!-- rnb-source-end -->
-<!-- rnb-output-begin eyJkYXRhIjoiXG5DYWxsOlxubG0oZm9ybXVsYSA9IHkgfiB3b3JrZXJzICsgaGlnaF9lYXJuZXJzICsgU2VydmljZV9SYXRlSGlnaCArIFxuICAgIEluZHVzdHJ5ICsgT2ZmaWNlICsgUmV0YWlsLCBkYXRhID0gbW9kZWxfZGYpXG5cblJlc2lkdWFsczpcbiAgICAgTWluICAgICAgIDFRICAgTWVkaWFuICAgICAgIDNRICAgICAgTWF4IFxuLTExOC4zODQgIC0xMS42MjEgICAtNS40MTEgICAgMC40MzIgIDIzMS4yMDMgXG5cbkNvZWZmaWNpZW50czpcbiAgICAgICAgICAgICAgICAgRXN0aW1hdGUgU3RkLiBFcnJvciB0IHZhbHVlIFByKD58dHwpICAgIFxuKEludGVyY2VwdCkgICAgICAzLjA4MDY5MiAgIDAuOTU4MjgyICAgMy4yMTUgIDAuMDAxMzIgKiogXG53b3JrZXJzICAgICAgICAgIDAuMDA0ODA5ICAgMC4wMDM3NTUgICAxLjI4MSAgMC4yMDA0MyAgICBcbmhpZ2hfZWFybmVycyAgICAgMC4wNTA4NDQgICAwLjAwODQ1OCAgIDYuMDEyIDIuMTFlLTA5ICoqKlxuU2VydmljZV9SYXRlSGlnaCAwLjA1NTY1NSAgIDAuMDEwNjgxICAgNS4yMTEgMi4wM2UtMDcgKioqXG5JbmR1c3RyeSAgICAgICAgIDAuMDM0MzQ2ICAgMC4wMDQ5MzMgICA2Ljk2MiA0LjI2ZS0xMiAqKipcbk9mZmljZSAgICAgICAgICAgMC4wMTYyODMgICAwLjAwMTgyNCAgIDguOTI1ICA8IDJlLTE2ICoqKlxuUmV0YWlsICAgICAgICAgICAwLjA0NDAyMiAgIDAuMDAzNzQzICAxMS43NjEgIDwgMmUtMTYgKioqXG4tLS1cblNpZ25pZi4gY29kZXM6ICAwIOKAmCoqKuKAmSAwLjAwMSDigJgqKuKAmSAwLjAxIOKAmCrigJkgMC4wNSDigJgu4oCZIDAuMSDigJgg4oCZIDFcblxuUmVzaWR1YWwgc3RhbmRhcmQgZXJyb3I6IDMxLjM2IG9uIDI1MDEgZGVncmVlcyBvZiBmcmVlZG9tXG4gICg1MiBvYnNlcnZhdGlvbnMgZGVsZXRlZCBkdWUgdG8gbWlzc2luZ25lc3MpXG5NdWx0aXBsZSBSLXNxdWFyZWQ6ICAwLjE5ODcsXHRBZGp1c3RlZCBSLXNxdWFyZWQ6ICAwLjE5NjggXG5GLXN0YXRpc3RpYzogMTAzLjQgb24gNiBhbmQgMjUwMSBERiwgIHAtdmFsdWU6IDwgMi4yZS0xNlxuIn0= -->
+<!-- rnb-output-begin eyJkYXRhIjoiXG5DYWxsOlxubG0oZm9ybXVsYSA9IHkgfiB3b3JrZXJzICsgaGlnaF9lYXJuZXJzICsgU2VydmljZV9SYXRlSGlnaCArIFxuICAgIEluZHVzdHJ5ICsgT2ZmaWNlICsgUmV0YWlsLCBkYXRhID0gbW9kZWxfZGYpXG5cblJlc2lkdWFsczpcbiAgICAgTWluICAgICAgIDFRICAgTWVkaWFuICAgICAgIDNRICAgICAgTWF4IFxuLTE2MS42MTEgIC0xNS4wMDEgICAtNi4wMjcgICAgMS44NzUgIDMwMC40ODUgXG5cbkNvZWZmaWNpZW50czpcbiAgICAgICAgICAgICAgICAgIEVzdGltYXRlIFN0ZC4gRXJyb3IgdCB2YWx1ZSBQcig+fHR8KSAgICBcbihJbnRlcmNlcHQpICAgICAgLTAuMzMyMDIxICAgMS41MTY4NzEgIC0wLjIxOSAgMC44MjY3NiAgICBcbndvcmtlcnMgICAgICAgICAgIDAuMDE1MDM1ICAgMC4wMDU0NzggICAyLjc0NSAgMC4wMDYxMSAqKiBcbmhpZ2hfZWFybmVycyAgICAgIDAuMDU2MDA0ICAgMC4wMTIwNTUgICA0LjY0NiAzLjYzZS0wNiAqKipcblNlcnZpY2VfUmF0ZUhpZ2ggIDAuMDg2Nzc4ICAgMC4wMTUxNDcgICA1LjcyOSAxLjE4ZS0wOCAqKipcbkluZHVzdHJ5ICAgICAgICAgIDAuMDQ5MDE2ICAgMC4wMDY2NTcgICA3LjM2MyAyLjY5ZS0xMyAqKipcbk9mZmljZSAgICAgICAgICAgIDAuMDIyMDQ4ICAgMC4wMDI0NTYgICA4Ljk3NiAgPCAyZS0xNiAqKipcblJldGFpbCAgICAgICAgICAgIDAuMDU2MDcxICAgMC4wMDUwMzEgIDExLjE0NSAgPCAyZS0xNiAqKipcbi0tLVxuU2lnbmlmLiBjb2RlczogIDAg4oCYKioq4oCZIDAuMDAxIOKAmCoq4oCZIDAuMDEg4oCYKuKAmSAwLjA1IOKAmC7igJkgMC4xIOKAmCDigJkgMVxuXG5SZXNpZHVhbCBzdGFuZGFyZCBlcnJvcjogNDAuODIgb24gMTg1NiBkZWdyZWVzIG9mIGZyZWVkb21cbiAgKDIyIG9ic2VydmF0aW9ucyBkZWxldGVkIGR1ZSB0byBtaXNzaW5nbmVzcylcbk11bHRpcGxlIFItc3F1YXJlZDogIDAuMjQ0OSxcdEFkanVzdGVkIFItc3F1YXJlZDogIDAuMjQyNSBcbkYtc3RhdGlzdGljOiAxMDAuMyBvbiA2IGFuZCAxODU2IERGLCAgcC12YWx1ZTogPCAyLjJlLTE2XG4ifQ== -->
 <pre><code>
 Call:
 lm(formula = y ~ workers + high_earners + Service_RateHigh + 
     Industry + Office + Retail, data = model_df)
 
 Residuals:
      Min       1Q   Median       3Q      Max 
--118.384  -11.621   -5.411    0.432  231.203 
+-161.611  -15.001   -6.027    1.875  300.485 
 
 Coefficients:
-                 Estimate Std. Error t value Pr(&gt;|t|)    
-(Intercept)      3.080692   0.958282   3.215  0.00132 ** 
-workers          0.004809   0.003755   1.281  0.20043    
-high_earners     0.050844   0.008458   6.012 2.11e-09 ***
-Service_RateHigh 0.055655   0.010681   5.211 2.03e-07 ***
-Industry         0.034346   0.004933   6.962 4.26e-12 ***
-Office           0.016283   0.001824   8.925  &lt; 2e-16 ***
-Retail           0.044022   0.003743  11.761  &lt; 2e-16 ***
+                  Estimate Std. Error t value Pr(&gt;|t|)    
+(Intercept)      -0.332021   1.516871  -0.219  0.82676    
+workers           0.015035   0.005478   2.745  0.00611 ** 
+high_earners      0.056004   0.012055   4.646 3.63e-06 ***
+Service_RateHigh  0.086778   0.015147   5.729 1.18e-08 ***
+Industry          0.049016   0.006657   7.363 2.69e-13 ***
+Office            0.022048   0.002456   8.976  &lt; 2e-16 ***
+Retail            0.056071   0.005031  11.145  &lt; 2e-16 ***
 ---
 Signif. codes:  0 *** 0.001 ** 0.01 * 0.05 . 0.1   1
 
-Residual standard error: 31.36 on 2501 degrees of freedom
-  (52 observations deleted due to missingness)
-Multiple R-squared:  0.1987,    Adjusted R-squared:  0.1968 
-F-statistic: 103.4 on 6 and 2501 DF,  p-value: &lt; 2.2e-16</code></pre>
+Residual standard error: 40.82 on 1856 degrees of freedom
+  (22 observations deleted due to missingness)
+Multiple R-squared:  0.2449,    Adjusted R-squared:  0.2425 
+F-statistic: 100.3 on 6 and 1856 DF,  p-value: &lt; 2.2e-16</code></pre>
 <!-- rnb-output-end -->
 <!-- rnb-chunk-end -->
 <!-- rnb-text-begin -->
@@ -557,27 +572,27 @@ <h1>Model 03</h1>
 
 summary(model_03)</code></pre>
 <!-- rnb-source-end -->
-<!-- rnb-output-begin eyJkYXRhIjoiXG5DYWxsOlxubG0oZm9ybXVsYSA9IHkgfiBoaWdoX2Vhcm5lcnMgKyBlbXBsb3ltZW50LCBkYXRhID0gbW9kZWxfZGYpXG5cblJlc2lkdWFsczpcbiAgICAgTWluICAgICAgIDFRICAgTWVkaWFuICAgICAgIDNRICAgICAgTWF4IFxuLTEzMC4xNjUgIC0xMS41NjYgICAtNi4wNzMgICAtMC4zODEgIDIzNC4yNTIgXG5cbkNvZWZmaWNpZW50czpcbiAgICAgICAgICAgICBFc3RpbWF0ZSBTdGQuIEVycm9yIHQgdmFsdWUgUHIoPnx0fCkgICAgXG4oSW50ZXJjZXB0KSAgNC40OTkzNTIgICAwLjg5MzgzNyAgIDUuMDM0IDUuMTVlLTA3ICoqKlxuaGlnaF9lYXJuZXJzIDAuMDU4MjA3ICAgMC4wMDQzODcgIDEzLjI2NyAgPCAyZS0xNiAqKipcbmVtcGxveW1lbnQgICAwLjAxODg3MiAgIDAuMDAxMDQ4ICAxOC4wMDAgIDwgMmUtMTYgKioqXG4tLS1cblNpZ25pZi4gY29kZXM6ICAwIOKAmCoqKuKAmSAwLjAwMSDigJgqKuKAmSAwLjAxIOKAmCrigJkgMC4wNSDigJgu4oCZIDAuMSDigJgg4oCZIDFcblxuUmVzaWR1YWwgc3RhbmRhcmQgZXJyb3I6IDMxLjk0IG9uIDI1MDUgZGVncmVlcyBvZiBmcmVlZG9tXG4gICg1MiBvYnNlcnZhdGlvbnMgZGVsZXRlZCBkdWUgdG8gbWlzc2luZ25lc3MpXG5NdWx0aXBsZSBSLXNxdWFyZWQ6ICAwLjE2NzYsXHRBZGp1c3RlZCBSLXNxdWFyZWQ6ICAwLjE2NjkgXG5GLXN0YXRpc3RpYzogMjUyLjEgb24gMiBhbmQgMjUwNSBERiwgIHAtdmFsdWU6IDwgMi4yZS0xNlxuIn0= -->
+<!-- rnb-output-begin eyJkYXRhIjoiXG5DYWxsOlxubG0oZm9ybXVsYSA9IHkgfiBoaWdoX2Vhcm5lcnMgKyBlbXBsb3ltZW50LCBkYXRhID0gbW9kZWxfZGYpXG5cblJlc2lkdWFsczpcbiAgICAgTWluICAgICAgIDFRICAgTWVkaWFuICAgICAgIDNRICAgICAgTWF4IFxuLTE3NC41NDkgIC0xNS4wNDcgICAtNy41MDcgICAgMC44MzEgIDMwNC44OTEgXG5cbkNvZWZmaWNpZW50czpcbiAgICAgICAgICAgICBFc3RpbWF0ZSBTdGQuIEVycm9yIHQgdmFsdWUgUHIoPnx0fCkgICAgXG4oSW50ZXJjZXB0KSAgMy4yMjUwMTYgICAxLjQwNTcyNiAgIDIuMjk0ICAgMC4wMjE5ICogIFxuaGlnaF9lYXJuZXJzIDAuMDgxMDUxICAgMC4wMDYyMjMgIDEzLjAyNSAgIDwyZS0xNiAqKipcbmVtcGxveW1lbnQgICAwLjAyNTYzMSAgIDAuMDAxNDQ3ICAxNy43MTkgICA8MmUtMTYgKioqXG4tLS1cblNpZ25pZi4gY29kZXM6ICAwIOKAmCoqKuKAmSAwLjAwMSDigJgqKuKAmSAwLjAxIOKAmCrigJkgMC4wNSDigJgu4oCZIDAuMSDigJgg4oCZIDFcblxuUmVzaWR1YWwgc3RhbmRhcmQgZXJyb3I6IDQxLjkxIG9uIDE4NjAgZGVncmVlcyBvZiBmcmVlZG9tXG4gICgyMiBvYnNlcnZhdGlvbnMgZGVsZXRlZCBkdWUgdG8gbWlzc2luZ25lc3MpXG5NdWx0aXBsZSBSLXNxdWFyZWQ6ICAwLjIwMjUsXHRBZGp1c3RlZCBSLXNxdWFyZWQ6ICAwLjIwMTYgXG5GLXN0YXRpc3RpYzogMjM2LjEgb24gMiBhbmQgMTg2MCBERiwgIHAtdmFsdWU6IDwgMi4yZS0xNlxuIn0= -->
 <pre><code>
 Call:
 lm(formula = y ~ high_earners + employment, data = model_df)
 
 Residuals:
      Min       1Q   Median       3Q      Max 
--130.165  -11.566   -6.073   -0.381  234.252 
+-174.549  -15.047   -7.507    0.831  304.891 
 
 Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
-(Intercept)  4.499352   0.893837   5.034 5.15e-07 ***
-high_earners 0.058207   0.004387  13.267  &lt; 2e-16 ***
-employment   0.018872   0.001048  18.000  &lt; 2e-16 ***
+(Intercept)  3.225016   1.405726   2.294   0.0219 *  
+high_earners 0.081051   0.006223  13.025   &lt;2e-16 ***
+employment   0.025631   0.001447  17.719   &lt;2e-16 ***
 ---
 Signif. codes:  0 *** 0.001 ** 0.01 * 0.05 . 0.1   1
 
-Residual standard error: 31.94 on 2505 degrees of freedom
-  (52 observations deleted due to missingness)
-Multiple R-squared:  0.1676,    Adjusted R-squared:  0.1669 
-F-statistic: 252.1 on 2 and 2505 DF,  p-value: &lt; 2.2e-16</code></pre>
+Residual standard error: 41.91 on 1860 degrees of freedom
+  (22 observations deleted due to missingness)
+Multiple R-squared:  0.2025,    Adjusted R-squared:  0.2016 
+F-statistic: 236.1 on 2 and 1860 DF,  p-value: &lt; 2.2e-16</code></pre>
 <!-- rnb-output-end -->
 <!-- rnb-chunk-end -->
 <!-- rnb-text-begin -->
@@ -592,31 +607,31 @@ <h1>Model 04</h1>
 
 summary(model_04)</code></pre>
 <!-- rnb-source-end -->
-<!-- rnb-output-begin eyJkYXRhIjoiXG5DYWxsOlxubG0oZm9ybXVsYSA9IHkgfiBoaWdoX2Vhcm5lcnMgKyBJbmR1c3RyeSArIE9mZmljZSArIFNlcnZpY2VfUmF0ZUhpZ2ggKyBcbiAgICBSZXRhaWwsIGRhdGEgPSBtb2RlbF9kZilcblxuUmVzaWR1YWxzOlxuICAgICBNaW4gICAgICAgMVEgICBNZWRpYW4gICAgICAgM1EgICAgICBNYXggXG4tMTE4LjM4OSAgLTExLjU1MyAgIC01LjQyOCAgICAwLjE5OSAgMjMwLjY5NSBcblxuQ29lZmZpY2llbnRzOlxuICAgICAgICAgICAgICAgICBFc3RpbWF0ZSBTdGQuIEVycm9yIHQgdmFsdWUgUHIoPnx0fCkgICAgXG4oSW50ZXJjZXB0KSAgICAgIDMuNTYyMDM3ICAgMC44ODE2MDkgICA0LjA0MCA1LjUwZS0wNSAqKipcbmhpZ2hfZWFybmVycyAgICAgMC4wNjAxNTYgICAwLjAwNDMyMCAgMTMuOTI0ICA8IDJlLTE2ICoqKlxuSW5kdXN0cnkgICAgICAgICAwLjAzMzY5NyAgIDAuMDA0OTA4ICAgNi44NjYgOC4yOWUtMTIgKioqXG5PZmZpY2UgICAgICAgICAgIDAuMDE2MDMyICAgMC4wMDE4MTQgICA4LjgzOCAgPCAyZS0xNiAqKipcblNlcnZpY2VfUmF0ZUhpZ2ggMC4wNTYwMzUgICAwLjAxMDY3OCAgIDUuMjQ4IDEuNjdlLTA3ICoqKlxuUmV0YWlsICAgICAgICAgICAwLjA0NDY0NyAgIDAuMDAzNzEyICAxMi4wMjkgIDwgMmUtMTYgKioqXG4tLS1cblNpZ25pZi4gY29kZXM6ICAwIOKAmCoqKuKAmSAwLjAwMSDigJgqKuKAmSAwLjAxIOKAmCrigJkgMC4wNSDigJgu4oCZIDAuMSDigJgg4oCZIDFcblxuUmVzaWR1YWwgc3RhbmRhcmQgZXJyb3I6IDMxLjM3IG9uIDI1MDIgZGVncmVlcyBvZiBmcmVlZG9tXG4gICg1MiBvYnNlcnZhdGlvbnMgZGVsZXRlZCBkdWUgdG8gbWlzc2luZ25lc3MpXG5NdWx0aXBsZSBSLXNxdWFyZWQ6ICAwLjE5ODIsXHRBZGp1c3RlZCBSLXNxdWFyZWQ6ICAwLjE5NjYgXG5GLXN0YXRpc3RpYzogMTIzLjcgb24gNSBhbmQgMjUwMiBERiwgIHAtdmFsdWU6IDwgMi4yZS0xNlxuIn0= -->
+<!-- rnb-output-begin eyJkYXRhIjoiXG5DYWxsOlxubG0oZm9ybXVsYSA9IHkgfiBoaWdoX2Vhcm5lcnMgKyBJbmR1c3RyeSArIE9mZmljZSArIFNlcnZpY2VfUmF0ZUhpZ2ggKyBcbiAgICBSZXRhaWwsIGRhdGEgPSBtb2RlbF9kZilcblxuUmVzaWR1YWxzOlxuICAgICBNaW4gICAgICAgMVEgICBNZWRpYW4gICAgICAgM1EgICAgICBNYXggXG4tMTYxLjAxOSAgLTE1LjE3NCAgIC02LjIwNCAgICAxLjY2OSAgMjk4LjY2NyBcblxuQ29lZmZpY2llbnRzOlxuICAgICAgICAgICAgICAgICBFc3RpbWF0ZSBTdGQuIEVycm9yIHQgdmFsdWUgUHIoPnx0fCkgICAgXG4oSW50ZXJjZXB0KSAgICAgIDEuMzk3MjczICAgMS4zODIyNTkgICAxLjAxMSAgICAwLjMxMiAgICBcbmhpZ2hfZWFybmVycyAgICAgMC4wODQ1NzAgICAwLjAwNjA5MyAgMTMuODc5ICA8IDJlLTE2ICoqKlxuSW5kdXN0cnkgICAgICAgICAwLjA0Njc1OSAgIDAuMDA2NjE4ICAgNy4wNjYgMi4yNWUtMTIgKioqXG5PZmZpY2UgICAgICAgICAgIDAuMDIxMjI5ICAgMC4wMDI0NDMgICA4LjY5MSAgPCAyZS0xNiAqKipcblNlcnZpY2VfUmF0ZUhpZ2ggMC4wODgwNjggICAwLjAxNTE2NiAgIDUuODA3IDcuNDdlLTA5ICoqKlxuUmV0YWlsICAgICAgICAgICAwLjA1Nzg0MiAgIDAuMDA0OTk4ICAxMS41NzMgIDwgMmUtMTYgKioqXG4tLS1cblNpZ25pZi4gY29kZXM6ICAwIOKAmCoqKuKAmSAwLjAwMSDigJgqKuKAmSAwLjAxIOKAmCrigJkgMC4wNSDigJgu4oCZIDAuMSDigJgg4oCZIDFcblxuUmVzaWR1YWwgc3RhbmRhcmQgZXJyb3I6IDQwLjg5IG9uIDE4NTcgZGVncmVlcyBvZiBmcmVlZG9tXG4gICgyMiBvYnNlcnZhdGlvbnMgZGVsZXRlZCBkdWUgdG8gbWlzc2luZ25lc3MpXG5NdWx0aXBsZSBSLXNxdWFyZWQ6ICAwLjI0MTksXHRBZGp1c3RlZCBSLXNxdWFyZWQ6ICAwLjIzOTggXG5GLXN0YXRpc3RpYzogMTE4LjUgb24gNSBhbmQgMTg1NyBERiwgIHAtdmFsdWU6IDwgMi4yZS0xNlxuIn0= -->
 <pre><code>
 Call:
 lm(formula = y ~ high_earners + Industry + Office + Service_RateHigh + 
     Retail, data = model_df)
 
 Residuals:
      Min       1Q   Median       3Q      Max 
--118.389  -11.553   -5.428    0.199  230.695 
+-161.019  -15.174   -6.204    1.669  298.667 
 
 Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
-(Intercept)      3.562037   0.881609   4.040 5.50e-05 ***
-high_earners     0.060156   0.004320  13.924  &lt; 2e-16 ***
-Industry         0.033697   0.004908   6.866 8.29e-12 ***
-Office           0.016032   0.001814   8.838  &lt; 2e-16 ***
-Service_RateHigh 0.056035   0.010678   5.248 1.67e-07 ***
-Retail           0.044647   0.003712  12.029  &lt; 2e-16 ***
+(Intercept)      1.397273   1.382259   1.011    0.312    
+high_earners     0.084570   0.006093  13.879  &lt; 2e-16 ***
+Industry         0.046759   0.006618   7.066 2.25e-12 ***
+Office           0.021229   0.002443   8.691  &lt; 2e-16 ***
+Service_RateHigh 0.088068   0.015166   5.807 7.47e-09 ***
+Retail           0.057842   0.004998  11.573  &lt; 2e-16 ***
 ---
 Signif. codes:  0 *** 0.001 ** 0.01 * 0.05 . 0.1   1
 
-Residual standard error: 31.37 on 2502 degrees of freedom
-  (52 observations deleted due to missingness)
-Multiple R-squared:  0.1982,    Adjusted R-squared:  0.1966 
-F-statistic: 123.7 on 5 and 2502 DF,  p-value: &lt; 2.2e-16</code></pre>
+Residual standard error: 40.89 on 1857 degrees of freedom
+  (22 observations deleted due to missingness)
+Multiple R-squared:  0.2419,    Adjusted R-squared:  0.2398 
+F-statistic: 118.5 on 5 and 1857 DF,  p-value: &lt; 2.2e-16</code></pre>
 <!-- rnb-output-end -->
 <!-- rnb-chunk-end -->
 <!-- rnb-text-begin -->
@@ -650,7 +665,7 @@ <h1>Write</h1>
 <!-- rnb-chunk-end -->
 </div>
 
-<div id=""rmd-source-code"">LS0tCnRpdGxlOiAiQWlycG9ydCBNb2RlbCIKb3V0cHV0OiBodG1sX25vdGVib29rCi0tLQoKIyBPdmVyaGVhZApgYGB7ciBvdmVyaGVhZCwgaW5jbHVkZSA9IEZBTFNFfQpwYWNrYWdlc192ZWN0b3IgPC0gYygidGlkeXZlcnNlIiwKICAgICAgICAgICAgICAgICAgICAgInNmIiwKICAgICAgICAgICAgICAgICAgICAgImNvcnJyIikKCm5lZWRfdG9faW5zdGFsbCA8LSBwYWNrYWdlc192ZWN0b3JbIShwYWNrYWdlc192ZWN0b3IgJWluJSBpbnN0YWxsZWQucGFja2FnZXMoKVssIlBhY2thZ2UiXSldCgppZiAobGVuZ3RoKG5lZWRfdG9faW5zdGFsbCkpIGluc3RhbGwucGFja2FnZXMobmVlZF90b19pbnN0YWxsKQoKZm9yIChwYWNrYWdlIGluIHBhY2thZ2VzX3ZlY3RvcikgewogIGxpYnJhcnkocGFja2FnZSwgY2hhcmFjdGVyLm9ubHkgPSBUUlVFKQp9CgpgYGAKCiMgUmVtb3RlIEkvTwpgYGB7ciByZW1vdGUtaW99CnByaXZhdGVfZGlyIDwtICIuLi8uLi9kb2NzL2RhdGEvX1BSSVZBVEUvIgpkYXRhX2RpciA8LSAiLi4vLi4vZG9jcy9kYXRhL2lucHV0LyIKCmNsZWFuX3N0cmVldGxpZ2h0X2ZpbGVuYW1lIDwtIHBhc3RlMChwcml2YXRlX2RpciwgImNsZWFuLXN0cmVldGxpZ2h0LnJkcyIpCnNvY2VjX2ZpbGVuYW1lIDwtIHBhc3RlMChkYXRhX2RpciwgInNlX2RhdGEvc2VfMjAxNi5jc3YiKQpzb2NlY19vdGhlcl92YXJzX2ZpbGVuYW1lIDwtIHBhc3RlMChkYXRhX2RpciwgImFpcnBvcnQvc2VfMjAxNl9vdGhlcl92YXJzLmNzdiIpCnRhel9zaGFwZV9maWxlbmFtZSA8LSBwYXN0ZTAoZGF0YV9kaXIsICJ0YXpzL21hc3Rlcl90YXpzLnNocCIpCgpjYW1wb19zbF9zaGFwZSA8LSBwYXN0ZTAocHJpdmF0ZV9kaXIsICJzdHJlZXRsaWdodC8xNjE0MjhfVFJNMjB0ZXN0NV8yMDE2L1NoYXBlZmlsZS8xNjE0MjhfVFJNMjB0ZXN0NV8yMDE2X29yaWdpbi8xNjE0MjhfVFJNMjB0ZXN0NV8yMDE2X29yaWdpbi5zaHAiKQpkdXJoYW1fc2xfc2hhcGUgPC0gcGFzdGUwKHByaXZhdGVfZGlyLCAic3RyZWV0bGlnaHQvMTY0NzkyX1RSTTIwXzIwMTZfQWxsL1NoYXBlZmlsZS8xNjQ3OTJfVFJNMjBfMjAxNl9BbGxfb3JpZ2luLzE2NDc5Ml9UUk0yMF8yMDE2X0FsbF9vcmlnaW4uc2hwIikKCm91dHB1dF9wcm9kdWN0aW9uX2ZpbGVuYW1lIDwtIHBhc3RlMChkYXRhX2RpciwgImFpcnBvcnQvYWlycG9ydC1wcm9kdWN0aW9ucy5jc3YiKQpgYGAKCiMgUGFyYW1ldGVycwpgYGB7ciBwYXJhbWV0ZXJzfQpBSVJQT1JUX1pPTkUgPC0gMTI2MQpMQVRfTE5HX0VQU0cgPC0gNDMyNgpSRFVfRU5QTEFORU1FTlRTIDwtIDQ1MDAwCk9VVExJRVJfTUlOIDwtIDIwMApgYGAKCiMgRGF0YSBSZWFkcwpgYGB7ciByZWFkfQpjbGVhbl9zbF9kZiA8LSByZWFkUkRTKGNsZWFuX3N0cmVldGxpZ2h0X2ZpbGVuYW1lKQpzb2NlY19kZiA8LSByZWFkX2Nzdihzb2NlY19maWxlbmFtZSwgY29sX3R5cGVzID0gY29scyguZGVmYXVsdCA9IGNvbF9kb3VibGUoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVEFaX05HID0gY29sX2ludGVnZXIoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ291bnR5ID0gY29sX2NoYXJhY3RlcigpKSkKCnNvY2VjX290aGVyX2RmIDwtIHJlYWRfY3N2KHNvY2VjX290aGVyX3ZhcnNfZmlsZW5hbWUsIGNvbF90eXBlcyA9IGNvbHMoLmRlZmF1bHQgPSBjb2xfZG91YmxlKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRBWiA9IGNvbF9pbnRlZ2VyKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFR5cGUgPSBjb2xfY2hhcmFjdGVyKCkpKQoKdGF6X3NmIDwtIHN0X3JlYWQodGF6X3NoYXBlX2ZpbGVuYW1lKSAlPiUKICBzdF90cmFuc2Zvcm0oTEFUX0xOR19FUFNHKQoKY2FtcG9fc2YgPC0gc3RfcmVhZChjYW1wb19zbF9zaGFwZSwgY3JzID0gTEFUX0xOR19FUFNHKQpkdXJoYW1fc2YgPC0gc3RfcmVhZChkdXJoYW1fc2xfc2hhcGUsIGNycyA9IExBVF9MTkdfRVBTRykKYGBgCgojIEdldCBDb29yZGluYXRlcyBmb3IgTWFzdGVyIFpvbmVzCmBgYHtyIGdldC1jb29yZHN9CmNlbnRyb2lkc19zZiA8LSBzZWxlY3QodGF6X3NmLCB0YXogPSBJRCwgY291bnR5ID0gQ09VTlRZLCBvcmlnX3pvbmUgPSBPUklHX0lELCBnZW9tZXRyeSkgJT4lCiAgc3RfY2VudHJvaWQoKQoKY2VudHJvaWRzX2RmIDwtIGFzX3RpYmJsZShzdF9jb29yZGluYXRlcyhjZW50cm9pZHNfc2YpKSAlPiUKICBiaW5kX2NvbHMoLiwgdGliYmxlKHRheiA9IGNlbnRyb2lkc19zZiR0YXosCiAgICAgICAgICAgICAgICAgICAgICBjb3VudHkgPSBjZW50cm9pZHNfc2YkY291bnR5LAogICAgICAgICAgICAgICAgICAgICAgb3JpZ196b25lID0gY2VudHJvaWRzX3NmJG9yaWdfem9uZSkpICU+JQogIHJlbmFtZShsYXQgPSBZLCBsbmcgPSBYKQoKYGBgCgojIEdldCBDb29yZGluYXRlcyBmb3IgU3RyZWV0TGlnaHQgVEFacwpgYGB7cn0KY19zZiA8LSBjYW1wb19zZiAlPiUKICBmaWx0ZXIoaXNfcGFzcyA9PSAwKSAlPiUKICBzZWxlY3QoaWQsIGdlb21ldHJ5KSAlPiUKICBzdF9jZW50cm9pZCguKQoKZF9zZiA8LSBkdXJoYW1fc2YgJT4lCiAgZmlsdGVyKGlzX3Bhc3MgPT0gMCkgJT4lCiAgc2VsZWN0KGlkLCBnZW9tZXRyeSkgJT4lCiAgc3RfY2VudHJvaWQoLikKCnNsX2NlbnRyb2lkc19kZiA8LSBiaW5kX3Jvd3MoCiAgbXV0YXRlKAogICAgYmluZF9jb2xzKGFzX3RpYmJsZShzdF9jb29yZGluYXRlcyhjX3NmKSksCiAgICAgICAgICAgICAgdGliYmxlKHpvbmUgPSBjX3NmJGlkKSksCiAgICBzb3VyY2UgPSAiY2FtcG8iKSwKICBtdXRhdGUoCiAgICBiaW5kX2NvbHMoYXNfdGliYmxlKHN0X2Nvb3JkaW5hdGVzKGRfc2YpKSwKICAgICAgICAgICAgICB0aWJibGUoem9uZSA9IGRfc2YkaWQpKSwKICAgIHNvdXJjZSA9ICJkdXJoYW0iKSkgJT4lCiAgbXV0YXRlKHpvbmUgPSBhcy5pbnRlZ2VyKHpvbmUpKSAlPiUKICByZW5hbWUobGF0ID0gWSwgbG5nID0gWCkKCnJlbW92ZShjX3NmLCBkX3NmKQpgYGAKCiMgRmluZCBDbG9zZXN0IE1hc3RlciBUQVogdG8gU3RyZWV0TGlnaHQgVEFaCmBgYHtyIGNsb3Nlc3R9CndvcmtpbmdfZGYgPC0gY2VudHJvaWRzX2RmICU+JQogIHNlbGVjdChtYXN0ZXJfdGF6ID0gdGF6LCBtYXN0ZXJfbGF0ID0gbGF0LCBtYXN0ZXJfbG5nID0gbG5nKSAlPiUKICBmdWxsX2pvaW4oLiwgc2xfY2VudHJvaWRzX2RmLCBieSA9IGNoYXJhY3RlcigpKSAlPiUKICBtdXRhdGUoZGlzdGFuY2UgPSBzcXJ0KChtYXN0ZXJfbGF0IC0gbGF0KSoqMiArIChtYXN0ZXJfbG5nIC0gbG5nKSoqMikpCgpjbG9zZXN0X2RmIDwtIHdvcmtpbmdfZGYgJT4lCiAgZ3JvdXBfYnkobWFzdGVyX3Rheiwgc291cmNlKSAlPiUKICBzdW1tYXJpc2UobWluX2Rpc3QgPSBtaW4oZGlzdGFuY2UpLCAuZ3JvdXBzID0gImRyb3AiKSAlPiUKICBsZWZ0X2pvaW4od29ya2luZ19kZiwgY2xvc2VzdF9kZiwgYnkgPSBjKCJtYXN0ZXJfdGF6IiwgInNvdXJjZSIpKSAlPiUKICBmaWx0ZXIoZGlzdGFuY2UgPD0gbWluX2Rpc3QpICU+JQogIHNlbGVjdCh0YXogPSBtYXN0ZXJfdGF6LAogICAgICAgICBsYXQgPSBtYXN0ZXJfbGF0LAogICAgICAgICBsbmcgPSBtYXN0ZXJfbG5nLAogICAgICAgICBzbF96b25lID0gem9uZSwKICAgICAgICAgc2xfc291cmNlID0gc291cmNlKQpgYGAKCiMgUmVkdWN0aW9ucwpgYGB7ciByZWR1Y3Rpb25zfQp3b3JraW5nX2RmIDwtIGNsZWFuX3NsX2RmICU+JQogIGZpbHRlcih0eXBlID09ICJQZXJzb25hbCIpICU+JQogIGZpbHRlcihkYXlfdHlwZSA9PSAiMTogV2Vla2RheSAoTS1UaCkiKSAlPiUKICBmaWx0ZXIob3JpZ19wYXNzX3Rocm91Z2ggPT0gIm5vIiAmIGRlc3RfcGFzc190aHJvdWdoID09ICJubyIpICU+JQogIGZpbHRlcihvcmlnX3pvbmUgPT0gQUlSUE9SVF9aT05FIHwgZGVzdF96b25lID09IEFJUlBPUlRfWk9ORSkgJT4lCiAgZmlsdGVyKG9yaWdfem9uZSAhPSBkZXN0X3pvbmUpICU+JQogIGZpbHRlcihkYXlfcGFydCA9PSAiMDogQWxsIERheSAoMTJhbS0xMmFtKSIpICU+JQogIGZpbHRlcighaXMubmEoZHVyYXRpb25fc2VjKSkgJT4lCiAgbXV0YXRlKHByb2R1Y3Rpb25fdGF6ID0gaWZfZWxzZShvcmlnX3pvbmUgPT0gQUlSUE9SVF9aT05FLCBkZXN0X3pvbmUsIG9yaWdfem9uZSkpICU+JQogIG11dGF0ZShwdXJwb3NlID0gaWZfZWxzZShvcmlnX3pvbmUgPT0gQUlSUE9SVF9aT05FLCAiRnJvbSBBaXJwb3J0IiwgIlRvIEFpcnBvcnQiKSkKCnByb2R1Y3Rpb25zX2RmIDwtIHdvcmtpbmdfZGYgJT4lCiAgZ3JvdXBfYnkocHJvZHVjdGlvbl90YXosIHNvdXJjZSkgJT4lCiAgc3VtbWFyaXplKGFpcnBvcnRfcHJvZHVjdGlvbnMgPSBzdW0oZmxvdyksIGR1cmF0aW9uX21pbiA9IG1lYW4oZHVyYXRpb25fc2VjKS82MC4wLCAuZ3JvdXBzID0gImRyb3AiKSAlPiUKICBsZWZ0X2pvaW4oLiwgY2xvc2VzdF9kZiwgYnkgPSBjKCJwcm9kdWN0aW9uX3RheiIgPSAic2xfem9uZSIsICJzb3VyY2UiID0gInNsX3NvdXJjZSIpKSAlPiUKICBncm91cF9ieSh0YXopICU+JQogIHN1bW1hcmlzZShhaXJwb3J0X3Byb2R1Y3Rpb25zID0gc3VtKGFpcnBvcnRfcHJvZHVjdGlvbnMpLAogICAgICAgICAgICBsYXQgPSBmaXJzdChsYXQpLAogICAgICAgICAgICBsbmcgPSBmaXJzdChsbmcpLAogICAgICAgICAgICAuZ3JvdXBzID0gImRyb3AiKSAlPiUKICBsZWZ0X2pvaW4oLiwgc29jZWNfZGYsIGJ5ID0gYygidGF6IiA9ICJUQVpfTkciKSkgJT4lCiAgbGVmdF9qb2luKC4sIHNlbGVjdChzb2NlY19vdGhlcl9kZiwgVEFaLCBQY3RfV29ya2VyLCBQY3RIaWdoRWFybiksIGJ5ID0gYygidGF6IiA9ICJUQVoiKSkgJT4lCiAgZmlsdGVyKENvdW50eSAhPSAiRXh0ZXJuYWwiKSAlPiUKICBtdXRhdGUoZW1wbG95bWVudCA9IEluZHVzdHJ5ICsgT2ZmaWNlICsgU2VydmljZV9SYXRlTG93ICsgU2VydmljZV9SYXRlSGlnaCArIFJldGFpbCkgJT4lCiAgbXV0YXRlKHdvcmtlcnMgPSBQY3RfV29ya2VyLzEwMC4wICogSEhfUE9QKSAlPiUKICBtdXRhdGUoaGlnaF9lYXJuZXJzID0gUGN0SGlnaEVhcm4vMTAwLjAgKiB3b3JrZXJzKQoKYGBgCgojIENvcnJlbGF0aW9ucwpgYGB7ciBjb3JyZWxhdGlvbn0KY29ycmVsYXRpb25zX2RmIDwtIHByb2R1Y3Rpb25zX2RmICU+JQogIHNlbGVjdChhaXJwb3J0X3Byb2R1Y3Rpb25zLAogICAgICAgICB3b3JrZXJzLAogICAgICAgICBlbXBsb3ltZW50LAogICAgICAgICBoaWdoX2Vhcm5lcnMsCiAgICAgICAgIEhILAogICAgICAgICBNRUFOSU5DLAogICAgICAgICBQY3RfV29ya2VyLAogICAgICAgICBTdHVkX0dRLAogICAgICAgICBPdGhlcl9Ob25JbnN0X0dRLAogICAgICAgICBJbnN0X0dRLAogICAgICAgICBUb3RhbF9QT1AsCiAgICAgICAgIEluZHVzdHJ5LAogICAgICAgICBPZmZpY2UsCiAgICAgICAgIFNlcnZpY2VfUmF0ZUhpZ2gsCiAgICAgICAgIFNlcnZpY2VfUmF0ZUxvdywKICAgICAgICAgUmV0YWlsLAogICAgICAgICBQY3RIaWdoRWFybiwKICAgICAgICAgRU5ST0xMTUVOVCkgJT4lCiAgY29ycmVsYXRlKCkgJT4lCiAgc2VsZWN0KHRlcm0sIGFpcnBvcnRfcHJvZHVjdGlvbnMpICU+JQogIGFycmFuZ2UoLWFpcnBvcnRfcHJvZHVjdGlvbnMpCgpjb3JyZWxhdGlvbnNfZGYKYGBgCgojIFByZXBhcmUgbW9kZWwgZGF0YQpgYGB7ciBwcmVwLW1vZGVsfQptb2RlbF9kZiA8LSBwcm9kdWN0aW9uc19kZiAlPiUKICBtdXRhdGUoeSA9IGlmX2Vsc2UoYWlycG9ydF9wcm9kdWN0aW9ucyA+IE9VVExJRVJfTUlOLCBPVVRMSUVSX01JTiwgYWlycG9ydF9wcm9kdWN0aW9ucykpCgphZGp1c3RfZmFjdG9yIDwtIFJEVV9FTlBMQU5FTUVOVFMvc3VtKG1vZGVsX2RmJHkpCgptb2RlbF9kZiA8LSBtb2RlbF9kZiAlPiUKICBtdXRhdGUoeSA9IHkgKiBhZGp1c3RfZmFjdG9yKQpgYGAKCgojIE1vZGVsIDAxCmBgYHtyIG1vZGVsLTAxfQptb2RlbF8wMSA8LSBsbSh5IH4gZW1wbG95bWVudCArIHdvcmtlcnMsCiAgICAgICAgICAgICAgIGRhdGEgPSBtb2RlbF9kZikKCnN1bW1hcnkobW9kZWxfMDEpCmBgYAoKIyBNb2RlbCAwMgpgYGB7ciBtb2RlbC0wMn0KbW9kZWxfMDIgPC0gbG0oeSB+IHdvcmtlcnMgKyBoaWdoX2Vhcm5lcnMgKyBTZXJ2aWNlX1JhdGVIaWdoICsgSW5kdXN0cnkgKyBPZmZpY2UgKyBSZXRhaWwsCiAgICAgICAgICAgICAgIGRhdGEgPSBtb2RlbF9kZikKCnN1bW1hcnkobW9kZWxfMDIpCmBgYAojIE1vZGVsIDAzCmBgYHtyIG1vZGVsLTAzfQptb2RlbF8wMyA8LSBsbSh5IH4gaGlnaF9lYXJuZXJzICsgZW1wbG95bWVudCwKICAgICAgICAgICAgICAgZGF0YSA9IG1vZGVsX2RmKQoKc3VtbWFyeShtb2RlbF8wMykKYGBgCgojIE1vZGVsIDA0CmBgYHtyIG1vZGVsLTA0fQptb2RlbF8wNCA8LSBsbSh5IH4gaGlnaF9lYXJuZXJzICsgSW5kdXN0cnkgKyBPZmZpY2UgKyBTZXJ2aWNlX1JhdGVIaWdoICsgUmV0YWlsLAogICAgICAgICAgICAgICBkYXRhID0gbW9kZWxfZGYpCgpzdW1tYXJ5KG1vZGVsXzA0KQpgYGAKCgojIEFkZCBNb2RlbCBSZXN1bHRzCmBgYHtyIGFkZC1yZXN1bHRzfQpvdXRwdXRfZGYgPC0gcHJvZHVjdGlvbnNfZGYgJT4lCiAgbXV0YXRlKG9ic2VydmVkX3Byb2R1Y3Rpb25zID0gaWZfZWxzZShhaXJwb3J0X3Byb2R1Y3Rpb25zIDwgT1VUTElFUl9NSU4sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhaXJwb3J0X3Byb2R1Y3Rpb25zICogYWRqdXN0X2ZhY3RvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9VVExJRVJfTUlOICogYWRqdXN0X2ZhY3RvcikpICU+JQogIG11dGF0ZShlc3RpbWF0ZWRfcHJvZHVjdGlvbnMgPSBtb2RlbF8wNCRjb2VmZmljaWVudHNbIihJbnRlcmNlcHQpIl0gKwogICAgICAgICAgIG1vZGVsXzA0JGNvZWZmaWNpZW50c1siaGlnaF9lYXJuZXJzIl0gKiBoaWdoX2Vhcm5lcnMgKwogICAgICAgICAgIG1vZGVsXzA0JGNvZWZmaWNpZW50c1siSW5kdXN0cnkiXSAqIEluZHVzdHJ5ICsKICAgICAgICAgICBtb2RlbF8wNCRjb2VmZmljaWVudHNbIk9mZmljZSJdICogT2ZmaWNlICsKICAgICAgICAgICBtb2RlbF8wNCRjb2VmZmljaWVudHNbIlNlcnZpY2VfUmF0ZUhpZ2giXSAqIFNlcnZpY2VfUmF0ZUhpZ2ggKwogICAgICAgICAgIG1vZGVsXzA0JGNvZWZmaWNpZW50c1siUmV0YWlsIl0gKiBSZXRhaWwpCmBgYAoKCiMgV3JpdGUKYGBge3Igd3JpdGV9CndyaXRlX2NzdihvdXRwdXRfZGYsIG91dHB1dF9wcm9kdWN0aW9uX2ZpbGVuYW1lKQpgYGAK</div>
+<div id=""rmd-source-code"">LS0tCnRpdGxlOiAiQWlycG9ydCBNb2RlbCIKb3V0cHV0OiBodG1sX25vdGVib29rCi0tLQoKIyBPdmVyaGVhZApgYGB7ciBvdmVyaGVhZCwgaW5jbHVkZSA9IEZBTFNFfQpwYWNrYWdlc192ZWN0b3IgPC0gYygidGlkeXZlcnNlIiwKICAgICAgICAgICAgICAgICAgICAgInNmIiwKICAgICAgICAgICAgICAgICAgICAgImNvcnJyIikKCm5lZWRfdG9faW5zdGFsbCA8LSBwYWNrYWdlc192ZWN0b3JbIShwYWNrYWdlc192ZWN0b3IgJWluJSBpbnN0YWxsZWQucGFja2FnZXMoKVssIlBhY2thZ2UiXSldCgppZiAobGVuZ3RoKG5lZWRfdG9faW5zdGFsbCkpIGluc3RhbGwucGFja2FnZXMobmVlZF90b19pbnN0YWxsKQoKZm9yIChwYWNrYWdlIGluIHBhY2thZ2VzX3ZlY3RvcikgewogIGxpYnJhcnkocGFja2FnZSwgY2hhcmFjdGVyLm9ubHkgPSBUUlVFKQp9CgpgYGAKCiMgUmVtb3RlIEkvTwpgYGB7ciByZW1vdGUtaW99CnByaXZhdGVfZGlyIDwtICIuLi8uLi9kb2NzL2RhdGEvX1BSSVZBVEUvIgpkYXRhX2RpciA8LSAiLi4vLi4vZG9jcy9kYXRhL2lucHV0LyIKCmNsZWFuX3N0cmVldGxpZ2h0X2ZpbGVuYW1lIDwtIHBhc3RlMChwcml2YXRlX2RpciwgImNsZWFuLXN0cmVldGxpZ2h0LnJkcyIpCnNvY2VjX2ZpbGVuYW1lIDwtIHBhc3RlMChkYXRhX2RpciwgInNlX2RhdGEvc2VfMjAxNi5jc3YiKQpzb2NlY19vdGhlcl92YXJzX2ZpbGVuYW1lIDwtIHBhc3RlMChkYXRhX2RpciwgImFpcnBvcnQvc2VfMjAxNl9vdGhlcl92YXJzLmNzdiIpCnRhel9zaGFwZV9maWxlbmFtZSA8LSBwYXN0ZTAoZGF0YV9kaXIsICJ0YXpzL21hc3Rlcl90YXpzLnNocCIpCgpjYW1wb19zbF9zaGFwZSA8LSBwYXN0ZTAocHJpdmF0ZV9kaXIsICJzdHJlZXRsaWdodC8xNjE0MjhfVFJNMjB0ZXN0NV8yMDE2L1NoYXBlZmlsZS8xNjE0MjhfVFJNMjB0ZXN0NV8yMDE2X29yaWdpbi8xNjE0MjhfVFJNMjB0ZXN0NV8yMDE2X29yaWdpbi5zaHAiKQpkdXJoYW1fc2xfc2hhcGUgPC0gcGFzdGUwKHByaXZhdGVfZGlyLCAic3RyZWV0bGlnaHQvMTY0NzkyX1RSTTIwXzIwMTZfQWxsL1NoYXBlZmlsZS8xNjQ3OTJfVFJNMjBfMjAxNl9BbGxfb3JpZ2luLzE2NDc5Ml9UUk0yMF8yMDE2X0FsbF9vcmlnaW4uc2hwIikKCm91dHB1dF9wcm9kdWN0aW9uX2ZpbGVuYW1lIDwtIHBhc3RlMChkYXRhX2RpciwgImFpcnBvcnQvYWlycG9ydC1wcm9kdWN0aW9ucy5jc3YiKQpgYGAKCiMgUGFyYW1ldGVycwpgYGB7ciBwYXJhbWV0ZXJzfQpTTF9BSVJQT1JUX1pPTkUgPC0gMTI2MQpMQVRfTE5HX0VQU0cgPC0gNDMyNgpSRFVfRU5QTEFORU1FTlRTIDwtIDQ1MDAwCk9VVExJRVJfTUlOIDwtIDIwMApgYGAKCiMgRGF0YSBSZWFkcwpgYGB7ciByZWFkfQpjbGVhbl9zbF9kZiA8LSByZWFkUkRTKGNsZWFuX3N0cmVldGxpZ2h0X2ZpbGVuYW1lKQpzb2NlY19kZiA8LSByZWFkX2Nzdihzb2NlY19maWxlbmFtZSwgY29sX3R5cGVzID0gY29scyguZGVmYXVsdCA9IGNvbF9kb3VibGUoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVEFaX05HID0gY29sX2ludGVnZXIoKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ291bnR5ID0gY29sX2NoYXJhY3RlcigpKSkKCnNvY2VjX290aGVyX2RmIDwtIHJlYWRfY3N2KHNvY2VjX290aGVyX3ZhcnNfZmlsZW5hbWUsIGNvbF90eXBlcyA9IGNvbHMoLmRlZmF1bHQgPSBjb2xfZG91YmxlKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRBWiA9IGNvbF9pbnRlZ2VyKCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFR5cGUgPSBjb2xfY2hhcmFjdGVyKCkpKQoKdGF6X3NmIDwtIHN0X3JlYWQodGF6X3NoYXBlX2ZpbGVuYW1lKSAlPiUKICBzdF90cmFuc2Zvcm0oTEFUX0xOR19FUFNHKQoKY2FtcG9fc2YgPC0gc3RfcmVhZChjYW1wb19zbF9zaGFwZSwgY3JzID0gTEFUX0xOR19FUFNHKQpkdXJoYW1fc2YgPC0gc3RfcmVhZChkdXJoYW1fc2xfc2hhcGUsIGNycyA9IExBVF9MTkdfRVBTRykKYGBgCgojIEdldCBDb29yZGluYXRlcyBmb3IgTWFzdGVyIFpvbmVzCmBgYHtyIGdldC1jb29yZHN9CmNlbnRyb2lkc19zZiA8LSBzZWxlY3QodGF6X3NmLCB0YXogPSBJRCwgZ2VvbWV0cnkpICU+JQogIHN0X2NlbnRyb2lkKCkKCmNlbnRyb2lkc19kZiA8LSBhc190aWJibGUoc3RfY29vcmRpbmF0ZXMoY2VudHJvaWRzX3NmKSkgJT4lCiAgYmluZF9jb2xzKC4sIHRpYmJsZSh0YXogPSBjZW50cm9pZHNfc2YkdGF6KSkgJT4lCiAgcmVuYW1lKGxhdCA9IFksIGxuZyA9IFgpCgpgYGAKCiMgR2V0IENvb3JkaW5hdGVzIGZvciBTdHJlZXRMaWdodCBUQVpzCmBgYHtyfQpjX3NmIDwtIGNhbXBvX3NmICU+JQogIGZpbHRlcihpc19wYXNzID09IDApICU+JQogIHNlbGVjdChpZCwgZ2VvbWV0cnkpICU+JQogIHN0X2NlbnRyb2lkKC4pCgpkX3NmIDwtIGR1cmhhbV9zZiAlPiUKICBmaWx0ZXIoaXNfcGFzcyA9PSAwKSAlPiUKICBzZWxlY3QoaWQsIGdlb21ldHJ5KSAlPiUKICBzdF9jZW50cm9pZCguKQoKc2xfY2VudHJvaWRzX2RmIDwtIGJpbmRfcm93cygKICBtdXRhdGUoCiAgICBiaW5kX2NvbHMoYXNfdGliYmxlKHN0X2Nvb3JkaW5hdGVzKGNfc2YpKSwKICAgICAgICAgICAgICB0aWJibGUoem9uZSA9IGNfc2YkaWQpKSwKICAgIHNvdXJjZSA9ICJjYW1wbyIpLAogIG11dGF0ZSgKICAgIGJpbmRfY29scyhhc190aWJibGUoc3RfY29vcmRpbmF0ZXMoZF9zZikpLAogICAgICAgICAgICAgIHRpYmJsZSh6b25lID0gZF9zZiRpZCkpLAogICAgc291cmNlID0gImR1cmhhbSIpKSAlPiUKICBtdXRhdGUoem9uZSA9IGFzLmludGVnZXIoem9uZSkpICU+JQogIHJlbmFtZShsYXQgPSBZLCBsbmcgPSBYKQoKcmVtb3ZlKGNfc2YsIGRfc2YpCmBgYAoKIyBGaW5kIENsb3Nlc3QgTWFzdGVyIFRBWiB0byBTdHJlZXRMaWdodCBUQVoKYGBge3IgY2xvc2VzdH0Kd29ya2luZ19kZiA8LSBjZW50cm9pZHNfZGYgJT4lCiAgc2VsZWN0KG1hc3Rlcl90YXogPSB0YXosIG1hc3Rlcl9sYXQgPSBsYXQsIG1hc3Rlcl9sbmcgPSBsbmcpICU+JQogIGZ1bGxfam9pbiguLCBzbF9jZW50cm9pZHNfZGYsIGJ5ID0gY2hhcmFjdGVyKCkpICU+JQogIG11dGF0ZShkaXN0YW5jZSA9IHNxcnQoKG1hc3Rlcl9sYXQgLSBsYXQpKioyICsgKG1hc3Rlcl9sbmcgLSBsbmcpKioyKSkKCmNsb3Nlc3RfZGYgPC0gd29ya2luZ19kZiAlPiUKICBncm91cF9ieSh6b25lLCBzb3VyY2UpICU+JQogIHN1bW1hcmlzZShtaW5fZGlzdCA9IG1pbihkaXN0YW5jZSksIC5ncm91cHMgPSAiZHJvcCIpICU+JQogIGxlZnRfam9pbih3b3JraW5nX2RmLCBjbG9zZXN0X2RmLCBieSA9IGMoInpvbmUiLCAic291cmNlIikpICU+JQogIGZpbHRlcihkaXN0YW5jZSA8PSBtaW5fZGlzdCkgJT4lCiAgc2VsZWN0KHRheiA9IG1hc3Rlcl90YXosCiAgICAgICAgIHNsX3pvbmUgPSB6b25lLAogICAgICAgICBzbF9zb3VyY2UgPSBzb3VyY2UsCiAgICAgICAgIGRpc3RhbmNlKQoKYGBgCgojIFJlZHVjdGlvbnMKYGBge3IgcmVkdWN0aW9uc30Kd29ya2luZ19kZiA8LSBjbGVhbl9zbF9kZiAlPiUKICBmaWx0ZXIodHlwZSA9PSAiUGVyc29uYWwiKSAlPiUKICBmaWx0ZXIoZGF5X3R5cGUgPT0gIjE6IFdlZWtkYXkgKE0tVGgpIikgJT4lCiAgZmlsdGVyKG9yaWdfcGFzc190aHJvdWdoID09ICJubyIgJiBkZXN0X3Bhc3NfdGhyb3VnaCA9PSAibm8iKSAlPiUKICBmaWx0ZXIob3JpZ196b25lID09IFNMX0FJUlBPUlRfWk9ORSB8IGRlc3Rfem9uZSA9PSBTTF9BSVJQT1JUX1pPTkUpICU+JQogIGZpbHRlcihvcmlnX3pvbmUgIT0gZGVzdF96b25lKSAlPiUKICBmaWx0ZXIoZGF5X3BhcnQgPT0gIjA6IEFsbCBEYXkgKDEyYW0tMTJhbSkiKSAlPiUKICBmaWx0ZXIoIWlzLm5hKGR1cmF0aW9uX3NlYykpICU+JQogIG11dGF0ZShwcm9kdWN0aW9uX3NsX3pvbmUgPSBpZl9lbHNlKG9yaWdfem9uZSA9PSBBSVJQT1JUX1pPTkUsIGRlc3Rfem9uZSwgb3JpZ196b25lKSkgJT4lCiAgbXV0YXRlKHB1cnBvc2UgPSBpZl9lbHNlKG9yaWdfem9uZSA9PSBBSVJQT1JUX1pPTkUsICJGcm9tIEFpcnBvcnQiLCAiVG8gQWlycG9ydCIpKQoKcHJvZHVjdGlvbnNfZGYgPC0gd29ya2luZ19kZiAlPiUKICBncm91cF9ieShwcm9kdWN0aW9uX3NsX3pvbmUsIHNvdXJjZSkgJT4lCiAgc3VtbWFyaXplKGFpcnBvcnRfcHJvZHVjdGlvbnMgPSBzdW0oZmxvdyksIGR1cmF0aW9uX21pbiA9IG1lYW4oZHVyYXRpb25fc2VjKS82MC4wLCAuZ3JvdXBzID0gImRyb3AiKSAlPiUKICBsZWZ0X2pvaW4oLiwgY2xvc2VzdF9kZiwgYnkgPSBjKCJwcm9kdWN0aW9uX3NsX3pvbmUiID0gInNsX3pvbmUiLCAic291cmNlIiA9ICJzbF9zb3VyY2UiKSkgJT4lCiAgZ3JvdXBfYnkodGF6KSAlPiUKICBzdW1tYXJpc2UoYWlycG9ydF9wcm9kdWN0aW9ucyA9IHN1bShhaXJwb3J0X3Byb2R1Y3Rpb25zKSwgLmdyb3VwcyA9ICJkcm9wIikgJT4lCiAgbGVmdF9qb2luKC4sIGNlbnRyb2lkc19kZiwgYnkgPSBjKCJ0YXoiKSkgJT4lCiAgbGVmdF9qb2luKC4sIHNvY2VjX2RmLCBieSA9IGMoInRheiIgPSAiVEFaX05HIikpICU+JQogIGxlZnRfam9pbiguLCBzZWxlY3Qoc29jZWNfb3RoZXJfZGYsIFRBWiwgUGN0X1dvcmtlciwgUGN0SGlnaEVhcm4pLCBieSA9IGMoInRheiIgPSAiVEFaIikpICU+JQogIGZpbHRlcihDb3VudHkgIT0gIkV4dGVybmFsIikgJT4lCiAgbXV0YXRlKGVtcGxveW1lbnQgPSBJbmR1c3RyeSArIE9mZmljZSArIFNlcnZpY2VfUmF0ZUxvdyArIFNlcnZpY2VfUmF0ZUhpZ2ggKyBSZXRhaWwpICU+JQogIG11dGF0ZSh3b3JrZXJzID0gUGN0X1dvcmtlci8xMDAuMCAqIEhIX1BPUCkgJT4lCiAgbXV0YXRlKGhpZ2hfZWFybmVycyA9IFBjdEhpZ2hFYXJuLzEwMC4wICogd29ya2VycykKCmBgYAoKIyBDb3JyZWxhdGlvbnMKYGBge3IgY29ycmVsYXRpb259CmNvcnJlbGF0aW9uc19kZiA8LSBwcm9kdWN0aW9uc19kZiAlPiUKICBzZWxlY3QoYWlycG9ydF9wcm9kdWN0aW9ucywKICAgICAgICAgd29ya2VycywKICAgICAgICAgZW1wbG95bWVudCwKICAgICAgICAgaGlnaF9lYXJuZXJzLAogICAgICAgICBISCwKICAgICAgICAgTUVBTklOQywKICAgICAgICAgUGN0X1dvcmtlciwKICAgICAgICAgU3R1ZF9HUSwKICAgICAgICAgT3RoZXJfTm9uSW5zdF9HUSwKICAgICAgICAgSW5zdF9HUSwKICAgICAgICAgVG90YWxfUE9QLAogICAgICAgICBJbmR1c3RyeSwKICAgICAgICAgT2ZmaWNlLAogICAgICAgICBTZXJ2aWNlX1JhdGVIaWdoLAogICAgICAgICBTZXJ2aWNlX1JhdGVMb3csCiAgICAgICAgIFJldGFpbCwKICAgICAgICAgUGN0SGlnaEVhcm4sCiAgICAgICAgIEVOUk9MTE1FTlQpICU+JQogIGNvcnJlbGF0ZSgpICU+JQogIHNlbGVjdCh0ZXJtLCBhaXJwb3J0X3Byb2R1Y3Rpb25zKSAlPiUKICBhcnJhbmdlKC1haXJwb3J0X3Byb2R1Y3Rpb25zKQoKY29ycmVsYXRpb25zX2RmCmBgYAoKIyBQcmVwYXJlIG1vZGVsIGRhdGEKYGBge3IgcHJlcC1tb2RlbH0KbW9kZWxfZGYgPC0gcHJvZHVjdGlvbnNfZGYgJT4lCiAgbXV0YXRlKHkgPSBpZl9lbHNlKGFpcnBvcnRfcHJvZHVjdGlvbnMgPiBPVVRMSUVSX01JTiwgT1VUTElFUl9NSU4sIGFpcnBvcnRfcHJvZHVjdGlvbnMpKQoKYWRqdXN0X2ZhY3RvciA8LSBSRFVfRU5QTEFORU1FTlRTL3N1bShtb2RlbF9kZiR5KQoKbW9kZWxfZGYgPC0gbW9kZWxfZGYgJT4lCiAgbXV0YXRlKHkgPSB5ICogYWRqdXN0X2ZhY3RvcikKYGBgCgoKIyBNb2RlbCAwMQpgYGB7ciBtb2RlbC0wMX0KbW9kZWxfMDEgPC0gbG0oeSB+IGVtcGxveW1lbnQgKyB3b3JrZXJzLAogICAgICAgICAgICAgICBkYXRhID0gbW9kZWxfZGYpCgpzdW1tYXJ5KG1vZGVsXzAxKQpgYGAKCiMgTW9kZWwgMDIKYGBge3IgbW9kZWwtMDJ9Cm1vZGVsXzAyIDwtIGxtKHkgfiB3b3JrZXJzICsgaGlnaF9lYXJuZXJzICsgU2VydmljZV9SYXRlSGlnaCArIEluZHVzdHJ5ICsgT2ZmaWNlICsgUmV0YWlsLAogICAgICAgICAgICAgICBkYXRhID0gbW9kZWxfZGYpCgpzdW1tYXJ5KG1vZGVsXzAyKQpgYGAKIyBNb2RlbCAwMwpgYGB7ciBtb2RlbC0wM30KbW9kZWxfMDMgPC0gbG0oeSB+IGhpZ2hfZWFybmVycyArIGVtcGxveW1lbnQsCiAgICAgICAgICAgICAgIGRhdGEgPSBtb2RlbF9kZikKCnN1bW1hcnkobW9kZWxfMDMpCmBgYAoKIyBNb2RlbCAwNApgYGB7ciBtb2RlbC0wNH0KbW9kZWxfMDQgPC0gbG0oeSB+IGhpZ2hfZWFybmVycyArIEluZHVzdHJ5ICsgT2ZmaWNlICsgU2VydmljZV9SYXRlSGlnaCArIFJldGFpbCwKICAgICAgICAgICAgICAgZGF0YSA9IG1vZGVsX2RmKQoKc3VtbWFyeShtb2RlbF8wNCkKYGBgCgoKIyBBZGQgTW9kZWwgUmVzdWx0cwpgYGB7ciBhZGQtcmVzdWx0c30Kb3V0cHV0X2RmIDwtIHByb2R1Y3Rpb25zX2RmICU+JQogIG11dGF0ZShvYnNlcnZlZF9wcm9kdWN0aW9ucyA9IGlmX2Vsc2UoYWlycG9ydF9wcm9kdWN0aW9ucyA8IE9VVExJRVJfTUlOLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWlycG9ydF9wcm9kdWN0aW9ucyAqIGFkanVzdF9mYWN0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPVVRMSUVSX01JTiAqIGFkanVzdF9mYWN0b3IpKSAlPiUKICBtdXRhdGUoZXN0aW1hdGVkX3Byb2R1Y3Rpb25zID0gbW9kZWxfMDQkY29lZmZpY2llbnRzWyIoSW50ZXJjZXB0KSJdICsKICAgICAgICAgICBtb2RlbF8wNCRjb2VmZmljaWVudHNbImhpZ2hfZWFybmVycyJdICogaGlnaF9lYXJuZXJzICsKICAgICAgICAgICBtb2RlbF8wNCRjb2VmZmljaWVudHNbIkluZHVzdHJ5Il0gKiBJbmR1c3RyeSArCiAgICAgICAgICAgbW9kZWxfMDQkY29lZmZpY2llbnRzWyJPZmZpY2UiXSAqIE9mZmljZSArCiAgICAgICAgICAgbW9kZWxfMDQkY29lZmZpY2llbnRzWyJTZXJ2aWNlX1JhdGVIaWdoIl0gKiBTZXJ2aWNlX1JhdGVIaWdoICsKICAgICAgICAgICBtb2RlbF8wNCRjb2VmZmljaWVudHNbIlJldGFpbCJdICogUmV0YWlsKQpgYGAKCgojIFdyaXRlCmBgYHtyIHdyaXRlfQp3cml0ZV9jc3Yob3V0cHV0X2RmLCBvdXRwdXRfcHJvZHVjdGlvbl9maWxlbmFtZSkKYGBgCg==</div>
 
 
 "
Triangle-Modeling-and-Analytics,TRMG2,5ea54abf7a21911998aa8d6afae9580f449310d0,Kyle Ward,kyle@caliper.com,2021-04-07T12:52:48Z,Kyle Ward,kyle@caliper.com,2021-04-07T12:52:48Z,Correct CSV heading error in transit mode table,src/01 - CreateScenario.rsc,False,False,False,False,1,1,2,"---FILE: src/01 - CreateScenario.rsc---
@@ -211,7 +211,7 @@ Macro ""Create Scenario Transit"" (Args)
   end
   SetView(mode_vw)
   DeleteRecordsInSet(del_set)
-  ExportView(mode_vw + ""|"", ""CSV"", Args.tmode_table, , {""CSV Header"": true})
+  ExportView(mode_vw + ""|"", ""CSV"", Args.tmode_table, , {""CSV Header"": ""true""})
   CloseView(mode_vw)
 
   CloseMap(map)"
Triangle-Modeling-and-Analytics,TRMG2,6e7c48172f80a43e8d81116c76ed3569c23b104d,Kyle Ward,kyle@caliper.com,2021-03-18T19:08:26Z,Kyle Ward,kyle@caliper.com,2021-03-18T19:08:26Z,"Fix transit mode table

mode_id has to be the second column",master/networks/transit_mode_table.csv,False,False,False,False,7,7,14,"---FILE: master/networks/transit_mode_table.csv---
@@ -1,7 +1,7 @@
-mode_name,abbr,mode_id,impedance,net_defs,lb,eb,brt,cr,lr,description
-Non-Transit,nt,1,,.---->,1,1,1,1,1,The net_def fields specify
-Local Bus,lb,2,,.---->,2,1,1,1,1,1: mode is active in network
-Express Bus,eb,3,,.---->,,2,1,1,1,2: mode is required in the network
-Bus Rapid Transit,brt,4,,.---->,,,2,1,1,
-Commuter Rail,cr,5,,.---->,,,,2,1,
-Light Rail,lr,6,,.---->,,,,,2,
+mode_name,mode_id,abbr,impedance,net_defs,lb,eb,brt,cr,lr,description
+Non-Transit,1,nt,,.---->,1,1,1,1,1,The net_def fields specify
+Local Bus,2,lb,,.---->,2,1,1,1,1,1: mode is active in network
+Express Bus,3,eb,,.---->,,2,1,1,1,2: mode is required in the network
+Bus Rapid Transit,4,brt,,.---->,,,2,1,1,
+Commuter Rail,5,cr,,.---->,,,,2,1,
+Light Rail,6,lr,,.---->,,,,,2,"
Triangle-Modeling-and-Analytics,TRMG2,bda5b21cf90ac061fe33d12b90e8db6076d6b2bf,Kyle Ward,kyle@caliper.com,2021-02-10T19:16:24Z,Kyle Ward,kyle@caliper.com,2021-02-10T19:16:24Z,"Complete first draft of the non-work, NHB regression models",docs/data/output/nhb/N_NH_K12_All_hov.csv;docs/data/output/nhb/N_NH_K12_All_sov.csv;docs/data/output/nhb/N_NH_K12_All_walk.csv;docs/data/output/nhb/N_NH_OME_All_auto_pay.csv;docs/data/output/nhb/N_NH_OME_All_bike.csv;docs/data/output/nhb/N_NH_OME_All_hov.csv;docs/data/output/nhb/N_NH_OME_All_sov.csv;docs/data/output/nhb/N_NH_OME_All_t.csv;docs/data/output/nhb/N_NH_OME_All_walk.csv;docs/data/output/nhb/N_NH_O_All_auto_pay.csv;docs/data/output/nhb/N_NH_O_All_bike.csv;docs/data/output/nhb/N_NH_O_All_hov.csv;docs/data/output/nhb/N_NH_O_All_sov.csv;docs/data/output/nhb/N_NH_O_All_t.csv;docs/data/output/nhb/N_NH_O_All_walk.csv;docs/nhb.Rmd;docs/nhb.html,True,False,True,False,3829,41,3870,"---FILE: docs/data/output/nhb/N_NH_K12_All_hov.csv---
@@ -0,0 +1,5 @@
+trip_type,estimated_as,estimate,std.error,statistic,p.value
+N_HB_K12_All_hov,N_HB_K12_All_hov,0.07793669653454269,0.0032294077493293773,24.133433305449618,0
+N_HB_OD_Long_hov,N_HB_OD_Long_hov,0.01950999897926513,0.002681602152345971,7.275500939688991,0
+N_HB_OD_Short_hov,N_HB_OD_Short_hov,0.05861760023847831,0.00366036253610813,16.01415151101489,0
+N_HB_K12_All_school_bus,N_HB_K12_All_school_bus,0.014452735108801466,0.004801783787867325,3.009867946432577,0.00262

---FILE: docs/data/output/nhb/N_NH_K12_All_sov.csv---
@@ -0,0 +1,5 @@
+trip_type,estimated_as,estimate,std.error,statistic,p.value
+N_HB_K12_All_hov,N_HB_K12_All_hov,0.03513912671968735,0.001990695329994381,17.651684911415618,0
+N_HB_K12_All_sov,N_HB_K12_All_sov,0.01768370140995779,0.003223859287062378,5.48525845433887,0
+N_HB_OD_Long_sov,N_HB_OD_All_sov,0.0029741155903319767,0.0014331614919907202,2.0752131612194016,0.03799
+N_HB_OD_Short_sov,N_HB_OD_All_sov,0.0029741155903319767,0.0014331614919907202,2.0752131612194016,0.03799

---FILE: docs/data/output/nhb/N_NH_K12_All_walk.csv---
@@ -0,0 +1,9 @@
+trip_type,estimated_as,estimate,std.error,statistic,p.value
+N_HB_K12_All_hov,N_HB_K12_All_auto,0.0072287412300348665,8.922670939004209e-4,8.101544122215058,0
+N_HB_K12_All_sov,N_HB_K12_All_auto,0.0072287412300348665,8.922670939004209e-4,8.101544122215058,0
+N_HB_K12_All_school_bus,N_HB_K12_All_school_bus,0.006064343204628173,0.0016936572778247332,3.5806200487131474,3.4e-4
+N_HB_K12_All_walk,N_HB_K12_All_walk,0.016138605033617186,0.005676562493882045,2.8430242864428394,0.00448
+N_HB_OD_Short_hov,N_HB_OD_Short_hov,0.003386062244735359,0.0012919373719999991,2.620918256659396,0.00878
+N_HB_OMED_All_hov,N_HB_OMED_All_hov,0.004899714009958745,0.0024579074899866845,1.993449318137392,0.04623
+N_HB_K12_All_bike,N_HB_K12_All_bike,0.0275516916297784,0.014787991308361196,1.8631125117175684,0.06247
+N_HB_OD_Short_walk,N_HB_OD_Short_walk,0.001732389508060627,0.001104700117064011,1.5681988996840535,0.11686

---FILE: docs/data/output/nhb/N_NH_OME_All_auto_pay.csv---
@@ -0,0 +1,5 @@
+trip_type,estimated_as,estimate,std.error,statistic,p.value
+N_HB_OD_Long_auto_pay,N_HB_OD_Long_auto_pay,0.13942989575496,0.010150679628434292,13.736015799807742,0
+N_HB_OD_Short_auto_pay,N_HB_OD_Short_auto_pay,0.2815122657052007,0.02058493201439635,13.675647095084955,0
+N_HB_OME_All_auto_pay,N_HB_OME_All_auto_pay,0.22059061410581568,0.006657969062500015,33.131817230611404,0
+N_HB_OMED_All_auto_pay,N_HB_OMED_All_auto_pay,0.29826916254163455,0.011423344682374947,26.110493102938,0

---FILE: docs/data/output/nhb/N_NH_OME_All_bike.csv---
@@ -0,0 +1,6 @@
+trip_type,estimated_as,estimate,std.error,statistic,p.value
+N_HB_K12_All_bike,N_HB_K12_All_bike,0.03477158275638026,0.007456821519100067,4.66305686240653,0
+N_HB_OD_Long_bike,N_HB_OD_Long_bike,0.028691340683315757,0.002812949515982991,10.199735373953025,0
+N_HB_OD_Long_t,N_HB_OD_Long_t,0.013124066374703472,0.0038515314148274173,3.407493010229425,6.6e-4
+N_HB_OD_Short_bike,N_HB_OD_Short_bike,0.002981386632907895,0.0021736843701230684,1.3715821275096607,0.17022
+N_HB_OME_All_bike,N_HB_OME_All_bike,0.7071020785871575,0.006702896097464521,105.49202438847743,0

---FILE: docs/data/output/nhb/N_NH_OME_All_hov.csv---
@@ -0,0 +1,11 @@
+trip_type,estimated_as,estimate,std.error,statistic,p.value
+N_HB_K12_All_hov,N_HB_K12_All_hov,0.05395952475371577,0.01514172611207978,3.563631012363108,3.7e-4
+N_HB_K12_All_sov,N_HB_K12_All_sov,0.05520845288458617,0.024493645050479237,2.2539908931809225,0.02421
+N_HB_OD_Long_sov,N_HB_OD_All_sov,0.07895672156334714,0.010993331462874997,7.182237871202896,0
+N_HB_OD_Short_sov,N_HB_OD_All_sov,0.07895672156334714,0.010993331462874997,7.182237871202896,0
+N_HB_OD_Long_hov,N_HB_OD_Long_hov,0.16626580529333962,0.01238850812958559,13.420970754038759,0
+N_HB_OD_Short_hov,N_HB_OD_Short_hov,0.402032510330676,0.01701852010354563,23.62323562122871,0
+N_HB_OME_All_hov,N_HB_OME_All_hov,0.5231748323958757,0.009487089466548623,55.14597856809347,0
+N_HB_OME_All_sov,N_HB_OME_All_sov,0.033650441671700206,0.012318949216298777,2.7315999993878104,0.00631
+N_HB_OMED_All_auto_pay,N_HB_OMED_All_auto_pay,0.7629510883994958,0.20125943507093186,3.790883583324187,1.5e-4
+N_HB_OMED_All_hov,N_HB_OMED_All_hov,0.26942891349150233,0.03211996303625876,8.388207458002249,0

---FILE: docs/data/output/nhb/N_NH_OME_All_sov.csv---
@@ -0,0 +1,9 @@
+trip_type,estimated_as,estimate,std.error,statistic,p.value
+N_HB_K12_All_hov,N_HB_K12_All_hov,0.03752722573596717,0.013371372199968055,2.80653512405083,0.00502
+N_HB_K12_All_sov,N_HB_K12_All_sov,0.05865240535939088,0.021634073269361002,2.7111124488265763,0.00671
+N_HB_OD_Long_hov,N_HB_OD_All_hov,0.04146981383116402,0.008710476244657324,4.760912338932103,0
+N_HB_OD_Short_hov,N_HB_OD_All_hov,0.04146981383116402,0.008710476244657324,4.760912338932103,0
+N_HB_OD_Long_sov,N_HB_OD_Long_sov,0.09648108356497917,0.01174363752626964,8.215604692256397,0
+N_HB_OD_Short_sov,N_HB_OD_Short_sov,0.0929880981262314,0.017329857718186317,5.365773893726072,0
+N_HB_OME_All_sov,N_HB_OME_All_sov,0.6338303480660237,0.010894653239108697,58.17811123999372,0
+N_HB_OMED_All_sov,N_HB_OMED_All_sov,0.32297817066058626,0.03552000803549643,9.092851846706298,0

---FILE: docs/data/output/nhb/N_NH_OME_All_t.csv---
@@ -0,0 +1,7 @@
+trip_type,estimated_as,estimate,std.error,statistic,p.value
+N_HB_K12_All_t,N_HB_K12_All_t,0.30935764999491727,0.012363810052281907,25.02122312513376,0
+N_HB_OD_Long_t,N_HB_OD_Long_t,0.04587072520425764,0.007269115022715261,6.3103589722980296,0
+N_HB_OD_Short_t,N_HB_OD_Short_t,0.26767750548545854,0.008882922210717748,30.133946817916573,0
+N_HB_OME_All_other,N_HB_OME_All_other,0.25212431325956014,0.017104385581160775,14.740331481842677,0
+N_HB_OME_All_t,N_HB_OME_All_t,0.30072813031582446,0.007242186190221965,41.52449583826669,0
+N_HB_OME_All_walk,N_HB_OME_All_walk,0.009192692160848616,0.0023368656086622617,3.933770143551803,8e-5

---FILE: docs/data/output/nhb/N_NH_OME_All_walk.csv---
@@ -0,0 +1,20 @@
+trip_type,estimated_as,estimate,std.error,statistic,p.value
+N_HB_K12_All_t,N_HB_K12_All_t,0.07848968643472991,0.04757128370131431,1.6499383730643655,0.09898
+N_HB_OD_Long_hov,N_HB_OD_All_hov,0.006098216291662167,0.002766867840057284,2.2040143021561565,0.02754
+N_HB_OD_Short_hov,N_HB_OD_All_hov,0.006098216291662167,0.002766867840057284,2.2040143021561565,0.02754
+N_HB_OD_Long_t,N_HB_OD_All_t,0.06469971422368949,0.021714261792449768,2.979595384918226,0.00289
+N_HB_OD_Short_t,N_HB_OD_All_t,0.06469971422368949,0.021714261792449768,2.979595384918226,0.00289
+N_HB_OD_Long_walk,N_HB_OD_Long_walk,0.03977246912403797,0.00830736423494095,4.7876159030988585,0
+N_HB_OD_Short_sov,N_HB_OD_Short_sov,0.012696975594403817,0.005492923954562153,2.3115149052552115,0.02082
+N_HB_OD_Short_walk,N_HB_OD_Short_walk,0.01432269122828929,0.004042052006973544,3.5434208178368536,4e-4
+N_HB_OD_Long_auto_pay,N_HB_OME_All_auto_pay,0.6074988914697858,0.022986781439603723,26.428184087709266,0
+N_HB_OME_All_auto_pay,N_HB_OME_All_auto_pay,0.6074988914697858,0.022986781439603723,26.428184087709266,0
+N_HB_OMED_All_auto_pay,N_HB_OME_All_auto_pay,0.6074988914697858,0.022986781439603723,26.428184087709266,0
+N_HB_OME_All_bike,N_HB_OME_All_bike,0.11970527239702165,0.04816160029774252,2.4854920031100507,0.01295
+N_HB_OME_All_hov,N_HB_OME_All_hov,0.007381968479617006,0.002655136294769937,2.780259715540004,0.00544
+N_HB_OME_All_other,N_HB_OME_All_other,0.19853175851535365,0.06586767085460907,3.014100179032844,0.00258
+N_HB_OME_All_sov,N_HB_OME_All_sov,0.025883836685930445,0.0034414705064789437,7.521156039896694,0
+N_HB_OME_All_t,N_HB_OME_All_t,0.08392756890200555,0.02780099196169011,3.0188695791020015,0.00254
+N_HB_OME_All_walk,N_HB_OME_All_walk,0.17108472454768905,0.009001019278242902,19.007261206653773,0
+N_HB_OMED_All_hov,N_HB_OMED_All_hov,0.016156282205957793,0.008991811198807646,1.7967772953351364,0.07239
+N_HB_OMED_All_walk,N_HB_OMED_All_walk,1.501760157471763,0.152868700624336,9.823856363914757,0

---FILE: docs/data/output/nhb/N_NH_O_All_auto_pay.csv---
@@ -0,0 +1,5 @@
+trip_type,estimated_as,estimate,std.error,statistic,p.value
+N_HB_OD_Short_sov,N_HB_OD_Short_sov,0.012849797078261987,0.0016923473580654667,7.592883941362176,0
+N_HB_OD_Long_auto_pay,N_HB_OD_Long_auto_pay,0.44460685584814785,0.015415111315032782,28.842273452451053,0
+N_HB_OD_Short_hov,N_HB_OD_Short_hov,-0.002253599668786399,0.0014672329555160998,-1.535952188310611,0.12457
+N_HB_OD_Short_auto_pay,N_HB_OD_Short_auto_pay,0.0386839614216968,0.031336674497541524,1.2344628791013448,0.21705

---FILE: docs/data/output/nhb/N_NH_O_All_bike.csv---
@@ -0,0 +1,4 @@
+trip_type,estimated_as,estimate,std.error,statistic,p.value
+N_HB_OD_Long_bike,N_HB_OD_Long_bike,0.13886601160815068,0.008262950726662588,16.80586223999411,0
+N_HB_OD_Short_bike,N_HB_OD_Short_bike,0.12783767200782425,0.006385179626671986,20.020998543850585,0
+N_HB_OME_All_bike,N_HB_OME_All_bike,0.08134558655273551,0.0196607491404277,4.137461190909937,4e-5

---FILE: docs/data/output/nhb/N_NH_O_All_hov.csv---
@@ -0,0 +1,10 @@
+trip_type,estimated_as,estimate,std.error,statistic,p.value
+N_HB_OD_Long_hov,N_HB_OD_Long_auto,0.05813316044769728,0.00565290185301211,10.283773176907614,0
+N_HB_OD_Long_sov,N_HB_OD_Long_auto,0.05813316044769728,0.00565290185301211,10.283773176907614,0
+N_HB_OD_Short_hov,N_HB_OD_Short_hov,0.32221431075011114,0.010885036049119834,29.601584165278485,0
+N_HB_OME_All_hov,N_HB_OME_All_hov,0.02962043308552312,0.005980523232000688,4.952816323332645,0
+N_HB_OD_Short_sov,N_HB_OD_Short_sov,0.15705228833103094,0.012536739867079255,12.52736277502583,0
+N_HB_K12_All_hov,N_HB_K12_All_auto,0.06533150842787427,0.007334132317174743,8.907871524881529,0
+N_HB_K12_All_sov,N_HB_K12_All_auto,0.06533150842787427,0.007334132317174743,8.907871524881529,0
+N_HB_OMED_All_hov,N_HB_OMED_All_hov,0.08222401087705708,0.020265440109782262,4.0573513544059185,5e-5
+N_HB_OME_All_sov,N_HB_OME_All_sov,0.014234766862255577,0.007763805435932947,1.8334780514170677,0.06675

---FILE: docs/data/output/nhb/N_NH_O_All_sov.csv---
@@ -0,0 +1,11 @@
+trip_type,estimated_as,estimate,std.error,statistic,p.value
+N_HB_K12_All_hov,N_HB_K12_All_auto,0.02480625834699231,0.004459723857426874,5.562285724413613,0
+N_HB_K12_All_sov,N_HB_K12_All_auto,0.02480625834699231,0.004459723857426874,5.562285724413613,0
+N_HB_OD_Long_hov,N_HB_OD_All_hov,0.021759459418517178,0.003777745394227552,5.759906279487743,0
+N_HB_OD_Short_hov,N_HB_OD_All_hov,0.021759459418517178,0.003777745394227552,5.759906279487743,0
+N_HB_OD_Long_sov,N_HB_OD_All_sov,0.1074580878335669,0.004204496707492355,25.55789558404888,0
+N_HB_OD_Short_sov,N_HB_OD_All_sov,0.1074580878335669,0.004204496707492355,25.55789558404888,0
+N_HB_OME_All_sov,N_HB_OME_All_sov,0.029258822533808338,0.004455961552802156,6.5662197007532,0
+N_HB_OMED_All_sov,N_HB_OME_All_sov,0.029258822533808338,0.004455961552802156,6.5662197007532,0
+N_HB_OME_All_hov,N_HB_OME_All_hov,0.0017411639886988717,0.003455444749381568,0.5038899808803174,0.61435
+N_HB_OMED_All_hov,N_HB_OME_All_hov,0.0017411639886988717,0.003455444749381568,0.5038899808803174,0.61435

---FILE: docs/data/output/nhb/N_NH_O_All_t.csv---
@@ -0,0 +1,8 @@
+trip_type,estimated_as,estimate,std.error,statistic,p.value
+N_HB_OD_Long_t,N_HB_OD_Long_t,0.07620835967957441,0.01433598736877167,5.315877987279789,0
+N_HB_OD_Short_t,N_HB_OD_Short_t,0.9429020604865948,0.018231591940333094,51.7180322800362,0
+N_HB_OMED_All_t,N_HB_OMED_All_t,0.3572773117711579,0.02696455205411343,13.249888633571995,0
+N_HB_K12_All_walk,N_HB_K12_All_walk,0.03729143497725348,0.010630682559823534,3.5079059850953263,4.5e-4
+N_HB_OME_All_t,N_HB_OME_All_t,0.04911792147448753,0.014261444067989766,3.444105746958273,5.7e-4
+N_HB_OD_Short_walk,N_HB_OD_Short_walk,0.0059315667429366906,0.002069189672827255,2.866613351511678,0.00416
+N_HB_OD_Short_sov,N_HB_OD_Short_sov,0.008324334651318564,0.002788922401484647,2.984785323136711,0.00284

---FILE: docs/data/output/nhb/N_NH_O_All_walk.csv---
@@ -0,0 +1,8 @@
+trip_type,estimated_as,estimate,std.error,statistic,p.value
+N_HB_OD_Short_hov,N_HB_OD_Short_hov,0.04453302451440506,0.005421907496454074,8.213534543613967,0
+N_HB_OD_Short_sov,N_HB_OD_OME_sov,0.028143946596728853,0.0032744254374350175,8.595079391630637,0
+N_HB_OME_All_sov,N_HB_OD_OME_sov,0.028143946596728853,0.0032744254374350175,8.595079391630637,0
+N_HB_OD_Short_walk,N_HB_OD_Short_walk,0.02620519041942996,0.004603223410059028,5.692791351852707,0
+N_HB_OME_All_walk,N_HB_OME_All_walk,0.10965253616401544,0.01025205131670218,10.695667898713545,0
+N_HB_OD_Long_walk,N_HB_OD_Long_walk,0.024615404262831906,0.009466500911542247,2.600264289080563,0.00933
+N_HB_OD_Short_t,N_HB_OD_Short_t,0.0745683348752084,0.038576534498463516,1.932997244171283,0.05326

---FILE: docs/nhb.Rmd---
@@ -2,7 +2,9 @@
 title: ""Non-Homebased Trips""
 author: ""Caliper Corporation""
 date: ""2/2/2021""
-output: html_document
+output: 
+  html_document:
+    toc_depth: 4
 editor_options: 
   chunk_output_type: console
 ---
@@ -18,12 +20,30 @@ library(kableExtra)
 source(""R/estimate_nhb.R"")
 ```
 
-## R Markdown
+## Introduction
+
+*TODO: Add*
+
+Modes:
+
+- SOV
+- HOV
+- Transit
+- Non-motorized
 
 ```{r, include = FALSE}
 trips <- read_csv(
   ""data/output/_PRIVATE/survey_processing/trips_processed.csv"") %>%
-  mutate(trip_type = paste0(trip_type, ""_"", mode_simple2))
+  mutate(
+    mode_simple2 = case_when(
+      mode_simple2 == ""bus"" ~ ""t"",
+      TRUE ~ mode_simple2
+    ),
+    trip_type = paste0(trip_type, ""_"", mode_simple2)
+  )
+
+# hold all model tables in a list
+output_list <- list()
 ```
 
 ```{r}
@@ -37,9 +57,476 @@ make_table <- function(df) {
 # unique(trips$mode_simple2)
 ```
 
+## Non-work types
+
+### N_NH_K12_All
+
+These are non-home-based trips with one trend end at school (K-12). This
+includes children attending school and parents dropping off children at school.
+The ""All"" means that this type does not separate short from long duration
+activities.
+
+#### SOV
+
+```{r, N_NH_K12_All_sov}
+type <- ""N_NH_K12_All_sov""
+model1 <- estimate_nhb(trips, type, dependent_vars = NULL)
+
+# After running regression on the raw trip types, this table collapses
+# some together.
+collapse_type <- trips %>%
+  mutate(
+    trip_type_orig = trip_type,
+    trip_type = case_when(
+      trip_type == ""N_HB_OD_Long_sov"" ~ ""N_HB_OD_All_sov"",
+      trip_type == ""N_HB_OD_Short_sov"" ~ ""N_HB_OD_All_sov"",
+      trip_type == ""N_HB_OD_Long_hov"" ~ ""N_HB_OD_All_hov"",
+      trip_type == ""N_HB_OD_Short_hov"" ~ ""N_HB_OD_All_hov"",
+      TRUE ~ trip_type
+    )
+  )
+model2 <- estimate_nhb(collapse_type, type, dependent_vars = NULL)
+
+# Finally select only the significant terms and re-estimate
+terms_to_use <- c(
+  ""N_HB_K12_All_hov"",
+  ""N_HB_K12_All_sov"",
+  ""N_HB_OD_All_sov""
+)
+model3 <- estimate_nhb(
+  collapse_type, type, dependent_vars = terms_to_use
+) %>%
+  left_join(
+    collapse_type %>%
+      select(trip_type, trip_type_orig) %>%
+      group_by(trip_type_orig) %>%
+      slice(1),
+    by = c(""term"" = ""trip_type"")
+  ) %>%
+  relocate(trip_type_orig, .before = term) %>%
+  rename(trip_type = trip_type_orig, estimated_as = term)
+
+output_list[type] <- list(model3)
+
+model3 %>%
+  make_table()
+```
+
+#### HOV
+
+```{r, N_NH_K12_All_hov}
+type <- ""N_NH_K12_All_hov""
+model1 <- estimate_nhb(trips, type, dependent_vars = NULL)
+
+# Collapse any purposes together
+collapse_type <- trips %>%
+  mutate(
+    trip_type_orig = trip_type
+  )
+model2 <- estimate_nhb(collapse_type, type, dependent_vars = NULL)
+
+# Finally select only the significant terms and re-estimate
+terms_to_use <- c(
+  ""N_HB_K12_All_hov"",
+  ""N_HB_OD_Long_hov"",
+  ""N_HB_OD_Short_hov"",
+  ""N_HB_K12_All_school_bus""
+)
+model3 <- estimate_nhb(
+  collapse_type, type, dependent_vars = terms_to_use
+) %>%
+  left_join(
+    collapse_type %>%
+      select(trip_type, trip_type_orig) %>%
+      group_by(trip_type_orig) %>%
+      slice(1),
+    by = c(""term"" = ""trip_type"")
+  ) %>%
+  relocate(trip_type_orig, .before = term) %>%
+  rename(trip_type = trip_type_orig, estimated_as = term)
+
+output_list[type] <- list(model3)
+
+model3 %>%
+  make_table()
+```
+
+#### Auto Pay
+
+There was only one observed trip in this category, so no model was estimated.
+
+```{r, N_NH_K12_All_auto_pay}
+type <- ""N_NH_K12_All_auto_pay""
+#Only 1 record
+n_records <- trips %>%
+  filter(trip_type == type) %>%
+  nrow()
+```
+
+#### Transit
+
+There were only five trips observed in this category, so no model was estimated.
+
+```{r, N_NH_K12_All_t}
+type <- ""N_NH_K12_All_t""
+n_records <- trips %>%
+  filter(trip_type == type) %>%
+  nrow()
+```
+
+#### Walk
+
+```{r, N_NH_K12_All_walk}
+type <- ""N_NH_K12_All_walk""
+model1 <- estimate_nhb(trips, type, dependent_vars = NULL)
+
+# Collapse types
+collapse_type <- trips %>%
+  mutate(
+    trip_type_orig = trip_type,
+    trip_type = case_when(
+      trip_type == ""N_HB_K12_All_sov"" ~ ""N_HB_K12_All_auto"",
+      trip_type == ""N_HB_K12_All_hov"" ~ ""N_HB_K12_All_auto"",
+      TRUE ~ trip_type
+    )
+  )
+model2 <- estimate_nhb(collapse_type, type, dependent_vars = NULL)
+
+# Finally select only the significant terms and re-estimate
+terms_to_use <- c(
+  ""N_HB_K12_All_auto"",
+  ""N_HB_K12_All_school_bus"",
+  ""N_HB_K12_All_walk"",
+  ""N_HB_OD_Short_hov"",
+  ""N_HB_OMED_All_hov"",
+  ""N_HB_K12_All_bike"",
+  ""N_HB_OD_Short_walk""
+)
+model3 <- estimate_nhb(
+  collapse_type, type, dependent_vars = terms_to_use
+) %>%
+  left_join(
+    collapse_type %>%
+      select(trip_type, trip_type_orig) %>%
+      group_by(trip_type_orig) %>%
+      slice(1),
+    by = c(""term"" = ""trip_type"")
+  ) %>%
+  relocate(trip_type_orig, .before = term) %>%
+  rename(trip_type = trip_type_orig, estimated_as = term)
+
+output_list[type] <- list(model3)
+
+model3 %>%
+  make_table()
+```
+
+#### Bike
+
+There was only one trip observed in this category, so no model was estimated.
+
+```{r, N_NH_K12_All_bike}
+type <- ""N_NH_K12_All_bike""
+n_records <- trips %>%
+  filter(trip_type == type) %>%
+  nrow()
+```
+
+### N_NH_OME_All
+
+These non-home-based trips are those where neither end is a K12 school and at
+least one end is an ""OME"" activity type. This includes the most common reasons
+people spend money: shopping, dining, and maintenance activities. The ""All""
+means that this trip includes all activity durations.
+
+#### SOV
+
+```{r, N_NH_OME_All_sov}
+type <- ""N_NH_OME_All_sov""
+model1 <- estimate_nhb(trips, type, dependent_vars = NULL)
+
+# After running regression on the raw trip types, this table collapses
+# some together.
+collapse_type <- trips %>%
+  mutate(
+    trip_type_orig = trip_type,
+    trip_type = case_when(
+      trip_type == ""N_HB_OD_Long_hov"" ~ ""N_HB_OD_All_hov"",
+      trip_type == ""N_HB_OD_Short_hov"" ~ ""N_HB_OD_All_hov"",
+      TRUE ~ trip_type
+    )
+  )
+model2 <- estimate_nhb(collapse_type, type, dependent_vars = NULL)
+
+# Finally select only the significant terms and re-estimate
+terms_to_use <- c(
+  ""N_HB_K12_All_hov"",
+  ""N_HB_K12_All_sov"",
+  ""N_HB_OD_All_hov"",
+  ""N_HB_OD_Long_sov"",
+  ""N_HB_OD_Short_sov"",
+  ""N_HB_OME_All_sov"",
+  ""N_HB_OMED_All_sov""
+)
+model3 <- estimate_nhb(
+  collapse_type, type, dependent_vars = terms_to_use
+) %>%
+  left_join(
+    collapse_type %>%
+      select(trip_type, trip_type_orig) %>%
+      group_by(trip_type_orig) %>%
+      slice(1),
+    by = c(""term"" = ""trip_type"")
+  ) %>%
+  relocate(trip_type_orig, .before = term) %>%
+  rename(trip_type = trip_type_orig, estimated_as = term)
+
+output_list[type] <- list(model3)
+
+model3 %>%
+  make_table()
+```
+
+#### HOV
+
+```{r, N_NH_OME_All_hov}
+type <- ""N_NH_OME_All_hov""
+model1 <- estimate_nhb(trips, type, dependent_vars = NULL)
+
+# After running regression on the raw trip types, this table collapses
+# some together.
+collapse_type <- trips %>%
+  mutate(
+    trip_type_orig = trip_type,
+    trip_type = case_when(
+      trip_type == ""N_HB_OD_Long_sov"" ~ ""N_HB_OD_All_sov"",
+      trip_type == ""N_HB_OD_Short_sov"" ~ ""N_HB_OD_All_sov"",
+      TRUE ~ trip_type
+    )
+  )
+model2 <- estimate_nhb(collapse_type, type, dependent_vars = NULL)
+
+# Finally select only the significant terms and re-estimate
+terms_to_use <- c(
+  ""N_HB_K12_All_hov"",
+  ""N_HB_K12_All_sov"",
+  ""N_HB_OD_All_sov"",
+  ""N_HB_OD_Long_hov"",
+  ""N_HB_OD_Short_hov"",
+  ""N_HB_OME_All_hov"",
+  ""N_HB_OME_All_sov"",
+  ""N_HB_OMED_All_auto_pay"",
+  ""N_HB_OMED_All_hov""
+)
+model3 <- estimate_nhb(
+  collapse_type, type, dependent_vars = terms_to_use
+) %>%
+  left_join(
+    collapse_type %>%
+      select(trip_type, trip_type_orig) %>%
+      group_by(trip_type_orig) %>%
+      slice(1),
+    by = c(""term"" = ""trip_type"")
+  ) %>%
+  relocate(trip_type_orig, .before = term) %>%
+  rename(trip_type = trip_type_orig, estimated_as = term)
+
+output_list[type] <- list(model3)
+
+model3 %>%
+  make_table()
+```
+
+#### Auto Pay
+
+```{r, N_NH_OME_All_auto_pay}
+type <- ""N_NH_OME_All_auto_pay""
+#Only 48 records
+n_records <- trips %>%
+  filter(trip_type == type) %>%
+  nrow()
+
+model1 <- estimate_nhb(trips, type, dependent_vars = NULL)
+
+# No collapsing needed for this type
+collapse_type <- trips %>%
+  mutate(trip_type_orig = trip_type)
+model2 <- estimate_nhb(collapse_type, type, dependent_vars = NULL)
+
+# Finally select only the significant terms and re-estimate
+terms_to_use <- c(
+  ""N_HB_OD_Long_auto_pay"",
+  ""N_HB_OD_Short_auto_pay"",
+  ""N_HB_OME_All_auto_pay"",
+  ""N_HB_OMED_All_auto_pay""
+)
+model3 <- estimate_nhb(
+  collapse_type, type, dependent_vars = terms_to_use
+) %>%
+  left_join(
+    collapse_type %>%
+      select(trip_type, trip_type_orig) %>%
+      group_by(trip_type_orig) %>%
+      slice(1),
+    by = c(""term"" = ""trip_type"")
+  ) %>%
+  relocate(trip_type_orig, .before = term) %>%
+  rename(trip_type = trip_type_orig, estimated_as = term)
+
+output_list[type] <- list(model3)
+
+model3 %>%
+  make_table()
+```
+
+#### Transit
+
+```{r, N_NH_OME_All_t}
+type <- ""N_NH_OME_All_t""
+model1 <- estimate_nhb(trips, type, dependent_vars = NULL)
+
+# No collapsing needed for this type
+collapse_type <- trips %>%
+  mutate(trip_type_orig = trip_type)
+
+# Finally select only the significant terms and re-estimate
+terms_to_use <- c(
+  ""N_HB_K12_All_t"",
+  ""N_HB_OD_Long_t"",
+  ""N_HB_OD_Short_t"",
+  ""N_HB_OME_All_other"",
+  ""N_HB_OME_All_t"",
+  ""N_HB_OME_All_walk""
+)
+model3 <- estimate_nhb(
+  collapse_type, type, dependent_vars = terms_to_use
+) %>%
+  left_join(
+    collapse_type %>%
+      select(trip_type, trip_type_orig) %>%
+      group_by(trip_type_orig) %>%
+      slice(1),
+    by = c(""term"" = ""trip_type"")
+  ) %>%
+  relocate(trip_type_orig, .before = term) %>%
+  rename(trip_type = trip_type_orig, estimated_as = term)
+
+output_list[type] <- list(model3)
+
+model3 %>%
+  make_table()
+```
+
+#### Walk
+
+```{r, N_NH_OME_All_walk}
+type <- ""N_NH_OME_All_walk""
+model1 <- estimate_nhb(trips, type, dependent_vars = NULL)
+
+# Collapse types
+collapse_type <- trips %>%
+  mutate(
+    trip_type_orig = trip_type,
+    trip_type = case_when(
+      trip_type == ""N_HB_OME_All_auto_pay"" ~ ""N_HB_OME_All_auto_pay"",
+      trip_type == ""N_HB_OMED_All_auto_pay"" ~ ""N_HB_OME_All_auto_pay"",
+      trip_type == ""N_HB_OD_Long_auto_pay"" ~ ""N_HB_OME_All_auto_pay"",
+      trip_type == ""N_HB_OD_Long_hov"" ~ ""N_HB_OD_All_hov"",
+      trip_type == ""N_HB_OD_Short_hov"" ~ ""N_HB_OD_All_hov"",
+      trip_type == ""N_HB_OD_Short_t"" ~ ""N_HB_OD_All_t"",
+      trip_type == ""N_HB_OD_Long_t"" ~ ""N_HB_OD_All_t"",
+      TRUE ~ trip_type
+    )
+  )
+model2 <- estimate_nhb(collapse_type, type, dependent_vars = NULL)
+
+# Finally select only the significant terms and re-estimate
+terms_to_use <- c(
+  ""N_HB_K12_All_t"",
+  ""N_HB_OD_All_hov"",
+  ""N_HB_OD_All_t"",
+  ""N_HB_OD_Long_walk"",
+  ""N_HB_OD_Short_sov"",
+  ""N_HB_OD_Short_walk"",
+  ""N_HB_OME_All_auto_pay"",
+  ""N_HB_OME_All_bike"",
+  ""N_HB_OME_All_hov"",
+  ""N_HB_OME_All_other"",
+  ""N_HB_OME_All_sov"",
+  ""N_HB_OME_All_t"",
+  ""N_HB_OME_All_walk"",
+  ""N_HB_OMED_All_hov"",
+  ""N_HB_OMED_All_walk""
+)
+model3 <- estimate_nhb(
+  collapse_type, type, dependent_vars = terms_to_use
+) %>%
+  left_join(
+    collapse_type %>%
+      select(trip_type, trip_type_orig) %>%
+      group_by(trip_type_orig) %>%
+      slice(1),
+    by = c(""term"" = ""trip_type"")
+  ) %>%
+  relocate(trip_type_orig, .before = term) %>%
+  rename(trip_type = trip_type_orig, estimated_as = term)
+
+output_list[type] <- list(model3)
+
+model3 %>%
+  make_table()
+```
+
+#### Bike
+
+```{r, N_NH_OME_All_bike}
+type <- ""N_NH_OME_All_bike""
+model1 <- estimate_nhb(trips, type, dependent_vars = NULL)
+
+# No collapsing needed for this type
+collapse_type <- trips %>%
+  mutate(trip_type_orig = trip_type)
+model2 <- estimate_nhb(collapse_type, type, dependent_vars = NULL)
+
+# Finally select only the significant terms and re-estimate
+terms_to_use <- c(
+  ""N_HB_K12_All_bike"",
+  ""N_HB_OD_Long_bike"",
+  ""N_HB_OD_Long_t"",
+  ""N_HB_OD_Short_bike"",
+  ""N_HB_OME_All_bike""
+)
+model3 <- estimate_nhb(
+  collapse_type, type, dependent_vars = terms_to_use
+) %>%
+  left_join(
+    collapse_type %>%
+      select(trip_type, trip_type_orig) %>%
+      group_by(trip_type_orig) %>%
+      slice(1),
+    by = c(""term"" = ""trip_type"")
+  ) %>%
+  relocate(trip_type_orig, .before = term) %>%
+  rename(trip_type = trip_type_orig, estimated_as = term)
+
+output_list[type] <- list(model3)
+
+model3 %>%
+  make_table()
+```
+
+
+### N_NH_O_All
+
+These non-home-based trips are those where neither end is a K12 school or
+a shopping/dining/maintenance activity (OME). The ""All"" means that this trip
+includes all activity durations.
+
+#### SOV
 
 ```{r, N_NH_O_All_sov}
-model1 <- estimate_nhb(trips, ""N_NH_O_All_sov"", dependent_vars = NULL)
+type <- ""N_NH_O_All_sov""
+model1 <- estimate_nhb(trips, type, dependent_vars = NULL)
 
 # After running regression on the raw trip types, this table collapses
 # some together.
@@ -53,20 +540,14 @@ collapse_type <- trips %>%
       trip_type == ""N_HB_OD_Short_hov"" ~ ""N_HB_OD_All_hov"",
       trip_type == ""N_HB_OD_Long_sov"" ~ ""N_HB_OD_All_sov"",
       trip_type == ""N_HB_OD_Short_sov"" ~ ""N_HB_OD_All_sov"",
-      
-      # trip_type == ""N_HB_OMED_All_hov"" ~ ""N_HB_OMED_All_auto"",
-      # trip_type == ""N_HB_OMED_All_sov"" ~ ""N_HB_OMED_All_auto"",
-      
       trip_type == ""N_HB_OMED_All_hov"" ~ ""N_HB_OME_All_hov"",
       trip_type == ""N_HB_OME_All_hov"" ~ ""N_HB_OME_All_hov"",
-      
       trip_type == ""N_HB_OMED_All_sov"" ~ ""N_HB_OME_All_sov"",
       trip_type == ""N_HB_OME_All_sov"" ~ ""N_HB_OME_All_sov"",
-      
       TRUE ~ trip_type
     )
   )
-model2 <- estimate_nhb(collapse_type, ""N_NH_O_All_sov"", dependent_vars = NULL)
+model2 <- estimate_nhb(collapse_type, type, dependent_vars = NULL)
 
 # Finally select only the significant terms and re-estimate
 terms_to_use <- c(
@@ -77,7 +558,7 @@ terms_to_use <- c(
   ""N_HB_OME_All_hov""
 )
 model3 <- estimate_nhb(
-  collapse_type, ""N_NH_O_All_sov"", dependent_vars = terms_to_use
+  collapse_type, type, dependent_vars = terms_to_use
 ) %>%
   left_join(
     collapse_type %>%
@@ -89,12 +570,17 @@ model3 <- estimate_nhb(
   relocate(trip_type_orig, .before = term) %>%
   rename(trip_type = trip_type_orig, estimated_as = term)
 
+output_list[type] <- list(model3)
+
 model3 %>%
   make_table()
 ```
 
+#### HOV
+
 ```{r, N_NH_O_All_hov}
-model1 <- estimate_nhb(trips, ""N_NH_O_All_hov"", dependent_vars = NULL)
+type <- ""N_NH_O_All_hov""
+model1 <- estimate_nhb(trips, type, dependent_vars = NULL)
 
 # After running regression on the raw trip types, this table collapses
 # some together.
@@ -109,7 +595,7 @@ collapse_type <- trips %>%
       TRUE ~ trip_type
     )
   )
-model2 <- estimate_nhb(collapse_type, ""N_NH_O_All_hov"", dependent_vars = NULL)
+model2 <- estimate_nhb(collapse_type, type, dependent_vars = NULL)
 
 # Finally select only the significant terms and re-estimate
 terms_to_use <- c(
@@ -122,7 +608,7 @@ terms_to_use <- c(
   ""N_HB_OME_All_sov""
 )
 model3 <- estimate_nhb(
-  collapse_type, ""N_NH_O_All_hov"", dependent_vars = terms_to_use
+  collapse_type, type, dependent_vars = terms_to_use
 ) %>%
   left_join(
     collapse_type %>%
@@ -134,29 +620,76 @@ model3 <- estimate_nhb(
   relocate(trip_type_orig, .before = term) %>%
   rename(trip_type = trip_type_orig, estimated_as = term)
 
+output_list[type] <- list(model3)
+
 model3 %>%
   make_table()
 ```
 
-```{r, N_NH_O_All_bus}
-model1 <- estimate_nhb(trips, ""N_NH_O_All_bus"", dependent_vars = NULL)
+#### Auto Pay
+
+```{r, N_NH_O_All_auto_pay}
+type <- ""N_NH_O_All_auto_pay""
+#Only 45 records
+n_records <- trips %>%
+  filter(trip_type == type) %>%
+  nrow()
+
+model1 <- estimate_nhb(trips, type, dependent_vars = NULL)
 
 # No collapsing needed for this type
 collapse_type <- trips %>%
   mutate(trip_type_orig = trip_type)
+model2 <- estimate_nhb(collapse_type, type, dependent_vars = NULL)
 
 # Finally select only the significant terms and re-estimate
 terms_to_use <- c(
-  ""N_HB_OD_Long_bus"",
-  ""N_HB_OD_Short_bus"",
-  ""N_HB_OMED_All_bus"",
+  ""N_HB_OD_Short_sov"",
+  ""N_HB_OD_Long_auto_pay"",
+  ""N_HB_OD_Short_hov"",
+  ""N_HB_OD_Short_auto_pay""
+)
+model3 <- estimate_nhb(
+  collapse_type, type, dependent_vars = terms_to_use
+) %>%
+  left_join(
+    collapse_type %>%
+      select(trip_type, trip_type_orig) %>%
+      group_by(trip_type_orig) %>%
+      slice(1),
+    by = c(""term"" = ""trip_type"")
+  ) %>%
+  relocate(trip_type_orig, .before = term) %>%
+  rename(trip_type = trip_type_orig, estimated_as = term)
+
+output_list[type] <- list(model3)
+
+model3 %>%
+  make_table()
+```
+
+#### Transit
+
+```{r, N_NH_O_All_t}
+type <- ""N_NH_O_All_t""
+model1 <- estimate_nhb(trips, type, dependent_vars = NULL)
+
+# No collapsing needed for this type
+collapse_type <- trips %>%
+  mutate(trip_type_orig = trip_type)
+
+# Finally select only the significant terms and re-estimate
+terms_to_use <- c(
+  ""N_HB_OD_Long_t"",
+  ""N_HB_OD_Short_t"",
+  ""N_HB_OMED_All_t"",
   ""N_HB_K12_All_walk"",
-  ""N_HB_OME_All_bus"",
+  ""N_HB_OME_All_t"",
   ""N_HB_OD_Short_walk"",
   ""N_HB_OD_Short_sov""
 )
 model3 <- estimate_nhb(
-  collapse_type, ""N_NH_O_All_bus"", dependent_vars = terms_to_use
+  collapse_type, type, dependent_vars = terms_to_use
 ) %>%
   left_join(
     collapse_type %>%
@@ -168,14 +701,19 @@ model3 <- estimate_nhb(
   relocate(trip_type_orig, .before = term) %>%
   rename(trip_type = trip_type_orig, estimated_as = term)
 
+output_list[type] <- list(model3)
+
 model3 %>%
   make_table()
 ```
 
+#### Walk
+
 ```{r, N_NH_O_All_walk}
-model1 <- estimate_nhb(trips, ""N_NH_O_All_walk"", dependent_vars = NULL)
+type <- ""N_NH_O_All_walk""
+model1 <- estimate_nhb(trips, type, dependent_vars = NULL)
 
-# No collapsing needed for this type
+# Collapse types
 collapse_type <- trips %>%
   mutate(
     trip_type_orig = trip_type,
@@ -185,7 +723,7 @@ collapse_type <- trips %>%
       TRUE ~ trip_type
     )
   )
-model2 <- estimate_nhb(collapse_type, ""N_NH_O_All_walk"", dependent_vars = NULL)
+model2 <- estimate_nhb(collapse_type, type, dependent_vars = NULL)
 
 # Finally select only the significant terms and re-estimate
 terms_to_use <- c(
@@ -194,11 +732,10 @@ terms_to_use <- c(
   ""N_HB_OD_Short_walk"",
   ""N_HB_OME_All_walk"",
   ""N_HB_OD_Long_walk"",
-  ""N_HB_OD_Short_bus"",
-  ""N_HB_OME_All_sov""
+  ""N_HB_OD_Short_t""
 )
 model3 <- estimate_nhb(
-  collapse_type, ""N_NH_O_All_walk"", dependent_vars = terms_to_use
+  collapse_type, type, dependent_vars = terms_to_use
 ) %>%
   left_join(
     collapse_type %>%
@@ -210,32 +747,31 @@ model3 <- estimate_nhb(
   relocate(trip_type_orig, .before = term) %>%
   rename(trip_type = trip_type_orig, estimated_as = term)
 
+output_list[type] <- list(model3)
+
 model3 %>%
   make_table()
 ```
 
-```{r, N_NH_O_All_auto_pay}
-#Only 45 records
-n_records <- trips %>%
-  filter(trip_type == ""N_NH_O_All_auto_pay"") %>%
-  nrow()
+#### Bike
 
-model1 <- estimate_nhb(trips, ""N_NH_O_All_auto_pay"", dependent_vars = NULL)
+```{r, N_NH_O_All_bike}
+type <- ""N_NH_O_All_bike""
+model1 <- estimate_nhb(trips, type, dependent_vars = NULL)
 
 # No collapsing needed for this type
 collapse_type <- trips %>%
   mutate(trip_type_orig = trip_type)
-model2 <- estimate_nhb(collapse_type, ""N_NH_O_All_auto_pay"", dependent_vars = NULL)
+model2 <- estimate_nhb(collapse_type, type, dependent_vars = NULL)
 
 # Finally select only the significant terms and re-estimate
 terms_to_use <- c(
-  ""N_HB_OD_Short_sov"",
-  ""N_HB_OD_Long_auto_pay"",
-  ""N_HB_OD_Short_hov"",
-  ""N_HB_OD_Short_auto_pay""
+  ""N_HB_OD_Long_bike"",
+  ""N_HB_OD_Short_bike"",
+  ""N_HB_OME_All_bike""
 )
 model3 <- estimate_nhb(
-  collapse_type, ""N_NH_O_All_auto_pay"", dependent_vars = terms_to_use
+  collapse_type, type, dependent_vars = terms_to_use
 ) %>%
   left_join(
     collapse_type %>%
@@ -247,6 +783,21 @@ model3 <- estimate_nhb(
   relocate(trip_type_orig, .before = term) %>%
   rename(trip_type = trip_type_orig, estimated_as = term)
 
+output_list[type] <- list(model3)
+
 model3 %>%
   make_table()
-```
\ No newline at end of file
+```
+
+
+
+
+```{r write_output, eval=FALSE}
+output_dir <- ""data/output/nhb/""
+for (i in 1:length(output_list)) {
+  name <- names(output_list)[i]
+  df <- output_list[[i]]
+  write_csv(df, paste0(output_dir, name, "".csv""))
+}
+```
+"
Triangle-Modeling-and-Analytics,TRMG2,602c0e66c4addf3023d1601727de2883d37014b5,Kyle Ward,kyle@caliper.com,2021-01-14T19:08:18Z,Kyle Ward,kyle@caliper.com,2021-01-14T19:08:18Z,"Update website

The navigation bar now includes links to the interim draft documents.
Also updated the renv snapshot after ensuring all Rmds knitted without
error.",docs/_site.yml;docs/generation_disaggregation.html;docs/index.Rmd;docs/index.html;docs/networks.Rmd;docs/networks.html;docs/renv.lock;docs/survey_processing.html;docs/tazs_and_se_data.html;docs/time_of_day.html,True,False,True,False,763,182,945,"---FILE: docs/_site.yml---
@@ -3,15 +3,22 @@ output_dir: "".""
 navbar:
   title: ""TRMG2""
   left:
-    - text: Ch. 1
+    - text: Databases
       menu:
-        - text: ""Databases""
-        - text: ""Sample Placeholder""
-          href: Database-TAZ.html
-        - text: ""-----------------""
-        - text: ""Surveys""
-        - text: ""Sample Placeholder""
-          href: Survey-HHSurvey.html
+        - text: ""TAZs and SE Data""
+          href: tazs_and_se_data.html
+        - text: ""Networks""
+          href: networks.html
+    - text: Surveys
+      menu:
+        - text: ""Household Survey""
+          href: survey_processing.html
+    - text: Models
+      menu:
+        - text: ""Dissaggregation""
+          href: generation_disaggregation.html
+        - text: ""Time of Day""
+          href: time_of_day.html
 output:
   html_document:
     theme: flatly

---FILE: docs/index.Rmd---
@@ -1,9 +1,12 @@
 ---
-title: ""My Website""
+title: ""Triangle Regional Model G2""
+output:
+  html_document:
+    toc: false
 ---
 
-Hello, Website!
+This website is under construction.
 
-For more information about simple R Markdown websites, please read the documentation at https://bookdown.org/yihui/rmarkdown/rmarkdown-site.html.
-
-Please also note that simple R Markdown sites are _not_ based on **blogdown**. They are probably good for websites with only a few Rmd documents. For larger-scale and more sophisticated websites (such as blogs), you may want to use **blogdown** instead: https://github.com/rstudio/blogdown.
+As the new Triangle Regional Model is developed, documentation will be added
+to the navigation bar at the top. All documentation is an interim product and
+is subject to change during the development process.
\ No newline at end of file

---FILE: docs/index.html---
@@ -11,19 +11,27 @@
 
 
 
-<title>My Website</title>
+<title>Triangle Regional Model G2</title>
 
 <script src=""site_libs/jquery-1.11.3/jquery.min.js""></script>
 <meta name=""viewport"" content=""width=device-width, initial-scale=1"" />
 <link href=""site_libs/bootstrap-3.3.5/css/flatly.min.css"" rel=""stylesheet"" />
 <script src=""site_libs/bootstrap-3.3.5/js/bootstrap.min.js""></script>
 <script src=""site_libs/bootstrap-3.3.5/shim/html5shiv.min.js""></script>
 <script src=""site_libs/bootstrap-3.3.5/shim/respond.min.js""></script>
-<script src=""site_libs/jqueryui-1.11.4/jquery-ui.min.js""></script>
-<link href=""site_libs/tocify-1.9.1/jquery.tocify.css"" rel=""stylesheet"" />
-<script src=""site_libs/tocify-1.9.1/jquery.tocify.js""></script>
 <script src=""site_libs/navigation-1.1/tabsets.js""></script>
 <script src=""site_libs/accessible-code-block-0.0.1/empty-anchor.js""></script>
+<link href=""site_libs/anchor-sections-1.0/anchor-sections.css"" rel=""stylesheet"" />
+<script src=""site_libs/anchor-sections-1.0/anchor-sections.js""></script>
+
+<style type=""text/css"">
+  code{white-space: pre-wrap;}
+  span.smallcaps{font-variant: small-caps;}
+  span.underline{text-decoration: underline;}
+  div.column{display: inline-block; vertical-align: top; width: 50%;}
+  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
+  ul.task-list{list-style: none;}
+    </style>
 
 
 
@@ -236,69 +244,6 @@
 
 
 
-<style type=""text/css"">
-
-#TOC {
-  margin: 25px 0px 20px 0px;
-}
-@media (max-width: 768px) {
-#TOC {
-  position: relative;
-  width: 100%;
-}
-}
-
-@media print {
-.toc-content {
-  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
-  float: right;
-}
-}
-
-.toc-content {
-  padding-left: 30px;
-  padding-right: 40px;
-}
-
-div.main-container {
-  max-width: 1200px;
-}
-
-div.tocify {
-  width: 20%;
-  max-width: 260px;
-  max-height: 85%;
-}
-
-@media (min-width: 768px) and (max-width: 991px) {
-  div.tocify {
-    width: 25%;
-  }
-}
-
-@media (max-width: 767px) {
-  div.tocify {
-    width: 100%;
-    max-width: none;
-  }
-}
-
-.tocify ul, .tocify li {
-  line-height: 20px;
-}
-
-.tocify-subheader .tocify-item {
-  font-size: 0.90em;
-}
-
-.tocify .list-group-item {
-  border-radius: 0px;
-}
-
-
-</style>
-
-
 
 </head>
 
@@ -308,16 +253,6 @@
 <div class=""container-fluid main-container"">
 
 
-<!-- setup 3col/9col grid for toc_float and main content  -->
-<div class=""row-fluid"">
-<div class=""col-xs-12 col-sm-4 col-md-3"">
-<div id=""TOC"" class=""tocify"">
-</div>
-</div>
-
-<div class=""toc-content col-xs-12 col-sm-8 col-md-9"">
-
-
 
 
 <div class=""navbar navbar-default  navbar-fixed-top"" role=""navigation"">
@@ -334,19 +269,43 @@
       <ul class=""nav navbar-nav"">
         <li class=""dropdown"">
   <a href=""#"" class=""dropdown-toggle"" data-toggle=""dropdown"" role=""button"" aria-expanded=""false"">
-    Ch. 1
+    Databases
      
     <span class=""caret""></span>
   </a>
   <ul class=""dropdown-menu"" role=""menu"">
-    <li class=""dropdown-header"">Databases</li>
     <li>
-      <a href=""Database-TAZ.html"">Sample Placeholder</a>
+      <a href=""tazs_and_se_data.html"">TAZs and SE Data</a>
+    </li>
+    <li>
+      <a href=""networks.html"">Networks</a>
     </li>
-    <li class=""divider""></li>
-    <li class=""dropdown-header"">Surveys</li>
+  </ul>
+</li>
+<li class=""dropdown"">
+  <a href=""#"" class=""dropdown-toggle"" data-toggle=""dropdown"" role=""button"" aria-expanded=""false"">
+    Surveys
+     
+    <span class=""caret""></span>
+  </a>
+  <ul class=""dropdown-menu"" role=""menu"">
     <li>
-      <a href=""Survey-HHSurvey.html"">Sample Placeholder</a>
+      <a href=""survey_processing.html"">Household Survey</a>
+    </li>
+  </ul>
+</li>
+<li class=""dropdown"">
+  <a href=""#"" class=""dropdown-toggle"" data-toggle=""dropdown"" role=""button"" aria-expanded=""false"">
+    Models
+     
+    <span class=""caret""></span>
+  </a>
+  <ul class=""dropdown-menu"" role=""menu"">
+    <li>
+      <a href=""generation_disaggregation.html"">Dissaggregation</a>
+    </li>
+    <li>
+      <a href=""time_of_day.html"">Time of Day</a>
     </li>
   </ul>
 </li>
@@ -362,14 +321,13 @@
 
 
 
-<h1 class=""title toc-ignore"">My Website</h1>
+<h1 class=""title toc-ignore"">Triangle Regional Model G2</h1>
 
 </div>
 
 
-<p>Hello, Website!</p>
-<p>For more information about simple R Markdown websites, please read the documentation at <a href=""https://bookdown.org/yihui/rmarkdown/rmarkdown-site.html"" class=""uri"">https://bookdown.org/yihui/rmarkdown/rmarkdown-site.html</a>.</p>
-<p>Please also note that simple R Markdown sites are <em>not</em> based on <strong>blogdown</strong>. They are probably good for websites with only a few Rmd documents. For larger-scale and more sophisticated websites (such as blogs), you may want to use <strong>blogdown</strong> instead: <a href=""https://github.com/rstudio/blogdown"" class=""uri"">https://github.com/rstudio/blogdown</a>.</p>
+<p>This website is under construction.</p>
+<p>As the new Triangle Regional Model is developed, documentation will be added to the navigation bar at the top. All documentation is an interim product and is subject to change during the development process.</p>
 
 <br>
 <br>
@@ -378,16 +336,14 @@ <h1 class=""title toc-ignore"">My Website</h1>
 <p><a href=""https://www.caliper.com/"">Caliper Corporation</a>, 2020</p>
 
 
-</div>
-</div>
 
 </div>
 
 <script>
 
 // add bootstrap table styles to pandoc tables
 function bootstrapStylePandocTables() {
-  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
+  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
 }
 $(document).ready(function () {
   bootstrapStylePandocTables();
@@ -412,32 +368,6 @@ <h1 class=""title toc-ignore"">My Website</h1>
 
 <!-- code folding -->
 
-<script>
-$(document).ready(function ()  {
-
-    // move toc-ignore selectors from section div to header
-    $('div.section.toc-ignore')
-        .removeClass('toc-ignore')
-        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');
-
-    // establish options
-    var options = {
-      selectors: ""h1,h2"",
-      theme: ""bootstrap3"",
-      context: '.toc-content',
-      hashGenerator: function (text) {
-        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
-      },
-      ignoreSelector: "".toc-ignore"",
-      scrollTo: 0
-    };
-    options.showAndHide = true;
-    options.smoothScroll = true;
-
-    // tocify
-    var toc = $(""#TOC"").tocify(options).data(""toc-tocify"");
-});
-</script>
 
 
 </body>

---FILE: docs/networks.Rmd---
@@ -65,15 +65,24 @@ model volumes and count data.
 
 ### Network Conflation
 
-Place holder documentation:
+Placeholder documentation:
 
-- Adam did a review of the entire network
+- Did a review of the entire network
 - Improved alignments, added collector/distributors/ramps, etc.
-- I performed connectivity checks
+- Performed connectivity checks
 - Also did a skim comparison.
   - Final %RMSE: 0.25%
   - Localized changes were more drastic. (see working_files/network_conflation/comparison_pics)
 - A lot of work done to improve Capital Blvd north of downtown. Included transit work.
-- I put shapefile exports of the old/new networks in data/input/networks/conflation.
-  - Consider leaflet maps.
 
+### All Streets
+
+Placeholder documentation:
+
+- Stakeholders decided to move forward with the all-streets addition 1/14
+- This will add a large number of additional streets to the model line layer for
+  the purpose of walk/bike/transit pathing.
+  
+## Transit
+
+To be added.
\ No newline at end of file

---FILE: docs/networks.html---
@@ -0,0 +1,529 @@
+<!DOCTYPE html>
+
+<html>
+
+<head>
+
+<meta charset=""utf-8"" />
+<meta name=""generator"" content=""pandoc"" />
+<meta http-equiv=""X-UA-Compatible"" content=""IE=EDGE"" />
+
+
+<meta name=""author"" content=""Caliper Corporation"" />
+
+<meta name=""date"" content=""2020-10-26"" />
+
+<title>Networks</title>
+
+<script src=""site_libs/jquery-1.11.3/jquery.min.js""></script>
+<meta name=""viewport"" content=""width=device-width, initial-scale=1"" />
+<link href=""site_libs/bootstrap-3.3.5/css/flatly.min.css"" rel=""stylesheet"" />
+<script src=""site_libs/bootstrap-3.3.5/js/bootstrap.min.js""></script>
+<script src=""site_libs/bootstrap-3.3.5/shim/html5shiv.min.js""></script>
+<script src=""site_libs/bootstrap-3.3.5/shim/respond.min.js""></script>
+<script src=""site_libs/jqueryui-1.11.4/jquery-ui.min.js""></script>
+<link href=""site_libs/tocify-1.9.1/jquery.tocify.css"" rel=""stylesheet"" />
+<script src=""site_libs/tocify-1.9.1/jquery.tocify.js""></script>
+<script src=""site_libs/navigation-1.1/tabsets.js""></script>
+<script src=""site_libs/accessible-code-block-0.0.1/empty-anchor.js""></script>
+<link href=""site_libs/anchor-sections-1.0/anchor-sections.css"" rel=""stylesheet"" />
+<script src=""site_libs/anchor-sections-1.0/anchor-sections.js""></script>
+
+<style type=""text/css"">
+  code{white-space: pre-wrap;}
+  span.smallcaps{font-variant: small-caps;}
+  span.underline{text-decoration: underline;}
+  div.column{display: inline-block; vertical-align: top; width: 50%;}
+  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
+  ul.task-list{list-style: none;}
+    </style>
+
+
+
+
+<style type=""text/css"">
+h1 {
+  font-size: 34px;
+}
+h1.title {
+  font-size: 38px;
+}
+h2 {
+  font-size: 30px;
+}
+h3 {
+  font-size: 24px;
+}
+h4 {
+  font-size: 18px;
+}
+h5 {
+  font-size: 16px;
+}
+h6 {
+  font-size: 12px;
+}
+.table th:not([align]) {
+  text-align: left;
+}
+</style>
+
+<link rel=""stylesheet"" href=""styles.css"" type=""text/css"" />
+
+
+
+<style type = ""text/css"">
+.main-container {
+  max-width: 940px;
+  margin-left: auto;
+  margin-right: auto;
+}
+code {
+  color: inherit;
+  background-color: rgba(0, 0, 0, 0.04);
+}
+img {
+  max-width:100%;
+}
+.tabbed-pane {
+  padding-top: 12px;
+}
+.html-widget {
+  margin-bottom: 20px;
+}
+button.code-folding-btn:focus {
+  outline: none;
+}
+summary {
+  display: list-item;
+}
+</style>
+
+
+<style type=""text/css"">
+/* padding for bootstrap navbar */
+body {
+  padding-top: 60px;
+  padding-bottom: 40px;
+}
+/* offset scroll position for anchor links (for fixed navbar)  */
+.section h1 {
+  padding-top: 65px;
+  margin-top: -65px;
+}
+.section h2 {
+  padding-top: 65px;
+  margin-top: -65px;
+}
+.section h3 {
+  padding-top: 65px;
+  margin-top: -65px;
+}
+.section h4 {
+  padding-top: 65px;
+  margin-top: -65px;
+}
+.section h5 {
+  padding-top: 65px;
+  margin-top: -65px;
+}
+.section h6 {
+  padding-top: 65px;
+  margin-top: -65px;
+}
+.dropdown-submenu {
+  position: relative;
+}
+.dropdown-submenu>.dropdown-menu {
+  top: 0;
+  left: 100%;
+  margin-top: -6px;
+  margin-left: -1px;
+  border-radius: 0 6px 6px 6px;
+}
+.dropdown-submenu:hover>.dropdown-menu {
+  display: block;
+}
+.dropdown-submenu>a:after {
+  display: block;
+  content: "" "";
+  float: right;
+  width: 0;
+  height: 0;
+  border-color: transparent;
+  border-style: solid;
+  border-width: 5px 0 5px 5px;
+  border-left-color: #cccccc;
+  margin-top: 5px;
+  margin-right: -10px;
+}
+.dropdown-submenu:hover>a:after {
+  border-left-color: #ffffff;
+}
+.dropdown-submenu.pull-left {
+  float: none;
+}
+.dropdown-submenu.pull-left>.dropdown-menu {
+  left: -100%;
+  margin-left: 10px;
+  border-radius: 6px 0 6px 6px;
+}
+</style>
+
+<script>
+// manage active state of menu based on current page
+$(document).ready(function () {
+  // active menu anchor
+  href = window.location.pathname
+  href = href.substr(href.lastIndexOf('/') + 1)
+  if (href === """")
+    href = ""index.html"";
+  var menuAnchor = $('a[href=""' + href + '""]');
+
+  // mark it active
+  menuAnchor.parent().addClass('active');
+
+  // if it's got a parent navbar menu mark it active as well
+  menuAnchor.closest('li.dropdown').addClass('active');
+});
+</script>
+
+<!-- tabsets -->
+
+<style type=""text/css"">
+.tabset-dropdown > .nav-tabs {
+  display: inline-table;
+  max-height: 500px;
+  min-height: 44px;
+  overflow-y: auto;
+  background: white;
+  border: 1px solid #ddd;
+  border-radius: 4px;
+}
+
+.tabset-dropdown > .nav-tabs > li.active:before {
+  content: """";
+  font-family: 'Glyphicons Halflings';
+  display: inline-block;
+  padding: 10px;
+  border-right: 1px solid #ddd;
+}
+
+.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
+  content: ""&#xe258;"";
+  border: none;
+}
+
+.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
+  content: """";
+  font-family: 'Glyphicons Halflings';
+  display: inline-block;
+  padding: 10px;
+  border-right: 1px solid #ddd;
+}
+
+.tabset-dropdown > .nav-tabs > li.active {
+  display: block;
+}
+
+.tabset-dropdown > .nav-tabs > li > a,
+.tabset-dropdown > .nav-tabs > li > a:focus,
+.tabset-dropdown > .nav-tabs > li > a:hover {
+  border: none;
+  display: inline-block;
+  border-radius: 4px;
+  background-color: transparent;
+}
+
+.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
+  display: block;
+  float: none;
+}
+
+.tabset-dropdown > .nav-tabs > li {
+  display: none;
+}
+</style>
+
+<!-- code folding -->
+
+
+
+<style type=""text/css"">
+
+#TOC {
+  margin: 25px 0px 20px 0px;
+}
+@media (max-width: 768px) {
+#TOC {
+  position: relative;
+  width: 100%;
+}
+}
+
+@media print {
+.toc-content {
+  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
+  float: right;
+}
+}
+
+.toc-content {
+  padding-left: 30px;
+  padding-right: 40px;
+}
+
+div.main-container {
+  max-width: 1200px;
+}
+
+div.tocify {
+  width: 20%;
+  max-width: 260px;
+  max-height: 85%;
+}
+
+@media (min-width: 768px) and (max-width: 991px) {
+  div.tocify {
+    width: 25%;
+  }
+}
+
+@media (max-width: 767px) {
+  div.tocify {
+    width: 100%;
+    max-width: none;
+  }
+}
+
+.tocify ul, .tocify li {
+  line-height: 20px;
+}
+
+.tocify-subheader .tocify-item {
+  font-size: 0.90em;
+}
+
+.tocify .list-group-item {
+  border-radius: 0px;
+}
+
+
+</style>
+
+
+
+</head>
+
+<body>
+
+
+<div class=""container-fluid main-container"">
+
+
+<!-- setup 3col/9col grid for toc_float and main content  -->
+<div class=""row-fluid"">
+<div class=""col-xs-12 col-sm-4 col-md-3"">
+<div id=""TOC"" class=""tocify"">
+</div>
+</div>
+
+<div class=""toc-content col-xs-12 col-sm-8 col-md-9"">
+
+
+
+
+<div class=""navbar navbar-default  navbar-fixed-top"" role=""navigation"">
+  <div class=""container"">
+    <div class=""navbar-header"">
+      <button type=""button"" class=""navbar-toggle collapsed"" data-toggle=""collapse"" data-target=""#navbar"">
+        <span class=""icon-bar""></span>
+        <span class=""icon-bar""></span>
+        <span class=""icon-bar""></span>
+      </button>
+      <a class=""navbar-brand"" href=""index.html"">TRMG2</a>
+    </div>
+    <div id=""navbar"" class=""navbar-collapse collapse"">
+      <ul class=""nav navbar-nav"">
+        <li class=""dropdown"">
+  <a href=""#"" class=""dropdown-toggle"" data-toggle=""dropdown"" role=""button"" aria-expanded=""false"">
+    Databases
+     
+    <span class=""caret""></span>
+  </a>
+  <ul class=""dropdown-menu"" role=""menu"">
+    <li>
+      <a href=""tazs_and_se_data.html"">TAZs and SE Data</a>
+    </li>
+    <li>
+      <a href=""networks.html"">Networks</a>
+    </li>
+  </ul>
+</li>
+<li class=""dropdown"">
+  <a href=""#"" class=""dropdown-toggle"" data-toggle=""dropdown"" role=""button"" aria-expanded=""false"">
+    Surveys
+     
+    <span class=""caret""></span>
+  </a>
+  <ul class=""dropdown-menu"" role=""menu"">
+    <li>
+      <a href=""survey_processing.html"">Household Survey</a>
+    </li>
+  </ul>
+</li>
+<li class=""dropdown"">
+  <a href=""#"" class=""dropdown-toggle"" data-toggle=""dropdown"" role=""button"" aria-expanded=""false"">
+    Models
+     
+    <span class=""caret""></span>
+  </a>
+  <ul class=""dropdown-menu"" role=""menu"">
+    <li>
+      <a href=""generation_disaggregation.html"">Dissaggregation</a>
+    </li>
+    <li>
+      <a href=""time_of_day.html"">Time of Day</a>
+    </li>
+  </ul>
+</li>
+      </ul>
+      <ul class=""nav navbar-nav navbar-right"">
+        
+      </ul>
+    </div><!--/.nav-collapse -->
+  </div><!--/.container -->
+</div><!--/.navbar -->
+
+<div class=""fluid-row"" id=""header"">
+
+
+
+<h1 class=""title toc-ignore"">Networks</h1>
+<h4 class=""author"">Caliper Corporation</h4>
+<h4 class=""date"">10/26/2020</h4>
+
+</div>
+
+
+<div id=""introduction"" class=""section level2"">
+<h2>Introduction</h2>
+<p>The highway and transit networks are critical inputs for any travel model. They provide travel time, accessibility, and other impedance information. The Caliper team used the various existing data sources from the model stakeholders in order to fashion a new master network for both highway and transit.</p>
+</div>
+<div id=""highway"" class=""section level2"">
+<h2>Highway</h2>
+<div id=""creating-the-master-network"" class=""section level3"">
+<h3>Creating the master network</h3>
+<p>Like TRMv6, the TRMG2 model uses a master network that contains all projects stakeholders might consider (including competing ideas). This allows each scenario network to be exported from the master with little or no manual editing. Information on using the project management tools is covered in the users guide.</p>
+<p>The previous highway network made heavy use of numeric codes that translated into values (e.g.a facility type of 1 might signify interstate). For TRMG2, these fields now contain the string values directly, which improves understanding, usability, and maintenance of the network. It also makes the models GISDK code easier to read.</p>
+<p>For these same reasons, the previous Special field was broken up into new HOV and Toll-related fields. For example, the TollType field includes values like Free, Toll, and HOT (for high-occupancy toll lane). It is easier to understand a query like TollType = Toll compared to Special = 43. For a full enumeration of field names and meanings, see the users guide.</p>
+<p>The Caliper team also updated the master network to reflect a 2016 base year during model estimation (the final network is a 2020 base year). In other words, if you export a scenario network without any projects it will reflect the 2016 road system. This was done by permanently modifying the base attributes of the master network with any projects scheduled to be complete by the base year date. This did include some road closures, and those links dropped out of the network permanently.</p>
+</div>
+<div id=""checking-the-master-network"" class=""section level3"">
+<h3>Checking the master network</h3>
+<p>With all the changes mentioned above, it was important to check that the new master networks projects matched the previous. To be exhaustive, Caliper wrote code do this programmatically. For instance, every project in the old master network had its length checked against the new network. Of the well- over 1000 projects, only 6 had length discrepancies. Each was investigated and corrected as necessary.</p>
+</div>
+<div id=""loading-count-data"" class=""section level3"">
+<h3>Loading count data</h3>
+<p>The previous model used a separate table to hold count data which then had to be joined to the network to make comparisons. For TRMG2, the basic count data including station ID and daily AWDT were added to the master network directly. This makes it easier to compare (either manually or in code) between model volumes and count data.</p>
+</div>
+<div id=""network-conflation"" class=""section level3"">
+<h3>Network Conflation</h3>
+<p>Placeholder documentation:</p>
+<ul>
+<li>Did a review of the entire network</li>
+<li>Improved alignments, added collector/distributors/ramps, etc.</li>
+<li>Performed connectivity checks</li>
+<li>Also did a skim comparison.
+<ul>
+<li>Final %RMSE: 0.25%</li>
+<li>Localized changes were more drastic. (see working_files/network_conflation/comparison_pics)</li>
+</ul></li>
+<li>A lot of work done to improve Capital Blvd north of downtown. Included transit work.</li>
+</ul>
+</div>
+<div id=""all-streets"" class=""section level3"">
+<h3>All Streets</h3>
+<p>Placeholder documentation:</p>
+<ul>
+<li>Stakeholders decided to move forward with the all-streets addition 1/14</li>
+<li>This will add a large number of additional streets to the model line layer for the purpose of walk/bike/transit pathing.</li>
+</ul>
+</div>
+</div>
+<div id=""transit"" class=""section level2"">
+<h2>Transit</h2>
+<p>To be added.</p>
+</div>
+
+<br>
+<br>
+<br>
+<hr>
+<p><a href=""https://www.caliper.com/"">Caliper Corporation</a>, 2020</p>
+
+
+</div>
+</div>
+
+</div>
+
+<script>
+
+// add bootstrap table styles to pandoc tables
+function bootstrapStylePandocTables() {
+  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
+}
+$(document).ready(function () {
+  bootstrapStylePandocTables();
+});
+
+
+</script>
+
+<!-- tabsets -->
+
+<script>
+$(document).ready(function () {
+  window.buildTabsets(""TOC"");
+});
+
+$(document).ready(function () {
+  $('.tabset-dropdown > .nav-tabs > li').click(function () {
+    $(this).parent().toggleClass('nav-tabs-open')
+  });
+});
+</script>
+
+<!-- code folding -->
+
+<script>
+$(document).ready(function ()  {
+
+    // move toc-ignore selectors from section div to header
+    $('div.section.toc-ignore')
+        .removeClass('toc-ignore')
+        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');
+
+    // establish options
+    var options = {
+      selectors: ""h1,h2"",
+      theme: ""bootstrap3"",
+      context: '.toc-content',
+      hashGenerator: function (text) {
+        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
+      },
+      ignoreSelector: "".toc-ignore"",
+      scrollTo: 0
+    };
+    options.showAndHide = true;
+    options.smoothScroll = true;
+
+    // tocify
+    var toc = $(""#TOC"").tocify(options).data(""toc-tocify"");
+});
+</script>
+
+
+</body>
+</html>

---FILE: docs/renv.lock---
@@ -128,6 +128,13 @@
       ""Repository"": ""CRAN"",
       ""Hash"": ""f61dbaec772ccd2e17705c1e872e9e7c""
     },
+    ""chron"": {
+      ""Package"": ""chron"",
+      ""Version"": ""2.3-56"",
+      ""Source"": ""Repository"",
+      ""Repository"": ""CRAN"",
+      ""Hash"": ""2d8e9b1143af1caf26a521ed26e8736b""
+    },
     ""class"": {
       ""Package"": ""class"",
       ""Version"": ""7.3-17"",

---FILE: docs/time_of_day.html---
@@ -356,19 +356,43 @@
       <ul class=""nav navbar-nav"">
         <li class=""dropdown"">
   <a href=""#"" class=""dropdown-toggle"" data-toggle=""dropdown"" role=""button"" aria-expanded=""false"">
-    Ch. 1
+    Databases
      
     <span class=""caret""></span>
   </a>
   <ul class=""dropdown-menu"" role=""menu"">
-    <li class=""dropdown-header"">Databases</li>
     <li>
-      <a href=""Database-TAZ.html"">Sample Placeholder</a>
+      <a href=""tazs_and_se_data.html"">TAZs and SE Data</a>
     </li>
-    <li class=""divider""></li>
-    <li class=""dropdown-header"">Surveys</li>
     <li>
-      <a href=""Survey-HHSurvey.html"">Sample Placeholder</a>
+      <a href=""networks.html"">Networks</a>
+    </li>
+  </ul>
+</li>
+<li class=""dropdown"">
+  <a href=""#"" class=""dropdown-toggle"" data-toggle=""dropdown"" role=""button"" aria-expanded=""false"">
+    Surveys
+     
+    <span class=""caret""></span>
+  </a>
+  <ul class=""dropdown-menu"" role=""menu"">
+    <li>
+      <a href=""survey_processing.html"">Household Survey</a>
+    </li>
+  </ul>
+</li>
+<li class=""dropdown"">
+  <a href=""#"" class=""dropdown-toggle"" data-toggle=""dropdown"" role=""button"" aria-expanded=""false"">
+    Models
+     
+    <span class=""caret""></span>
+  </a>
+  <ul class=""dropdown-menu"" role=""menu"">
+    <li>
+      <a href=""generation_disaggregation.html"">Dissaggregation</a>
+    </li>
+    <li>
+      <a href=""time_of_day.html"">Time of Day</a>
     </li>
   </ul>
 </li>
@@ -399,8 +423,8 @@ <h1>Introduction</h1>
 <h1>Peak period determination</h1>
 <p><em>(To skip to the final period definitions, click <a href=""#final_defs"">here</a>.)</em></p>
 <p>Peak period determination is based on an analysis of the trips in motion throughout the day. First, the day is broken up into 15-minute increments. A trip from the household survey is said to be in motion if any portion of the trip occurs within the 15-minute bin. As a result, a single trip can be counted in multiple bins. Determining the peak period considers the distribution of all trips as well as the distribution of trips on work tours individually. The chart below shows these two distributions, which look as expected with the AM peak being shorter and more condensed than the PM. Travelers have much more flexibility in their travel choices in the PM.</p>
-<div id=""htmlwidget-de04d3b4dfa186224c25"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
-<script type=""application/json"" data-for=""htmlwidget-de04d3b4dfa186224c25"">{""x"":{""visdat"":{""474c2ee436f8"":[""function () "",""plotlyVisDat""]},""cur_data"":""474c2ee436f8"",""attrs"":{""474c2ee436f8"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""All"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter""},""474c2ee436f8.1"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""Work"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Distribution of Trips in Motion by Purpose"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Time of Day""},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Trips in Motion""},""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[0,0.15,0.3,0.45,1,1.15,1.3,1.45,2,2.15,2.3,2.45,3,3.15,3.3,3.45,4,4.15,4.3,4.45,5,5.15,5.3,5.45,6,6.15,6.3,6.45,7,7.15,7.3,7.45,8,8.15,8.3,8.45,9,9.15,9.3,9.45,10,10.15,10.3,10.45,11,11.15,11.3,11.45,12,12.15,12.3,12.45,13,13.15,13.3,13.45,14,14.15,14.3,14.45,15,15.15,15.3,15.45,16,16.15,16.3,16.45,17,17.15,17.3,17.45,18,18.15,18.3,18.45,19,19.15,19.3,19.45,20,20.15,20.3,20.45,21,21.15,21.3,21.45,22,22.15,22.3,22.45,23,23.15,23.3,23.45,24],""y"":[2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,6006.91633033752,3410.09362983704,4500.83061599731,4765.82431411743,8006.77574920654,6569.41974258423,7685.39112472534,8822.62908744812,13670.3632354736,19029.7920532227,30755.1913146973,39920.9330482483,73665.8692264557,93827.7578754425,155618.7302742,217000.553527832,339489.420529048,338475.687319819,362149.301777267,340161.540987396,375711.299628321,317973.359033012,325394.165305138,278288.722034136,304165.738966306,238774.572054545,211934.913558642,201615.277951558,261444.767658552,224182.515823682,240411.656651815,216316.87800916,258462.408271154,233479.573026657,241757.714330673,244000.05855751,314327.5847435,274645.207396825,261858.255025228,255500.890740713,302353.041838964,260254.874181112,247806.449596723,233514.178727468,284886.193562826,288110.05854257,336457.066494306,316149.00978597,384585.508785566,357340.021060308,390415.789463043,369449.946901703,453370.847463989,391825.133561516,403544.182270114,368451.706189219,458363.171119054,435890.852298101,462039.169150988,416507.126527786,446981.770751953,350170.189201355,340231.466928482,285659.168889682,294781.842376391,234046.789671898,222718.154975573,198955.189921061,202134.527949015,157585.30718867,154584.655879974,120148.76292038,137054.122617722,99612.0579586029,86707.1680469513,68113.8166332245,55674.9314994812,42631.0930080414,39612.3422546387,31067.600730896,35572.7873001099,29269.5131282806,25186.135099411,21243.2928848267,0],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  6,007"",""  3,410"",""  4,501"",""  4,766"",""  8,007"",""  6,569"",""  7,685"",""  8,823"","" 13,670"","" 19,030"","" 30,755"","" 39,921"","" 73,666"","" 93,828"",""155,619"",""217,001"",""339,489"",""338,476"",""362,149"",""340,162"",""375,711"",""317,973"",""325,394"",""278,289"",""304,166"",""238,775"",""211,935"",""201,615"",""261,445"",""224,183"",""240,412"",""216,317"",""258,462"",""233,480"",""241,758"",""244,000"",""314,328"",""274,645"",""261,858"",""255,501"",""302,353"",""260,255"",""247,806"",""233,514"",""284,886"",""288,110"",""336,457"",""316,149"",""384,586"",""357,340"",""390,416"",""369,450"",""453,371"",""391,825"",""403,544"",""368,452"",""458,363"",""435,891"",""462,039"",""416,507"",""446,982"",""350,170"",""340,231"",""285,659"",""294,782"",""234,047"",""222,718"",""198,955"",""202,135"",""157,585"",""154,585"",""120,149"",""137,054"","" 99,612"","" 86,707"","" 68,114"","" 55,675"","" 42,631"","" 39,612"","" 31,068"","" 35,573"","" 29,270"","" 25,186"","" 21,243"",""      0""],""name"":""All"",""type"":""scatter"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""line"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[0,0.15,0.3,0.45,1,1.15,1.3,1.45,2,2.15,2.3,2.45,3,3.15,3.3,3.45,4,4.15,4.3,4.45,5,5.15,5.3,5.45,6,6.15,6.3,6.45,7,7.15,7.3,7.45,8,8.15,8.3,8.45,9,9.15,9.3,9.45,10,10.15,10.3,10.45,11,11.15,11.3,11.45,12,12.15,12.3,12.45,13,13.15,13.3,13.45,14,14.15,14.3,14.45,15,15.15,15.3,15.45,16,16.15,16.3,16.45,17,17.15,17.3,17.45,18,18.15,18.3,18.45,19,19.15,19.3,19.45,20,20.15,20.3,20.45,21,21.15,21.3,21.45,22,22.15,22.3,22.45,23,23.15,23.3,23.45],""y"":[313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,1368.14471435547,673.78125,1290.64489746094,1290.64489746094,3582.1994972229,2464.88962936402,2760.15663146973,3252.00533103943,7170.20836257935,10944.5705299377,18278.1314353943,22772.9522399902,40962.7974319458,46689.6261520386,71671.4431629181,92738.5137805939,150121.176033656,160475.758799617,174631.647320175,160235.875906372,176584.240990702,145970.291184807,133684.912169456,107898.875323931,98084.0097525914,68907.8140633901,60239.1537841161,52148.5661805471,61376.8012002309,53499.0538438161,57156.4226678213,51714.7440255483,55748.2428334554,50851.3968804677,62917.8235581716,64655.5109418233,107873.165196737,89689.8134759267,84471.6837056478,79623.8989995321,96105.3636945089,75678.8679231008,63543.777484258,55533.1231854757,70126.9929688772,68129.5283292135,68327.0395387014,64309.9662955602,80941.5015033086,74425.043481191,92530.7737687429,86981.9077679952,121737.705289586,123305.580771192,149290.841483498,140414.695619965,199862.497659365,190494.715003649,189810.962597847,155000.185897827,158401.026243846,118268.938961665,103551.622719447,79876.4266621272,70955.6488720576,51992.2698087692,47440.1874818802,41133.6848983765,44302.4138393402,35089.6498508453,28721.6733798981,20429.4450054169,29044.1197738648,21860.3189640045,16134.6745758057,12429.3692684174,10275.6075439453,10753.3359584808,9298.27993583679,10544.0161933899,9824.87848091125,8994.08058929444,5731.84379768372,4000.18750953674],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""  1,368"",""    674"",""  1,291"",""  1,291"",""  3,582"",""  2,465"",""  2,760"",""  3,252"",""  7,170"","" 10,945"","" 18,278"","" 22,773"","" 40,963"","" 46,690"","" 71,671"","" 92,739"",""150,121"",""160,476"",""174,632"",""160,236"",""176,584"",""145,970"",""133,685"",""107,899"","" 98,084"","" 68,908"","" 60,239"","" 52,149"","" 61,377"","" 53,499"","" 57,156"","" 51,715"","" 55,748"","" 50,851"","" 62,918"","" 64,656"",""107,873"","" 89,690"","" 84,472"","" 79,624"","" 96,105"","" 75,679"","" 63,544"","" 55,533"","" 70,127"","" 68,130"","" 68,327"","" 64,310"","" 80,942"","" 74,425"","" 92,531"","" 86,982"",""121,738"",""123,306"",""149,291"",""140,415"",""199,862"",""190,495"",""189,811"",""155,000"",""158,401"",""118,269"",""103,552"","" 79,876"","" 70,956"","" 51,992"","" 47,440"","" 41,134"","" 44,302"","" 35,090"","" 28,722"","" 20,429"","" 29,044"","" 21,860"","" 16,135"","" 12,429"","" 10,276"","" 10,753"",""  9,298"","" 10,544"",""  9,825"",""  8,994"",""  5,732"",""  4,000""],""name"":""Work"",""type"":""scatter"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""line"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
+<div id=""htmlwidget-1d25ddd3fe6ae48300d4"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
+<script type=""application/json"" data-for=""htmlwidget-1d25ddd3fe6ae48300d4"">{""x"":{""visdat"":{""3a70208c1d70"":[""function () "",""plotlyVisDat""]},""cur_data"":""3a70208c1d70"",""attrs"":{""3a70208c1d70"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""All"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter""},""3a70208c1d70.1"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""Work"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Distribution of Trips in Motion by Purpose"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Time of Day""},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Trips in Motion""},""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[0,0.15,0.3,0.45,1,1.15,1.3,1.45,2,2.15,2.3,2.45,3,3.15,3.3,3.45,4,4.15,4.3,4.45,5,5.15,5.3,5.45,6,6.15,6.3,6.45,7,7.15,7.3,7.45,8,8.15,8.3,8.45,9,9.15,9.3,9.45,10,10.15,10.3,10.45,11,11.15,11.3,11.45,12,12.15,12.3,12.45,13,13.15,13.3,13.45,14,14.15,14.3,14.45,15,15.15,15.3,15.45,16,16.15,16.3,16.45,17,17.15,17.3,17.45,18,18.15,18.3,18.45,19,19.15,19.3,19.45,20,20.15,20.3,20.45,21,21.15,21.3,21.45,22,22.15,22.3,22.45,23,23.15,23.3,23.45,24],""y"":[2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,6006.91633033752,3410.09362983704,4500.83061599731,4765.82431411743,8006.77574920654,6569.41974258423,7685.39112472534,8822.62908744812,13670.3632354736,19029.7920532227,30755.1913146973,39920.9330482483,73665.8692264557,93827.7578754425,155618.7302742,217000.553527832,339489.420529048,338475.687319819,362149.301777267,340161.540987396,375711.299628321,317973.359033012,325394.165305138,278288.722034136,304165.738966306,238774.572054545,211934.913558642,201615.277951558,261444.767658552,224182.515823682,240411.656651815,216316.87800916,258462.408271154,233479.573026657,241757.714330673,244000.05855751,314327.5847435,274645.207396825,261858.255025228,255500.890740713,302353.041838964,260254.874181112,247806.449596723,233514.178727468,284886.193562826,288110.05854257,336457.066494306,316149.00978597,384585.508785566,357340.021060308,390415.789463043,369449.946901703,453370.847463989,391825.133561516,403544.182270114,368451.706189219,458363.171119054,435890.852298101,462039.169150988,416507.126527786,446981.770751953,350170.189201355,340231.466928482,285659.168889682,294781.842376391,234046.789671898,222718.154975573,198955.189921061,202134.527949015,157585.30718867,154584.655879974,120148.76292038,137054.122617722,99612.0579586029,86707.1680469513,68113.8166332245,55674.9314994812,42631.0930080414,39612.3422546387,31067.600730896,35572.7873001099,29269.5131282806,25186.135099411,21243.2928848267,0],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  6,007"",""  3,410"",""  4,501"",""  4,766"",""  8,007"",""  6,569"",""  7,685"",""  8,823"","" 13,670"","" 19,030"","" 30,755"","" 39,921"","" 73,666"","" 93,828"",""155,619"",""217,001"",""339,489"",""338,476"",""362,149"",""340,162"",""375,711"",""317,973"",""325,394"",""278,289"",""304,166"",""238,775"",""211,935"",""201,615"",""261,445"",""224,183"",""240,412"",""216,317"",""258,462"",""233,480"",""241,758"",""244,000"",""314,328"",""274,645"",""261,858"",""255,501"",""302,353"",""260,255"",""247,806"",""233,514"",""284,886"",""288,110"",""336,457"",""316,149"",""384,586"",""357,340"",""390,416"",""369,450"",""453,371"",""391,825"",""403,544"",""368,452"",""458,363"",""435,891"",""462,039"",""416,507"",""446,982"",""350,170"",""340,231"",""285,659"",""294,782"",""234,047"",""222,718"",""198,955"",""202,135"",""157,585"",""154,585"",""120,149"",""137,054"","" 99,612"","" 86,707"","" 68,114"","" 55,675"","" 42,631"","" 39,612"","" 31,068"","" 35,573"","" 29,270"","" 25,186"","" 21,243"",""      0""],""name"":""All"",""type"":""scatter"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""line"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[0,0.15,0.3,0.45,1,1.15,1.3,1.45,2,2.15,2.3,2.45,3,3.15,3.3,3.45,4,4.15,4.3,4.45,5,5.15,5.3,5.45,6,6.15,6.3,6.45,7,7.15,7.3,7.45,8,8.15,8.3,8.45,9,9.15,9.3,9.45,10,10.15,10.3,10.45,11,11.15,11.3,11.45,12,12.15,12.3,12.45,13,13.15,13.3,13.45,14,14.15,14.3,14.45,15,15.15,15.3,15.45,16,16.15,16.3,16.45,17,17.15,17.3,17.45,18,18.15,18.3,18.45,19,19.15,19.3,19.45,20,20.15,20.3,20.45,21,21.15,21.3,21.45,22,22.15,22.3,22.45,23,23.15,23.3,23.45],""y"":[313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,1368.14471435547,673.78125,1290.64489746094,1290.64489746094,3582.1994972229,2464.88962936402,2760.15663146973,3252.00533103943,7170.20836257935,10944.5705299377,18278.1314353943,22772.9522399902,40962.7974319458,46689.6261520386,71671.4431629181,92738.5137805939,150121.176033656,160475.758799617,174631.647320175,160235.875906372,176584.240990702,145970.291184807,133684.912169456,107898.875323931,98084.0097525914,68907.8140633901,60239.1537841161,52148.5661805471,61376.8012002309,53499.0538438161,57156.4226678213,51714.7440255483,55748.2428334554,50851.3968804677,62917.8235581716,64655.5109418233,107873.165196737,89689.8134759267,84471.6837056478,79623.8989995321,96105.3636945089,75678.8679231008,63543.777484258,55533.1231854757,70126.9929688772,68129.5283292135,68327.0395387014,64309.9662955602,80941.5015033086,74425.043481191,92530.7737687429,86981.9077679952,121737.705289586,123305.580771192,149290.841483498,140414.695619965,199862.497659365,190494.715003649,189810.962597847,155000.185897827,158401.026243846,118268.938961665,103551.622719447,79876.4266621272,70955.6488720576,51992.2698087692,47440.1874818802,41133.6848983765,44302.4138393402,35089.6498508453,28721.6733798981,20429.4450054169,29044.1197738648,21860.3189640045,16134.6745758057,12429.3692684174,10275.6075439453,10753.3359584808,9298.27993583679,10544.0161933899,9824.87848091125,8994.08058929444,5731.84379768372,4000.18750953674],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""  1,368"",""    674"",""  1,291"",""  1,291"",""  3,582"",""  2,465"",""  2,760"",""  3,252"",""  7,170"","" 10,945"","" 18,278"","" 22,773"","" 40,963"","" 46,690"","" 71,671"","" 92,739"",""150,121"",""160,476"",""174,632"",""160,236"",""176,584"",""145,970"",""133,685"",""107,899"","" 98,084"","" 68,908"","" 60,239"","" 52,149"","" 61,377"","" 53,499"","" 57,156"","" 51,715"","" 55,748"","" 50,851"","" 62,918"","" 64,656"",""107,873"","" 89,690"","" 84,472"","" 79,624"","" 96,105"","" 75,679"","" 63,544"","" 55,533"","" 70,127"","" 68,130"","" 68,327"","" 64,310"","" 80,942"","" 74,425"","" 92,531"","" 86,982"",""121,738"",""123,306"",""149,291"",""140,415"",""199,862"",""190,495"",""189,811"",""155,000"",""158,401"",""118,269"",""103,552"","" 79,876"","" 70,956"","" 51,992"","" 47,440"","" 41,134"","" 44,302"","" 35,090"","" 28,722"","" 20,429"","" 29,044"","" 21,860"","" 16,135"","" 12,429"","" 10,276"","" 10,753"",""  9,298"","" 10,544"",""  9,825"",""  8,994"",""  5,732"",""  4,000""],""name"":""Work"",""type"":""scatter"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""line"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
 <p>The next step is to determine the peak hour for all trips and those on work tours. In the tables below, the AM and PM peak hours by type are presented. At a minimum, the AM and PM peak periods should contain the respective peak hour for work trips and all trips. The chart below shows that the peak hour for work and all trips are exactly the same.</p>
 <table class=""table"" style=""width: auto !important; margin-left: auto; margin-right: auto;"">
 <thead>
@@ -480,8 +504,8 @@ <h1>Peak period determination</h1>
 </tr>
 </tbody>
 </table>
-<div id=""htmlwidget-aa11f352ae9064176f53"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
-<script type=""application/json"" data-for=""htmlwidget-aa11f352ae9064176f53"">{""x"":{""visdat"":{""474c7484288c"":[""function () "",""plotlyVisDat""]},""cur_data"":""474c7484288c"",""attrs"":{""474c7484288c"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""All"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter""},""474c7484288c.1"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""Work"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true},""474c7484288c.2"":{""x"":[7.5,17.1],""y"":[471279.952534008,471279.952534008],""mode"":""text"",""hoverinfo"":""x"",""text"":[""Work and All"",""Work and All""],""name"":""Peak Hours"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Peak Hours"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Time of Day""},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Trips in Motion""},""shapes"":[{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":462039.169150988},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":462039.169150988},{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":16.45,""x1"":17.45,""y0"":0,""y1"":462039.169150988},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":16.45,""x1"":17.45,""y0"":0,""y1"":462039.169150988}],""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[0,0.15,0.3,0.45,1,1.15,1.3,1.45,2,2.15,2.3,2.45,3,3.15,3.3,3.45,4,4.15,4.3,4.45,5,5.15,5.3,5.45,6,6.15,6.3,6.45,7,7.15,7.3,7.45,8,8.15,8.3,8.45,9,9.15,9.3,9.45,10,10.15,10.3,10.45,11,11.15,11.3,11.45,12,12.15,12.3,12.45,13,13.15,13.3,13.45,14,14.15,14.3,14.45,15,15.15,15.3,15.45,16,16.15,16.3,16.45,17,17.15,17.3,17.45,18,18.15,18.3,18.45,19,19.15,19.3,19.45,20,20.15,20.3,20.45,21,21.15,21.3,21.45,22,22.15,22.3,22.45,23,23.15,23.3,23.45,24],""y"":[2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,6006.91633033752,3410.09362983704,4500.83061599731,4765.82431411743,8006.77574920654,6569.41974258423,7685.39112472534,8822.62908744812,13670.3632354736,19029.7920532227,30755.1913146973,39920.9330482483,73665.8692264557,93827.7578754425,155618.7302742,217000.553527832,339489.420529048,338475.687319819,362149.301777267,340161.540987396,375711.299628321,317973.359033012,325394.165305138,278288.722034136,304165.738966306,238774.572054545,211934.913558642,201615.277951558,261444.767658552,224182.515823682,240411.656651815,216316.87800916,258462.408271154,233479.573026657,241757.714330673,244000.05855751,314327.5847435,274645.207396825,261858.255025228,255500.890740713,302353.041838964,260254.874181112,247806.449596723,233514.178727468,284886.193562826,288110.05854257,336457.066494306,316149.00978597,384585.508785566,357340.021060308,390415.789463043,369449.946901703,453370.847463989,391825.133561516,403544.182270114,368451.706189219,458363.171119054,435890.852298101,462039.169150988,416507.126527786,446981.770751953,350170.189201355,340231.466928482,285659.168889682,294781.842376391,234046.789671898,222718.154975573,198955.189921061,202134.527949015,157585.30718867,154584.655879974,120148.76292038,137054.122617722,99612.0579586029,86707.1680469513,68113.8166332245,55674.9314994812,42631.0930080414,39612.3422546387,31067.600730896,35572.7873001099,29269.5131282806,25186.135099411,21243.2928848267,0],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  6,007"",""  3,410"",""  4,501"",""  4,766"",""  8,007"",""  6,569"",""  7,685"",""  8,823"","" 13,670"","" 19,030"","" 30,755"","" 39,921"","" 73,666"","" 93,828"",""155,619"",""217,001"",""339,489"",""338,476"",""362,149"",""340,162"",""375,711"",""317,973"",""325,394"",""278,289"",""304,166"",""238,775"",""211,935"",""201,615"",""261,445"",""224,183"",""240,412"",""216,317"",""258,462"",""233,480"",""241,758"",""244,000"",""314,328"",""274,645"",""261,858"",""255,501"",""302,353"",""260,255"",""247,806"",""233,514"",""284,886"",""288,110"",""336,457"",""316,149"",""384,586"",""357,340"",""390,416"",""369,450"",""453,371"",""391,825"",""403,544"",""368,452"",""458,363"",""435,891"",""462,039"",""416,507"",""446,982"",""350,170"",""340,231"",""285,659"",""294,782"",""234,047"",""222,718"",""198,955"",""202,135"",""157,585"",""154,585"",""120,149"",""137,054"","" 99,612"","" 86,707"","" 68,114"","" 55,675"","" 42,631"","" 39,612"","" 31,068"","" 35,573"","" 29,270"","" 25,186"","" 21,243"",""      0""],""name"":""All"",""type"":""scatter"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""line"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[0,0.15,0.3,0.45,1,1.15,1.3,1.45,2,2.15,2.3,2.45,3,3.15,3.3,3.45,4,4.15,4.3,4.45,5,5.15,5.3,5.45,6,6.15,6.3,6.45,7,7.15,7.3,7.45,8,8.15,8.3,8.45,9,9.15,9.3,9.45,10,10.15,10.3,10.45,11,11.15,11.3,11.45,12,12.15,12.3,12.45,13,13.15,13.3,13.45,14,14.15,14.3,14.45,15,15.15,15.3,15.45,16,16.15,16.3,16.45,17,17.15,17.3,17.45,18,18.15,18.3,18.45,19,19.15,19.3,19.45,20,20.15,20.3,20.45,21,21.15,21.3,21.45,22,22.15,22.3,22.45,23,23.15,23.3,23.45],""y"":[313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,1368.14471435547,673.78125,1290.64489746094,1290.64489746094,3582.1994972229,2464.88962936402,2760.15663146973,3252.00533103943,7170.20836257935,10944.5705299377,18278.1314353943,22772.9522399902,40962.7974319458,46689.6261520386,71671.4431629181,92738.5137805939,150121.176033656,160475.758799617,174631.647320175,160235.875906372,176584.240990702,145970.291184807,133684.912169456,107898.875323931,98084.0097525914,68907.8140633901,60239.1537841161,52148.5661805471,61376.8012002309,53499.0538438161,57156.4226678213,51714.7440255483,55748.2428334554,50851.3968804677,62917.8235581716,64655.5109418233,107873.165196737,89689.8134759267,84471.6837056478,79623.8989995321,96105.3636945089,75678.8679231008,63543.777484258,55533.1231854757,70126.9929688772,68129.5283292135,68327.0395387014,64309.9662955602,80941.5015033086,74425.043481191,92530.7737687429,86981.9077679952,121737.705289586,123305.580771192,149290.841483498,140414.695619965,199862.497659365,190494.715003649,189810.962597847,155000.185897827,158401.026243846,118268.938961665,103551.622719447,79876.4266621272,70955.6488720576,51992.2698087692,47440.1874818802,41133.6848983765,44302.4138393402,35089.6498508453,28721.6733798981,20429.4450054169,29044.1197738648,21860.3189640045,16134.6745758057,12429.3692684174,10275.6075439453,10753.3359584808,9298.27993583679,10544.0161933899,9824.87848091125,8994.08058929444,5731.84379768372,4000.18750953674],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""  1,368"",""    674"",""  1,291"",""  1,291"",""  3,582"",""  2,465"",""  2,760"",""  3,252"",""  7,170"","" 10,945"","" 18,278"","" 22,773"","" 40,963"","" 46,690"","" 71,671"","" 92,739"",""150,121"",""160,476"",""174,632"",""160,236"",""176,584"",""145,970"",""133,685"",""107,899"","" 98,084"","" 68,908"","" 60,239"","" 52,149"","" 61,377"","" 53,499"","" 57,156"","" 51,715"","" 55,748"","" 50,851"","" 62,918"","" 64,656"",""107,873"","" 89,690"","" 84,472"","" 79,624"","" 96,105"","" 75,679"","" 63,544"","" 55,533"","" 70,127"","" 68,130"","" 68,327"","" 64,310"","" 80,942"","" 74,425"","" 92,531"","" 86,982"",""121,738"",""123,306"",""149,291"",""140,415"",""199,862"",""190,495"",""189,811"",""155,000"",""158,401"",""118,269"",""103,552"","" 79,876"","" 70,956"","" 51,992"","" 47,440"","" 41,134"","" 44,302"","" 35,090"","" 28,722"","" 20,429"","" 29,044"","" 21,860"","" 16,135"","" 12,429"","" 10,276"","" 10,753"",""  9,298"","" 10,544"",""  9,825"",""  8,994"",""  5,732"",""  4,000""],""name"":""Work"",""type"":""scatter"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""line"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[7.5,17.1],""y"":[471279.952534008,471279.952534008],""mode"":""text"",""hoverinfo"":[""x"",""x""],""text"":[""Work and All"",""Work and All""],""name"":""Peak Hours"",""type"":""scatter"",""marker"":{""color"":""rgba(44,160,44,1)"",""line"":{""color"":""rgba(44,160,44,1)""}},""error_y"":{""color"":""rgba(44,160,44,1)""},""error_x"":{""color"":""rgba(44,160,44,1)""},""line"":{""color"":""rgba(44,160,44,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
+<div id=""htmlwidget-1a1dd455732f517ae8a2"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
+<script type=""application/json"" data-for=""htmlwidget-1a1dd455732f517ae8a2"">{""x"":{""visdat"":{""3a70374e2f98"":[""function () "",""plotlyVisDat""]},""cur_data"":""3a70374e2f98"",""attrs"":{""3a70374e2f98"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""All"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter""},""3a70374e2f98.1"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""Work"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true},""3a70374e2f98.2"":{""x"":[7.5,17.1],""y"":[471279.952534008,471279.952534008],""mode"":""text"",""hoverinfo"":""x"",""text"":[""Work and All"",""Work and All""],""name"":""Peak Hours"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Peak Hours"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Time of Day""},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Trips in Motion""},""shapes"":[{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":462039.169150988},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":462039.169150988},{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":16.45,""x1"":17.45,""y0"":0,""y1"":462039.169150988},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":16.45,""x1"":17.45,""y0"":0,""y1"":462039.169150988}],""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[0,0.15,0.3,0.45,1,1.15,1.3,1.45,2,2.15,2.3,2.45,3,3.15,3.3,3.45,4,4.15,4.3,4.45,5,5.15,5.3,5.45,6,6.15,6.3,6.45,7,7.15,7.3,7.45,8,8.15,8.3,8.45,9,9.15,9.3,9.45,10,10.15,10.3,10.45,11,11.15,11.3,11.45,12,12.15,12.3,12.45,13,13.15,13.3,13.45,14,14.15,14.3,14.45,15,15.15,15.3,15.45,16,16.15,16.3,16.45,17,17.15,17.3,17.45,18,18.15,18.3,18.45,19,19.15,19.3,19.45,20,20.15,20.3,20.45,21,21.15,21.3,21.45,22,22.15,22.3,22.45,23,23.15,23.3,23.45,24],""y"":[2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,6006.91633033752,3410.09362983704,4500.83061599731,4765.82431411743,8006.77574920654,6569.41974258423,7685.39112472534,8822.62908744812,13670.3632354736,19029.7920532227,30755.1913146973,39920.9330482483,73665.8692264557,93827.7578754425,155618.7302742,217000.553527832,339489.420529048,338475.687319819,362149.301777267,340161.540987396,375711.299628321,317973.359033012,325394.165305138,278288.722034136,304165.738966306,238774.572054545,211934.913558642,201615.277951558,261444.767658552,224182.515823682,240411.656651815,216316.87800916,258462.408271154,233479.573026657,241757.714330673,244000.05855751,314327.5847435,274645.207396825,261858.255025228,255500.890740713,302353.041838964,260254.874181112,247806.449596723,233514.178727468,284886.193562826,288110.05854257,336457.066494306,316149.00978597,384585.508785566,357340.021060308,390415.789463043,369449.946901703,453370.847463989,391825.133561516,403544.182270114,368451.706189219,458363.171119054,435890.852298101,462039.169150988,416507.126527786,446981.770751953,350170.189201355,340231.466928482,285659.168889682,294781.842376391,234046.789671898,222718.154975573,198955.189921061,202134.527949015,157585.30718867,154584.655879974,120148.76292038,137054.122617722,99612.0579586029,86707.1680469513,68113.8166332245,55674.9314994812,42631.0930080414,39612.3422546387,31067.600730896,35572.7873001099,29269.5131282806,25186.135099411,21243.2928848267,0],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  6,007"",""  3,410"",""  4,501"",""  4,766"",""  8,007"",""  6,569"",""  7,685"",""  8,823"","" 13,670"","" 19,030"","" 30,755"","" 39,921"","" 73,666"","" 93,828"",""155,619"",""217,001"",""339,489"",""338,476"",""362,149"",""340,162"",""375,711"",""317,973"",""325,394"",""278,289"",""304,166"",""238,775"",""211,935"",""201,615"",""261,445"",""224,183"",""240,412"",""216,317"",""258,462"",""233,480"",""241,758"",""244,000"",""314,328"",""274,645"",""261,858"",""255,501"",""302,353"",""260,255"",""247,806"",""233,514"",""284,886"",""288,110"",""336,457"",""316,149"",""384,586"",""357,340"",""390,416"",""369,450"",""453,371"",""391,825"",""403,544"",""368,452"",""458,363"",""435,891"",""462,039"",""416,507"",""446,982"",""350,170"",""340,231"",""285,659"",""294,782"",""234,047"",""222,718"",""198,955"",""202,135"",""157,585"",""154,585"",""120,149"",""137,054"","" 99,612"","" 86,707"","" 68,114"","" 55,675"","" 42,631"","" 39,612"","" 31,068"","" 35,573"","" 29,270"","" 25,186"","" 21,243"",""      0""],""name"":""All"",""type"":""scatter"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""line"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[0,0.15,0.3,0.45,1,1.15,1.3,1.45,2,2.15,2.3,2.45,3,3.15,3.3,3.45,4,4.15,4.3,4.45,5,5.15,5.3,5.45,6,6.15,6.3,6.45,7,7.15,7.3,7.45,8,8.15,8.3,8.45,9,9.15,9.3,9.45,10,10.15,10.3,10.45,11,11.15,11.3,11.45,12,12.15,12.3,12.45,13,13.15,13.3,13.45,14,14.15,14.3,14.45,15,15.15,15.3,15.45,16,16.15,16.3,16.45,17,17.15,17.3,17.45,18,18.15,18.3,18.45,19,19.15,19.3,19.45,20,20.15,20.3,20.45,21,21.15,21.3,21.45,22,22.15,22.3,22.45,23,23.15,23.3,23.45],""y"":[313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,1368.14471435547,673.78125,1290.64489746094,1290.64489746094,3582.1994972229,2464.88962936402,2760.15663146973,3252.00533103943,7170.20836257935,10944.5705299377,18278.1314353943,22772.9522399902,40962.7974319458,46689.6261520386,71671.4431629181,92738.5137805939,150121.176033656,160475.758799617,174631.647320175,160235.875906372,176584.240990702,145970.291184807,133684.912169456,107898.875323931,98084.0097525914,68907.8140633901,60239.1537841161,52148.5661805471,61376.8012002309,53499.0538438161,57156.4226678213,51714.7440255483,55748.2428334554,50851.3968804677,62917.8235581716,64655.5109418233,107873.165196737,89689.8134759267,84471.6837056478,79623.8989995321,96105.3636945089,75678.8679231008,63543.777484258,55533.1231854757,70126.9929688772,68129.5283292135,68327.0395387014,64309.9662955602,80941.5015033086,74425.043481191,92530.7737687429,86981.9077679952,121737.705289586,123305.580771192,149290.841483498,140414.695619965,199862.497659365,190494.715003649,189810.962597847,155000.185897827,158401.026243846,118268.938961665,103551.622719447,79876.4266621272,70955.6488720576,51992.2698087692,47440.1874818802,41133.6848983765,44302.4138393402,35089.6498508453,28721.6733798981,20429.4450054169,29044.1197738648,21860.3189640045,16134.6745758057,12429.3692684174,10275.6075439453,10753.3359584808,9298.27993583679,10544.0161933899,9824.87848091125,8994.08058929444,5731.84379768372,4000.18750953674],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""  1,368"",""    674"",""  1,291"",""  1,291"",""  3,582"",""  2,465"",""  2,760"",""  3,252"",""  7,170"","" 10,945"","" 18,278"","" 22,773"","" 40,963"","" 46,690"","" 71,671"","" 92,739"",""150,121"",""160,476"",""174,632"",""160,236"",""176,584"",""145,970"",""133,685"",""107,899"","" 98,084"","" 68,908"","" 60,239"","" 52,149"","" 61,377"","" 53,499"","" 57,156"","" 51,715"","" 55,748"","" 50,851"","" 62,918"","" 64,656"",""107,873"","" 89,690"","" 84,472"","" 79,624"","" 96,105"","" 75,679"","" 63,544"","" 55,533"","" 70,127"","" 68,130"","" 68,327"","" 64,310"","" 80,942"","" 74,425"","" 92,531"","" 86,982"",""121,738"",""123,306"",""149,291"",""140,415"",""199,862"",""190,495"",""189,811"",""155,000"",""158,401"",""118,269"",""103,552"","" 79,876"","" 70,956"","" 51,992"","" 47,440"","" 41,134"","" 44,302"","" 35,090"","" 28,722"","" 20,429"","" 29,044"","" 21,860"","" 16,135"","" 12,429"","" 10,276"","" 10,753"",""  9,298"","" 10,544"",""  9,825"",""  8,994"",""  5,732"",""  4,000""],""name"":""Work"",""type"":""scatter"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""line"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[7.5,17.1],""y"":[471279.952534008,471279.952534008],""mode"":""text"",""hoverinfo"":[""x"",""x""],""text"":[""Work and All"",""Work and All""],""name"":""Peak Hours"",""type"":""scatter"",""marker"":{""color"":""rgba(44,160,44,1)"",""line"":{""color"":""rgba(44,160,44,1)""}},""error_y"":{""color"":""rgba(44,160,44,1)""},""error_x"":{""color"":""rgba(44,160,44,1)""},""line"":{""color"":""rgba(44,160,44,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
 <div id=""final_defs"" class=""section level2"">
 <h2>Final Period Definitions</h2>
 The final period definitions are shown in the table below including the mid-day (MD) period. The remaining hours of the day are captured in the night (NT) period. In the chart, the final period is represented by the gray rectangle.
@@ -561,8 +585,8 @@ <h2>Final Period Definitions</h2>
 </tr>
 </tbody>
 </table>
-<div id=""htmlwidget-e641680287f65ac7d116"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
-<script type=""application/json"" data-for=""htmlwidget-e641680287f65ac7d116"">{""x"":{""visdat"":{""474c5ec3b66"":[""function () "",""plotlyVisDat""]},""cur_data"":""474c5ec3b66"",""attrs"":{""474c5ec3b66"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""All"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter""},""474c5ec3b66.1"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""Work"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true},""474c5ec3b66.2"":{""x"":[3.3,8,12,16.3,20.5999166666667],""y"":[489761.519300048,489761.519300048,489761.519300048,489761.519300048,489761.519300048],""mode"":""text"",""hoverinfo"":""x"",""text"":[""NT"",""AM"",""MD"",""PM"",""NT""],""name"":""Period"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Peak Periods"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Time of Day""},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Trips in Motion""},""shapes"":[{""type"":""rect"",""fillcolor"":""gray"",""line"":{""color"":""black""},""opacity"":0.3,""x0"":7,""x1"":9,""y0"":0,""y1"":480520.735917028},{""type"":""rect"",""fillcolor"":""gray"",""line"":{""color"":""black""},""opacity"":0.3,""x0"":15,""x1"":18,""y0"":0,""y1"":480520.735917028},{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":462039.169150988},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":462039.169150988},{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":16.45,""x1"":17.45,""y0"":0,""y1"":462039.169150988},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":16.45,""x1"":17.45,""y0"":0,""y1"":462039.169150988}],""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[0,0.15,0.3,0.45,1,1.15,1.3,1.45,2,2.15,2.3,2.45,3,3.15,3.3,3.45,4,4.15,4.3,4.45,5,5.15,5.3,5.45,6,6.15,6.3,6.45,7,7.15,7.3,7.45,8,8.15,8.3,8.45,9,9.15,9.3,9.45,10,10.15,10.3,10.45,11,11.15,11.3,11.45,12,12.15,12.3,12.45,13,13.15,13.3,13.45,14,14.15,14.3,14.45,15,15.15,15.3,15.45,16,16.15,16.3,16.45,17,17.15,17.3,17.45,18,18.15,18.3,18.45,19,19.15,19.3,19.45,20,20.15,20.3,20.45,21,21.15,21.3,21.45,22,22.15,22.3,22.45,23,23.15,23.3,23.45,24],""y"":[2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,6006.91633033752,3410.09362983704,4500.83061599731,4765.82431411743,8006.77574920654,6569.41974258423,7685.39112472534,8822.62908744812,13670.3632354736,19029.7920532227,30755.1913146973,39920.9330482483,73665.8692264557,93827.7578754425,155618.7302742,217000.553527832,339489.420529048,338475.687319819,362149.301777267,340161.540987396,375711.299628321,317973.359033012,325394.165305138,278288.722034136,304165.738966306,238774.572054545,211934.913558642,201615.277951558,261444.767658552,224182.515823682,240411.656651815,216316.87800916,258462.408271154,233479.573026657,241757.714330673,244000.05855751,314327.5847435,274645.207396825,261858.255025228,255500.890740713,302353.041838964,260254.874181112,247806.449596723,233514.178727468,284886.193562826,288110.05854257,336457.066494306,316149.00978597,384585.508785566,357340.021060308,390415.789463043,369449.946901703,453370.847463989,391825.133561516,403544.182270114,368451.706189219,458363.171119054,435890.852298101,462039.169150988,416507.126527786,446981.770751953,350170.189201355,340231.466928482,285659.168889682,294781.842376391,234046.789671898,222718.154975573,198955.189921061,202134.527949015,157585.30718867,154584.655879974,120148.76292038,137054.122617722,99612.0579586029,86707.1680469513,68113.8166332245,55674.9314994812,42631.0930080414,39612.3422546387,31067.600730896,35572.7873001099,29269.5131282806,25186.135099411,21243.2928848267,0],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  6,007"",""  3,410"",""  4,501"",""  4,766"",""  8,007"",""  6,569"",""  7,685"",""  8,823"","" 13,670"","" 19,030"","" 30,755"","" 39,921"","" 73,666"","" 93,828"",""155,619"",""217,001"",""339,489"",""338,476"",""362,149"",""340,162"",""375,711"",""317,973"",""325,394"",""278,289"",""304,166"",""238,775"",""211,935"",""201,615"",""261,445"",""224,183"",""240,412"",""216,317"",""258,462"",""233,480"",""241,758"",""244,000"",""314,328"",""274,645"",""261,858"",""255,501"",""302,353"",""260,255"",""247,806"",""233,514"",""284,886"",""288,110"",""336,457"",""316,149"",""384,586"",""357,340"",""390,416"",""369,450"",""453,371"",""391,825"",""403,544"",""368,452"",""458,363"",""435,891"",""462,039"",""416,507"",""446,982"",""350,170"",""340,231"",""285,659"",""294,782"",""234,047"",""222,718"",""198,955"",""202,135"",""157,585"",""154,585"",""120,149"",""137,054"","" 99,612"","" 86,707"","" 68,114"","" 55,675"","" 42,631"","" 39,612"","" 31,068"","" 35,573"","" 29,270"","" 25,186"","" 21,243"",""      0""],""name"":""All"",""type"":""scatter"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""line"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[0,0.15,0.3,0.45,1,1.15,1.3,1.45,2,2.15,2.3,2.45,3,3.15,3.3,3.45,4,4.15,4.3,4.45,5,5.15,5.3,5.45,6,6.15,6.3,6.45,7,7.15,7.3,7.45,8,8.15,8.3,8.45,9,9.15,9.3,9.45,10,10.15,10.3,10.45,11,11.15,11.3,11.45,12,12.15,12.3,12.45,13,13.15,13.3,13.45,14,14.15,14.3,14.45,15,15.15,15.3,15.45,16,16.15,16.3,16.45,17,17.15,17.3,17.45,18,18.15,18.3,18.45,19,19.15,19.3,19.45,20,20.15,20.3,20.45,21,21.15,21.3,21.45,22,22.15,22.3,22.45,23,23.15,23.3,23.45],""y"":[313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,1368.14471435547,673.78125,1290.64489746094,1290.64489746094,3582.1994972229,2464.88962936402,2760.15663146973,3252.00533103943,7170.20836257935,10944.5705299377,18278.1314353943,22772.9522399902,40962.7974319458,46689.6261520386,71671.4431629181,92738.5137805939,150121.176033656,160475.758799617,174631.647320175,160235.875906372,176584.240990702,145970.291184807,133684.912169456,107898.875323931,98084.0097525914,68907.8140633901,60239.1537841161,52148.5661805471,61376.8012002309,53499.0538438161,57156.4226678213,51714.7440255483,55748.2428334554,50851.3968804677,62917.8235581716,64655.5109418233,107873.165196737,89689.8134759267,84471.6837056478,79623.8989995321,96105.3636945089,75678.8679231008,63543.777484258,55533.1231854757,70126.9929688772,68129.5283292135,68327.0395387014,64309.9662955602,80941.5015033086,74425.043481191,92530.7737687429,86981.9077679952,121737.705289586,123305.580771192,149290.841483498,140414.695619965,199862.497659365,190494.715003649,189810.962597847,155000.185897827,158401.026243846,118268.938961665,103551.622719447,79876.4266621272,70955.6488720576,51992.2698087692,47440.1874818802,41133.6848983765,44302.4138393402,35089.6498508453,28721.6733798981,20429.4450054169,29044.1197738648,21860.3189640045,16134.6745758057,12429.3692684174,10275.6075439453,10753.3359584808,9298.27993583679,10544.0161933899,9824.87848091125,8994.08058929444,5731.84379768372,4000.18750953674],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""  1,368"",""    674"",""  1,291"",""  1,291"",""  3,582"",""  2,465"",""  2,760"",""  3,252"",""  7,170"","" 10,945"","" 18,278"","" 22,773"","" 40,963"","" 46,690"","" 71,671"","" 92,739"",""150,121"",""160,476"",""174,632"",""160,236"",""176,584"",""145,970"",""133,685"",""107,899"","" 98,084"","" 68,908"","" 60,239"","" 52,149"","" 61,377"","" 53,499"","" 57,156"","" 51,715"","" 55,748"","" 50,851"","" 62,918"","" 64,656"",""107,873"","" 89,690"","" 84,472"","" 79,624"","" 96,105"","" 75,679"","" 63,544"","" 55,533"","" 70,127"","" 68,130"","" 68,327"","" 64,310"","" 80,942"","" 74,425"","" 92,531"","" 86,982"",""121,738"",""123,306"",""149,291"",""140,415"",""199,862"",""190,495"",""189,811"",""155,000"",""158,401"",""118,269"",""103,552"","" 79,876"","" 70,956"","" 51,992"","" 47,440"","" 41,134"","" 44,302"","" 35,090"","" 28,722"","" 20,429"","" 29,044"","" 21,860"","" 16,135"","" 12,429"","" 10,276"","" 10,753"",""  9,298"","" 10,544"",""  9,825"",""  8,994"",""  5,732"",""  4,000""],""name"":""Work"",""type"":""scatter"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""line"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[3.3,8,12,16.3,20.5999166666667],""y"":[489761.519300048,489761.519300048,489761.519300048,489761.519300048,489761.519300048],""mode"":""text"",""hoverinfo"":[""x"",""x"",""x"",""x"",""x""],""text"":[""NT"",""AM"",""MD"",""PM"",""NT""],""name"":""Period"",""type"":""scatter"",""marker"":{""color"":""rgba(44,160,44,1)"",""line"":{""color"":""rgba(44,160,44,1)""}},""error_y"":{""color"":""rgba(44,160,44,1)""},""error_x"":{""color"":""rgba(44,160,44,1)""},""line"":{""color"":""rgba(44,160,44,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
+<div id=""htmlwidget-ab75efd2f5f1093922b7"" style=""width:672px;height:480px;"" class=""plotly html-widget""></div>
+<script type=""application/json"" data-for=""htmlwidget-ab75efd2f5f1093922b7"">{""x"":{""visdat"":{""3a70550f5621"":[""function () "",""plotlyVisDat""]},""cur_data"":""3a70550f5621"",""attrs"":{""3a70550f5621"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""All"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter""},""3a70550f5621.1"":{""x"":{},""y"":{},""mode"":""lines"",""hoverinfo"":""text+x"",""text"":{},""name"":""Work"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true},""3a70550f5621.2"":{""x"":[3.3,8,12,16.3,20.5999166666667],""y"":[489761.519300048,489761.519300048,489761.519300048,489761.519300048,489761.519300048],""mode"":""text"",""hoverinfo"":""x"",""text"":[""NT"",""AM"",""MD"",""PM"",""NT""],""name"":""Period"",""alpha_stroke"":1,""sizes"":[10,100],""spans"":[1,20],""type"":""scatter"",""inherit"":true}},""layout"":{""margin"":{""b"":40,""l"":60,""t"":25,""r"":10},""title"":""Peak Periods"",""xaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Time of Day""},""yaxis"":{""domain"":[0,1],""automargin"":true,""title"":""Trips in Motion""},""shapes"":[{""type"":""rect"",""fillcolor"":""gray"",""line"":{""color"":""black""},""opacity"":0.3,""x0"":7,""x1"":9,""y0"":0,""y1"":480520.735917028},{""type"":""rect"",""fillcolor"":""gray"",""line"":{""color"":""black""},""opacity"":0.3,""x0"":15,""x1"":18,""y0"":0,""y1"":480520.735917028},{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":462039.169150988},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":7,""x1"":8,""y0"":0,""y1"":462039.169150988},{""type"":""rect"",""fillcolor"":""blue"",""line"":{""color"":""blue""},""opacity"":0.3,""x0"":16.45,""x1"":17.45,""y0"":0,""y1"":462039.169150988},{""type"":""rect"",""fillcolor"":""green"",""line"":{""color"":""green""},""opacity"":0.3,""x0"":16.45,""x1"":17.45,""y0"":0,""y1"":462039.169150988}],""hovermode"":""closest"",""showlegend"":true},""source"":""A"",""config"":{""showSendToCloud"":false},""data"":[{""x"":[0,0.15,0.3,0.45,1,1.15,1.3,1.45,2,2.15,2.3,2.45,3,3.15,3.3,3.45,4,4.15,4.3,4.45,5,5.15,5.3,5.45,6,6.15,6.3,6.45,7,7.15,7.3,7.45,8,8.15,8.3,8.45,9,9.15,9.3,9.45,10,10.15,10.3,10.45,11,11.15,11.3,11.45,12,12.15,12.3,12.45,13,13.15,13.3,13.45,14,14.15,14.3,14.45,15,15.15,15.3,15.45,16,16.15,16.3,16.45,17,17.15,17.3,17.45,18,18.15,18.3,18.45,19,19.15,19.3,19.45,20,20.15,20.3,20.45,21,21.15,21.3,21.45,22,22.15,22.3,22.45,23,23.15,23.3,23.45,24],""y"":[2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,2169.83521461487,6006.91633033752,3410.09362983704,4500.83061599731,4765.82431411743,8006.77574920654,6569.41974258423,7685.39112472534,8822.62908744812,13670.3632354736,19029.7920532227,30755.1913146973,39920.9330482483,73665.8692264557,93827.7578754425,155618.7302742,217000.553527832,339489.420529048,338475.687319819,362149.301777267,340161.540987396,375711.299628321,317973.359033012,325394.165305138,278288.722034136,304165.738966306,238774.572054545,211934.913558642,201615.277951558,261444.767658552,224182.515823682,240411.656651815,216316.87800916,258462.408271154,233479.573026657,241757.714330673,244000.05855751,314327.5847435,274645.207396825,261858.255025228,255500.890740713,302353.041838964,260254.874181112,247806.449596723,233514.178727468,284886.193562826,288110.05854257,336457.066494306,316149.00978597,384585.508785566,357340.021060308,390415.789463043,369449.946901703,453370.847463989,391825.133561516,403544.182270114,368451.706189219,458363.171119054,435890.852298101,462039.169150988,416507.126527786,446981.770751953,350170.189201355,340231.466928482,285659.168889682,294781.842376391,234046.789671898,222718.154975573,198955.189921061,202134.527949015,157585.30718867,154584.655879974,120148.76292038,137054.122617722,99612.0579586029,86707.1680469513,68113.8166332245,55674.9314994812,42631.0930080414,39612.3422546387,31067.600730896,35572.7873001099,29269.5131282806,25186.135099411,21243.2928848267,0],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  2,170"",""  6,007"",""  3,410"",""  4,501"",""  4,766"",""  8,007"",""  6,569"",""  7,685"",""  8,823"","" 13,670"","" 19,030"","" 30,755"","" 39,921"","" 73,666"","" 93,828"",""155,619"",""217,001"",""339,489"",""338,476"",""362,149"",""340,162"",""375,711"",""317,973"",""325,394"",""278,289"",""304,166"",""238,775"",""211,935"",""201,615"",""261,445"",""224,183"",""240,412"",""216,317"",""258,462"",""233,480"",""241,758"",""244,000"",""314,328"",""274,645"",""261,858"",""255,501"",""302,353"",""260,255"",""247,806"",""233,514"",""284,886"",""288,110"",""336,457"",""316,149"",""384,586"",""357,340"",""390,416"",""369,450"",""453,371"",""391,825"",""403,544"",""368,452"",""458,363"",""435,891"",""462,039"",""416,507"",""446,982"",""350,170"",""340,231"",""285,659"",""294,782"",""234,047"",""222,718"",""198,955"",""202,135"",""157,585"",""154,585"",""120,149"",""137,054"","" 99,612"","" 86,707"","" 68,114"","" 55,675"","" 42,631"","" 39,612"","" 31,068"","" 35,573"","" 29,270"","" 25,186"","" 21,243"",""      0""],""name"":""All"",""type"":""scatter"",""marker"":{""color"":""rgba(31,119,180,1)"",""line"":{""color"":""rgba(31,119,180,1)""}},""error_y"":{""color"":""rgba(31,119,180,1)""},""error_x"":{""color"":""rgba(31,119,180,1)""},""line"":{""color"":""rgba(31,119,180,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[0,0.15,0.3,0.45,1,1.15,1.3,1.45,2,2.15,2.3,2.45,3,3.15,3.3,3.45,4,4.15,4.3,4.45,5,5.15,5.3,5.45,6,6.15,6.3,6.45,7,7.15,7.3,7.45,8,8.15,8.3,8.45,9,9.15,9.3,9.45,10,10.15,10.3,10.45,11,11.15,11.3,11.45,12,12.15,12.3,12.45,13,13.15,13.3,13.45,14,14.15,14.3,14.45,15,15.15,15.3,15.45,16,16.15,16.3,16.45,17,17.15,17.3,17.45,18,18.15,18.3,18.45,19,19.15,19.3,19.45,20,20.15,20.3,20.45,21,21.15,21.3,21.45,22,22.15,22.3,22.45,23,23.15,23.3,23.45],""y"":[313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,313.570938110351,1368.14471435547,673.78125,1290.64489746094,1290.64489746094,3582.1994972229,2464.88962936402,2760.15663146973,3252.00533103943,7170.20836257935,10944.5705299377,18278.1314353943,22772.9522399902,40962.7974319458,46689.6261520386,71671.4431629181,92738.5137805939,150121.176033656,160475.758799617,174631.647320175,160235.875906372,176584.240990702,145970.291184807,133684.912169456,107898.875323931,98084.0097525914,68907.8140633901,60239.1537841161,52148.5661805471,61376.8012002309,53499.0538438161,57156.4226678213,51714.7440255483,55748.2428334554,50851.3968804677,62917.8235581716,64655.5109418233,107873.165196737,89689.8134759267,84471.6837056478,79623.8989995321,96105.3636945089,75678.8679231008,63543.777484258,55533.1231854757,70126.9929688772,68129.5283292135,68327.0395387014,64309.9662955602,80941.5015033086,74425.043481191,92530.7737687429,86981.9077679952,121737.705289586,123305.580771192,149290.841483498,140414.695619965,199862.497659365,190494.715003649,189810.962597847,155000.185897827,158401.026243846,118268.938961665,103551.622719447,79876.4266621272,70955.6488720576,51992.2698087692,47440.1874818802,41133.6848983765,44302.4138393402,35089.6498508453,28721.6733798981,20429.4450054169,29044.1197738648,21860.3189640045,16134.6745758057,12429.3692684174,10275.6075439453,10753.3359584808,9298.27993583679,10544.0161933899,9824.87848091125,8994.08058929444,5731.84379768372,4000.18750953674],""mode"":""lines"",""hoverinfo"":[""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x"",""text+x""],""text"":[""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""    314"",""  1,368"",""    674"",""  1,291"",""  1,291"",""  3,582"",""  2,465"",""  2,760"",""  3,252"",""  7,170"","" 10,945"","" 18,278"","" 22,773"","" 40,963"","" 46,690"","" 71,671"","" 92,739"",""150,121"",""160,476"",""174,632"",""160,236"",""176,584"",""145,970"",""133,685"",""107,899"","" 98,084"","" 68,908"","" 60,239"","" 52,149"","" 61,377"","" 53,499"","" 57,156"","" 51,715"","" 55,748"","" 50,851"","" 62,918"","" 64,656"",""107,873"","" 89,690"","" 84,472"","" 79,624"","" 96,105"","" 75,679"","" 63,544"","" 55,533"","" 70,127"","" 68,130"","" 68,327"","" 64,310"","" 80,942"","" 74,425"","" 92,531"","" 86,982"",""121,738"",""123,306"",""149,291"",""140,415"",""199,862"",""190,495"",""189,811"",""155,000"",""158,401"",""118,269"",""103,552"","" 79,876"","" 70,956"","" 51,992"","" 47,440"","" 41,134"","" 44,302"","" 35,090"","" 28,722"","" 20,429"","" 29,044"","" 21,860"","" 16,135"","" 12,429"","" 10,276"","" 10,753"",""  9,298"","" 10,544"",""  9,825"",""  8,994"",""  5,732"",""  4,000""],""name"":""Work"",""type"":""scatter"",""marker"":{""color"":""rgba(255,127,14,1)"",""line"":{""color"":""rgba(255,127,14,1)""}},""error_y"":{""color"":""rgba(255,127,14,1)""},""error_x"":{""color"":""rgba(255,127,14,1)""},""line"":{""color"":""rgba(255,127,14,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null},{""x"":[3.3,8,12,16.3,20.5999166666667],""y"":[489761.519300048,489761.519300048,489761.519300048,489761.519300048,489761.519300048],""mode"":""text"",""hoverinfo"":[""x"",""x"",""x"",""x"",""x""],""text"":[""NT"",""AM"",""MD"",""PM"",""NT""],""name"":""Period"",""type"":""scatter"",""marker"":{""color"":""rgba(44,160,44,1)"",""line"":{""color"":""rgba(44,160,44,1)""}},""error_y"":{""color"":""rgba(44,160,44,1)""},""error_x"":{""color"":""rgba(44,160,44,1)""},""line"":{""color"":""rgba(44,160,44,1)""},""xaxis"":""x"",""yaxis"":""y"",""frame"":null}],""highlight"":{""on"":""plotly_click"",""persistent"":false,""dynamic"":false,""selectize"":false,""opacityDim"":0.2,""selected"":{""opacity"":1},""debounce"":0},""shinyEvents"":[""plotly_hover"",""plotly_click"",""plotly_selected"",""plotly_relayout"",""plotly_brushed"",""plotly_brushing"",""plotly_clickannotation"",""plotly_doubleclick"",""plotly_deselect"",""plotly_afterplot"",""plotly_sunburstclick""],""base_url"":""https://plot.ly""},""evals"":[],""jsHooks"":[]}</script>
 <p>The table below shows the average 15-minute trips in motion during each period. These period definitions accurately capture the disparate characteristics of each.</p>
 <table class=""table"" style=""width: auto !important; margin-left: auto; margin-right: auto;"">
 <thead>"
Triangle-Modeling-and-Analytics,TRMG2,bb949a3ced5bf1c6c9d30e4ec9bb0b869776a011,Kyle Ward,kyle@caliper.com,2020-12-09T21:45:49Z,Kyle Ward,kyle@caliper.com,2020-12-09T21:45:49Z,"Re-create the renv library

Used renv::hydrate() to create an exact copy of my library.
This resolved some issues surrounding the RDCOMClient
and caliperR packages.",docs/TAZs.Rmd;docs/renv.lock,True,False,True,False,23,159,182,"---FILE: docs/TAZs.Rmd---
@@ -13,6 +13,9 @@ knitr::opts_chunk$set(echo = TRUE)
 library(tidyverse)
 library(sf)
 library(leaflet)
+
+library(RDCOMClient)
+library(caliperR)
 ```
 
 ```{r}
@@ -86,7 +89,7 @@ calc_percents <- se_data %>%
 ```
 
 ```{r}
-if (1 = 0) {
+if (1 == 0) {
   write_csv(
     calc_percents, ""data/output/se_data/se_2016.csv"",
     na = ""0""

---FILE: docs/renv.lock---
@@ -23,13 +23,6 @@
       ""Repository"": ""CRAN"",
       ""Hash"": ""4744be45519d675af66c28478720fce5""
     },
-    ""DT"": {
-      ""Package"": ""DT"",
-      ""Version"": ""0.16"",
-      ""Source"": ""Repository"",
-      ""Repository"": ""CRAN"",
-      ""Hash"": ""acac794cc3e393ca65f916e5ced5c1d2""
-    },
     ""Formula"": {
       ""Package"": ""Formula"",
       ""Version"": ""1.2-4"",
@@ -39,10 +32,10 @@
     },
     ""Hmisc"": {
       ""Package"": ""Hmisc"",
-      ""Version"": ""4.4-2"",
+      ""Version"": ""4.4-1"",
       ""Source"": ""Repository"",
       ""Repository"": ""CRAN"",
-      ""Hash"": ""66458e906b2112a8b1639964efd77d7c""
+      ""Hash"": ""35bce0d50fdf86441171ff6742e29c8c""
     },
     ""KernSmooth"": {
       ""Package"": ""KernSmooth"",
@@ -133,13 +126,6 @@
       ""Repository"": ""CRAN"",
       ""Hash"": ""9addc7e2c5954eca5719928131fed98c""
     },
-    ""brew"": {
-      ""Package"": ""brew"",
-      ""Version"": ""1.0-6"",
-      ""Source"": ""Repository"",
-      ""Repository"": ""CRAN"",
-      ""Hash"": ""92a5f887f9ae3035ac7afde22ba73ee9""
-    },
     ""brio"": {
       ""Package"": ""brio"",
       ""Version"": ""1.1.0"",
@@ -157,15 +143,9 @@
     ""caliperR"": {
       ""Package"": ""caliperR"",
       ""Version"": ""1.0.0"",
-      ""Source"": ""GitHub"",
-      ""Remotes"": ""dkyleward/RDCOMClient"",
-      ""RemoteType"": ""github"",
-      ""RemoteHost"": ""api.github.com"",
-      ""RemoteRepo"": ""caliperR"",
-      ""RemoteUsername"": ""dkyleward"",
-      ""RemoteRef"": ""HEAD"",
-      ""RemoteSha"": ""1230a5905c6ce40af0ef36678d987e8a0efa6f23"",
-      ""Hash"": ""cacaad6b4db01c18f4b8f679507aa71a""
+      ""Source"": ""unknown"",
+      ""Remotes"": ""Caliper-Corporation/RDCOMClient"",
+      ""Hash"": ""841acc24eda79bcc3428ad472ba7e7f6""
     },
     ""callr"": {
       ""Package"": ""callr"",
@@ -225,24 +205,10 @@
     },
     ""colorspace"": {
       ""Package"": ""colorspace"",
-      ""Version"": ""2.0-0"",
-      ""Source"": ""Repository"",
-      ""Repository"": ""CRAN"",
-      ""Hash"": ""abea3384649ef37f60ef51ce002f3547""
-    },
-    ""commonmark"": {
-      ""Package"": ""commonmark"",
-      ""Version"": ""1.7"",
-      ""Source"": ""Repository"",
-      ""Repository"": ""CRAN"",
-      ""Hash"": ""0f22be39ec1d141fd03683c06f3a6e67""
-    },
-    ""covr"": {
-      ""Package"": ""covr"",
-      ""Version"": ""3.5.1"",
+      ""Version"": ""1.4-1"",
       ""Source"": ""Repository"",
       ""Repository"": ""CRAN"",
-      ""Hash"": ""6d80a9fc3c0c8473153b54fa54719dfd""
+      ""Hash"": ""6b436e95723d1f0e861224dd9b094dfb""
     },
     ""cpp11"": {
       ""Package"": ""cpp11"",
@@ -293,13 +259,6 @@
       ""Repository"": ""CRAN"",
       ""Hash"": ""6c8fe8fa26a23b79949375d372c7b395""
     },
-    ""devtools"": {
-      ""Package"": ""devtools"",
-      ""Version"": ""2.3.2"",
-      ""Source"": ""Repository"",
-      ""Repository"": ""CRAN"",
-      ""Hash"": ""415656f50722f5b6e6bcf80855ce11b9""
-    },
     ""diffobj"": {
       ""Package"": ""diffobj"",
       ""Version"": ""0.3.2"",
@@ -398,27 +357,6 @@
       ""Repository"": ""CRAN"",
       ""Hash"": ""4ded8b439797f7b1693bd3d238d0106b""
     },
-    ""gh"": {
-      ""Package"": ""gh"",
-      ""Version"": ""1.2.0"",
-      ""Source"": ""Repository"",
-      ""Repository"": ""CRAN"",
-      ""Hash"": ""05129b4387282404780d2f8593636388""
-    },
-    ""git2r"": {
-      ""Package"": ""git2r"",
-      ""Version"": ""0.27.1"",
-      ""Source"": ""Repository"",
-      ""Repository"": ""CRAN"",
-      ""Hash"": ""531a82d1beed1f545beb25f4f5945bf7""
-    },
-    ""gitcreds"": {
-      ""Package"": ""gitcreds"",
-      ""Version"": ""0.1.1"",
-      ""Source"": ""Repository"",
-      ""Repository"": ""CRAN"",
-      ""Hash"": ""f3aefccc1cc50de6338146b62f115de8""
-    },
     ""glue"": {
       ""Package"": ""glue"",
       ""Version"": ""1.4.2"",
@@ -496,13 +434,6 @@
       ""Repository"": ""CRAN"",
       ""Hash"": ""a525aba14184fec243f9eaec62fbed43""
     },
-    ""ini"": {
-      ""Package"": ""ini"",
-      ""Version"": ""0.3.1"",
-      ""Source"": ""Repository"",
-      ""Repository"": ""CRAN"",
-      ""Hash"": ""6154ec2223172bce8162d4153cda21f7""
-    },
     ""isoband"": {
       ""Package"": ""isoband"",
       ""Version"": ""0.2.2"",
@@ -596,17 +527,17 @@
     },
     ""lubridate"": {
       ""Package"": ""lubridate"",
-      ""Version"": ""1.7.9.2"",
+      ""Version"": ""1.7.9"",
       ""Source"": ""Repository"",
       ""Repository"": ""CRAN"",
-      ""Hash"": ""5b5b02f621d39a499def7923a5aee746""
+      ""Hash"": ""fc1c91e2e8d9e1fc932e75aa1ed989b7""
     },
     ""magrittr"": {
       ""Package"": ""magrittr"",
-      ""Version"": ""2.0.1"",
+      ""Version"": ""1.5"",
       ""Source"": ""Repository"",
       ""Repository"": ""CRAN"",
-      ""Hash"": ""41287f1ac7d28a92f0a286ed507928d3""
+      ""Hash"": ""1bb58822a20301cee84a41678e25d9b7""
     },
     ""markdown"": {
       ""Package"": ""markdown"",
@@ -615,13 +546,6 @@
       ""Repository"": ""CRAN"",
       ""Hash"": ""61e4a10781dd00d7d81dd06ca9b94e95""
     },
-    ""memoise"": {
-      ""Package"": ""memoise"",
-      ""Version"": ""1.1.0"",
-      ""Source"": ""Repository"",
-      ""Repository"": ""CRAN"",
-      ""Hash"": ""58baa74e4603fcfb9a94401c58c8f9b1""
-    },
     ""mgcv"": {
       ""Package"": ""mgcv"",
       ""Version"": ""1.8-33"",
@@ -764,17 +688,10 @@
     },
     ""raster"": {
       ""Package"": ""raster"",
-      ""Version"": ""3.4-5"",
+      ""Version"": ""3.3-13"",
       ""Source"": ""Repository"",
       ""Repository"": ""CRAN"",
-      ""Hash"": ""a3ded548110163cf499d63c3932dd499""
-    },
-    ""rcmdcheck"": {
-      ""Package"": ""rcmdcheck"",
-      ""Version"": ""1.3.3"",
-      ""Source"": ""Repository"",
-      ""Repository"": ""CRAN"",
-      ""Hash"": ""ed95895886dab6d2a584da45503555da""
+      ""Hash"": ""51cfecf7b9518d46b119f92d581616b6""
     },
     ""readr"": {
       ""Package"": ""readr"",
@@ -804,34 +721,13 @@
       ""Repository"": ""CRAN"",
       ""Hash"": ""76c9e04c712a05848ae7a23d2f170a40""
     },
-    ""remotes"": {
-      ""Package"": ""remotes"",
-      ""Version"": ""2.2.0"",
-      ""Source"": ""Repository"",
-      ""Repository"": ""CRAN"",
-      ""Hash"": ""430a0908aee75b1fcba0e62857cab0ce""
-    },
-    ""renv"": {
-      ""Package"": ""renv"",
-      ""Version"": ""0.12.2"",
-      ""Source"": ""Repository"",
-      ""Repository"": ""CRAN"",
-      ""Hash"": ""398cc1ea892e1aade66d1ecbb2874d24""
-    },
     ""reprex"": {
       ""Package"": ""reprex"",
       ""Version"": ""0.3.0"",
       ""Source"": ""Repository"",
       ""Repository"": ""CRAN"",
       ""Hash"": ""b06bfb3504cc8a4579fd5567646f745b""
     },
-    ""rex"": {
-      ""Package"": ""rex"",
-      ""Version"": ""1.2.0"",
-      ""Source"": ""Repository"",
-      ""Repository"": ""CRAN"",
-      ""Hash"": ""093584b944440c5cd07a696b3c8e0e4c""
-    },
     ""rlang"": {
       ""Package"": ""rlang"",
       ""Version"": ""0.4.8"",
@@ -846,13 +742,6 @@
       ""Repository"": ""CRAN"",
       ""Hash"": ""20a0a94af9e8f7040510447763aab3e9""
     },
-    ""roxygen2"": {
-      ""Package"": ""roxygen2"",
-      ""Version"": ""7.1.1"",
-      ""Source"": ""Repository"",
-      ""Repository"": ""CRAN"",
-      ""Hash"": ""fcd94e00cc409b25d07ca50f7bf339f5""
-    },
     ""rpart"": {
       ""Package"": ""rpart"",
       ""Version"": ""4.1-15"",
@@ -862,24 +751,17 @@
     },
     ""rprojroot"": {
       ""Package"": ""rprojroot"",
-      ""Version"": ""2.0.2"",
+      ""Version"": ""1.3-2"",
       ""Source"": ""Repository"",
       ""Repository"": ""CRAN"",
-      ""Hash"": ""249d8cd1e74a8f6a26194a91b47f21d1""
+      ""Hash"": ""f6a407ae5dd21f6f80a6708bbb6eb3ae""
     },
     ""rstudioapi"": {
       ""Package"": ""rstudioapi"",
-      ""Version"": ""0.13"",
-      ""Source"": ""Repository"",
-      ""Repository"": ""CRAN"",
-      ""Hash"": ""06c85365a03fdaf699966cc1d3cf53ea""
-    },
-    ""rversions"": {
-      ""Package"": ""rversions"",
-      ""Version"": ""2.0.2"",
+      ""Version"": ""0.12"",
       ""Source"": ""Repository"",
       ""Repository"": ""CRAN"",
-      ""Hash"": ""0ec41191f744d0f5afad8c6f35cc36e4""
+      ""Hash"": ""7849949afe010c2bdaffe05ccff4c731""
     },
     ""rvest"": {
       ""Package"": ""rvest"",
@@ -902,13 +784,6 @@
       ""Repository"": ""CRAN"",
       ""Hash"": ""3838071b66e0c566d55cc26bd6e27bf4""
     },
-    ""sessioninfo"": {
-      ""Package"": ""sessioninfo"",
-      ""Version"": ""1.1.1"",
-      ""Source"": ""Repository"",
-      ""Repository"": ""CRAN"",
-      ""Hash"": ""308013098befe37484df72c39cf90d6e""
-    },
     ""sf"": {
       ""Package"": ""sf"",
       ""Version"": ""0.9-6"",
@@ -1000,13 +875,6 @@
       ""Repository"": ""CRAN"",
       ""Hash"": ""4a3df844d6d35ca2ba2b7ba95446b955""
     },
-    ""usethis"": {
-      ""Package"": ""usethis"",
-      ""Version"": ""1.6.3"",
-      ""Source"": ""Repository"",
-      ""Repository"": ""CRAN"",
-      ""Hash"": ""c541a7aed5f7fb3b487406bf92842e34""
-    },
     ""utf8"": {
       ""Package"": ""utf8"",
       ""Version"": ""1.1.4"",
@@ -1016,10 +884,10 @@
     },
     ""vctrs"": {
       ""Package"": ""vctrs"",
-      ""Version"": ""0.3.5"",
+      ""Version"": ""0.3.4"",
       ""Source"": ""Repository"",
       ""Repository"": ""CRAN"",
-      ""Hash"": ""d25c5bea636cf892edbfd64fc3d20c20""
+      ""Hash"": ""0bc90078aeee42f2520b1d0a33bd6758""
     },
     ""viridis"": {
       ""Package"": ""viridis"",
@@ -1077,13 +945,6 @@
       ""Repository"": ""CRAN"",
       ""Hash"": ""d4d71a75dd3ea9eb5fa28cc21f9585e2""
     },
-    ""xopen"": {
-      ""Package"": ""xopen"",
-      ""Version"": ""1.0.0"",
-      ""Source"": ""Repository"",
-      ""Repository"": ""CRAN"",
-      ""Hash"": ""6c85f015dee9cc7710ddd20f86881f58""
-    },
     ""yaml"": {
       ""Package"": ""yaml"",
       ""Version"": ""2.2.1"","
Triangle-Modeling-and-Analytics,TRMG2,ed2ea255b7cd6806fbac87243ccd2f88ef4f7a3f,Kyle Ward,kyle@caliper.com,2020-12-09T16:22:48Z,Kyle Ward,kyle@caliper.com,2020-12-09T16:22:48Z,"Corrected node IDs

Did a check and found that SE table rows did not equal number
of centroid nodes. Found and corrected issues and re-exported.",master/networks/master_links.BIN;master/networks/master_links.BX;master/networks/master_links.dln;master/networks/master_links.kln;master/networks/master_links.pts;master/networks/master_links.sty;master/networks/master_links.upx;master/networks/master_links_.BIN;master/networks/master_links_.BX;master/networks/master_links_.DCB;master/networks/master_links_.sty;master/networks/master_transit.rtg;master/networks/master_transit.rts,False,False,False,False,7,6,13,"---FILE: master/networks/master_links_.DCB---
@@ -1,7 +1,8 @@
 TRMG2 Master Network
-44
-""new_id:1"",I,1,4,0,4,0,,"""","""",,""Sum"",
-""Centroid"",I,5,4,0,8,0,,"""",""Nodes on the network where travel can begin/end.|||1: the node is a centroid|0: not a centroid"",,""Blank"",
-""External"",I,9,4,0,8,0,,"""",""1: the node is an external centroid/station|0: is not||All external stations are centroids. Not all centroids|are external stations."",,""Blank"",
-""PnR Category1"",C,13,16,0,16,0,,"""","""",,""Blank"",
-""PnR Category2"",C,29,16,0,16,0,,"""","""",,""Blank"",
+48
+""revised_id"",I,1,4,0,8,0,,"""","""",,""Sum"",
+""ID"",I,5,4,0,10,0,,"""","""",,""Sum"",
+""Centroid"",I,9,4,0,8,0,,"""",""Nodes on the network where travel can begin/end.|||1: the node is a centroid|0: not a centroid"",,""Blank"",
+""External"",I,13,4,0,8,0,,"""",""1: the node is an external centroid/station|0: is not||All external stations are centroids. Not all centroids|are external stations."",,""Blank"",
+""PnR Category1"",C,17,16,0,16,0,,"""","""",,""Blank"",
+""PnR Category2"",C,33,16,0,16,0,,"""","""",,""Blank"","
Triangle-Modeling-and-Analytics,TRMG2,e7e7cf646697f8a8a0df02ba694a426c31449e60,Kyle Ward,kyle@caliper.com,2020-12-09T14:40:26Z,Kyle Ward,kyle@caliper.com,2020-12-09T14:40:26Z,"Add codes to the se data table

For categorical fields, codes make the options clear
and reduce typo errors.",master/se_data/se_2016.DCB;master/se_data/se_2016.bxl,False,False,False,False,1,1,2,"---FILE: master/se_data/se_2016.DCB---
@@ -1,7 +1,7 @@
 
 94
 ""TAZ"",I,1,4,0,11,0,,"""","""",,""Sum"",
-""Type"",C,5,10,0,10,0,,"""","""",,""Copy"",
+""Type"",C,5,10,0,10,0,,"""",""Whether the centroid is an internal or external zone"",,""Copy"",
 ""HH"",I,15,4,0,11,0,,"""","""",,""Sum"",
 ""HH_POP"",I,19,4,0,11,0,,"""","""",,""Sum"",
 ""MEANINC"",I,23,4,0,11,0,,"""","""",,""Sum"","
Triangle-Modeling-and-Analytics,TRMG2,3c65023aecebec0c3b920cd58abdf09f93f915a5,Kyle Ward,kyle@caliper.com,2020-12-08T20:34:50Z,Kyle Ward,kyle@caliper.com,2020-12-08T20:34:50Z,"Export network to update centroid node IDs

After editing the network, the new centroids had IDs different
from their associated TAZ IDs. The new exported layer fixes
this. I also changed the file name and layer name to
master_links to futher clarify it from 'network' (.net files).",master/networks/master_links.BIN;master/networks/master_links.BX;master/networks/master_links.DCB;master/networks/master_links.dbd;master/networks/master_links.dln;master/networks/master_links.kln;master/networks/master_links.pts;master/networks/master_links.sty;master/networks/master_links_.BIN;master/networks/master_links_.BX;master/networks/master_links_.DCB;master/networks/master_links_.sty;master/networks/master_network.BX;master/networks/master_network.DCB;master/networks/master_network.dln;master/networks/master_network.kln;master/networks/master_network.sty;master/networks/master_network.upx;master/networks/master_network_.BIN;master/networks/master_network_.BX;master/networks/master_network_.DCB;master/networks/master_network_.sty;master/networks/master_transit.rtg;master/networks/master_transit.rts,False,False,False,False,119,135,254,"---FILE: master/networks/master_links.DCB---
@@ -0,0 +1,112 @@
+TRMG2 Master Network
+982
+""ID"",I,1,4,0,4,0,,"""","""",,""Sum"",
+""RoadName"",C,5,32,0,32,0,,"""","""",,""Copy"",
+""NCDOTClass"",C,37,20,0,20,0,,"""",""This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"",
+""HCMType"",C,57,20,0,20,0,,"""",""Highway Capacity Manuall Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|MajorArterial|MinorArterial|CollectorLocal|Ramp|CC|PNR|TransitOnly"",,""Copy"",
+""ABLanes"",I,77,4,0,8,0,,"""",""Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""BALanes"",I,81,4,0,8,0,,"""",""Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""PostedSpeed"",I,85,4,0,8,0,,"""",""Speed as posted on roadway signage"",,""Copy"",
+""HCMMedian"",C,89,16,0,16,0,,"""",""HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
+""DTWB"",C,105,9,0,9,0,,"""",""Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
+""TollType"",C,114,9,0,9,0,,"""",""Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
+""HOVType"",C,123,9,0,9,0,,"""",""None: No occupancy restriction|HOV2: Requires at least 2 occupants to use|HOV3: Requires at least 3 occupants to use"",,""Copy"",
+""special_temp"",I,132,4,0,8,0,,"""",""Hanging on to this field temporarily until I determine|how to mark toll/hov/hot links"",,""Copy"",
+""parklink_temp"",I,136,4,0,8,0,,"""",""Keeping this temp field for now to keep track of parking|lot links"",,""Copy"",
+""p1ID"",C,140,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
+""p1HCMType"",C,156,16,0,16,0,,"""",""Project Field|Highway Capacity Manuall Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|MajorArterial|MinorArterial|CollectorLocal|Ramp|CC|PNR|TransitOnly"",,""Copy"",
+""p1ABLanes"",I,172,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""p1BALanes"",I,176,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""p1PostedSpeed"",I,180,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
+""p1HCMMedian"",C,184,16,0,16,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
+""p1DTWB"",C,200,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
+""p1TollType"",C,209,9,0,9,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
+""p1HOVType"",C,218,9,0,9,0,,"""",""Project Field|None: No occupancy restriction|HOV2: Requires at least 2 occupants to use|HOV3: Requires at least 3 occupants to use"",,""Copy"",
+""p2ID"",C,227,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
+""p2HCMType"",C,243,16,0,16,0,,"""",""Project Field|Highway Capacity Manuall Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|MajorArterial|MinorArterial|CollectorLocal|Ramp|CC|PNR|TransitOnly"",,""Copy"",
+""p2ABLanes"",I,259,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""p2BALanes"",I,263,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""p2PostedSpeed"",I,267,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
+""p2HCMMedian"",C,271,16,0,16,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
+""p2DTWB"",C,287,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
+""p2TollType"",C,296,9,0,9,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
+""p2HOVType"",C,305,9,0,9,0,,"""",""Project Field|None: No occupancy restriction|HOV2: Requires at least 2 occupants to use|HOV3: Requires at least 3 occupants to use"",,""Copy"",
+""p3ID"",C,314,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
+""p3HCMType"",C,330,16,0,16,0,,"""",""Project Field|Highway Capacity Manuall Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|MajorArterial|MinorArterial|CollectorLocal|Ramp|CC|PNR|TransitOnly"",,""Copy"",
+""p3ABLanes"",I,346,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""p3BALanes"",I,350,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
+""p3PostedSpeed"",I,354,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
+""p3HCMMedian"",C,358,16,0,16,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
+""p3DTWB"",C,374,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
+""p3TollType"",C,383,9,0,9,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
+""p3HOVType"",C,392,9,0,9,0,,"""",""Project Field|None: No occupancy restriction|HOV2: Requires at least 2 occupants to use|HOV3: Requires at least 3 occupants to use"",,""Copy"",
+""CountID"",C,401,16,0,16,0,,"""",""The CVG/VLM ID of the count"",,""Copy"",
+""DailyVolume"",I,417,4,0,8,0,,"""",""The AWDT volume"",,""Copy"",
+""old_fields"",C,421,16,0,16,0,,"""","""",,""Copy"",
+""TRMv6_IDs"",I,437,4,0,10,0,,"""","""",,""Blank"",
+""TRMv7_IDs"",I,441,4,0,10,0,,"""","""",,""Blank"",
+""TransCAD_ID"",I,445,4,0,8,0,,""Sum|Avg"",""Created to preserve link ID."",,""Copy"",
+""ROADNAME:1"",C,449,30,0,30,0,,"""","""",,""Copy"",
+""COUNTY"",C,479,16,0,16,0,,"""","""",,""Copy"",
+""FCLASS"",S,495,2,0,6,0,,"""","""",,""Copy"",
+""NEWFCLASS"",S,497,2,0,6,0,,"""","""",,""Copy"",
+""FCGROUP"",I,499,4,0,6,0,,""Sum|Avg"","""",,""Copy"",
+""B_DIRECTION"",I,503,4,0,5,0,,""Sum|Avg"","""",,""Copy"",
+""B_LANESAB"",I,507,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""B_LANESBA"",I,511,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""B_POSTSPD"",R,515,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
+""B_MED_LT"",I,523,4,0,10,0,,""Sum|Avg"",""1 = NO median or continuous left turn lane|2 = With a median or continuous left turn lane|99 = Median or left turn treatment irrelevant"",,""Copy"",
+""B_SPECIAL"",I,527,4,0,10,0,,""Sum|Avg"",""1 = Interstate/Freeway|2 = Suburban Freeway|3 = Urban Freeway|4 = Rural Highway|21 = Freeway to freeway ramps|22 = Freeway to freeway loop ramp with weave|23 = Freeway to freeway loop ramp|24 = Freeway to arterial ramp/loop|25 = Arterial to freeway ramp/loop|26 = Arterial to arterial ramp/loop|31 = Centroid connector|41 = HOV link|54 = Parking lot link|55 = Transit only link|99 = All other highway link types"",,""Copy"",
+""B_MODE"",I,531,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""B_FacilityType"",I,535,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""B_Lane_Width"",R,539,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
+""B_Lateral_ClearanceAB"",R,547,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
+""B_Lateral_ClearanceBA"",R,555,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
+""B_PARKING"",S,563,2,0,6,0,,""Sum|Avg"","""",,""Copy"",
+""B_Remain_Highway"",I,565,4,0,10,0,,""Sum|Avg"",""\""Remain_Highway\"" is used to flag all the highway links that will remain as highways even when their area types are changed. One example is the NC-54 to the south of Chapel Hill since they have ramps but they are not freeways."",,""Copy"",
+""AREATYPE"",I,569,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""Shoulder_Width"",R,573,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
+""TruckProhibited"",S,581,2,0,4,0,,""Sum|Avg"","""",,""Copy"",
+""COUNT_ID(AB)"",I,583,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""COUNT_ID(BA)"",I,587,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""COUNT_DirRatio"",F,591,4,0,10,2,,""Sum|Avg"","""",,""Copy"",
+""COUNT_ID"",I,595,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""ABLINKTIME"",R,599,8,0,10,3,,""Sum|Avg"","""",,""Sum"",
+""BALINKTIME"",R,607,8,0,10,3,,""Sum|Avg"","""",,""Sum"",
+""ABNONTRANSITTIME"",R,615,8,0,10,2,,""Sum|Avg"","""",,""Sum"",
+""BANONTRANSITTIME"",R,623,8,0,10,2,,""Sum|Avg"","""",,""Sum"",
+""ProjID1"",C,631,10,0,10,0,,"""","""",,""Copy"",
+""ProjName1"",C,641,60,0,60,0,,"""","""",,""Copy"",
+""ProjTime1"",C,701,10,0,10,0,,"""","""",,""Copy"",
+""Predecessor1"",C,711,24,0,24,0,,"""","""",,""Copy"",
+""Direction1"",I,735,4,0,5,0,,""Sum|Avg"","""",,""Copy"",
+""LanesAB1"",I,739,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""LanesBA1"",I,743,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""PostSpd1"",R,747,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
+""Med_Lt1"",I,755,4,0,10,0,,""Sum|Avg"",""1 = NO median or continuous left turn lane|2 = With a median or continuous left turn lane|99 = Median or left turn treatment irrelevant"",,""Copy"",
+""Special1"",I,759,4,0,10,0,,""Sum|Avg"",""1 = Interstate/Freeway|2 = Suburban Freeway|3 = Urban Freeway|4 = Rural Highway|21 = Freeway to freeway ramps|22 = Freeway to freeway loop ramp with weave|23 = Freeway to freeway loop ramp|24 = Freeway to arterial ramp/loop|25 = Arterial to freeway ramp/loop|26 = Arterial to arterial ramp/loop|31 = Centroid connector|41 = HOV link|54 = Parking lot link|55 = Transit only link|99 = All other highway link types"",,""Copy"",
+""Mode1"",I,763,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""FacilityType1"",I,767,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""Lane_Width1"",R,771,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
+""Lateral_ClearanceAB1"",R,779,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
+""Lateral_ClearanceBA1"",R,787,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
+""Parking1"",I,795,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""Remain_Highway1"",I,799,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""ProjID2"",C,803,10,0,10,0,,"""","""",,""Copy"",
+""ProjName2"",C,813,60,0,60,0,,"""","""",,""Copy"",
+""ProjTime2"",C,873,10,0,10,0,,"""","""",,""Copy"",
+""Predecessor2"",C,883,24,0,24,0,,"""","""",,""Copy"",
+""Direction2"",I,907,4,0,5,0,,""Sum|Avg"","""",,""Copy"",
+""LanesAB2"",I,911,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""LanesBA2"",I,915,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""PostSpd2"",R,919,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
+""Med_Lt2"",I,927,4,0,10,0,,""Sum|Avg"",""1 = NO median or continuous left turn lane|2 = With a median or continuous left turn lane|99 = Median or left turn treatment irrelevant"",,""Copy"",
+""Special2"",I,931,4,0,10,0,,""Sum|Avg"",""1 = Interstate/Freeway|2 = Suburban Freeway|3 = Urban Freeway|4 = Rural Highway|21 = Freeway to freeway ramps|22 = Freeway to freeway loop ramp with weave|23 = Freeway to freeway loop ramp|24 = Freeway to arterial ramp/loop|25 = Arterial to freeway ramp/loop|26 = Arterial to arterial ramp/loop|31 = Centroid connector|41 = HOV link|54 = Parking lot link|55 = Transit only link|99 = All other highway link types"",,""Copy"",
+""Mode2"",I,935,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""FacilityType2"",I,939,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""Lane_Width2"",R,943,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
+""Lateral_ClearanceAB2"",R,951,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
+""Lateral_ClearanceBA2"",R,959,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
+""Parking2"",I,967,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""Remain_Highway2"",I,971,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
+""ff_time"",R,975,8,0,10,2,,"""","""",,""Sum"",

---FILE: master/networks/master_links_.DCB---
@@ -0,0 +1,7 @@
+TRMG2 Master Network
+44
+""new_id"",I,1,4,0,4,0,,"""","""",,""Sum"",
+""TAZ"",I,5,4,0,8,0,,"""","""",,""Blank"",
+""External"",I,9,4,0,8,0,,"""","""",,""Blank"",
+""PnR Category1"",C,13,16,0,16,0,,"""","""",,""Blank"",
+""PnR Category2"",C,29,16,0,16,0,,"""","""",,""Blank"",

---FILE: master/networks/master_network.DCB---
@@ -1,113 +0,0 @@
-TRMG2 Master Network
-986
-""ID"",I,1,4,0,4,0,,"""","""",,""Sum"",
-""ID:1"",I,5,4,0,10,0,,"""","""",,""Sum"",
-""RoadName"",C,9,32,0,32,0,,"""","""",,""Copy"",
-""NCDOTClass"",C,41,20,0,20,0,,"""",""This field does not affect model output and is only used|for reporting purposes. The NCDOT roadway classification|is a political classification and does not always accurately|reflect the road's operating characteristics.||Interstate|OtherFreeway|PrincipalArterial|MinorArterial|MajorCollector|MinorCollector|Local|NA"",,""Copy"",
-""HCMType"",C,61,20,0,20,0,,"""",""Highway Capacity Manuall Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|MajorArterial|MinorArterial|CollectorLocal|Ramp|CC|PNR|TransitOnly"",,""Copy"",
-""ABLanes"",I,81,4,0,8,0,,"""",""Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""BALanes"",I,85,4,0,8,0,,"""",""Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""PostedSpeed"",I,89,4,0,8,0,,"""",""Speed as posted on roadway signage"",,""Copy"",
-""HCMMedian"",C,93,16,0,16,0,,"""",""HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
-""DTWB"",C,109,9,0,9,0,,"""",""Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
-""TollType"",C,118,9,0,9,0,,"""",""Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
-""HOVType"",C,127,9,0,9,0,,"""",""None: No occupancy restriction|HOV2: Requires at least 2 occupants to use|HOV3: Requires at least 3 occupants to use"",,""Copy"",
-""special_temp"",I,136,4,0,8,0,,"""",""Hanging on to this field temporarily until I determine|how to mark toll/hov/hot links"",,""Copy"",
-""parklink_temp"",I,140,4,0,8,0,,"""",""Keeping this temp field for now to keep track of parking|lot links"",,""Copy"",
-""p1ID"",C,144,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
-""p1HCMType"",C,160,16,0,16,0,,"""",""Project Field|Highway Capacity Manuall Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|MajorArterial|MinorArterial|CollectorLocal|Ramp|CC|PNR|TransitOnly"",,""Copy"",
-""p1ABLanes"",I,176,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""p1BALanes"",I,180,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""p1PostedSpeed"",I,184,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
-""p1HCMMedian"",C,188,16,0,16,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
-""p1DTWB"",C,204,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
-""p1TollType"",C,213,9,0,9,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
-""p1HOVType"",C,222,9,0,9,0,,"""",""Project Field|None: No occupancy restriction|HOV2: Requires at least 2 occupants to use|HOV3: Requires at least 3 occupants to use"",,""Copy"",
-""p2ID"",C,231,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
-""p2HCMType"",C,247,16,0,16,0,,"""",""Project Field|Highway Capacity Manuall Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|MajorArterial|MinorArterial|CollectorLocal|Ramp|CC|PNR|TransitOnly"",,""Copy"",
-""p2ABLanes"",I,263,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""p2BALanes"",I,267,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""p2PostedSpeed"",I,271,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
-""p2HCMMedian"",C,275,16,0,16,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
-""p2DTWB"",C,291,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
-""p2TollType"",C,300,9,0,9,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
-""p2HOVType"",C,309,9,0,9,0,,"""",""Project Field|None: No occupancy restriction|HOV2: Requires at least 2 occupants to use|HOV3: Requires at least 3 occupants to use"",,""Copy"",
-""p3ID"",C,318,16,0,16,0,,"""",""Project Field|Project ID"",,""Copy"",
-""p3HCMType"",C,334,16,0,16,0,,"""",""Project Field|Highway Capacity Manuall Type|This classification describes the operational characteristics|of the link and is used to determine capacity and freeflow|speed.||Freeway|MLHighway|TLHighway|MajorArterial|MinorArterial|CollectorLocal|Ramp|CC|PNR|TransitOnly"",,""Copy"",
-""p3ABLanes"",I,350,4,0,8,0,,"""",""Project Field|Number of lanes in the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""p3BALanes"",I,354,4,0,8,0,,"""",""Project Field|Number of lanes against the topological direction|(direction link was drawn)|Layer style settings can be used to show link topo direction."",,""Copy"",
-""p3PostedSpeed"",I,358,4,0,8,0,,"""",""Project Field|Speed as posted on roadway signage"",,""Copy"",
-""p3HCMMedian"",C,362,16,0,16,0,,"""",""Project Field|HCM Median Type|Restrictive|NonRestrictive|None||The model currently treats Restrictive and NonRestrictive|the same."",,""Copy"",
-""p3DTWB"",C,378,9,0,9,0,,"""",""Project Field|Drive/Transit/Walk/Bike|Which high level modes are allowed?||T: Transit Only|DT: Drive and Transit|WB: Walk and Bike only|etc."",,""Copy"",
-""p3TollType"",C,387,9,0,9,0,,"""",""Project Field|Free: no tolls|HOT: tolls but HOV is free|Toll: everyone pays a toll"",,""Copy"",
-""p3HOVType"",C,396,9,0,9,0,,"""",""Project Field|None: No occupancy restriction|HOV2: Requires at least 2 occupants to use|HOV3: Requires at least 3 occupants to use"",,""Copy"",
-""CountID"",C,405,16,0,16,0,,"""",""The CVG/VLM ID of the count"",,""Copy"",
-""DailyVolume"",I,421,4,0,8,0,,"""",""The AWDT volume"",,""Copy"",
-""old_fields"",C,425,16,0,16,0,,"""","""",,""Copy"",
-""TRMv6_IDs"",I,441,4,0,10,0,,"""","""",,""Blank"",
-""TRMv7_IDs"",I,445,4,0,10,0,,"""","""",,""Blank"",
-""TransCAD_ID"",I,449,4,0,8,0,,""Sum|Avg"",""Created to preserve link ID."",,""Copy"",
-""ROADNAME:1"",C,453,30,0,30,0,,"""","""",,""Copy"",
-""COUNTY"",C,483,16,0,16,0,,"""","""",,""Copy"",
-""FCLASS"",S,499,2,0,6,0,,"""","""",,""Copy"",
-""NEWFCLASS"",S,501,2,0,6,0,,"""","""",,""Copy"",
-""FCGROUP"",I,503,4,0,6,0,,""Sum|Avg"","""",,""Copy"",
-""B_DIRECTION"",I,507,4,0,5,0,,""Sum|Avg"","""",,""Copy"",
-""B_LANESAB"",I,511,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""B_LANESBA"",I,515,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""B_POSTSPD"",R,519,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
-""B_MED_LT"",I,527,4,0,10,0,,""Sum|Avg"",""1 = NO median or continuous left turn lane|2 = With a median or continuous left turn lane|99 = Median or left turn treatment irrelevant"",,""Copy"",
-""B_SPECIAL"",I,531,4,0,10,0,,""Sum|Avg"",""1 = Interstate/Freeway|2 = Suburban Freeway|3 = Urban Freeway|4 = Rural Highway|21 = Freeway to freeway ramps|22 = Freeway to freeway loop ramp with weave|23 = Freeway to freeway loop ramp|24 = Freeway to arterial ramp/loop|25 = Arterial to freeway ramp/loop|26 = Arterial to arterial ramp/loop|31 = Centroid connector|41 = HOV link|54 = Parking lot link|55 = Transit only link|99 = All other highway link types"",,""Copy"",
-""B_MODE"",I,535,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""B_FacilityType"",I,539,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""B_Lane_Width"",R,543,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
-""B_Lateral_ClearanceAB"",R,551,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
-""B_Lateral_ClearanceBA"",R,559,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
-""B_PARKING"",S,567,2,0,6,0,,""Sum|Avg"","""",,""Copy"",
-""B_Remain_Highway"",I,569,4,0,10,0,,""Sum|Avg"",""\""Remain_Highway\"" is used to flag all the highway links that will remain as highways even when their area types are changed. One example is the NC-54 to the south of Chapel Hill since they have ramps but they are not freeways."",,""Copy"",
-""AREATYPE"",I,573,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""Shoulder_Width"",R,577,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
-""TruckProhibited"",S,585,2,0,4,0,,""Sum|Avg"","""",,""Copy"",
-""COUNT_ID(AB)"",I,587,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""COUNT_ID(BA)"",I,591,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""COUNT_DirRatio"",F,595,4,0,10,2,,""Sum|Avg"","""",,""Copy"",
-""COUNT_ID"",I,599,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""ABLINKTIME"",R,603,8,0,10,3,,""Sum|Avg"","""",,""Sum"",
-""BALINKTIME"",R,611,8,0,10,3,,""Sum|Avg"","""",,""Sum"",
-""ABNONTRANSITTIME"",R,619,8,0,10,2,,""Sum|Avg"","""",,""Sum"",
-""BANONTRANSITTIME"",R,627,8,0,10,2,,""Sum|Avg"","""",,""Sum"",
-""ProjID1"",C,635,10,0,10,0,,"""","""",,""Copy"",
-""ProjName1"",C,645,60,0,60,0,,"""","""",,""Copy"",
-""ProjTime1"",C,705,10,0,10,0,,"""","""",,""Copy"",
-""Predecessor1"",C,715,24,0,24,0,,"""","""",,""Copy"",
-""Direction1"",I,739,4,0,5,0,,""Sum|Avg"","""",,""Copy"",
-""LanesAB1"",I,743,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""LanesBA1"",I,747,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""PostSpd1"",R,751,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
-""Med_Lt1"",I,759,4,0,10,0,,""Sum|Avg"",""1 = NO median or continuous left turn lane|2 = With a median or continuous left turn lane|99 = Median or left turn treatment irrelevant"",,""Copy"",
-""Special1"",I,763,4,0,10,0,,""Sum|Avg"",""1 = Interstate/Freeway|2 = Suburban Freeway|3 = Urban Freeway|4 = Rural Highway|21 = Freeway to freeway ramps|22 = Freeway to freeway loop ramp with weave|23 = Freeway to freeway loop ramp|24 = Freeway to arterial ramp/loop|25 = Arterial to freeway ramp/loop|26 = Arterial to arterial ramp/loop|31 = Centroid connector|41 = HOV link|54 = Parking lot link|55 = Transit only link|99 = All other highway link types"",,""Copy"",
-""Mode1"",I,767,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""FacilityType1"",I,771,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""Lane_Width1"",R,775,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
-""Lateral_ClearanceAB1"",R,783,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
-""Lateral_ClearanceBA1"",R,791,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
-""Parking1"",I,799,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""Remain_Highway1"",I,803,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""ProjID2"",C,807,10,0,10,0,,"""","""",,""Copy"",
-""ProjName2"",C,817,60,0,60,0,,"""","""",,""Copy"",
-""ProjTime2"",C,877,10,0,10,0,,"""","""",,""Copy"",
-""Predecessor2"",C,887,24,0,24,0,,"""","""",,""Copy"",
-""Direction2"",I,911,4,0,5,0,,""Sum|Avg"","""",,""Copy"",
-""LanesAB2"",I,915,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""LanesBA2"",I,919,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""PostSpd2"",R,923,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
-""Med_Lt2"",I,931,4,0,10,0,,""Sum|Avg"",""1 = NO median or continuous left turn lane|2 = With a median or continuous left turn lane|99 = Median or left turn treatment irrelevant"",,""Copy"",
-""Special2"",I,935,4,0,10,0,,""Sum|Avg"",""1 = Interstate/Freeway|2 = Suburban Freeway|3 = Urban Freeway|4 = Rural Highway|21 = Freeway to freeway ramps|22 = Freeway to freeway loop ramp with weave|23 = Freeway to freeway loop ramp|24 = Freeway to arterial ramp/loop|25 = Arterial to freeway ramp/loop|26 = Arterial to arterial ramp/loop|31 = Centroid connector|41 = HOV link|54 = Parking lot link|55 = Transit only link|99 = All other highway link types"",,""Copy"",
-""Mode2"",I,939,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""FacilityType2"",I,943,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""Lane_Width2"",R,947,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
-""Lateral_ClearanceAB2"",R,955,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
-""Lateral_ClearanceBA2"",R,963,8,0,10,2,,""Sum|Avg"","""",,""Copy"",
-""Parking2"",I,971,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""Remain_Highway2"",I,975,4,0,10,0,,""Sum|Avg"","""",,""Copy"",
-""ff_time"",R,979,8,0,10,2,,"""","""",,""Sum"",

---FILE: master/networks/master_network_.DCB---
@@ -1,22 +0,0 @@
-TRMG2 Master Network
-116
-""ID"",I,1,4,0,10,0,,"""","""",,""Sum"",
-""ID:1"",I,5,4,0,10,0,,"""","""",,""Blank"",
-""ID:1:1"",I,9,4,0,10,0,,"""","""",,""Blank"",
-""TRMv6_NodeID"",I,13,4,0,10,0,,"""","""",,""Blank"",
-""TRMv7_NodeID"",I,17,4,0,8,0,,"""","""",,""Blank"",
-""ID:1:1:1"",I,21,4,0,10,0,,"""","""",,""Blank"",
-""PARKINGNODE"",I,25,4,0,10,0,,"""","""",,""Blank"",
-""CBD Walk"",I,29,4,0,10,0,,"""","""",,""Blank"",
-""6digitTAZ"",I,33,4,0,10,0,,"""","""",,""Blank"",
-""TAZ_v7_ID"",I,37,4,0,8,0,,"""","""",,""Blank"",
-""TAZ"",I,41,4,0,8,0,,"""","""",,""Blank"",
-""County"",C,45,16,0,16,0,,"""","""",,""Blank"",
-""External_v7"",I,61,4,0,8,0,,"""","""",,""Blank"",
-""External"",I,65,4,0,8,0,,"""","""",,""Blank"",
-""PnR Category1"",C,69,16,0,16,0,,"""","""",,""Blank"",
-""PnR Category2"",C,85,16,0,16,0,,"""","""",,""Blank"",
-""Preserve"",I,101,4,0,8,0,,"""","""",,""Blank"",
-""MaxDriveTime"",I,105,4,0,8,0,,"""","""",,""Blank"",
-""Original_Node_ID"",I,109,4,0,8,0,,"""","""",,""Sum"",
-""Existing"",I,113,4,0,8,0,,"""","""",,""Sum"","
Triangle-Modeling-and-Analytics,TRMG2,9423177bb475e47b0aaf5a633d1d30a111672004,Kyle Ward,kyle@caliper.com,2020-12-07T16:15:26Z,Kyle Ward,kyle@caliper.com,2020-12-07T16:15:26Z,"Make another connectivity pass

Widened the search to 200 ft. Found that the new JoCo centroids had not
been tagged with TAZ IDs. Fixed. Found a few other issues and corrected.",master/networks/master_network.BIN;master/networks/master_network.BX;master/networks/master_network.dln;master/networks/master_network.kln;master/networks/master_network.pts;master/networks/master_network.upx;master/networks/master_network_.BIN;master/networks/master_network_.BX;master/networks/master_transit.rts,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,74ad317d1408e767e34a4cdb0cd9bf6e1667c129,Kyle Ward,kyle@caliper.com,2020-12-07T14:36:32Z,Kyle Ward,kyle@caliper.com,2020-12-07T14:36:32Z,"Perform connectivity check

Used the connectivity checker to scan for nodes that were near other line
features but not connected. Resolved 10-20 issues.",docs/networks.Rmd;master/networks/master_network.BIN;master/networks/master_network.BX;master/networks/master_network.dln;master/networks/master_network.kln;master/networks/master_network.pts;master/networks/master_network.upx;master/networks/master_network_.BIN;master/networks/master_network_.BX;master/networks/master_transit.rtg;master/networks/master_transit.rts;master/networks/master_transitL.BX;master/networks/master_transitL.bin,True,False,True,False,4,1,5,"---FILE: docs/networks.Rmd---
@@ -61,4 +61,7 @@ The previous model used a separate table to hold count data which then had to be
 joined to the network to make comparisons. For TRMG2, the basic count data
 including station ID and daily AWDT were added to the master network directly.
 This makes it easier to compare (either manually or in code) between
-model volumes and count data.
\ No newline at end of file
+model volumes and count data.
+
+### Network Conflation
+"
Triangle-Modeling-and-Analytics,TRMG2,0d4a51fedf817575c25f42a5416bf7a25a6a59bd,Kyle Ward,kyle@caliper.com,2020-11-16T16:28:08Z,Kyle Ward,kyle@caliper.com,2020-11-16T16:28:08Z,Correct error guessing school purposes,docs/survey_processing.Rmd,True,False,True,False,4,2,6,"---FILE: docs/survey_processing.Rmd---
@@ -667,16 +667,18 @@ det_sch_place <- det_home_place %>%
     # Guess school places for students with missing school loc info
     o_place = ifelse(
       student_type != """" &
+        is.na(school_address) &
         o_activity %in% c(""PreK"", ""K12"", ""U"") &
         o_place == ""O"" &
-        ""school"" %in% tolower(origin_name),
+        str_detect(origin_name, ""school""),
       ""S"", o_place
     ),
     d_place = ifelse(
       student_type != """" &
+        is.na(school_address) &
         d_activity %in% c(""PreK"", ""K12"", ""U"") &
         d_place == ""O"" &
-        ""school"" %in% tolower(destination_name),
+        str_detect(origin_name, ""school""),
       ""S"", d_place
     )
   ) %>%"
Triangle-Modeling-and-Analytics,TRMG2,9d5efd22de23d398df841b021aec283f1784d634,Kyle Ward,kyle@caliper.com,2020-10-30T14:12:23Z,Kyle Ward,kyle@caliper.com,2020-10-30T14:12:23Z,"Correct transit errors

This corrects several issues with the transit routes after transfer.
Mostly, the elimination of tiny links from the network caused
some routes to look for link IDs that no longer existed. The ODX
and Alamance connector routes had to be manually corrected
given the new line network in Alamance County.",master/networks/master_transit.rtg;master/networks/master_transit.rts;master/networks/master_transitL.BX;master/networks/master_transitL.bin;master/networks/master_transitR.BX;master/networks/master_transitS.BX;master/networks/master_transitS.bin;master/networks/master_transitS.grp;master/networks/master_transitS.lok;master/networks/master_transitS.pnk;master/networks/master_transitS.r0,False,False,False,False,0,0,0,
Triangle-Modeling-and-Analytics,TRMG2,a98982ce8c193705da83c852c7859fea7aec90ca,Kyle Ward,kyle@caliper.com,2020-10-30T13:37:53Z,Kyle Ward,kyle@caliper.com,2020-10-30T13:41:08Z,"Create master_transit from 2016 route system

This route system still has some errors in it, but I'm committing this version
before making those corrections. (Route 240 requires requires recoding
along the old model boundary.)",master/networks/master_transit.rtg;master/networks/master_transit.rts;master/networks/master_transitL.BX;master/networks/master_transitL.DCB;master/networks/master_transitL.bin;master/networks/master_transitR.BX;master/networks/master_transitR.DCB;master/networks/master_transitR.bin;master/networks/master_transitS.BX;master/networks/master_transitS.DCB;master/networks/master_transitS.bin;master/networks/master_transitS.cdd;master/networks/master_transitS.cdk;master/networks/master_transitS.dbd;master/networks/master_transitS.dsc;master/networks/master_transitS.dsk;master/networks/master_transitS.grp;master/networks/master_transitS.lok;master/networks/master_transitS.pnk;master/networks/master_transitS.r0,False,False,False,False,28,0,28,"---FILE: master/networks/master_transitL.DCB---
@@ -0,0 +1,5 @@
+
+9
+""Route_ID"",I,1,4,0,9,0,,"""","""",,""Sum"",
+""Link_ID"",I,5,4,0,9,0,,"""","""",,""Sum"",
+""Direction"",C,9,1,0,1,0,,"""","""",,""Copy"",

---FILE: master/networks/master_transitR.DCB---
@@ -0,0 +1,19 @@
+
+147
+""Route_ID"",I,1,4,0,9,0,,"""","""",,""Sum"",
+""Route_Name"",C,5,33,0,33,0,,"""","""",,""Copy"",
+""Operator"",I,38,4,0,8,0,,"""","""",,""Sum"",
+""Company"",I,42,4,0,8,0,,"""","""",,""Sum"",
+""Mode"",I,46,4,0,8,0,,"""","""",,""Sum"",
+""AMPK_Hdwy"",R,50,8,0,8,1,,"""","""",,""Sum"",
+""OP_Hdwy"",R,58,8,0,8,1,,"""","""",,""Sum"",
+""XferPen"",R,66,8,0,8,3,,"""","""",,""Sum"",
+""RFacLocal"",R,74,8,0,8,3,,"""","""",,""Sum"",
+""RFacPrem"",R,82,8,0,8,3,,"""","""",,""Sum"",
+""RFacRail"",R,90,8,0,8,3,,"""","""",,""Sum"",
+""FareFac"",R,98,8,0,8,3,,"""","""",,""Sum"",
+""Fare"",R,106,8,0,8,2,,"""","""",,""Sum"",
+""Line_No"",C,114,10,0,10,0,,"""","""",,""Copy"",
+""len"",R,124,8,0,8,3,,"""","""",,""Sum"",
+""PK_InitWT"",R,132,8,0,8,3,,"""","""",,""Sum"",
+""OP_InitWT"",R,140,8,0,8,3,,"""","""",,""Sum"",

---FILE: master/networks/master_transitS.DCB---
@@ -0,0 +1,4 @@
+
+8
+""STOP_ID"",I,1,4,0,9,0,,"""","""",,""Sum"",
+""NodeID"",I,5,4,0,8,0,,"""","""",,""Sum"","
Triangle-Modeling-and-Analytics,TRMG2,1f03672c7ab87693a97ee4c5af3ced7142d8c43e,Kyle Ward,kyle@caliper.com,2020-10-26T17:50:44Z,Kyle Ward,kyle@caliper.com,2020-10-26T17:50:44Z,"Check project lengths and make minor corrections

I checked to make sure that each project is still the same length
as it was in the TrueU. Only ~5 projects were different, and only
one of those required a correction. The others are different because
of link closures before 2016.",master/networks/master_network.BIN;src/utils/project_management/HighwayProjectManagement.rsc;src/utils/utils.rsc,False,False,False,False,245,6,251,"---FILE: src/utils/project_management/HighwayProjectManagement.rsc---
@@ -614,11 +614,15 @@ Macro ""Export Project Layer"" (MacroOpts)
     end
   end
 
-  // CloseMap(map)
+  CloseMap(map)
 endmacro
 
-Macro ""run""
-  opts.hwy_dbd = ""C:\\projects\\Oahu\\working_files\\CMP\\mapping\\master_network\\Oahu Network 102907.dbd""
-  RunMacro(""Export Project Layer"", opts)
+/*
+Flesh out into a general macro for the drop down menu.
+*/
 
-endmacro
\ No newline at end of file
+Macro ""run export project layer""
+  opts.hwy_dbd = ""C:\\projects\\TRM\\trm_project\\repo_trmg2\\master\\networks\\master_network.dbd""
+  RunMacro(""Export Project Layer"", opts)
+  ShowMessage(""Project layer exported"")
+endmacro

---FILE: src/utils/utils.rsc---
@@ -101,4 +101,239 @@ Macro ""Add Fields"" (view, a_fields, initial_values)
       SetDataVector(view + ""|"", field, v, )
     end
   end
-EndMacro
\ No newline at end of file
+EndMacro
+
+/*
+Checks that a file argument is valid.
+
+Inputs (in named array)
+  * file
+    * The file to be checked
+  * required
+    * True/False: if the argument is required (by the parent macro).
+  * must_exist
+    * True/False: if the file must exist
+  * extension
+    * Optional string specifying a required extension (e.g. ""dbd"")
+
+Returns
+  * The file string
+*/
+
+Macro ""check file"" (MacroOpts)
+
+  arg = MacroOpts.file
+  required = MacroOpts.required
+  must_exist = MacroOpts.must_exist
+  extension = MacroOpts.extension
+
+  if TypeOf(arg) = ""null"" then do
+    if required 
+      then Throw(""An argument was not provided or is null."")
+      else return()
+  end
+  if TypeOf(arg) <> ""string"" then Throw(""A file path must be a string"")
+  if GetFileInfo(arg) = null then Throw(""File '"" + arg + ""' does not exist"")
+  if extension <> null then do
+    {drive, folder, name, ext} = SplitPath(arg)
+    if ext <> ""."" + extension then Throw(
+      ""File '"" + arg+ ""' must have a '"" + extension + ""' extension.""
+    )
+  end
+  return(arg)
+endmacro
+
+/*
+Checks that an argument is a vector or can be converted to one.
+
+Inputs (in named array)
+  * vector
+    * The vector to be checked
+  * required
+    * True/False: if the argument is required (by the parent macro).
+
+Returns
+  * The vector
+*/
+
+Macro ""check vector"" (MacroOpts)
+
+  arg = MacroOpts.vector
+  required = MacroOpts.required
+
+  if TypeOf(arg) = ""null"" then do
+    if required
+      then Throw(""An argument is missing or not provided."")
+      else return()
+  end
+  if TypeOf(arg) = ""array"" then arg = A2V(arg)
+  if TypeOf(arg) <> ""vector"" then arg = A2V({arg})
+  return(arg)
+endmacro
+
+/*doc
+Checks that an argument is an array or can be converted to one.
+
+Inputs (in named array)
+  * array
+    * The array to be checked
+  * required
+    * True/False: if the argument is required (by the parent macro).
+
+Returns
+  * The array
+*/
+
+Macro ""check array"" (MacroOpts)
+
+  arg = MacroOpts.array
+  required = MacroOpts.required
+
+  if TypeOf(arg) = ""null"" then do
+    if required
+      then Throw(""An argument is missing or not provided."")
+      else return()
+  end
+  if TypeOf(arg) = ""vector"" then arg = V2A(arg)
+  if TypeOf(arg) <> ""array"" then arg = {arg}
+  return(arg)
+endmacro
+
+/*
+Checks that an argument is a string
+
+Inputs (in named array)
+  * string
+    * The string to be checked
+  * required
+    * True/False: if the argument is required (by the parent macro).
+*/
+
+Macro ""check string"" (MacroOpts)
+
+  arg = MacroOpts.string
+  required = MacroOpts.required
+
+  if TypeOf(arg) = ""null"" then do
+    if required
+      then Throw(""An argument is missing or not provided."")
+      else return()
+  end
+  if TypeOf(arg) <> ""string"" then Throw(
+    ""Expected string but found "" + TypeOf(arg)
+  )
+  return(arg)
+endmacro
+
+/*
+Macro to simplify the process of map creation.
+
+Inputs
+  MacroOpts
+    Named array that holds argument names
+
+    file
+      String
+      Full path to the file to map. Supported types:
+        Point, Line, Polygon geographic files. RTS files.
+
+    minimized
+      Optional String (""true"" or ""false"")
+      Defaults to ""true"".
+      Whether to minimize the map. Makes a number of geospatial calculations
+      faster if the map does not have to be redrawn.
+
+Returns
+  An array of two things:
+  1. the name of the map
+  2. an array of layer names
+    * for dbd files: {node, link}
+    * for rts files: {route, stops, phys. stops, node, link}
+*/
+
+Macro ""Create Map"" (MacroOpts)
+
+  // Argument extraction
+  file = MacroOpts.file
+  minimized = MacroOpts.minimized
+
+  // Argument checking
+  if file = null then Throw(""Create Map: 'file' not provided"")
+  if minimized = null then minimized = ""true""
+
+  // Determine file extension
+  {drive, directory, filename, ext} = SplitPath(file)
+  if Lower(ext) = "".dbd"" then file_type = ""dbd""
+  else if Lower(ext) = "".rts"" then file_type = ""rts""
+  else Throw(""Create Map: 'file' must be either a '.dbd.' or '.rts' file"")
+
+  // Get a unique name for the map
+  map_name = RunMacro(""Get Unique Map Name"")
+
+  // Create the map if a dbd file was passed
+  if file_type = ""dbd"" then do
+    a_layers = GetDBLayers(file)
+    {scope, label, rev} = GetDBInfo(file)
+    opts = null
+    opts.scope = scope
+    map_name = CreateMap(map_name, opts)
+    if minimized then MinimizeWindow(GetWindowName())
+    for layer in a_layers do
+      l = AddLayer(map_name, layer, file, layer)
+      RunMacro(""G30 new layer default settings"", l)
+      actual_layers = actual_layers + {l}
+    end
+  end
+
+  // Create the map if a RTS file was passed
+  if file_type = ""rts"" then do
+
+    // Get the RTS's highway file
+    opts = null
+    opts.rts_file = file
+    hwy_dbd = RunMacro(""Get RTS Highway File"", opts)
+    {scope, label, rev} = GetDBInfo(hwy_dbd)
+    opts = null
+    opts.Scope = scope
+    map = CreateMap(map_name, opts)
+    if minimized then MinimizeWindow(GetWindowName())
+    {, , opts} = GetRouteSystemInfo(file)
+    rlyr = opts.Name
+    actual_layers = AddRouteSystemLayer(map, rlyr, file, )
+    if !minimized then do
+      for layer in actual_layers do
+        // Check for null - the physcial stops layer is often null
+        if layer <> null then RunMacro(""G30 new layer default settings"", layer)
+      end
+    end
+  end
+
+  return({map_name, actual_layers})
+EndMacro
+
+/*
+Helper to ""Create Map"" macro.
+Avoids duplciating map names by using an odd name and checking to make
+sure that map name does not already exist.
+
+Similar to ""unique_view_name"" in gplyr.
+*/
+
+Macro ""Get Unique Map Name""
+  {map_names, idx, cur_name} = GetMaps()
+  if map_names.length = 0 then do
+    map_name = ""gisdk_tools1""
+  end else do
+    num = 0
+    exists = ""True""
+    while exists do
+      num = num + 1
+      map_name = ""gisdk_tools"" + String(num)
+      exists = if (ArrayPosition(map_names, {map_name}, ) <> 0)
+        then ""True""
+        else ""False""
+    end
+  end
+
+  return(map_name)
+EndMacro"
Triangle-Modeling-and-Analytics,TRMG2,92e26398062a33894de15017c81d942cc35d9e0c,Kyle Ward,kyle@caliper.com,2020-10-26T14:00:04Z,Kyle Ward,kyle@caliper.com,2020-10-26T14:00:04Z,Minor corrections to two links' direction field,master/networks/master_network.BIN;master/networks/master_network.dln,False,False,False,False,0,0,0,
