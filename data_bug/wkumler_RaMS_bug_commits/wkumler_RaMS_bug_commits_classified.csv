repo_owner,repo_name,commit_hash,author,author_email,date,committer_name,committer_email,committer_date,message,filenames,touches_rmd,touches_r,touches_r_or_rmd,is_merge,added,deleted,changed,diff,_touch_r,_touch_rmd,bug_category,category_score
wkumler,RaMS,d9bd93d0a3b67bae7b77a778f05c05b8e47dc3e6,wkumler,wkumler@uw.edu,2024-10-09T00:12:39Z,wkumler,wkumler@uw.edu,2024-10-09T00:12:39Z,Fixes from spell_check(),R/grabMzmlFunctions.R;R/grabMzxmlFunctions.R;R/minifyMSFunctions.R;man/grabMzxmlSpectraVoltage.Rd;man/grabSpectraVoltage.Rd;man/minifyMzxml.Rd;vignettes/Intro-to-tmzML.Rmd;vignettes/speed_size_comparison.Rmd,True,True,True,False,8,8,16,"---FILE: R/grabMzmlFunctions.R---
@@ -756,7 +756,7 @@ grabSpectraPremz <- function(xml_nodes){
 }
 
 
-#' Extract the collison energies from the spectra of an mzML nodeset
+#' Extract the collision energies from the spectra of an mzML nodeset
 #'
 #' Although the collision energy is typically fixed per file, it's equally fast
 #' (afaik) to just grab them all individually here. Also, I'm worried about

---FILE: R/grabMzxmlFunctions.R---
@@ -600,7 +600,7 @@ grabMzxmlSpectraPremz <- function(xml_nodes){
 }
 
 
-#' Extract the collison energies from the spectra of an mzXML nodeset
+#' Extract the collision energies from the spectra of an mzXML nodeset
 #'
 #' Although the collision energy is typically fixed per file, it's equally
 #' fast (afaik) to just grab them all individually here. Also, I'm worried about

---FILE: R/minifyMSFunctions.R---
@@ -434,7 +434,7 @@ minifyMzml <- function(filename, output_filename, ppm,
 
 
 # minifyMzxml ----
-#' Shrink mzxML files by including only data points near masses of interest
+#' Shrink mzXML files by including only data points near masses of interest
 #'
 #' mzXML files can be annoyingly large if only a few masses are of interest. This large size makes it
 #' difficult to share them online for debugging purposes and often means that untargeted algorithms

---FILE: man/grabMzxmlSpectraVoltage.Rd---
@@ -2,7 +2,7 @@
 % Please edit documentation in R/grabMzxmlFunctions.R
 \name{grabMzxmlSpectraVoltage}
 \alias{grabMzxmlSpectraVoltage}
-\title{Extract the collison energies from the spectra of an mzXML nodeset}
+\title{Extract the collision energies from the spectra of an mzXML nodeset}
 \usage{
 grabMzxmlSpectraVoltage(xml_nodes)
 }

---FILE: man/grabSpectraVoltage.Rd---
@@ -2,7 +2,7 @@
 % Please edit documentation in R/grabMzmlFunctions.R
 \name{grabSpectraVoltage}
 \alias{grabSpectraVoltage}
-\title{Extract the collison energies from the spectra of an mzML nodeset}
+\title{Extract the collision energies from the spectra of an mzML nodeset}
 \usage{
 grabSpectraVoltage(xml_nodes)
 }

---FILE: man/minifyMzxml.Rd---
@@ -2,7 +2,7 @@
 % Please edit documentation in R/minifyMSFunctions.R
 \name{minifyMzxml}
 \alias{minifyMzxml}
-\title{Shrink mzxML files by including only data points near masses of interest}
+\title{Shrink mzXML files by including only data points near masses of interest}
 \usage{
 minifyMzxml(
   filename,

---FILE: vignettes/Intro-to-tmzML.Rmd---
@@ -128,7 +128,7 @@ created_files <- mapply(tmzmlMaker, files_to_convert, files_to_create)
 ```
 
 These files should now exist in the folder and can be opened with Notepad or
-a similar word processer if you're curious, but they're mostly encoded so it
+a similar word processor if you're curious, but they're mostly encoded so it
 may not be incredibly informative.
 
 Extracting a chromatogram from a tmzML document should feel very familiar to

---FILE: vignettes/speed_size_comparison.Rmd---
@@ -321,7 +321,7 @@ ggsave(""vignettes/figures/ssc_vignette_renders/par_time_gp.png"", width = 6.5, he
 
 ## MS data query timings
 
-After the MS data has been transformed into an accessible format, it still needs to be queried for a single chromatogram of interest. This typically means performing a search across the ~75 millon entries of mz/rt/int data for the m/z values within a certain window, and can be performed either on an object in memory (e.g. MSnExp & RaMS) or on a disk object.
+After the MS data has been transformed into an accessible format, it still needs to be queried for a single chromatogram of interest. This typically means performing a search across the ~75 million entries of mz/rt/int data for the m/z values within a certain window, and can be performed either on an object in memory (e.g. MSnExp & RaMS) or on a disk object.
 
 ```{r time2query}
 msnexp_obj <- readMSData(ms_files, mode=""inMemory"", msLevel. = 1)",True,True,Documentation / Formatting,6
wkumler,RaMS,9c1aa281da3d01328f9d58c07c4b3369d8cd1607,wkumler,wkumler@uw.edu,2024-10-08T23:51:21Z,wkumler,wkumler@uw.edu,2024-10-08T23:51:21Z,"Fixed failing tests on CRAN

Now using packages listed in Suggests conditionally instead of universally",DESCRIPTION;NEWS.md;cran-comments.md;tests/testthat/setup-load.R;tests/testthat/test_extras.R,False,True,True,False,26,17,43,"---FILE: DESCRIPTION---
@@ -1,7 +1,7 @@
 Package: RaMS
 Type: Package
 Title: R Access to Mass-Spec Data
-Version: 1.4.2
+Version: 1.4.3
 Authors@R: c(
   person(given = ""William"", family = ""Kumler"", email = ""wkumler@uw.edu"",
          role = c(""aut"", ""cre"", ""cph"")),

---FILE: NEWS.md---
@@ -1,9 +1,10 @@
 # RaMS (development version)
 
-# RaMS 1.4.2
- - Added timezone support to metadata's timestamps (mzML files are all UTC)
+# RaMS 1.4.3 (patch)
+ - Added timezone support to metadata's timestamps (mzML files are all UTC afaik)
  - Fixed several bugs in the README and vignettes (it's been a minute since I recompiled these!)
  - Switched to canonical CRAN URLs
+ - Handling Suggested packages in the tests more carefully (removed bulk tidyverse call)
 
 # RaMS 1.4
  - Added MS3 support to file reading and minification

---FILE: cran-comments.md---
@@ -1,8 +1,9 @@
 
 ## Resubmission
 
-This is a resubmission, updating the package from v1.4.0 to v1.4.2 with some
-additional bug fixes.
+This is a resubmission, updating the package from v1.4.0 to v1.4.3 with some
+additional bug fixes. I've also tested with the system environment variable
+_R_CHECK_DEPENDS_ONLY_ set to true to avoid the problems in my last submission.
 
 ## Test environments
 * local R installation, R 4.4.0

---FILE: tests/testthat/setup-load.R---
@@ -1,5 +1,4 @@
 # devtools::load_all()
-library(tidyverse)
 library(data.table)
 setDTthreads(2)
 

---FILE: tests/testthat/test_extras.R---
@@ -44,23 +44,31 @@ test_that(""qplotMS1data works as expected"", {
   test_df$int <- rep(dnorm(seq(-10, 10, length.out=100)), 10)*10+runif(1000)
   test_df$filename <- rep(LETTERS[1:10], each=100)
 
-  ggplot_output <- qplotMS1data(test_df)
-  expect_s3_class(ggplot_output, ""ggplot"")
-
   baseplot_output <- qplotMS1data(test_df, force_base = TRUE)
   expect_null(baseplot_output)
 
-  test_df$startime <- rep(gl(2, 5, labels = c(""Morn"", ""Eve"")), each=100)
-  expect_no_error(qplotMS1data(test_df, color_col=""startime"", facet_col=""startime""))
-  expect_no_error({
-    qplotMS1data(test_df, color_col=""startime"", facet_col=""startime"",
-                 facet_args=list(ncol=2, scales=""free""))
-  })
+  if(requireNamespace(""ggplot2"", quietly = TRUE)){
+    ggplot_output <- qplotMS1data(test_df)
+    expect_s3_class(ggplot_output, ""ggplot"")
+
+
+    test_df$startime <- rep(gl(2, 5, labels = c(""Morn"", ""Eve"")), each=100)
+    expect_no_error(qplotMS1data(test_df, color_col=""startime"", facet_col=""startime""))
+    expect_no_error({
+      qplotMS1data(test_df, color_col=""startime"", facet_col=""startime"",
+                   facet_args=list(ncol=2, scales=""free""))
+    })
+
+    expect_no_error(qplotMS1data(mzML_everything$MS1[mz%between%pmppm(118.0865)]))
+    expect_no_error(qplotMS1data(mzML_everything$MS1[mz%between%pmppm(138.0555, 10)]))
+  }
   expect_warning(qplotMS1data(test_df, color_col=""startime"", force_base = TRUE))
   expect_warning(qplotMS1data(test_df, facet_col=""startime"", force_base = TRUE))
 
-  expect_no_error(qplotMS1data(mzML_everything$MS1[mz%between%pmppm(118.0865)]))
-  expect_no_error(qplotMS1data(mzML_everything$MS1[mz%between%pmppm(138.0555, 10)]))
+  expect_no_error(qplotMS1data(mzML_everything$MS1[mz%between%pmppm(118.0865)],
+                               force_base = TRUE))
+  expect_no_error(qplotMS1data(mzML_everything$MS1[mz%between%pmppm(138.0555, 10)],
+                               force_base=TRUE))
 })
 
 test_that(""mz_group works as expected"", {",True,False,Dependency / Package,7
wkumler,RaMS,c83c69410df1640a6167e4d91f0a20bd8a3f280e,wkumler,wkumler@uw.edu,2024-09-18T18:51:06Z,wkumler,wkumler@uw.edu,2024-09-18T18:51:06Z,Adding MS3 info and fixing bugs,vignettes/Intro-to-RaMS.Rmd,True,False,True,False,36,47,83,"---FILE: vignettes/Intro-to-RaMS.Rmd---
@@ -126,7 +126,8 @@ to your chromatograms as well, so customize away!
 ```{r ggplotdemo, dpi=144}
 ggplot(msdata$BPC) + 
   geom_polygon(aes(x=rt, y=int, color=filename), lwd=1, fill=""#FFFFFF44"") +
-  theme(legend.position = c(0.8, 0.7), plot.title = element_text(face=""bold""),
+  theme(legend.position = ""inside"", legend.position.inside=c(0.8, 0.7), 
+        plot.title = element_text(face=""bold""),
         axis.title = element_text(size = 15)) +
   scale_y_continuous(labels = c(0, ""250M"", ""500M""), breaks = c(0, 2.5e8, 5e8)) +
   scale_colour_manual(values = c(""#2596be"", ""#6c25be"", ""#bea925"")) +
@@ -170,55 +171,55 @@ section below on saving space.
 Because `RaMS` returns [data.tables](https://cran.r-project.org/package=data.table) rather than normal `data.frame`s, indexing
 is super-fast and a bit more intuitive than with base R. Below, I also use the
 `pmppm` function from `RaMS` to produce a mass range from an initial mass and
-spectrometer accuracy (here, 5 parts-per-million).
+spectrometer accuracy (here, 5 parts-per-million) and select only retention
+times that are between 4 and 9 minutes.
 
 ```{r adenineplot, warning=FALSE, message=FALSE}
 library(data.table)
 
 adenine_mz <- 136.06232
 
-adenine_data <- msdata$MS1[mz%between%pmppm(adenine_mz, ppm=5)]
+adenine_data <- msdata$MS1[mz%between%pmppm(adenine_mz, ppm=5)][rt%between%c(4, 9)]
 
-ggplot(adenine_data) + geom_line(aes(x=rt, y=int, color=filename)) + lims(x=c(4, 9))
+ggplot(adenine_data) + geom_line(aes(x=rt, y=int, color=filename))
 ```
 
 This makes it easy to grab the data for multiple compounds of interest with a
 simple loop, provided here by the `purrr` package of the tidyverse:
 
 ```{r multicmpdplot}
-mzs_of_interest <- c(adenine=136.06232, valine=118.0865, homarine=138.055503)
+mzs_of_interest <- c(Adenine=136.06232, Valine=118.0865, Homarine=138.055503)
 
-mass_data <- imap_dfr(mzs_of_interest, function(mz_i, name){
+mass_data <- imap(mzs_of_interest, function(mz_i, name){
   cbind(msdata$MS1[mz%between%pmppm(mz_i, ppm=10)], name)
-})
+}) %>%
+  bind_rows() %>%
+  filter(rt%between%c(4, 9))
 
 ggplot(mass_data) + 
   geom_line(aes(x=rt, y=int, color=filename)) + 
-  facet_wrap(~name, ncol = 1, scales = ""free_y"") +
-  lims(x=c(4, 9))
+  facet_wrap(~name, ncol = 1, scales = ""free_y"")
 ```
 
-### Moving along: MS2 data
+### Moving along: MS<sup>n</sup> data
 
 `RaMS` also handles MS<sup>2</sup> data elegantly. Request it with the ""MS2"" 
 option for `grab_what`, although it's often a good idea to grab the MS1 data
 alongside.
 
 ```{r MS2data}
-msdata <- grabMSdata(data_files[1], grab_what = ""everything"")
+msdata <- grabMSdata(data_files[1], grab_what = c(""MS1"", ""MS2"", ""MS3""))
 knitr::kable(head(msdata$MS2, 3))
 ```
 
 DDA data can be plotted nicely with `ggplot2` as well. Typically it makes sense
 to filter for a precursor mass, then render the fragments obtained.
 
 ```{r MS2demo}
-homarine_mz <- 137.047678+1.007276
+iodine_MS2 <- msdata$MS2[premz%between%pmppm(351.0818, 5)][rt==min(rt)]
+iodine_MS2$int <- iodine_MS2$int/max(iodine_MS2$int)
 
-homarine_MS2 <- msdata$MS2[premz%between%pmppm(homarine_mz, 5)]
-homarine_MS2$int <- homarine_MS2$int/max(homarine_MS2$int)
-
-ggplot(homarine_MS2) +
+ggplot(iodine_MS2) +
   geom_point(aes(x=fragmz, y=int)) +
   geom_segment(aes(x=fragmz, xend=fragmz, y=int, yend=0)) +
   scale_y_continuous(breaks = c(0, .5, 1), labels = c(""0%"", ""50%"", ""100%"")) +
@@ -231,23 +232,23 @@ as `plotly`, making data exploration not only simple but also highly intuitive.
 ```{r plotly, eval=FALSE}
 ## Not run to save space in the vignette:
 library(plotly)
-msdata <- grabMSdata(data_files, grab_what = c(""MS1"", ""MS2"", ""BPC""))
 
 compound_MS1 <- msdata$MS1 %>% 
-  filter(mz%between%pmppm(homarine_mz, 10)) %>%
-  filter(!str_detect(filename, ""DDA""))
+  filter(mz%between%pmppm(351.0818, 10)) %>%
+  filter(!str_detect(filename, ""DDA"")) %>%
+  slice_max(int, by = rt)
 
-compound_MS2 <- msdata$MS2[premz%between%pmppm(homarine_mz, 10)] %>% 
+compound_MS2 <- msdata$MS2[premz%between%pmppm(351.0818, 10)] %>% 
   group_by(rt) %>%
   arrange(desc(int)) %>%
+  slice(1:10) %>%
   summarise(frags=paste(
     paste(round(fragmz, digits = 3), round(int), sep = "": ""), collapse = ""\n""),
     .groups=""drop""
   ) %>%
   mutate(int=approx(x = compound_MS1$rt, y=compound_MS1$int, xout = rt)$y)
 plot_ly(compound_MS1) %>%
-  add_trace(type=""scatter"", mode=""lines"", x=~rt, y=~int, color=~filename,
-            hoverinfo=""none"") %>%
+  add_trace(type=""scatter"", mode=""lines"", x=~rt, y=~int, hoverinfo=""none"") %>%
   add_trace(type=""scatter"", mode=""markers"", x=~rt, y=~int,
             text=~frags, hoverinfo=""text"", showlegend=FALSE,
             marker=list(color=""black""), data = compound_MS2) %>%
@@ -257,35 +258,23 @@ plot_ly(compound_MS1) %>%
 
 Easy access to MS<sup>2</sup> data also allows us to rapidly perform 
 simple operations such as searching for a
-specific fragment mass. For example, if we know that homarine typically
-produces a fragment with a mass of 94.06567, we simply subset the MS<sup>2</sup> data
+specific fragment mass. For example, if we want to find other precursor masses
+that produced a fragment of 57.07, we simply subset the MS<sup>2</sup> data
 for fragments in a range around that mass:
 
 ```{r homarine_fragsearch}
-homarine_frag_mz <- 94.06567
-msdata$MS2[fragmz%between%pmppm(homarine_frag_mz, ppm = 5)] %>%
+msdata$MS2[fragmz%between%pmppm(57.07, ppm = 10)] %>%
   head() %>% knitr::kable()
 ```
 
-We find that there's not only homarine that produces that fragment,
-but at least one other compound. Precursor masses like this can then
-be searched manually in online databases or, since the data is already in R,
-passed to a script that automatically queries them.
-
-Similarly, we can easily search instead for neutral losses with this method. If
-we suspect other molecules are producing a similar neutral loss as homarine:
-
-```{r homarine_neutsearch}
-homarine_neutral_loss <- homarine_mz - homarine_frag_mz
+Support for MS<sup>3</sup> data was added in RaMS 1.4 and includes an additional
+""prepremz"" column that contains the original MS<sup>1</sup> value selected for
+later fragmentation.
 
-msdata$MS2 <- mutate(msdata$MS2, neutral_loss=premz-fragmz) %>%
-  select(""rt"", ""premz"", ""fragmz"", ""neutral_loss"", ""int"", ""voltage"", ""filename"")
-msdata$MS2[neutral_loss%between%pmppm(homarine_neutral_loss, ppm = 5)] %>%
-  arrange(desc(int)) %>% head() %>% knitr::kable()
+```{r}
+msdata$MS3 %>% head() %>% knitr::kable()
 ```
 
-We can again confirm our suspicions that there's another signal with
-a similar neutral loss: one with a mass of 104.0710.
 
 ### Continuing: chromatograms!
 
@@ -310,7 +299,7 @@ plot(given_chrom$rt, given_chrom$int, type=""l"", main=ptitle)
 ```
 
 Version 1.3 also enabled support for DAD (diode array detection) data. This data
-type can be requested using `grab_what = DAD` and will return an additional
+type can be requested using `grab_what = ""DAD""` and will return an additional
 item in the list with columns for retention time, wavelength, and intensity.
 
 ## Advanced RaMS usage
@@ -342,10 +331,10 @@ into R's memory sequentially, the mass window is extracted, and the rest of
 the data is discarded.
 
 ```{r EICdemo}
-all_data <- grabMSdata(data_files, grab_what = c(""MS1"", ""MS2""))
+all_data <- grabMSdata(data_files[-1], grab_what = c(""MS1"", ""MS2""))
 
 mzs_of_interest <- c(adenine=136.06232, valine=118.0865)
-small_data <- grabMSdata(data_files, grab_what = c(""EIC"", ""EIC_MS2""),
+small_data <- grabMSdata(data_files[-1], grab_what = c(""EIC"", ""EIC_MS2""),
                          mz=mzs_of_interest, ppm = 5)
 
 all_data$MS1 %>%
@@ -364,7 +353,7 @@ as.numeric(object.size(all_data)/object.size(small_data))
 ```
 
 As expected, the size of the `small_data` object is much smaller than the
-`all_data` object, here by a factor of about 15x. For files that haven't 
+`all_data` object, here by a factor of about 20x. For files that haven't 
 already been ""minified"", that size reduction will be even 
 more significant. Of course, this comes with the cost of needing to re-load
 the data a second time if a new mass feature becomes of interest but this 
@@ -379,7 +368,7 @@ only the data between those bounds is relevant. Below, peaks are deliberately
 sliced in half to show that this is filtering on retention time instead of mass.
 
 ```{r rtrangedemo}
-small_data <- grabMSdata(data_files, grab_what = c(""MS1"", ""MS2""), rtrange = c(6, 8))
+small_data <- grabMSdata(data_files[-1], grab_what = c(""MS1"", ""MS2""), rtrange = c(6, 8))
 
 all_data$MS1 %>%
   mutate(type=""All data"") %>%",False,True,Implementation / Logic,6
wkumler,RaMS,a0efafa6d9f9c247097791d7fddd7ec2f3729ca2,wkumler,wkumler@uw.edu,2024-09-17T23:30:51Z,wkumler,wkumler@uw.edu,2024-09-17T23:30:51Z,"Fixing Metabolights URLs

Now that they're stored in FILES on FTP server instead of in the directory directly",vignettes/Minifying-files-with-RaMS.Rmd,True,False,True,False,1,1,2,"---FILE: vignettes/Minifying-files-with-RaMS.Rmd---
@@ -146,7 +146,7 @@ been deposited.
 
 ```{r download from MBLs, eval=FALSE}
 if(!dir.exists(""vignettes/data""))dir.create(""vignettes/data"")
-base_url <- ""ftp://ftp.ebi.ac.uk/pub/databases/metabolights/studies/public/MTBLS703/""
+base_url <- ""ftp://ftp.ebi.ac.uk/pub/databases/metabolights/studies/public/MTBLS703/FILES/""
 chosen_files <- paste0(base_url, ""170223_Smp_LB12HL_"", c(""AB"", ""CD"", ""EF""), ""_pos.mzXML"")
 new_names <- gsub(x=basename(chosen_files), ""170223_Smp_"", """")
 ",False,True,Rendering / Conversion,3
wkumler,RaMS,ae64a954e727ab6f6a87aa52ab68f7feb49c5fb7,Ethan Bass,ethanbass@gmail.com,2024-09-17T20:04:24Z,Ethan Bass,ethanbass@gmail.com,2024-09-17T20:07:20Z,fix: wrong time zones returned by `strptime`,R/grabMzmlFunctions.R;tests/testthat/test_chroms.R,False,True,True,False,7,1,8,"---FILE: R/grabMzmlFunctions.R---
@@ -283,7 +283,8 @@ grabMzmlMetadata <- function(xml_data){
   time_node <- xml2::xml_find_first(xml_data, xpath = ""//d1:run"")
   time_val <- xml2::xml_attr(time_node, ""startTimeStamp"")
   if(!is.na(time_val)){
-    time_stamp <- as.POSIXct(strptime(time_val, ""%Y-%m-%dT%H:%M:%SZ""))
+    time_val <- sub(""Z$"", ""+0000"", time_val)
+    time_stamp <- as.POSIXct(strptime(time_val, ""%Y-%m-%dT%H:%M:%S%z"", tz=""UTC""))
   } else {
     time_stamp <- as.POSIXct(NA)
   }

---FILE: tests/testthat/test_chroms.R---
@@ -21,3 +21,8 @@ test_that(""warning thrown when requesting chroms from mzXML"", {
   expect_warning(grabMSdata(mzXML_filenames[2], grab_what = ""chroms""),
                  regexp = ""grab_what = 'chroms' not available for mzXML documents"")
 })
+
+test_that(""time stamp is correct"", {
+  expect_identical(msdata_MRM_everything$metadata$timestamp,
+                   as.POSIXct(""2022-08-11 12:34:56"",tz=""UTC""))
+})",True,False,Implementation / Logic,6
wkumler,RaMS,416d0245e244ecc415de3d748594eba62ecea574,wkumler,wkumler@uw.edu,2024-03-06T23:03:04Z,wkumler,wkumler@uw.edu,2024-03-06T23:03:04Z,Hotfix for multi-encoding mzXML files,R/grabMzxmlFunctions.R,False,True,True,False,8,3,11,"---FILE: R/grabMzxmlFunctions.R---
@@ -638,17 +638,22 @@ grabMzxmlSpectraVoltage <- function(xml_nodes){
 
 grabMzxmlSpectraMzInt <- function(xml_nodes, file_metadata){
   all_peak_nodes <- xml2::xml_text(xml2::xml_find_all(xml_nodes, xpath = ""d1:peaks""))
-  vals <- lapply(all_peak_nodes, function(binary){
+  init_peak_encs <- xml2::xml_attr(xml2::xml_find_all(xml_nodes, xpath = ""d1:peaks""), ""compressionType"")
+  all_peak_encs <- rep(""none"", length(init_peak_encs))
+  all_peak_encs[init_peak_encs==""zlib""] <- ""gzip""
+  all_peak_encs[init_peak_encs==""zlib compression""] <- ""gzip""
+
+  vals <- mapply(function(binary, encoding_i){
     if(!nchar(binary))return(matrix(ncol = 2, nrow = 0))
     decoded_binary <- base64enc::base64decode(binary)
     raw_binary <- as.raw(decoded_binary)
-    decomp_binary <- memDecompress(raw_binary, type = file_metadata$compression)
+    decomp_binary <- memDecompress(raw_binary, type = encoding_i)
     final_binary <- readBin(decomp_binary, what = ""numeric"",
                             n=length(decomp_binary)/file_metadata$precision,
                             size = file_metadata$precision,
                             endian = file_metadata$endi_enc)
     matrix(final_binary, ncol = 2, byrow = TRUE)
-  })
+  }, all_peak_nodes, all_peak_encs)
 }
 
 ",True,False,Implementation / Logic,6
wkumler,RaMS,17d2064ea5306338d6df7b69f43e7b7ecb023ada,wkumler,wkumler@uw.edu,2024-02-29T22:59:02Z,wkumler,wkumler@uw.edu,2024-02-29T22:59:02Z,Fixed bug preventing reading in of mzML and mzXML simultaneously,R/grabMSdataCode.R,False,True,True,False,1,1,2,"---FILE: R/grabMSdataCode.R---
@@ -187,7 +187,7 @@ grabMSdata <- function(files, grab_what=""everything"", verbosity=NULL,
   # Bind all the similar pieces together (e.g. stack MS1 from different files)
   # all_file_data_output <- Reduce(function(x,y) Map(rbind, x, y, fill=TRUE), all_file_data)
   all_file_data_output <- lapply(seq_along(all_file_data[[1]]), function(sub_index){
-    rbindlist(lapply(all_file_data, `[[`, sub_index))
+    rbindlist(lapply(all_file_data, `[[`, sub_index), fill = TRUE)
   })
   names(all_file_data_output) <- names(all_file_data[[1]])
 ",True,False,Implementation / Logic,6
wkumler,RaMS,e68429c7550f323fac927db8429c53b354d339d6,wkumler,wkumler@uw.edu,2024-02-27T17:34:34Z,wkumler,wkumler@uw.edu,2024-02-27T17:34:34Z,Fixing broken example,R/grabMSdataCode.R;man/grabAccessionData.Rd,False,True,True,False,4,4,8,"---FILE: R/grabMSdataCode.R---
@@ -314,8 +314,8 @@ checkOutputQuality <- function(output_data, grab_what){
 #' \dontshow{data.table::setDTthreads(2)}
 #' sample_dir <- system.file(""extdata"", package = ""RaMS"")
 #' sample_file <- list.files(sample_dir, full.names=TRUE)[3]
-#' # Get ion injection time
-#' iit_df <- grabAccessionData(sample_file, ""MS:1000927"")
+#' # Get highest observed m/z detected
+#' topmass_df <- grabAccessionData(sample_file, ""MS:1000527"")
 #' # Manually create TIC
 #' int_df <- grabAccessionData(sample_file, ""MS:1000285"")
 #' rt_df <- grabAccessionData(sample_file, ""MS:1000016"")

---FILE: man/grabAccessionData.Rd---
@@ -28,8 +28,8 @@ library(RaMS)
 \dontshow{data.table::setDTthreads(2)}
 sample_dir <- system.file(""extdata"", package = ""RaMS"")
 sample_file <- list.files(sample_dir, full.names=TRUE)[3]
-# Get ion injection time
-iit_df <- grabAccessionData(sample_file, ""MS:1000927"")
+# Get highest observed m/z detected
+topmass_df <- grabAccessionData(sample_file, ""MS:1000527"")
 # Manually create TIC
 int_df <- grabAccessionData(sample_file, ""MS:1000285"")
 rt_df <- grabAccessionData(sample_file, ""MS:1000016"")",True,False,Documentation / Formatting,6
wkumler,RaMS,4d3c7969a57a2fa084acfe4d38b9369c6cbd83ff,wkumler,wkumler@uw.edu,2023-12-13T18:30:50Z,wkumler,wkumler@uw.edu,2023-12-13T18:30:50Z,Incrementing to 1.3.4 patch,DESCRIPTION,False,False,False,False,1,1,2,"---FILE: DESCRIPTION---
@@ -1,7 +1,7 @@
 Package: RaMS
 Type: Package
 Title: R Access to Mass-Spec Data
-Version: 1.3.3
+Version: 1.3.4
 Authors@R: c(
   person(given = ""William"", family = ""Kumler"", email = ""wkumler@uw.edu"",
          role = c(""aut"", ""cre"", ""cph"")),",False,False,Dependency / Package,6
wkumler,RaMS,3309b84e8b02392e1e0fc32a9da89c6ba68f3ef7,wkumler,wkumler@uw.edu,2023-12-12T20:15:10Z,wkumler,wkumler@uw.edu,2023-12-12T20:15:10Z,Updating to 1.3.3 patch,DESCRIPTION;cran-comments.md,False,False,False,False,7,1,8,"---FILE: DESCRIPTION---
@@ -1,7 +1,7 @@
 Package: RaMS
 Type: Package
 Title: R Access to Mass-Spec Data
-Version: 1.3.2
+Version: 1.3.3
 Authors@R: c(
   person(given = ""William"", family = ""Kumler"", email = ""wkumler@uw.edu"",
          role = c(""aut"", ""cre"", ""cph"")),

---FILE: cran-comments.md---
@@ -1,4 +1,10 @@
 
+## Resubmission
+
+This is a resubmission. In this version I have reduced the example runtimes to
+below 5s (I hope) for tests and examples and set data.table to use only two
+threads to avoid CPU time > 2.5 times elapsed time
+
 ## Test environments
 * local R installation, R 4.3.2
 * windows-latest (release) (via GitHub Actions)",False,False,Documentation / Formatting,6
wkumler,RaMS,4a18e13ac571b30e6214f2ec6879f6d5c4c4fe5b,wkumler,wkumler@uw.edu,2023-11-30T03:23:16Z,wkumler,wkumler@uw.edu,2023-11-30T03:23:16Z,Installing mzR directly because Linux errors,.github/workflows/r-check-cran.yml,False,False,False,False,1,0,1,"---FILE: .github/workflows/r-check-cran.yml---
@@ -71,6 +71,7 @@ jobs:
       - name: Install dependencies
         run: |
           install.packages(""stringi"")
+          BiocManager::install(""mzR"")
           remotes::install_deps(dependencies = TRUE, repos=BiocManager::repositories())
           remotes::install_cran(""rcmdcheck"")
         shell: Rscript {0}",False,False,Data / Input Handling,3
wkumler,RaMS,0e0abaebbe5d956b9c25f01e1e9c8470523f3044,wkumler,wkumler@uw.edu,2023-11-15T19:19:34Z,wkumler,wkumler@uw.edu,2023-11-15T19:19:34Z,"Fixed failing unit test

Upgraded from warning to error and didn't change unit check to reflect",tests/testthat/test_extras.R,False,True,True,False,1,1,2,"---FILE: tests/testthat/test_extras.R---
@@ -10,7 +10,7 @@ test_that(""pmppm works as expected"", {
 
   expect_gt(max(pmppm(100, 10)), max(pmppm(100, 5)))
 
-  expect_warning(pmppm(100:110, 10))
+  expect_error(pmppm(100:110, 10))
 })
 
 test_that(""trapz works as expected"", {",True,False,Implementation / Logic,6
wkumler,RaMS,b4ef0df8d86179f815b947086b769075d6f7c635,wkumler,wkumler@uw.edu,2023-11-15T18:49:25Z,wkumler,wkumler@uw.edu,2023-11-15T18:49:25Z,Adding more error handling to pmppm function,R/grabMSdataCode.R,False,True,True,False,5,2,7,"---FILE: R/grabMSdataCode.R---
@@ -502,8 +502,11 @@ timeReport <- function(last_time, text=NULL){
 #' pmppm(118.0865, 2.5)
 #' pmppm(892.535313, 10)
 pmppm <- function(mass, ppm=4){
-  if(length(mass)>1)warning(""Vectorized masses are not supported in pmppm"")
-  if(length(ppm)>1)warning(""Vectorized ppms are not supported in pmppm"")
+  if(length(mass)>1)stop(""Vectorized masses are not supported in pmppm"")
+  if(length(ppm)>1)stop(""Vectorized ppms are not supported in pmppm"")
+  if(!is.numeric(mass))stop(""'mass' must be numeric"")
+  if(!is.numeric(ppm))stop(""'ppm' must be numeric"")
+  if(ppm<0)warning(""'ppm' should be positive"")
   c(mass*(1-ppm/1000000), mass*(1+ppm/1000000))
 }
 ",True,False,Implementation / Logic,6
wkumler,RaMS,acf4f7bff26d7aa12f114204104a7ca13d8aee28,wkumler,wkumler@uw.edu,2023-11-15T16:55:09Z,wkumler,wkumler@uw.edu,2023-11-15T16:55:09Z,Adding warnings to pmppm and fixing erroneous unit tests,R/grabMSdataCode.R;tests/testthat/test_extras.R,False,True,True,False,9,3,12,"---FILE: R/grabMSdataCode.R---
@@ -494,7 +494,11 @@ checkQuickMLs <- function(files){
 #' pmppm(1000000, 5)
 #' pmppm(118.0865, 2.5)
 #' pmppm(892.535313, 10)
-pmppm <- function(mass, ppm=4)c(mass*(1-ppm/1000000), mass*(1+ppm/1000000))
+pmppm <- function(mass, ppm=4){
+  if(length(mass)>1)warning(""Vectorized masses are not supported in pmppm"")
+  if(length(ppm)>1)warning(""Vectorized ppms are not supported in pmppm"")
+  c(mass*(1-ppm/1000000), mass*(1+ppm/1000000))
+}
 
 #' Trapezoidal integration of mass-spec retention time / intensity values
 #'

---FILE: tests/testthat/test_extras.R---
@@ -9,6 +9,8 @@ test_that(""pmppm works as expected"", {
   expect_lt(pmppm(100)[1], pmppm(100)[2])
 
   expect_gt(max(pmppm(100, 10)), max(pmppm(100, 5)))
+
+  expect_warning(pmppm(100:110, 10))
 })
 
 test_that(""trapz works as expected"", {
@@ -17,10 +19,10 @@ test_that(""trapz works as expected"", {
   expect_equal(trapz(0, 1), 0)
   expect_equal(trapz(1, 1), 0)
   expect_equal(trapz(1:10, 1:10, baseline = ""square""), 40.5)
-  expect_equal(trapz(1:10, 1:10, baseline = ""linear""), 0)
+  expect_equal(trapz(1:10, 1:10, baseline = ""trapezoid""), 0)
   expect_equal(trapz(c(0, 100), c(1, 1)), 100)
   expect_equal(trapz(c(0, 100), c(1, 1), ""square""), 0)
-  expect_equal(trapz(c(0, 100), c(1, 1), ""linear""), 0)
+  expect_equal(trapz(c(0, 100), c(1, 1), ""trapezoid""), 0)
 
   x_vals <- 1:10
   y_vals <- runif(10)",True,False,Implementation / Logic,6
wkumler,RaMS,1f6a753f5128b133f6a6efd6da7f785c7df2d2f7,wkumler,wkumler@uw.edu,2023-11-14T00:46:10Z,wkumler,wkumler@uw.edu,2023-11-14T00:46:10Z,ASAP error message instead of afterward,R/grabMSdataCode.R,False,True,True,False,3,0,3,"---FILE: R/grabMSdataCode.R---
@@ -452,6 +452,8 @@ checkProvidedPrefilter <- function(prefilter){
 }
 
 checkQuickMLs <- function(files){
+  init_warn_val <- getOption(""warn"")
+  options(warn=1)
   ml_check <- grepl(""\\.mzx?ml$|\\.mzx?ml\\.gz$"", files, ignore.case = TRUE)
   if(!all(ml_check)){
     nonml_files <- files[!ml_check]
@@ -469,6 +471,7 @@ checkQuickMLs <- function(files){
     }
     warning(warn_string)
   }
+  options(warn=init_warn_val)
 }
 
 ",True,False,Implementation / Logic,6
wkumler,RaMS,afa4f27b0444df43aebce748beb14ed2be5cb1b8,wkumler,wkumler@uw.edu,2023-11-14T00:22:29Z,wkumler,wkumler@uw.edu,2023-11-14T00:22:29Z,"Fixing quickCheckMLs bug (regex reads spaces, duh)",R/grabMSdataCode.R,False,True,True,False,1,1,2,"---FILE: R/grabMSdataCode.R---
@@ -452,7 +452,7 @@ checkProvidedPrefilter <- function(prefilter){
 }
 
 checkQuickMLs <- function(files){
-  ml_check <- grepl(""\\.mzx?ml$ | \\.mzx?ml\\.gz$"", files, ignore.case = TRUE)
+  ml_check <- grepl(""\\.mzx?ml$|\\.mzx?ml\\.gz$"", files, ignore.case = TRUE)
   if(!all(ml_check)){
     nonml_files <- files[!ml_check]
     if(length(nonml_files)>5){",True,False,Implementation / Logic,6
wkumler,RaMS,3ffa6878ea05df6f5232af677c34eea380c70541,wkumler,wkumler@uw.edu,2022-12-14T18:37:05Z,wkumler,wkumler@uw.edu,2022-12-14T18:37:05Z,Updating to v1.3.1 patch,DESCRIPTION;NEWS.md;cran-comments.md,False,False,False,False,13,1,14,"---FILE: DESCRIPTION---
@@ -1,7 +1,7 @@
 Package: RaMS
 Type: Package
 Title: R Access to Mass-Spec Data
-Version: 1.3.0
+Version: 1.3.1
 Authors@R: c(
   person(given = ""William"", family = ""Kumler"", email = ""wkumler@uw.edu"",
          role = c(""aut"", ""cre"", ""cph"")),

---FILE: NEWS.md---
@@ -1,5 +1,12 @@
 # RaMS (development version)
 
+# RaMS 1.3.1 (patch)
+ - Squashed a bunch of bugs around CRAN submission
+ - Changed where unit tests write to
+ - Improved unit test coverage
+ - Fixed broken URLs
+ - Added base64encoding to the package officially
+
 # RaMS 1.3.0
 ## DAD and chromatogram handling
  - Added support for DAD (diode array detection) data with `grab_what = ""DAD""`, credit to @ethanbass for the code

---FILE: cran-comments.md---
@@ -1,3 +1,8 @@
+## Resubmission
+This is a resubmission. In this patch version I have:
+
+* Incremented version number to avoid name conflicts with the existing package
+
 ## Resubmission (prior)
 This is a resubmission. In this version I have:
 ",False,False,Documentation / Formatting,6
wkumler,RaMS,52f91c1a6bc2664a5093a352ec65f804adf092cc,wkumler,wkumler@uw.edu,2022-12-13T19:08:38Z,wkumler,wkumler@uw.edu,2022-12-13T19:08:38Z,Adding base64encoding to the package officially. Not sure why/how this wasn't necessary before but it's fixed now!,NAMESPACE;R/grabMSdataCode.R,False,True,True,False,2,1,3,"---FILE: NAMESPACE---
@@ -17,3 +17,4 @@ import(data.table)
 import(utils)
 import(xml2)
 importFrom(base64enc,base64decode)
+importFrom(base64enc,base64encode)

---FILE: R/grabMSdataCode.R---
@@ -460,7 +460,7 @@ timeReport <- function(last_time, text=NULL){
 #' @import xml2
 #' @import data.table
 #' @import utils
-#' @importFrom base64enc base64decode
+#' @importFrom base64enc base64decode base64encode
 #' @export
 data.table::between
 #' @export",True,False,Dependency / Package,7
wkumler,RaMS,5ee6a3eea2418fb169bf1f8a2c344be94a65d071,wkumler,wkumler@uw.edu,2022-11-16T20:28:59Z,wkumler,wkumler@uw.edu,2022-11-16T20:28:59Z,Fixed URL for CRAN compatibility,README.md;cran-comments.md,False,False,False,False,7,2,9,"---FILE: README.md---
@@ -7,7 +7,7 @@ R-based access to Mass-Spec data (RaMS)
 [![R build
 status](https://github.com/wkumler/RaMS/workflows/R-CMD-check/badge.svg)](https://github.com/wkumler/RaMS/actions/)
 [![Codecov test
-coverage](https://codecov.io/gh/wkumler/RaMS/branch/master/graph/badge.svg?token=FU9R6TAOOO)](https://codecov.io/gh/wkumler/RaMS)
+coverage](https://codecov.io/gh/wkumler/RaMS/branch/master/graph/badge.svg?token=FU9R6TAOOO)](https://app.codecov.io/gh/wkumler/RaMS)
 <!-- badges: end -->
 
 **Table of contents:** [Overview](.#overview) -
@@ -265,4 +265,4 @@ Issues page](https://github.com/wkumler/RaMS/issues).
 
 ------------------------------------------------------------------------
 
-README last built on 2022-11-14
+README last built on 2022-11-16

---FILE: cran-comments.md---
@@ -1,6 +1,11 @@
 ## Resubmission
 This is a resubmission. In this version I have:
 
+* Fixed more invalid URLs! Sorry I didn't catch them all last time
+
+## Resubmission (prior)
+This is a resubmission. In this version I have:
+
 * Fixed invalid URLs
 * Reduced some examples to have CPU time < 2.5 times elapsed time
 ",False,False,Documentation / Formatting,6
wkumler,RaMS,26dbfca88a05a4c6c2991418f55f633984dbbea3,wkumler,wkumler@uw.edu,2022-11-14T19:59:10Z,wkumler,wkumler@uw.edu,2022-11-14T19:59:17Z,Fixing broken URLs after CRAN feedback,README.md;doc/Intro-to-RaMS.Rmd;doc/Intro-to-RaMS.html;doc/Intro-to-tmzML.html;doc/Minifying-files-with-RaMS.Rmd;doc/Minifying-files-with-RaMS.html;doc/RaMS-and-friends.html;vignettes/Intro-to-RaMS.Rmd;vignettes/Minifying-files-with-RaMS.Rmd,True,False,True,False,1614,461,2075,"---FILE: README.md---
@@ -7,7 +7,7 @@ R-based access to Mass-Spec data (RaMS)
 [![R build
 status](https://github.com/wkumler/RaMS/workflows/R-CMD-check/badge.svg)](https://github.com/wkumler/RaMS/actions/)
 [![Codecov test
-coverage](https://codecov.io/gh/wkumler/RaMS/branch/master/graph/badge.svg)](https://codecov.io/gh/wkumler/RaMS)
+coverage](https://codecov.io/gh/wkumler/RaMS/branch/master/graph/badge.svg?token=FU9R6TAOOO)](https://codecov.io/gh/wkumler/RaMS)
 <!-- badges: end -->
 
 **Table of contents:** [Overview](.#overview) -
@@ -231,7 +231,7 @@ slightly older **mzXML** format, as well as the custom [**tmzML**
 format](https://htmlpreview.github.io/?https://github.com/wkumler/RaMS/blob/master/doc/Intro-to-tmzML.html)
 as of version 1.2.0. Tools to convert data from other formats are
 available through
-[Proteowizard’s](http://proteowizard.sourceforge.net/tools.shtml)
+[Proteowizard’s](https://proteowizard.sourceforge.io/tools/msconvert.html)
 `msconvert` tool. Data can, however, be gzip compressed (file ending
 .gz) and this compression actually speeds up data retrieval
 significantly as well as reducing file sizes.
@@ -265,4 +265,4 @@ Issues page](https://github.com/wkumler/RaMS/issues).
 
 ------------------------------------------------------------------------
 
-README last built on 2022-04-08
+README last built on 2022-11-14

---FILE: doc/Intro-to-RaMS.Rmd---
@@ -45,7 +45,7 @@ If you have your own data, feel free to load it here. If not, there's a couple
 small example files you're welcome to use in the ""extdata"" folder. The first of 
 these contains DDA data from a pooled sample, while the others are individual 
 samples. I'll be using these throughout. For more details on the origin of these
-files, see the [minification vignette](doc/Minifying-files-with-RaMS.html).
+files, see the [minification vignette](https://htmlpreview.github.io/?https://github.com/wkumler/RaMS/blob/master/doc/Minifying-files-with-RaMS.html).
 
 ```{r findfiles, message=FALSE}
 library(RaMS)
@@ -426,7 +426,7 @@ reduce file size and read times. Sharp-eyed users will have noticed that the
 demo files are already gzipped, which is part of the reason they are so small.
 
 `zlib` compression is slightly trickier, and is most often performed with tools
-such as [Proteowizard](http://proteowizard.sourceforge.net/doc_users.html)'s 
+such as [Proteowizard](https://proteowizard.sourceforge.io/doc_users.html)'s 
 `msconvert` tool with the option ""-z"". 
 
 Read times may also be slow if files are being accessed via the Internet, either

---FILE: doc/Minifying-files-with-RaMS.Rmd---
@@ -179,7 +179,7 @@ minifyMSdata(files = init_files, output_files = out_files, warn = FALSE,
 
 Now we have four minified mzXML files in our inst/extdata folder. However, we'd
 like to be able to demo the mzML functionality as well as that of mzXMLs, so
-we can use [Proteowizard's](http://proteowizard.sourceforge.net/tools.shtml) 
+we can use [Proteowizard's](https://proteowizard.sourceforge.io/tools/msconvert.html) 
 `msconvert` tool because `RaMS` can't convert between mzML and mzXML or vice 
 versa. You'll need to install `msconvert` and add it to your path for this
 step.

---FILE: doc/Minifying-files-with-RaMS.html---
@@ -14,26 +14,38 @@
 
 <title>Minifying files with RaMS</title>
 
-<script src=""data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK""></script>
+<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
+// be compatible with the behavior of Pandoc < 2.8).
+document.addEventListener('DOMContentLoaded', function(e) {
+  var hs = document.querySelectorAll(""div.section[class*='level'] > :first-child"");
+  var i, h, a;
+  for (i = 0; i < hs.length; i++) {
+    h = hs[i];
+    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
+    a = h.attributes;
+    while (a.length > 0) h.removeAttribute(a[0].name);
+  }
+});
+</script>
 
 <style type=""text/css"">
-  code{white-space: pre-wrap;}
-  span.smallcaps{font-variant: small-caps;}
-  span.underline{text-decoration: underline;}
-  div.column{display: inline-block; vertical-align: top; width: 50%;}
-  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
-  ul.task-list{list-style: none;}
-    </style>
+code{white-space: pre-wrap;}
+span.smallcaps{font-variant: small-caps;}
+span.underline{text-decoration: underline;}
+div.column{display: inline-block; vertical-align: top; width: 50%;}
+div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
+ul.task-list{list-style: none;}
+</style>
 
 
 
 <style type=""text/css"">
-  code {
-    white-space: pre;
-  }
-  .sourceCode {
-    overflow: visible;
-  }
+code {
+white-space: pre;
+}
+.sourceCode {
+overflow: visible;
+}
 </style>
 <style type=""text/css"" data-origin=""pandoc"">
 pre > code.sourceCode { white-space: pre; position: relative; }
@@ -51,55 +63,54 @@
 pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
 }
 pre.numberSource code
-  { counter-reset: source-line 0; }
+{ counter-reset: source-line 0; }
 pre.numberSource code > span
-  { position: relative; left: -4em; counter-increment: source-line; }
+{ position: relative; left: -4em; counter-increment: source-line; }
 pre.numberSource code > span > a:first-child::before
-  { content: counter(source-line);
-    position: relative; left: -1em; text-align: right; vertical-align: baseline;
-    border: none; display: inline-block;
-    -webkit-touch-callout: none; -webkit-user-select: none;
-    -khtml-user-select: none; -moz-user-select: none;
-    -ms-user-select: none; user-select: none;
-    padding: 0 4px; width: 4em;
-    color: #aaaaaa;
-  }
-pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
+{ content: counter(source-line);
+position: relative; left: -1em; text-align: right; vertical-align: baseline;
+border: none; display: inline-block;
+-webkit-touch-callout: none; -webkit-user-select: none;
+-khtml-user-select: none; -moz-user-select: none;
+-ms-user-select: none; user-select: none;
+padding: 0 4px; width: 4em;
+color: #aaaaaa;
+}
+pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
 div.sourceCode
-  {   }
+{ }
 @media screen {
 pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
 }
-code span.al { color: #ff0000; font-weight: bold; } /* Alert */
-code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
-code span.at { color: #7d9029; } /* Attribute */
-code span.bn { color: #40a070; } /* BaseN */
-code span.bu { } /* BuiltIn */
-code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
-code span.ch { color: #4070a0; } /* Char */
-code span.cn { color: #880000; } /* Constant */
-code span.co { color: #60a0b0; font-style: italic; } /* Comment */
-code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
-code span.do { color: #ba2121; font-style: italic; } /* Documentation */
-code span.dt { color: #902000; } /* DataType */
-code span.dv { color: #40a070; } /* DecVal */
-code span.er { color: #ff0000; font-weight: bold; } /* Error */
-code span.ex { } /* Extension */
-code span.fl { color: #40a070; } /* Float */
-code span.fu { color: #06287e; } /* Function */
-code span.im { } /* Import */
-code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
-code span.kw { color: #007020; font-weight: bold; } /* Keyword */
-code span.op { color: #666666; } /* Operator */
-code span.ot { color: #007020; } /* Other */
-code span.pp { color: #bc7a00; } /* Preprocessor */
-code span.sc { color: #4070a0; } /* SpecialChar */
-code span.ss { color: #bb6688; } /* SpecialString */
-code span.st { color: #4070a0; } /* String */
-code span.va { color: #19177c; } /* Variable */
-code span.vs { color: #4070a0; } /* VerbatimString */
-code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
-
+code span.al { color: #ff0000; font-weight: bold; } 
+code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
+code span.at { color: #7d9029; } 
+code span.bn { color: #40a070; } 
+code span.bu { color: #008000; } 
+code span.cf { color: #007020; font-weight: bold; } 
+code span.ch { color: #4070a0; } 
+code span.cn { color: #880000; } 
+code span.co { color: #60a0b0; font-style: italic; } 
+code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
+code span.do { color: #ba2121; font-style: italic; } 
+code span.dt { color: #902000; } 
+code span.dv { color: #40a070; } 
+code span.er { color: #ff0000; font-weight: bold; } 
+code span.ex { } 
+code span.fl { color: #40a070; } 
+code span.fu { color: #06287e; } 
+code span.im { color: #008000; font-weight: bold; } 
+code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
+code span.kw { color: #007020; font-weight: bold; } 
+code span.op { color: #666666; } 
+code span.ot { color: #007020; } 
+code span.pp { color: #bc7a00; } 
+code span.sc { color: #4070a0; } 
+code span.ss { color: #bb6688; } 
+code span.st { color: #4070a0; } 
+code span.va { color: #19177c; } 
+code span.vs { color: #4070a0; } 
+code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
 </style>
 <script>
 // apply pandoc div.sourceCode style to pre.sourceCode instead
@@ -133,7 +144,187 @@
 
 
 
-<link rel=""stylesheet"" href=""data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A"" type=""text/css"" />
+<style type=""text/css"">body {
+background-color: #fff;
+margin: 1em auto;
+max-width: 700px;
+overflow: visible;
+padding-left: 2em;
+padding-right: 2em;
+font-family: ""Open Sans"", ""Helvetica Neue"", Helvetica, Arial, sans-serif;
+font-size: 14px;
+line-height: 1.35;
+}
+#TOC {
+clear: both;
+margin: 0 0 10px 10px;
+padding: 4px;
+width: 400px;
+border: 1px solid #CCCCCC;
+border-radius: 5px;
+background-color: #f6f6f6;
+font-size: 13px;
+line-height: 1.3;
+}
+#TOC .toctitle {
+font-weight: bold;
+font-size: 15px;
+margin-left: 5px;
+}
+#TOC ul {
+padding-left: 40px;
+margin-left: -1.5em;
+margin-top: 5px;
+margin-bottom: 5px;
+}
+#TOC ul ul {
+margin-left: -2em;
+}
+#TOC li {
+line-height: 16px;
+}
+table {
+margin: 1em auto;
+border-width: 1px;
+border-color: #DDDDDD;
+border-style: outset;
+border-collapse: collapse;
+}
+table th {
+border-width: 2px;
+padding: 5px;
+border-style: inset;
+}
+table td {
+border-width: 1px;
+border-style: inset;
+line-height: 18px;
+padding: 5px 5px;
+}
+table, table th, table td {
+border-left-style: none;
+border-right-style: none;
+}
+table thead, table tr.even {
+background-color: #f7f7f7;
+}
+p {
+margin: 0.5em 0;
+}
+blockquote {
+background-color: #f6f6f6;
+padding: 0.25em 0.75em;
+}
+hr {
+border-style: solid;
+border: none;
+border-top: 1px solid #777;
+margin: 28px 0;
+}
+dl {
+margin-left: 0;
+}
+dl dd {
+margin-bottom: 13px;
+margin-left: 13px;
+}
+dl dt {
+font-weight: bold;
+}
+ul {
+margin-top: 0;
+}
+ul li {
+list-style: circle outside;
+}
+ul ul {
+margin-bottom: 0;
+}
+pre, code {
+background-color: #f7f7f7;
+border-radius: 3px;
+color: #333;
+white-space: pre-wrap; 
+}
+pre {
+border-radius: 3px;
+margin: 5px 0px 10px 0px;
+padding: 10px;
+}
+pre:not([class]) {
+background-color: #f7f7f7;
+}
+code {
+font-family: Consolas, Monaco, 'Courier New', monospace;
+font-size: 85%;
+}
+p > code, li > code {
+padding: 2px 0px;
+}
+div.figure {
+text-align: center;
+}
+img {
+background-color: #FFFFFF;
+padding: 2px;
+border: 1px solid #DDDDDD;
+border-radius: 3px;
+border: 1px solid #CCCCCC;
+margin: 0 5px;
+}
+h1 {
+margin-top: 0;
+font-size: 35px;
+line-height: 40px;
+}
+h2 {
+border-bottom: 4px solid #f7f7f7;
+padding-top: 10px;
+padding-bottom: 2px;
+font-size: 145%;
+}
+h3 {
+border-bottom: 2px solid #f7f7f7;
+padding-top: 10px;
+font-size: 120%;
+}
+h4 {
+border-bottom: 1px solid #f7f7f7;
+margin-left: 8px;
+font-size: 105%;
+}
+h5, h6 {
+border-bottom: 1px solid #ccc;
+font-size: 105%;
+}
+a {
+color: #0033dd;
+text-decoration: none;
+}
+a:hover {
+color: #6666ff; }
+a:visited {
+color: #800080; }
+a:visited:hover {
+color: #BB00BB; }
+a[href^=""http:""] {
+text-decoration: underline; }
+a[href^=""https:""] {
+text-decoration: underline; }
+
+code > span.kw { color: #555; font-weight: bold; } 
+code > span.dt { color: #902000; } 
+code > span.dv { color: #40a070; } 
+code > span.bn { color: #d14; } 
+code > span.fl { color: #d14; } 
+code > span.ch { color: #d14; } 
+code > span.st { color: #d14; } 
+code > span.co { color: #888888; font-style: italic; } 
+code > span.ot { color: #007020; } 
+code > span.al { color: #ff0000; font-weight: bold; } 
+code > span.fu { color: #900; font-weight: bold; } 
+code > span.er { color: #a61717; background-color: #e3d2d2; } 
+</style>
 
 
 
@@ -150,9 +341,30 @@ <h1 class=""title toc-ignore"">Minifying files with RaMS</h1>
 
 
 <!-- This vignette is created from a .Rmd file: please edit that instead. -->
-<p>As of version 1.1.0, <code>RaMS</code> also has functions that allow irrelevant data to be removed from the file to reduce file sizes. Like <code>grabMSdata</code>, there’s one wrapper function <code>minifyMSdata</code> that accepts mzML or mzXML files, plus a vector of <em>m/z</em> values that should either be kept (<code>mz_include</code>) or removed (<code>mz_exclude</code>). The function then opens up the provided MS files and removes data points in the MS<sup>1</sup> and MS<sup>2</sup> spectra that fall outside the accepted bounds. <code>mz_include</code> is useful when only a few masses are of interest, as in targeted metabolomics. <code>mz_exclude</code> is useful when many masses are known to be contaminants or interfere with peakpicking/plotting abilities. This minification can shrink a file over three orders of magnitude, decreasing both processing time and memory allocation later in the pipeline.</p>
-<p>This is also very useful for creating demo MS files - <code>RaMS</code> uses these functions to produce the sample data in <code>extdata</code>, with 6 MS files taking up less than 5 megabytes of disk space. Many other programs provide the ability to shrink files, but none (known to me) shrink files by excluding <em>m/z</em> values and instead can only remove certain retention times.</p>
-<p>Below, we begin with a large MS file containing both MS<sup>1</sup> and MS<sup>2</sup> data and extract only the data corresponding to valine/glycine betaine and homarine.</p>
+<p>As of version 1.1.0, <code>RaMS</code> also has functions that allow
+irrelevant data to be removed from the file to reduce file sizes. Like
+<code>grabMSdata</code>, there’s one wrapper function
+<code>minifyMSdata</code> that accepts mzML or mzXML files, plus a
+vector of <em>m/z</em> values that should either be kept
+(<code>mz_include</code>) or removed (<code>mz_exclude</code>). The
+function then opens up the provided MS files and removes data points in
+the MS<sup>1</sup> and MS<sup>2</sup> spectra that fall outside the
+accepted bounds. <code>mz_include</code> is useful when only a few
+masses are of interest, as in targeted metabolomics.
+<code>mz_exclude</code> is useful when many masses are known to be
+contaminants or interfere with peakpicking/plotting abilities. This
+minification can shrink a file over three orders of magnitude,
+decreasing both processing time and memory allocation later in the
+pipeline.</p>
+<p>This is also very useful for creating demo MS files -
+<code>RaMS</code> uses these functions to produce the sample data in
+<code>extdata</code>, with 6 MS files taking up less than 5 megabytes of
+disk space. Many other programs provide the ability to shrink files, but
+none (known to me) shrink files by excluding <em>m/z</em> values and
+instead can only remove certain retention times.</p>
+<p>Below, we begin with a large MS file containing both MS<sup>1</sup>
+and MS<sup>2</sup> data and extract only the data corresponding to
+valine/glycine betaine and homarine.</p>
 <div class=""sourceCode"" id=""cb1""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb1-1""><a href=""#cb1-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">library</span>(RaMS)</span>
 <span id=""cb1-2""><a href=""#cb1-2"" aria-hidden=""true"" tabindex=""-1""></a>msdata_files <span class=""ot"">&lt;-</span> <span class=""fu"">list.files</span>(</span>
 <span id=""cb1-3""><a href=""#cb1-3"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""fu"">system.file</span>(<span class=""st"">&quot;extdata&quot;</span>, <span class=""at"">package =</span> <span class=""st"">&quot;RaMS&quot;</span>), <span class=""at"">full.names =</span> <span class=""cn"">TRUE</span>, <span class=""at"">pattern =</span> <span class=""st"">&quot;mzML&quot;</span></span>
@@ -164,7 +376,9 @@ <h1 class=""title toc-ignore"">Minifying files with RaMS</h1>
 <span id=""cb1-9""><a href=""#cb1-9"" aria-hidden=""true"" tabindex=""-1""></a>masses_of_interest <span class=""ot"">&lt;-</span> <span class=""fu"">c</span>(<span class=""fl"">118.0865</span>, <span class=""fl"">138.0555</span>)</span>
 <span id=""cb1-10""><a href=""#cb1-10"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">minifyMSdata</span>(<span class=""at"">files =</span> initial_filename, <span class=""at"">output_files =</span> output_filename, </span>
 <span id=""cb1-11""><a href=""#cb1-11"" aria-hidden=""true"" tabindex=""-1""></a>             <span class=""at"">mz_include =</span> masses_of_interest, <span class=""at"">ppm =</span> <span class=""dv"">10</span>, <span class=""at"">warn =</span> <span class=""cn"">FALSE</span>)</span></code></pre></div>
-<p>Then, when we open the file up (with <code>RaMS</code> or other software) we are left with the data corresponding only to those compounds:</p>
+<p>Then, when we open the file up (with <code>RaMS</code> or other
+software) we are left with the data corresponding only to those
+compounds:</p>
 <div class=""sourceCode"" id=""cb2""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb2-1""><a href=""#cb2-1"" aria-hidden=""true"" tabindex=""-1""></a>init_msdata <span class=""ot"">&lt;-</span> <span class=""fu"">grabMSdata</span>(initial_filename)</span>
 <span id=""cb2-2""><a href=""#cb2-2"" aria-hidden=""true"" tabindex=""-1""></a>msdata <span class=""ot"">&lt;-</span> <span class=""fu"">grabMSdata</span>(output_filename)</span></code></pre></div>
 <div class=""sourceCode"" id=""cb3""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb3-1""><a href=""#cb3-1"" aria-hidden=""true"" tabindex=""-1""></a>knitr<span class=""sc"">::</span><span class=""fu"">kable</span>(<span class=""fu"">head</span>(msdata<span class=""sc"">$</span>MS1, <span class=""dv"">3</span>))</span></code></pre></div>
@@ -200,6 +414,14 @@ <h1 class=""title toc-ignore"">Minifying files with RaMS</h1>
 </table>
 <div class=""sourceCode"" id=""cb4""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb4-1""><a href=""#cb4-1"" aria-hidden=""true"" tabindex=""-1""></a>knitr<span class=""sc"">::</span><span class=""fu"">kable</span>(<span class=""fu"">head</span>(msdata<span class=""sc"">$</span>MS2, <span class=""dv"">3</span>))</span></code></pre></div>
 <table>
+<colgroup>
+<col width=""13%"" />
+<col width=""13%"" />
+<col width=""13%"" />
+<col width=""15%"" />
+<col width=""11%"" />
+<col width=""33%"" />
+</colgroup>
 <thead>
 <tr class=""header"">
 <th align=""right"">rt</th>
@@ -237,13 +459,15 @@ <h1 class=""title toc-ignore"">Minifying files with RaMS</h1>
 </tr>
 </tbody>
 </table>
-<p>Both the TIC and BPC are updated to reflect the smaller file size as well:</p>
+<p>Both the TIC and BPC are updated to reflect the smaller file size as
+well:</p>
 <div class=""sourceCode"" id=""cb5""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb5-1""><a href=""#cb5-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">par</span>(<span class=""at"">mfrow=</span><span class=""fu"">c</span>(<span class=""dv"">2</span>, <span class=""dv"">1</span>), <span class=""at"">mar=</span><span class=""fu"">c</span>(<span class=""fl"">2.1</span>, <span class=""fl"">2.1</span>, <span class=""fl"">1.1</span>, <span class=""fl"">0.1</span>))</span>
 <span id=""cb5-2""><a href=""#cb5-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">plot</span>(init_msdata<span class=""sc"">$</span>BPC<span class=""sc"">$</span>rt, init_msdata<span class=""sc"">$</span>BPC<span class=""sc"">$</span>int, <span class=""at"">type =</span> <span class=""st"">&quot;l&quot;</span>, <span class=""at"">main =</span> <span class=""st"">&quot;Initial BPC&quot;</span>)</span>
 <span id=""cb5-3""><a href=""#cb5-3"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">plot</span>(msdata<span class=""sc"">$</span>BPC<span class=""sc"">$</span>rt, msdata<span class=""sc"">$</span>BPC<span class=""sc"">$</span>int, <span class=""at"">type =</span> <span class=""st"">&quot;l&quot;</span>, <span class=""at"">main =</span> <span class=""st"">&quot;New BPC&quot;</span>)</span></code></pre></div>
 <p><img src=""data:image/png;base64,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"" width=""80%"" style=""display: block; margin: auto;"" /></p>
 <hr />
-<p>The <code>minifyMSdata</code> function is vectorized so the exact same syntax can be used for multiple files:</p>
+<p>The <code>minifyMSdata</code> function is vectorized so the exact
+same syntax can be used for multiple files:</p>
 <div class=""sourceCode"" id=""cb6""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb6-1""><a href=""#cb6-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">dir.create</span>(<span class=""st"">&quot;mini_mzMLs/&quot;</span>)</span>
 <span id=""cb6-2""><a href=""#cb6-2"" aria-hidden=""true"" tabindex=""-1""></a>output_files <span class=""ot"">&lt;-</span> <span class=""fu"">paste0</span>(<span class=""st"">&quot;mini_mzMLs/&quot;</span>, <span class=""fu"">basename</span>(msdata_files))</span>
 <span id=""cb6-3""><a href=""#cb6-3"" aria-hidden=""true"" tabindex=""-1""></a>output_files <span class=""ot"">&lt;-</span> <span class=""fu"">gsub</span>(<span class=""at"">x=</span>output_files, <span class=""st"">&quot;</span><span class=""sc"">\\</span><span class=""st"">.gz&quot;</span>, <span class=""st"">&quot;&quot;</span>)</span>
@@ -255,11 +479,27 @@ <h1 class=""title toc-ignore"">Minifying files with RaMS</h1>
 <span id=""cb7-3""><a href=""#cb7-3"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">library</span>(ggplot2)</span>
 <span id=""cb7-4""><a href=""#cb7-4"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">ggplot</span>(mini_msdata<span class=""sc"">$</span>BPC) <span class=""sc"">+</span> <span class=""fu"">geom_line</span>(<span class=""fu"">aes</span>(<span class=""at"">x=</span>rt, <span class=""at"">y=</span>int, <span class=""at"">color=</span>filename)) <span class=""sc"">+</span> <span class=""fu"">theme_bw</span>()</span></code></pre></div>
 <p><img src=""data:image/png;base64,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"" width=""80%"" style=""display: block; margin: auto;"" /></p>
-<p>These new files are valid according to the validator provided in MSnbase, which means that most programs should be able to open them, but this feature is still experimental and may break on quirky data. If that happens, please feel free to submit a bug report at</p>
+<p>These new files are valid according to the validator provided in
+MSnbase, which means that most programs should be able to open them, but
+this feature is still experimental and may break on quirky data. If that
+happens, please feel free to submit a bug report at</p>
 <hr />
-<p>As an example of how I use this minification function, here’s the code used to create the minified files in the <code>\extdata</code> folder that ships with the package. This was especially useful because the package can’t be more than 5MB but it’s incredibly useful to include some standalone MS data for demos and vignettes like this one. I don’t actually run this code in the vignette itself to save compilation time but it will run if you test it yourself.</p>
-<p>These files originate from the <a href=""https://sites.google.com/view/anitra-ingalls"">Ingalls Lab</a> at the University of Washington, USA and are published in the manuscript <a href=""https://www.sciencedirect.com/science/article/pii/S1434461018301184""><strong>“Metabolic consequences of cobalamin scarcity in diatoms as revealed through metabolomics”</strong></a>. Files are downloaded from the corresponding <a href=""https://www.ebi.ac.uk/metabolights/MTBLS703/files"">Metabolights repository</a>.</p>
-<p>First, we identify the <em>m/z</em> values we’d like to keep in the minified files. For the demo data, I’ll use the Ingalls Lab list of targeted compounds - those we have authentic standards for.</p>
+<p>As an example of how I use this minification function, here’s the
+code used to create the minified files in the <code>\extdata</code>
+folder that ships with the package. This was especially useful because
+the package can’t be more than 5MB but it’s incredibly useful to include
+some standalone MS data for demos and vignettes like this one. I don’t
+actually run this code in the vignette itself to save compilation time
+but it will run if you test it yourself.</p>
+<p>These files originate from the <a href=""https://sites.google.com/view/anitra-ingalls"">Ingalls Lab</a> at
+the University of Washington, USA and are published in the manuscript <a href=""https://www.sciencedirect.com/science/article/pii/S1434461018301184""><strong>“Metabolic
+consequences of cobalamin scarcity in diatoms as revealed through
+metabolomics”</strong></a>. Files are downloaded from the corresponding
+<a href=""https://www.ebi.ac.uk/metabolights/MTBLS703/files"">Metabolights
+repository</a>.</p>
+<p>First, we identify the <em>m/z</em> values we’d like to keep in the
+minified files. For the demo data, I’ll use the Ingalls Lab list of
+targeted compounds - those we have authentic standards for.</p>
 <div class=""sourceCode"" id=""cb8""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb8-1""><a href=""#cb8-1"" aria-hidden=""true"" tabindex=""-1""></a>raw_stans <span class=""ot"">&lt;-</span> <span class=""fu"">read.csv</span>(<span class=""fu"">paste0</span>(<span class=""st"">&quot;https://raw.githubusercontent.com/&quot;</span>,</span>
 <span id=""cb8-2""><a href=""#cb8-2"" aria-hidden=""true"" tabindex=""-1""></a>                             <span class=""st"">&quot;IngallsLabUW/Ingalls_Standards/&quot;</span>,</span>
 <span id=""cb8-3""><a href=""#cb8-3"" aria-hidden=""true"" tabindex=""-1""></a>                             <span class=""st"">&quot;b098927ea0089b6e7a31e1758e7c7eaad5408535/&quot;</span>,</span>
@@ -268,15 +508,19 @@ <h1 class=""title toc-ignore"">Minifying files with RaMS</h1>
 <span id=""cb8-6""><a href=""#cb8-6"" aria-hidden=""true"" tabindex=""-1""></a>mzs_to_include <span class=""ot"">&lt;-</span> <span class=""fu"">as.numeric</span>(<span class=""fu"">unique</span>(raw_stans[raw_stans<span class=""sc"">$</span>Fraction1<span class=""sc"">==</span><span class=""st"">&quot;HILICPos&quot;</span>,]<span class=""sc"">$</span>m.z))</span>
 <span id=""cb8-7""><a href=""#cb8-7"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Include glycine betaine isotopes for README demo</span></span>
 <span id=""cb8-8""><a href=""#cb8-8"" aria-hidden=""true"" tabindex=""-1""></a>mzs_to_include <span class=""ot"">&lt;-</span> <span class=""fu"">c</span>(mzs_to_include, <span class=""fl"">119.0899</span>, <span class=""fl"">119.0835</span>)</span></code></pre></div>
-<p>Then, we download the raw MS data from the online repository into which it’s been deposited.</p>
+<p>Then, we download the raw MS data from the online repository into
+which it’s been deposited.</p>
 <div class=""sourceCode"" id=""cb9""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb9-1""><a href=""#cb9-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""cf"">if</span>(<span class=""sc"">!</span><span class=""fu"">dir.exists</span>(<span class=""st"">&quot;vignettes/data&quot;</span>))<span class=""fu"">dir.create</span>(<span class=""st"">&quot;vignettes/data&quot;</span>)</span>
 <span id=""cb9-2""><a href=""#cb9-2"" aria-hidden=""true"" tabindex=""-1""></a>base_url <span class=""ot"">&lt;-</span> <span class=""st"">&quot;ftp://ftp.ebi.ac.uk/pub/databases/metabolights/studies/public/MTBLS703/&quot;</span></span>
 <span id=""cb9-3""><a href=""#cb9-3"" aria-hidden=""true"" tabindex=""-1""></a>chosen_files <span class=""ot"">&lt;-</span> <span class=""fu"">paste0</span>(base_url, <span class=""st"">&quot;170223_Smp_LB12HL_&quot;</span>, <span class=""fu"">c</span>(<span class=""st"">&quot;AB&quot;</span>, <span class=""st"">&quot;CD&quot;</span>, <span class=""st"">&quot;EF&quot;</span>), <span class=""st"">&quot;_pos.mzXML&quot;</span>)</span>
 <span id=""cb9-4""><a href=""#cb9-4"" aria-hidden=""true"" tabindex=""-1""></a>new_names <span class=""ot"">&lt;-</span> <span class=""fu"">gsub</span>(<span class=""at"">x=</span><span class=""fu"">basename</span>(chosen_files), <span class=""st"">&quot;170223_Smp_&quot;</span>, <span class=""st"">&quot;&quot;</span>)</span>
 <span id=""cb9-5""><a href=""#cb9-5"" aria-hidden=""true"" tabindex=""-1""></a></span>
 <span id=""cb9-6""><a href=""#cb9-6"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">mapply</span>(download.file, chosen_files, <span class=""fu"">paste0</span>(<span class=""st"">&quot;vignettes/data/&quot;</span>, new_names), </span>
 <span id=""cb9-7""><a href=""#cb9-7"" aria-hidden=""true"" tabindex=""-1""></a>       <span class=""at"">mode =</span> <span class=""st"">&quot;wb&quot;</span>, <span class=""at"">method =</span> <span class=""st"">&quot;libcurl&quot;</span>)</span></code></pre></div>
-<p>The MSMS data wasn’t uploaded, so we handle that separately by pulling it off the lab computer manually and copying it over to our temporary directory. If you’re following along, you can skip this chunk or use your own DDA data.</p>
+<p>The MSMS data wasn’t uploaded, so we handle that separately by
+pulling it off the lab computer manually and copying it over to our
+temporary directory. If you’re following along, you can skip this chunk
+or use your own DDA data.</p>
 <div class=""sourceCode"" id=""cb10""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb10-1""><a href=""#cb10-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">file.copy</span>(<span class=""at"">from =</span> <span class=""fu"">paste0</span>(<span class=""st"">&quot;Z:/1_QEdata/2016/2016_Katherine_1335_LightB12_&quot;</span>,</span>
 <span id=""cb10-2""><a href=""#cb10-2"" aria-hidden=""true"" tabindex=""-1""></a>                        <span class=""st"">&quot;Experiment/170223_KRH_Rerun_1335_LightB12_Exp_HILIC/&quot;</span>,</span>
 <span id=""cb10-3""><a href=""#cb10-3"" aria-hidden=""true"" tabindex=""-1""></a>                        <span class=""st"">&quot;positive/&quot;</span>,</span>
@@ -290,28 +534,38 @@ <h1 class=""title toc-ignore"">Minifying files with RaMS</h1>
 <span id=""cb11-5""><a href=""#cb11-5"" aria-hidden=""true"" tabindex=""-1""></a>out_files <span class=""ot"">&lt;-</span> <span class=""fu"">paste0</span>(<span class=""st"">&quot;inst/extdata/&quot;</span>, <span class=""fu"">basename</span>(init_files))</span>
 <span id=""cb11-6""><a href=""#cb11-6"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">minifyMSdata</span>(<span class=""at"">files =</span> init_files, <span class=""at"">output_files =</span> out_files, <span class=""at"">warn =</span> <span class=""cn"">FALSE</span>,</span>
 <span id=""cb11-7""><a href=""#cb11-7"" aria-hidden=""true"" tabindex=""-1""></a>             <span class=""at"">mz_include =</span> mzs_to_include, <span class=""at"">ppm =</span> <span class=""dv"">20</span>)</span></code></pre></div>
-<p>Now we have four minified mzXML files in our inst/extdata folder. However, we’d like to be able to demo the mzML functionality as well as that of mzXMLs, so we can use <a href=""http://proteowizard.sourceforge.net/tools.shtml"">Proteowizard’s</a> <code>msconvert</code> tool because <code>RaMS</code> can’t convert between mzML and mzXML or vice versa. You’ll need to install <code>msconvert</code> and add it to your path for this step.</p>
-<p>We also use <code>msconvert</code> to trim the files by retention time, keeping data between 4 and 15 minutes.</p>
-<p>Finally, we gzip the files to get them as small as possible, also using <code>msconvert</code>.</p>
+<p>Now we have four minified mzXML files in our inst/extdata folder.
+However, we’d like to be able to demo the mzML functionality as well as
+that of mzXMLs, so we can use <a href=""https://proteowizard.sourceforge.io/tools/msconvert.html"">Proteowizard’s</a>
+<code>msconvert</code> tool because <code>RaMS</code> can’t convert
+between mzML and mzXML or vice versa. You’ll need to install
+<code>msconvert</code> and add it to your path for this step.</p>
+<p>We also use <code>msconvert</code> to trim the files by retention
+time, keeping data between 4 and 15 minutes.</p>
+<p>Finally, we gzip the files to get them as small as possible, also
+using <code>msconvert</code>.</p>
 <div class=""sourceCode"" id=""cb12""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb12-1""><a href=""#cb12-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">system</span>(<span class=""st"">&quot;msconvert inst/extdata/*.mzXML -o inst/extdata/temp --noindex&quot;</span>)</span>
 <span id=""cb12-2""><a href=""#cb12-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">system</span>(<span class=""st"">&quot;msconvert --mzXML inst/extdata/*.mzXML -o inst/extdata/temp --noindex&quot;</span>)</span>
 <span id=""cb12-3""><a href=""#cb12-3"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">system</span>(<span class=""st"">&#39;msconvert inst/extdata/temp/*.mzML --filter </span><span class=""sc"">\&quot;</span><span class=""st"">scanTime [240,900]</span><span class=""sc"">\&quot;</span><span class=""st""> -o inst/extdata -g&#39;</span>)</span>
 <span id=""cb12-4""><a href=""#cb12-4"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">system</span>(<span class=""st"">&#39;msconvert inst/extdata/temp/*.mzXML --mzXML --filter </span><span class=""sc"">\&quot;</span><span class=""st"">scanTime [240,900]</span><span class=""sc"">\&quot;</span><span class=""st""> -o inst/extdata -g&#39;</span>)</span></code></pre></div>
-<p>And then for the last few steps, we again rename the files (since <code>msconvert</code> expands them to their full .raw names) and remove the ones we don’t need for the demos.</p>
+<p>And then for the last few steps, we again rename the files (since
+<code>msconvert</code> expands them to their full .raw names) and remove
+the ones we don’t need for the demos.</p>
 <div class=""sourceCode"" id=""cb13""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb13-1""><a href=""#cb13-1"" aria-hidden=""true"" tabindex=""-1""></a>init_files <span class=""ot"">&lt;-</span> <span class=""fu"">list.files</span>(<span class=""st"">&quot;inst/extdata&quot;</span>, <span class=""at"">full.names =</span> <span class=""cn"">TRUE</span>)</span>
 <span id=""cb13-2""><a href=""#cb13-2"" aria-hidden=""true"" tabindex=""-1""></a>new_names <span class=""ot"">&lt;-</span> <span class=""fu"">paste0</span>(<span class=""st"">&quot;inst/extdata/&quot;</span>, <span class=""fu"">gsub</span>(<span class=""at"">x=</span>init_files, <span class=""st"">&quot;.*(Smp_|Extracts_)&quot;</span>, <span class=""st"">&quot;&quot;</span>))</span>
 <span id=""cb13-3""><a href=""#cb13-3"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">file.rename</span>(init_files, new_names)</span>
 <span id=""cb13-4""><a href=""#cb13-4"" aria-hidden=""true"" tabindex=""-1""></a></span>
 <span id=""cb13-5""><a href=""#cb13-5"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">unlink</span>(<span class=""st"">&quot;inst/extdata/temp&quot;</span>, <span class=""at"">recursive =</span> <span class=""cn"">TRUE</span>)</span>
 <span id=""cb13-6""><a href=""#cb13-6"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">file.remove</span>(<span class=""fu"">list.files</span>(<span class=""st"">&quot;inst/extdata&quot;</span>, <span class=""at"">pattern =</span> <span class=""st"">&quot;mzXML$&quot;</span>, <span class=""at"">full.names =</span> <span class=""cn"">TRUE</span>))</span>
 <span id=""cb13-7""><a href=""#cb13-7"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">file.remove</span>(<span class=""fu"">paste0</span>(<span class=""st"">&quot;inst/extdata/&quot;</span>, <span class=""fu"">c</span>(<span class=""st"">&quot;LB12HL_CD.mzXML.gz&quot;</span>, <span class=""st"">&quot;LB12HL_EF.mzXML.gz&quot;</span>)))</span></code></pre></div>
-<p>To check that the new files look ok, we can see if we can read them with <code>RaMS</code> and <code>MSnbase</code>.</p>
+<p>To check that the new files look ok, we can see if we can read them
+with <code>RaMS</code> and <code>MSnbase</code>.</p>
 <div class=""sourceCode"" id=""cb14""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb14-1""><a href=""#cb14-1"" aria-hidden=""true"" tabindex=""-1""></a>MSnbase<span class=""sc"">::</span><span class=""fu"">readMSData</span>(<span class=""fu"">list.files</span>(<span class=""st"">&quot;inst/extdata&quot;</span>, <span class=""at"">full.names =</span> <span class=""cn"">TRUE</span>)[<span class=""dv"">1</span>], <span class=""at"">msLevel. =</span> <span class=""dv"">1</span>)</span>
 <span id=""cb14-2""><a href=""#cb14-2"" aria-hidden=""true"" tabindex=""-1""></a>RaMS<span class=""sc"">::</span><span class=""fu"">grabMSdata</span>(new_names[<span class=""dv"">1</span>])</span></code></pre></div>
 <p>Finally, remember to clean up the original downloads folder</p>
 <div class=""sourceCode"" id=""cb15""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb15-1""><a href=""#cb15-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">unlink</span>(<span class=""st"">&quot;vignettes/data&quot;</span>, <span class=""at"">recursive =</span> <span class=""cn"">TRUE</span>)</span></code></pre></div>
 <hr />
-<p>README last built on 2022-11-10</p>
+<p>README last built on 2022-11-14</p>
 
 
 

---FILE: doc/RaMS-and-friends.html---
@@ -14,26 +14,38 @@
 
 <title>RaMS and friends</title>
 
-<script src=""data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK""></script>
+<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
+// be compatible with the behavior of Pandoc < 2.8).
+document.addEventListener('DOMContentLoaded', function(e) {
+  var hs = document.querySelectorAll(""div.section[class*='level'] > :first-child"");
+  var i, h, a;
+  for (i = 0; i < hs.length; i++) {
+    h = hs[i];
+    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
+    a = h.attributes;
+    while (a.length > 0) h.removeAttribute(a[0].name);
+  }
+});
+</script>
 
 <style type=""text/css"">
-  code{white-space: pre-wrap;}
-  span.smallcaps{font-variant: small-caps;}
-  span.underline{text-decoration: underline;}
-  div.column{display: inline-block; vertical-align: top; width: 50%;}
-  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
-  ul.task-list{list-style: none;}
-    </style>
+code{white-space: pre-wrap;}
+span.smallcaps{font-variant: small-caps;}
+span.underline{text-decoration: underline;}
+div.column{display: inline-block; vertical-align: top; width: 50%;}
+div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
+ul.task-list{list-style: none;}
+</style>
 
 
 
 <style type=""text/css"">
-  code {
-    white-space: pre;
-  }
-  .sourceCode {
-    overflow: visible;
-  }
+code {
+white-space: pre;
+}
+.sourceCode {
+overflow: visible;
+}
 </style>
 <style type=""text/css"" data-origin=""pandoc"">
 pre > code.sourceCode { white-space: pre; position: relative; }
@@ -51,55 +63,54 @@
 pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
 }
 pre.numberSource code
-  { counter-reset: source-line 0; }
+{ counter-reset: source-line 0; }
 pre.numberSource code > span
-  { position: relative; left: -4em; counter-increment: source-line; }
+{ position: relative; left: -4em; counter-increment: source-line; }
 pre.numberSource code > span > a:first-child::before
-  { content: counter(source-line);
-    position: relative; left: -1em; text-align: right; vertical-align: baseline;
-    border: none; display: inline-block;
-    -webkit-touch-callout: none; -webkit-user-select: none;
-    -khtml-user-select: none; -moz-user-select: none;
-    -ms-user-select: none; user-select: none;
-    padding: 0 4px; width: 4em;
-    color: #aaaaaa;
-  }
-pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
+{ content: counter(source-line);
+position: relative; left: -1em; text-align: right; vertical-align: baseline;
+border: none; display: inline-block;
+-webkit-touch-callout: none; -webkit-user-select: none;
+-khtml-user-select: none; -moz-user-select: none;
+-ms-user-select: none; user-select: none;
+padding: 0 4px; width: 4em;
+color: #aaaaaa;
+}
+pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
 div.sourceCode
-  {   }
+{ }
 @media screen {
 pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
 }
-code span.al { color: #ff0000; font-weight: bold; } /* Alert */
-code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
-code span.at { color: #7d9029; } /* Attribute */
-code span.bn { color: #40a070; } /* BaseN */
-code span.bu { } /* BuiltIn */
-code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
-code span.ch { color: #4070a0; } /* Char */
-code span.cn { color: #880000; } /* Constant */
-code span.co { color: #60a0b0; font-style: italic; } /* Comment */
-code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
-code span.do { color: #ba2121; font-style: italic; } /* Documentation */
-code span.dt { color: #902000; } /* DataType */
-code span.dv { color: #40a070; } /* DecVal */
-code span.er { color: #ff0000; font-weight: bold; } /* Error */
-code span.ex { } /* Extension */
-code span.fl { color: #40a070; } /* Float */
-code span.fu { color: #06287e; } /* Function */
-code span.im { } /* Import */
-code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
-code span.kw { color: #007020; font-weight: bold; } /* Keyword */
-code span.op { color: #666666; } /* Operator */
-code span.ot { color: #007020; } /* Other */
-code span.pp { color: #bc7a00; } /* Preprocessor */
-code span.sc { color: #4070a0; } /* SpecialChar */
-code span.ss { color: #bb6688; } /* SpecialString */
-code span.st { color: #4070a0; } /* String */
-code span.va { color: #19177c; } /* Variable */
-code span.vs { color: #4070a0; } /* VerbatimString */
-code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
-
+code span.al { color: #ff0000; font-weight: bold; } 
+code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
+code span.at { color: #7d9029; } 
+code span.bn { color: #40a070; } 
+code span.bu { color: #008000; } 
+code span.cf { color: #007020; font-weight: bold; } 
+code span.ch { color: #4070a0; } 
+code span.cn { color: #880000; } 
+code span.co { color: #60a0b0; font-style: italic; } 
+code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
+code span.do { color: #ba2121; font-style: italic; } 
+code span.dt { color: #902000; } 
+code span.dv { color: #40a070; } 
+code span.er { color: #ff0000; font-weight: bold; } 
+code span.ex { } 
+code span.fl { color: #40a070; } 
+code span.fu { color: #06287e; } 
+code span.im { color: #008000; font-weight: bold; } 
+code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
+code span.kw { color: #007020; font-weight: bold; } 
+code span.op { color: #666666; } 
+code span.ot { color: #007020; } 
+code span.pp { color: #bc7a00; } 
+code span.sc { color: #4070a0; } 
+code span.ss { color: #bb6688; } 
+code span.st { color: #4070a0; } 
+code span.va { color: #19177c; } 
+code span.vs { color: #4070a0; } 
+code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
 </style>
 <script>
 // apply pandoc div.sourceCode style to pre.sourceCode instead
@@ -133,7 +144,187 @@
 
 
 
-<link rel=""stylesheet"" href=""data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A"" type=""text/css"" />
+<style type=""text/css"">body {
+background-color: #fff;
+margin: 1em auto;
+max-width: 700px;
+overflow: visible;
+padding-left: 2em;
+padding-right: 2em;
+font-family: ""Open Sans"", ""Helvetica Neue"", Helvetica, Arial, sans-serif;
+font-size: 14px;
+line-height: 1.35;
+}
+#TOC {
+clear: both;
+margin: 0 0 10px 10px;
+padding: 4px;
+width: 400px;
+border: 1px solid #CCCCCC;
+border-radius: 5px;
+background-color: #f6f6f6;
+font-size: 13px;
+line-height: 1.3;
+}
+#TOC .toctitle {
+font-weight: bold;
+font-size: 15px;
+margin-left: 5px;
+}
+#TOC ul {
+padding-left: 40px;
+margin-left: -1.5em;
+margin-top: 5px;
+margin-bottom: 5px;
+}
+#TOC ul ul {
+margin-left: -2em;
+}
+#TOC li {
+line-height: 16px;
+}
+table {
+margin: 1em auto;
+border-width: 1px;
+border-color: #DDDDDD;
+border-style: outset;
+border-collapse: collapse;
+}
+table th {
+border-width: 2px;
+padding: 5px;
+border-style: inset;
+}
+table td {
+border-width: 1px;
+border-style: inset;
+line-height: 18px;
+padding: 5px 5px;
+}
+table, table th, table td {
+border-left-style: none;
+border-right-style: none;
+}
+table thead, table tr.even {
+background-color: #f7f7f7;
+}
+p {
+margin: 0.5em 0;
+}
+blockquote {
+background-color: #f6f6f6;
+padding: 0.25em 0.75em;
+}
+hr {
+border-style: solid;
+border: none;
+border-top: 1px solid #777;
+margin: 28px 0;
+}
+dl {
+margin-left: 0;
+}
+dl dd {
+margin-bottom: 13px;
+margin-left: 13px;
+}
+dl dt {
+font-weight: bold;
+}
+ul {
+margin-top: 0;
+}
+ul li {
+list-style: circle outside;
+}
+ul ul {
+margin-bottom: 0;
+}
+pre, code {
+background-color: #f7f7f7;
+border-radius: 3px;
+color: #333;
+white-space: pre-wrap; 
+}
+pre {
+border-radius: 3px;
+margin: 5px 0px 10px 0px;
+padding: 10px;
+}
+pre:not([class]) {
+background-color: #f7f7f7;
+}
+code {
+font-family: Consolas, Monaco, 'Courier New', monospace;
+font-size: 85%;
+}
+p > code, li > code {
+padding: 2px 0px;
+}
+div.figure {
+text-align: center;
+}
+img {
+background-color: #FFFFFF;
+padding: 2px;
+border: 1px solid #DDDDDD;
+border-radius: 3px;
+border: 1px solid #CCCCCC;
+margin: 0 5px;
+}
+h1 {
+margin-top: 0;
+font-size: 35px;
+line-height: 40px;
+}
+h2 {
+border-bottom: 4px solid #f7f7f7;
+padding-top: 10px;
+padding-bottom: 2px;
+font-size: 145%;
+}
+h3 {
+border-bottom: 2px solid #f7f7f7;
+padding-top: 10px;
+font-size: 120%;
+}
+h4 {
+border-bottom: 1px solid #f7f7f7;
+margin-left: 8px;
+font-size: 105%;
+}
+h5, h6 {
+border-bottom: 1px solid #ccc;
+font-size: 105%;
+}
+a {
+color: #0033dd;
+text-decoration: none;
+}
+a:hover {
+color: #6666ff; }
+a:visited {
+color: #800080; }
+a:visited:hover {
+color: #BB00BB; }
+a[href^=""http:""] {
+text-decoration: underline; }
+a[href^=""https:""] {
+text-decoration: underline; }
+
+code > span.kw { color: #555; font-weight: bold; } 
+code > span.dt { color: #902000; } 
+code > span.dv { color: #40a070; } 
+code > span.bn { color: #d14; } 
+code > span.fl { color: #d14; } 
+code > span.ch { color: #d14; } 
+code > span.st { color: #d14; } 
+code > span.co { color: #888888; font-style: italic; } 
+code > span.ot { color: #007020; } 
+code > span.al { color: #ff0000; font-weight: bold; } 
+code > span.fu { color: #900; font-weight: bold; } 
+code > span.er { color: #a61717; background-color: #e3d2d2; } 
+</style>
 
 
 
@@ -153,13 +344,22 @@ <h1 class=""title toc-ignore"">RaMS and friends</h1>
 <ul>
 <li><a href=""#standard-export-to-csv"">Standard export to CSV</a></li>
 <li><a href=""#fancier-export-to-excel"">Fancier export to Excel</a></li>
-<li><a href=""#exporting-to-sql-database"">Exporting to SQL database</a></li>
-<li><a href=""#interfacing-with-python-via-reticulate"">Interfacing with Python via <code>reticulate</code></a></li>
+<li><a href=""#exporting-to-sql-database"">Exporting to SQL
+database</a></li>
+<li><a href=""#interfacing-with-python-via-reticulate"">Interfacing with
+Python via <code>reticulate</code></a></li>
 </ul>
-<p>The strength of <code>RaMS</code> is its simple data format. Table-like data structures are common in most programming languages, and they can always be converted to the nigh-universal matrix format. The goal of this vignette is to illustrate this strength by exporting MS data to several formats that can be used outside of R.</p>
+<p>The strength of <code>RaMS</code> is its simple data format.
+Table-like data structures are common in most programming languages, and
+they can always be converted to the nigh-universal matrix format. The
+goal of this vignette is to illustrate this strength by exporting MS
+data to several formats that can be used outside of R.</p>
 <div id=""standard-export-to-csv"" class=""section level2"">
 <h2>Standard export to CSV</h2>
-<p>As with all rectangular data, <code>RaMS</code> objects can be easily exported to CSV files with base R functions. This works best with a few chromatograms at a time, as the millions of data points found in most MS files can overwhelm common file readers.</p>
+<p>As with all rectangular data, <code>RaMS</code> objects can be easily
+exported to CSV files with base R functions. This works best with a few
+chromatograms at a time, as the millions of data points found in most MS
+files can overwhelm common file readers.</p>
 <div class=""sourceCode"" id=""cb1""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb1-1""><a href=""#cb1-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">library</span>(RaMS)</span>
 <span id=""cb1-2""><a href=""#cb1-2"" aria-hidden=""true"" tabindex=""-1""></a></span>
 <span id=""cb1-3""><a href=""#cb1-3"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Locate an MS file</span></span>
@@ -168,13 +368,13 @@ <h2>Standard export to CSV</h2>
 <span id=""cb1-6""><a href=""#cb1-6"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Grab the MS data</span></span>
 <span id=""cb1-7""><a href=""#cb1-7"" aria-hidden=""true"" tabindex=""-1""></a>msdata <span class=""ot"">&lt;-</span> <span class=""fu"">grabMSdata</span>(single_file, <span class=""at"">grab_what =</span> <span class=""st"">&quot;everything&quot;</span>)</span></code></pre></div>
 <pre><code>## 
-## Reading file LB12HL_AB.mzML.gz... 0.16 secs 
-## Reading MS1 data...0.16 secs 
+## Reading file LB12HL_AB.mzML.gz... 0.23 secs 
+## Reading MS1 data...0.14 secs 
 ## Reading MS2 data...0.02 secs 
-## Reading BPC...0.1 secs 
-## Reading TIC...0.08 secs 
-## Reading file metadata...0.12 secs 
-## Total time: 0.63 secs</code></pre>
+## Reading BPC...0.08 secs 
+## Reading TIC...0.07 secs 
+## Reading file metadata...0.14 secs 
+## Total time: 0.7 secs</code></pre>
 <div class=""sourceCode"" id=""cb3""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb3-1""><a href=""#cb3-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Write out MS1 data to .csv file</span></span>
 <span id=""cb3-2""><a href=""#cb3-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">write.csv</span>(<span class=""at"">x =</span> msdata<span class=""sc"">$</span>MS1, <span class=""at"">file =</span> <span class=""st"">&quot;MS1_data.csv&quot;</span>)</span>
 <span id=""cb3-3""><a href=""#cb3-3"" aria-hidden=""true"" tabindex=""-1""></a></span>
@@ -184,107 +384,119 @@ <h2>Standard export to CSV</h2>
 </div>
 <div id=""fancier-export-to-excel"" class=""section level2"">
 <h2>Fancier export to Excel</h2>
-<p>Excel workbooks are a common format because of their intuitive GUI and widespread adoption. They can also encode more information than CSV files due to their multiple “sheets” within a single workbook - perfect for encoding both MS1 and MS2 information in one place. This vignette uses the <a href=""https://cran.r-project.org/package=openxlsx""><code>openxlsx</code></a> package, although there are several alternatives with identical functionality.</p>
-<div class=""sourceCode"" id=""cb5""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb5-1""><a href=""#cb5-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">library</span>(openxlsx)</span></code></pre></div>
-<pre><code>## Warning: package &#39;openxlsx&#39; was built under R version 4.1.2</code></pre>
-<div class=""sourceCode"" id=""cb7""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb7-1""><a href=""#cb7-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Locate an MS2 file</span></span>
-<span id=""cb7-2""><a href=""#cb7-2"" aria-hidden=""true"" tabindex=""-1""></a>MS2_file <span class=""ot"">&lt;-</span> <span class=""fu"">system.file</span>(<span class=""st"">&quot;extdata&quot;</span>, <span class=""st"">&quot;DDApos_2.mzML.gz&quot;</span>, <span class=""at"">package =</span> <span class=""st"">&quot;RaMS&quot;</span>)</span>
-<span id=""cb7-3""><a href=""#cb7-3"" aria-hidden=""true"" tabindex=""-1""></a></span>
-<span id=""cb7-4""><a href=""#cb7-4"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Grab the MS1 and MS2 data</span></span>
-<span id=""cb7-5""><a href=""#cb7-5"" aria-hidden=""true"" tabindex=""-1""></a>msdata <span class=""ot"">&lt;-</span> <span class=""fu"">grabMSdata</span>(MS2_file, <span class=""at"">grab_what=</span><span class=""fu"">c</span>(<span class=""st"">&quot;MS1&quot;</span>, <span class=""st"">&quot;MS2&quot;</span>))</span></code></pre></div>
+<p>Excel workbooks are a common format because of their intuitive GUI
+and widespread adoption. They can also encode more information than CSV
+files due to their multiple “sheets” within a single workbook - perfect
+for encoding both MS1 and MS2 information in one place. This vignette
+uses the <a href=""https://cran.r-project.org/package=openxlsx""><code>openxlsx</code></a>
+package, although there are several alternatives with identical
+functionality.</p>
+<div class=""sourceCode"" id=""cb5""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb5-1""><a href=""#cb5-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">library</span>(openxlsx)</span>
+<span id=""cb5-2""><a href=""#cb5-2"" aria-hidden=""true"" tabindex=""-1""></a></span>
+<span id=""cb5-3""><a href=""#cb5-3"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Locate an MS2 file</span></span>
+<span id=""cb5-4""><a href=""#cb5-4"" aria-hidden=""true"" tabindex=""-1""></a>MS2_file <span class=""ot"">&lt;-</span> <span class=""fu"">system.file</span>(<span class=""st"">&quot;extdata&quot;</span>, <span class=""st"">&quot;DDApos_2.mzML.gz&quot;</span>, <span class=""at"">package =</span> <span class=""st"">&quot;RaMS&quot;</span>)</span>
+<span id=""cb5-5""><a href=""#cb5-5"" aria-hidden=""true"" tabindex=""-1""></a></span>
+<span id=""cb5-6""><a href=""#cb5-6"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Grab the MS1 and MS2 data</span></span>
+<span id=""cb5-7""><a href=""#cb5-7"" aria-hidden=""true"" tabindex=""-1""></a>msdata <span class=""ot"">&lt;-</span> <span class=""fu"">grabMSdata</span>(MS2_file, <span class=""at"">grab_what=</span><span class=""fu"">c</span>(<span class=""st"">&quot;MS1&quot;</span>, <span class=""st"">&quot;MS2&quot;</span>))</span></code></pre></div>
 <pre><code>## 
-## Reading file DDApos_2.mzML.gz... 0.44 secs 
-## Reading MS1 data...0.39 secs 
-## Reading MS2 data...0.11 secs 
-## Total time: 0.94 secs</code></pre>
-<div class=""sourceCode"" id=""cb9""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb9-1""><a href=""#cb9-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Write out MS data to Excel file</span></span>
-<span id=""cb9-2""><a href=""#cb9-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># openxlsx writes each object in a list to a unique sheet</span></span>
-<span id=""cb9-3""><a href=""#cb9-3"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Produces one sheet for MS1 and one for MS2</span></span>
-<span id=""cb9-4""><a href=""#cb9-4"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">write.xlsx</span>(msdata, <span class=""at"">file =</span> <span class=""st"">&quot;MS2_data.xlsx&quot;</span>)</span>
-<span id=""cb9-5""><a href=""#cb9-5"" aria-hidden=""true"" tabindex=""-1""></a></span>
-<span id=""cb9-6""><a href=""#cb9-6"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Clean up afterward</span></span>
-<span id=""cb9-7""><a href=""#cb9-7"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">file.remove</span>(<span class=""st"">&quot;MS2_data.xlsx&quot;</span>)</span></code></pre></div>
+## Reading file DDApos_2.mzML.gz... 0.54 secs 
+## Reading MS1 data...0.34 secs 
+## Reading MS2 data...0.12 secs 
+## Total time: 1 secs</code></pre>
+<div class=""sourceCode"" id=""cb7""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb7-1""><a href=""#cb7-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Write out MS data to Excel file</span></span>
+<span id=""cb7-2""><a href=""#cb7-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># openxlsx writes each object in a list to a unique sheet</span></span>
+<span id=""cb7-3""><a href=""#cb7-3"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Produces one sheet for MS1 and one for MS2</span></span>
+<span id=""cb7-4""><a href=""#cb7-4"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">write.xlsx</span>(msdata, <span class=""at"">file =</span> <span class=""st"">&quot;MS2_data.xlsx&quot;</span>)</span>
+<span id=""cb7-5""><a href=""#cb7-5"" aria-hidden=""true"" tabindex=""-1""></a></span>
+<span id=""cb7-6""><a href=""#cb7-6"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Clean up afterward</span></span>
+<span id=""cb7-7""><a href=""#cb7-7"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">file.remove</span>(<span class=""st"">&quot;MS2_data.xlsx&quot;</span>)</span></code></pre></div>
 <pre><code>## [1] TRUE</code></pre>
 </div>
 <div id=""exporting-to-sql-database"" class=""section level2"">
 <h2>Exporting to SQL database</h2>
-<p>For more robust data processing and storage, or to work with larger-than-memory data sets, SQL databases are an excellent choice. This vignette will demo the <a href=""https://cran.r-project.org/package=RSQLite""><code>RSQLite</code></a> package’s engine, although several other database engines have similar functionality.</p>
-<div class=""sourceCode"" id=""cb11""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb11-1""><a href=""#cb11-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">library</span>(DBI)</span></code></pre></div>
-<pre><code>## Warning: package &#39;DBI&#39; was built under R version 4.1.2</code></pre>
-<div class=""sourceCode"" id=""cb13""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb13-1""><a href=""#cb13-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Get data from multiple files to show off</span></span>
-<span id=""cb13-2""><a href=""#cb13-2"" aria-hidden=""true"" tabindex=""-1""></a>mzml_files <span class=""ot"">&lt;-</span> <span class=""fu"">system.file</span>(<span class=""fu"">c</span>(<span class=""st"">&quot;extdata/LB12HL_AB.mzML.gz&quot;</span>, </span>
-<span id=""cb13-3""><a href=""#cb13-3"" aria-hidden=""true"" tabindex=""-1""></a>                            <span class=""st"">&quot;extdata/LB12HL_CD.mzML.gz&quot;</span>), </span>
-<span id=""cb13-4""><a href=""#cb13-4"" aria-hidden=""true"" tabindex=""-1""></a>                          <span class=""at"">package =</span> <span class=""st"">&quot;RaMS&quot;</span>)</span>
-<span id=""cb13-5""><a href=""#cb13-5"" aria-hidden=""true"" tabindex=""-1""></a>msdata <span class=""ot"">&lt;-</span> <span class=""fu"">grabMSdata</span>(mzml_files)</span></code></pre></div>
+<p>For more robust data processing and storage, or to work with
+larger-than-memory data sets, SQL databases are an excellent choice.
+This vignette will demo the <a href=""https://cran.r-project.org/package=RSQLite""><code>RSQLite</code></a>
+package’s engine, although several other database engines have similar
+functionality.</p>
+<div class=""sourceCode"" id=""cb9""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb9-1""><a href=""#cb9-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">library</span>(DBI)</span>
+<span id=""cb9-2""><a href=""#cb9-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Get data from multiple files to show off</span></span>
+<span id=""cb9-3""><a href=""#cb9-3"" aria-hidden=""true"" tabindex=""-1""></a>mzml_files <span class=""ot"">&lt;-</span> <span class=""fu"">system.file</span>(<span class=""fu"">c</span>(<span class=""st"">&quot;extdata/LB12HL_AB.mzML.gz&quot;</span>, </span>
+<span id=""cb9-4""><a href=""#cb9-4"" aria-hidden=""true"" tabindex=""-1""></a>                            <span class=""st"">&quot;extdata/LB12HL_CD.mzML.gz&quot;</span>), </span>
+<span id=""cb9-5""><a href=""#cb9-5"" aria-hidden=""true"" tabindex=""-1""></a>                          <span class=""at"">package =</span> <span class=""st"">&quot;RaMS&quot;</span>)</span>
+<span id=""cb9-6""><a href=""#cb9-6"" aria-hidden=""true"" tabindex=""-1""></a>msdata <span class=""ot"">&lt;-</span> <span class=""fu"">grabMSdata</span>(mzml_files)</span></code></pre></div>
 <pre><code>## 
   |                                                                            
   |                                                                      |   0%
   |                                                                            
   |===================================                                   |  50%
   |                                                                            
   |======================================================================| 100%
-## Total time: 1.03 secs</code></pre>
-<div class=""sourceCode"" id=""cb15""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb15-1""><a href=""#cb15-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Create the sqlite database and connect to it</span></span>
-<span id=""cb15-2""><a href=""#cb15-2"" aria-hidden=""true"" tabindex=""-1""></a>MSdb <span class=""ot"">&lt;-</span> <span class=""fu"">dbConnect</span>(RSQLite<span class=""sc"">::</span><span class=""fu"">SQLite</span>(), <span class=""st"">&quot;MSdata.sqlite&quot;</span>)</span>
-<span id=""cb15-3""><a href=""#cb15-3"" aria-hidden=""true"" tabindex=""-1""></a></span>
-<span id=""cb15-4""><a href=""#cb15-4"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Export MS1 and MS2 data to sqlite tables</span></span>
-<span id=""cb15-5""><a href=""#cb15-5"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">dbWriteTable</span>(MSdb, <span class=""st"">&quot;MS1&quot;</span>, msdata<span class=""sc"">$</span>MS1)</span>
-<span id=""cb15-6""><a href=""#cb15-6"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">dbWriteTable</span>(MSdb, <span class=""st"">&quot;MS2&quot;</span>, msdata<span class=""sc"">$</span>MS2)</span>
-<span id=""cb15-7""><a href=""#cb15-7"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">dbListTables</span>(MSdb)</span></code></pre></div>
+## Total time: 1.12 secs</code></pre>
+<div class=""sourceCode"" id=""cb11""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb11-1""><a href=""#cb11-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Create the sqlite database and connect to it</span></span>
+<span id=""cb11-2""><a href=""#cb11-2"" aria-hidden=""true"" tabindex=""-1""></a>MSdb <span class=""ot"">&lt;-</span> <span class=""fu"">dbConnect</span>(RSQLite<span class=""sc"">::</span><span class=""fu"">SQLite</span>(), <span class=""st"">&quot;MSdata.sqlite&quot;</span>)</span>
+<span id=""cb11-3""><a href=""#cb11-3"" aria-hidden=""true"" tabindex=""-1""></a></span>
+<span id=""cb11-4""><a href=""#cb11-4"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Export MS1 and MS2 data to sqlite tables</span></span>
+<span id=""cb11-5""><a href=""#cb11-5"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">dbWriteTable</span>(MSdb, <span class=""st"">&quot;MS1&quot;</span>, msdata<span class=""sc"">$</span>MS1)</span>
+<span id=""cb11-6""><a href=""#cb11-6"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">dbWriteTable</span>(MSdb, <span class=""st"">&quot;MS2&quot;</span>, msdata<span class=""sc"">$</span>MS2)</span>
+<span id=""cb11-7""><a href=""#cb11-7"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">dbListTables</span>(MSdb)</span></code></pre></div>
 <pre><code>## [1] &quot;MS1&quot; &quot;MS2&quot;</code></pre>
-<div class=""sourceCode"" id=""cb17""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb17-1""><a href=""#cb17-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Perform a simple query to ensure data was exported correctly</span></span>
-<span id=""cb17-2""><a href=""#cb17-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">dbGetQuery</span>(MSdb, <span class=""st"">&#39;SELECT * FROM MS1 LIMIT 3&#39;</span>)</span></code></pre></div>
+<div class=""sourceCode"" id=""cb13""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb13-1""><a href=""#cb13-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Perform a simple query to ensure data was exported correctly</span></span>
+<span id=""cb13-2""><a href=""#cb13-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">dbGetQuery</span>(MSdb, <span class=""st"">&#39;SELECT * FROM MS1 LIMIT 3&#39;</span>)</span></code></pre></div>
 <pre><code>##      rt       mz        int          filename
 ## 1 4.009 139.0503 1800550.12 LB12HL_AB.mzML.gz
 ## 2 4.009 148.0967  206310.81 LB12HL_AB.mzML.gz
 ## 3 4.009 136.0618   71907.15 LB12HL_AB.mzML.gz</code></pre>
-<div class=""sourceCode"" id=""cb19""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb19-1""><a href=""#cb19-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Perform EIC extraction in SQL rather than in R</span></span>
-<span id=""cb19-2""><a href=""#cb19-2"" aria-hidden=""true"" tabindex=""-1""></a>EIC_query <span class=""ot"">&lt;-</span> <span class=""st"">&#39;SELECT * FROM MS1 WHERE mz BETWEEN :lower_bound AND :upper_bound&#39;</span></span>
-<span id=""cb19-3""><a href=""#cb19-3"" aria-hidden=""true"" tabindex=""-1""></a>query_params <span class=""ot"">&lt;-</span> <span class=""fu"">list</span>(<span class=""at"">lower_bound=</span><span class=""fl"">118.086</span>, <span class=""at"">upper_bound=</span><span class=""fl"">118.087</span>)</span>
-<span id=""cb19-4""><a href=""#cb19-4"" aria-hidden=""true"" tabindex=""-1""></a>EIC <span class=""ot"">&lt;-</span> <span class=""fu"">dbGetQuery</span>(MSdb, EIC_query, <span class=""at"">params =</span> query_params)</span>
-<span id=""cb19-5""><a href=""#cb19-5"" aria-hidden=""true"" tabindex=""-1""></a></span>
-<span id=""cb19-6""><a href=""#cb19-6"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Append with additional files</span></span>
-<span id=""cb19-7""><a href=""#cb19-7"" aria-hidden=""true"" tabindex=""-1""></a>extra_file <span class=""ot"">&lt;-</span> <span class=""fu"">system.file</span>(<span class=""st"">&quot;extdata&quot;</span>, <span class=""st"">&quot;LB12HL_EF.mzML.gz&quot;</span>, <span class=""at"">package =</span> <span class=""st"">&quot;RaMS&quot;</span>)</span>
-<span id=""cb19-8""><a href=""#cb19-8"" aria-hidden=""true"" tabindex=""-1""></a>extra_msdata <span class=""ot"">&lt;-</span> <span class=""fu"">grabMSdata</span>(extra_file, <span class=""at"">grab_what =</span> <span class=""st"">&quot;everything&quot;</span>)</span></code></pre></div>
+<div class=""sourceCode"" id=""cb15""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb15-1""><a href=""#cb15-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Perform EIC extraction in SQL rather than in R</span></span>
+<span id=""cb15-2""><a href=""#cb15-2"" aria-hidden=""true"" tabindex=""-1""></a>EIC_query <span class=""ot"">&lt;-</span> <span class=""st"">&#39;SELECT * FROM MS1 WHERE mz BETWEEN :lower_bound AND :upper_bound&#39;</span></span>
+<span id=""cb15-3""><a href=""#cb15-3"" aria-hidden=""true"" tabindex=""-1""></a>query_params <span class=""ot"">&lt;-</span> <span class=""fu"">list</span>(<span class=""at"">lower_bound=</span><span class=""fl"">118.086</span>, <span class=""at"">upper_bound=</span><span class=""fl"">118.087</span>)</span>
+<span id=""cb15-4""><a href=""#cb15-4"" aria-hidden=""true"" tabindex=""-1""></a>EIC <span class=""ot"">&lt;-</span> <span class=""fu"">dbGetQuery</span>(MSdb, EIC_query, <span class=""at"">params =</span> query_params)</span>
+<span id=""cb15-5""><a href=""#cb15-5"" aria-hidden=""true"" tabindex=""-1""></a></span>
+<span id=""cb15-6""><a href=""#cb15-6"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Append with additional files</span></span>
+<span id=""cb15-7""><a href=""#cb15-7"" aria-hidden=""true"" tabindex=""-1""></a>extra_file <span class=""ot"">&lt;-</span> <span class=""fu"">system.file</span>(<span class=""st"">&quot;extdata&quot;</span>, <span class=""st"">&quot;LB12HL_EF.mzML.gz&quot;</span>, <span class=""at"">package =</span> <span class=""st"">&quot;RaMS&quot;</span>)</span>
+<span id=""cb15-8""><a href=""#cb15-8"" aria-hidden=""true"" tabindex=""-1""></a>extra_msdata <span class=""ot"">&lt;-</span> <span class=""fu"">grabMSdata</span>(extra_file, <span class=""at"">grab_what =</span> <span class=""st"">&quot;everything&quot;</span>)</span></code></pre></div>
 <pre><code>## 
-## Reading file LB12HL_EF.mzML.gz... 0.14 secs 
-## Reading MS1 data...0.13 secs 
-## Reading MS2 data...0.02 secs 
-## Reading BPC...0.08 secs 
-## Reading TIC...0.08 secs 
-## Reading file metadata...0.12 secs 
-## Total time: 0.57 secs</code></pre>
-<div class=""sourceCode"" id=""cb21""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb21-1""><a href=""#cb21-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">dbGetQuery</span>(MSdb, <span class=""st"">&#39;SELECT COUNT(*) FROM MS1&#39;</span>) <span class=""co""># Initial number of rows</span></span></code></pre></div>
+## Reading file LB12HL_EF.mzML.gz... 0.16 secs 
+## Reading MS1 data...0.15 secs 
+## Reading MS2 data...0.01 secs 
+## Reading BPC...0.07 secs 
+## Reading TIC...0.07 secs 
+## Reading file metadata...0.14 secs 
+## Total time: 0.62 secs</code></pre>
+<div class=""sourceCode"" id=""cb17""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb17-1""><a href=""#cb17-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">dbGetQuery</span>(MSdb, <span class=""st"">&#39;SELECT COUNT(*) FROM MS1&#39;</span>) <span class=""co""># Initial number of rows</span></span></code></pre></div>
 <pre><code>##   COUNT(*)
 ## 1    42313</code></pre>
-<div class=""sourceCode"" id=""cb23""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb23-1""><a href=""#cb23-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">dbAppendTable</span>(MSdb, <span class=""st"">&quot;MS1&quot;</span>, extra_msdata<span class=""sc"">$</span>MS1)</span></code></pre></div>
+<div class=""sourceCode"" id=""cb19""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb19-1""><a href=""#cb19-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">dbAppendTable</span>(MSdb, <span class=""st"">&quot;MS1&quot;</span>, extra_msdata<span class=""sc"">$</span>MS1)</span></code></pre></div>
 <pre><code>## [1] 22124</code></pre>
-<div class=""sourceCode"" id=""cb25""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb25-1""><a href=""#cb25-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Confirm three different files exist in DB</span></span>
-<span id=""cb25-2""><a href=""#cb25-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">dbGetQuery</span>(MSdb, <span class=""st"">&#39;SELECT DISTINCT filename FROM MS1&#39;</span>)</span></code></pre></div>
+<div class=""sourceCode"" id=""cb21""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb21-1""><a href=""#cb21-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Confirm three different files exist in DB</span></span>
+<span id=""cb21-2""><a href=""#cb21-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">dbGetQuery</span>(MSdb, <span class=""st"">&#39;SELECT DISTINCT filename FROM MS1&#39;</span>)</span></code></pre></div>
 <pre><code>##            filename
 ## 1 LB12HL_AB.mzML.gz
 ## 2 LB12HL_CD.mzML.gz
 ## 3 LB12HL_EF.mzML.gz</code></pre>
-<div class=""sourceCode"" id=""cb27""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb27-1""><a href=""#cb27-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Confirm new rows have been added</span></span>
-<span id=""cb27-2""><a href=""#cb27-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">dbGetQuery</span>(MSdb, <span class=""st"">&#39;SELECT COUNT(*) FROM MS1&#39;</span>)</span></code></pre></div>
+<div class=""sourceCode"" id=""cb23""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb23-1""><a href=""#cb23-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Confirm new rows have been added</span></span>
+<span id=""cb23-2""><a href=""#cb23-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">dbGetQuery</span>(MSdb, <span class=""st"">&#39;SELECT COUNT(*) FROM MS1&#39;</span>)</span></code></pre></div>
 <pre><code>##   COUNT(*)
 ## 1    64437</code></pre>
-<div class=""sourceCode"" id=""cb29""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb29-1""><a href=""#cb29-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Disconnect after export</span></span>
-<span id=""cb29-2""><a href=""#cb29-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">dbDisconnect</span>(MSdb)</span>
-<span id=""cb29-3""><a href=""#cb29-3"" aria-hidden=""true"" tabindex=""-1""></a></span>
-<span id=""cb29-4""><a href=""#cb29-4"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Clean up afterward</span></span>
-<span id=""cb29-5""><a href=""#cb29-5"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">unlink</span>(<span class=""st"">&quot;MSdata.sqlite&quot;</span>)</span></code></pre></div>
+<div class=""sourceCode"" id=""cb25""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb25-1""><a href=""#cb25-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Disconnect after export</span></span>
+<span id=""cb25-2""><a href=""#cb25-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">dbDisconnect</span>(MSdb)</span>
+<span id=""cb25-3""><a href=""#cb25-3"" aria-hidden=""true"" tabindex=""-1""></a></span>
+<span id=""cb25-4""><a href=""#cb25-4"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Clean up afterward</span></span>
+<span id=""cb25-5""><a href=""#cb25-5"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">unlink</span>(<span class=""st"">&quot;MSdata.sqlite&quot;</span>)</span></code></pre></div>
 </div>
 <div id=""interfacing-with-python-via-reticulate"" class=""section level2"">
 <h2>Interfacing with Python via <code>reticulate</code></h2>
-<p>R and Python are commonly used together, and the <a href=""https://rstudio.github.io/reticulate/""><code>reticulate</code></a> package makes this even easier by enabling a Python interpreter within R. RStudio, in which this vignette was written, supports both R and Python code chunks as shown below.</p>
+<p>R and Python are commonly used together, and the <a href=""https://rstudio.github.io/reticulate/""><code>reticulate</code></a>
+package makes this even easier by enabling a Python interpreter within
+R. RStudio, in which this vignette was written, supports both R and
+Python code chunks as shown below.</p>
 <div id=""r-code-chunk-r"" class=""section level3"">
 <h3>R code chunk: {r}</h3>
-<div class=""sourceCode"" id=""cb30""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb30-1""><a href=""#cb30-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Locate a couple MS files</span></span>
-<span id=""cb30-2""><a href=""#cb30-2"" aria-hidden=""true"" tabindex=""-1""></a>data_dir <span class=""ot"">&lt;-</span> <span class=""fu"">system.file</span>(<span class=""st"">&quot;extdata&quot;</span>, <span class=""at"">package =</span> <span class=""st"">&quot;RaMS&quot;</span>)</span>
-<span id=""cb30-3""><a href=""#cb30-3"" aria-hidden=""true"" tabindex=""-1""></a>file_paths <span class=""ot"">&lt;-</span> <span class=""fu"">list.files</span>(data_dir, <span class=""at"">pattern =</span> <span class=""st"">&quot;HL.*mzML&quot;</span>, <span class=""at"">full.names =</span> <span class=""cn"">TRUE</span>)</span>
-<span id=""cb30-4""><a href=""#cb30-4"" aria-hidden=""true"" tabindex=""-1""></a></span>
-<span id=""cb30-5""><a href=""#cb30-5"" aria-hidden=""true"" tabindex=""-1""></a>msdata <span class=""ot"">&lt;-</span> <span class=""fu"">grabMSdata</span>(<span class=""at"">files =</span> file_paths, <span class=""at"">grab_what =</span> <span class=""st"">&quot;BPC&quot;</span>)<span class=""sc"">$</span>BPC</span></code></pre></div>
+<div class=""sourceCode"" id=""cb26""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb26-1""><a href=""#cb26-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Locate a couple MS files</span></span>
+<span id=""cb26-2""><a href=""#cb26-2"" aria-hidden=""true"" tabindex=""-1""></a>data_dir <span class=""ot"">&lt;-</span> <span class=""fu"">system.file</span>(<span class=""st"">&quot;extdata&quot;</span>, <span class=""at"">package =</span> <span class=""st"">&quot;RaMS&quot;</span>)</span>
+<span id=""cb26-3""><a href=""#cb26-3"" aria-hidden=""true"" tabindex=""-1""></a>file_paths <span class=""ot"">&lt;-</span> <span class=""fu"">list.files</span>(data_dir, <span class=""at"">pattern =</span> <span class=""st"">&quot;HL.*mzML&quot;</span>, <span class=""at"">full.names =</span> <span class=""cn"">TRUE</span>)</span>
+<span id=""cb26-4""><a href=""#cb26-4"" aria-hidden=""true"" tabindex=""-1""></a></span>
+<span id=""cb26-5""><a href=""#cb26-5"" aria-hidden=""true"" tabindex=""-1""></a>msdata <span class=""ot"">&lt;-</span> <span class=""fu"">grabMSdata</span>(<span class=""at"">files =</span> file_paths, <span class=""at"">grab_what =</span> <span class=""st"">&quot;BPC&quot;</span>)<span class=""sc"">$</span>BPC</span></code></pre></div>
 <pre><code>## 
   |                                                                            
   |                                                                      |   0%
@@ -294,18 +506,18 @@ <h3>R code chunk: {r}</h3>
   |===============================================                       |  67%
   |                                                                            
   |======================================================================| 100%
-## Total time: 0.36 secs</code></pre>
+## Total time: 0.42 secs</code></pre>
 </div>
 <div id=""python-code-chunk-python"" class=""section level3"">
 <h3>Python code chunk: {python}</h3>
-<div class=""sourceCode"" id=""cb32""><pre class=""sourceCode python""><code class=""sourceCode python""><span id=""cb32-1""><a href=""#cb32-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Not run to pass R CMD check on GitHub</span></span>
-<span id=""cb32-2""><a href=""#cb32-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Make sure python, matplotlib, and seaborn are installed</span></span>
-<span id=""cb32-3""><a href=""#cb32-3"" aria-hidden=""true"" tabindex=""-1""></a></span>
-<span id=""cb32-4""><a href=""#cb32-4"" aria-hidden=""true"" tabindex=""-1""></a><span class=""im"">import</span> seaborn <span class=""im"">as</span> sns</span>
-<span id=""cb32-5""><a href=""#cb32-5"" aria-hidden=""true"" tabindex=""-1""></a><span class=""im"">import</span> matplotlib.pyplot <span class=""im"">as</span> plt</span>
-<span id=""cb32-6""><a href=""#cb32-6"" aria-hidden=""true"" tabindex=""-1""></a></span>
-<span id=""cb32-7""><a href=""#cb32-7"" aria-hidden=""true"" tabindex=""-1""></a>sns.relplot(data<span class=""op"">=</span>r.msdata, kind<span class=""op"">=</span><span class=""st"">&quot;line&quot;</span>, x<span class=""op"">=</span><span class=""st"">&quot;rt&quot;</span>, y<span class=""op"">=</span><span class=""st"">&quot;int&quot;</span>, hue<span class=""op"">=</span><span class=""st"">&quot;filename&quot;</span>)</span>
-<span id=""cb32-8""><a href=""#cb32-8"" aria-hidden=""true"" tabindex=""-1""></a>plt.show()</span></code></pre></div>
+<div class=""sourceCode"" id=""cb28""><pre class=""sourceCode python""><code class=""sourceCode python""><span id=""cb28-1""><a href=""#cb28-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Not run to pass R CMD check on GitHub</span></span>
+<span id=""cb28-2""><a href=""#cb28-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># Make sure python, matplotlib, and seaborn are installed</span></span>
+<span id=""cb28-3""><a href=""#cb28-3"" aria-hidden=""true"" tabindex=""-1""></a></span>
+<span id=""cb28-4""><a href=""#cb28-4"" aria-hidden=""true"" tabindex=""-1""></a><span class=""im"">import</span> seaborn <span class=""im"">as</span> sns</span>
+<span id=""cb28-5""><a href=""#cb28-5"" aria-hidden=""true"" tabindex=""-1""></a><span class=""im"">import</span> matplotlib.pyplot <span class=""im"">as</span> plt</span>
+<span id=""cb28-6""><a href=""#cb28-6"" aria-hidden=""true"" tabindex=""-1""></a></span>
+<span id=""cb28-7""><a href=""#cb28-7"" aria-hidden=""true"" tabindex=""-1""></a>sns.relplot(data<span class=""op"">=</span>r.msdata, kind<span class=""op"">=</span><span class=""st"">&quot;line&quot;</span>, x<span class=""op"">=</span><span class=""st"">&quot;rt&quot;</span>, y<span class=""op"">=</span><span class=""st"">&quot;int&quot;</span>, hue<span class=""op"">=</span><span class=""st"">&quot;filename&quot;</span>)</span>
+<span id=""cb28-8""><a href=""#cb28-8"" aria-hidden=""true"" tabindex=""-1""></a>plt.show()</span></code></pre></div>
 </div>
 </div>
 

---FILE: vignettes/Intro-to-RaMS.Rmd---
@@ -45,7 +45,7 @@ If you have your own data, feel free to load it here. If not, there's a couple
 small example files you're welcome to use in the ""extdata"" folder. The first of 
 these contains DDA data from a pooled sample, while the others are individual 
 samples. I'll be using these throughout. For more details on the origin of these
-files, see the [minification vignette](doc/Minifying-files-with-RaMS.html).
+files, see the [minification vignette](https://htmlpreview.github.io/?https://github.com/wkumler/RaMS/blob/master/doc/Minifying-files-with-RaMS.html).
 
 ```{r findfiles, message=FALSE}
 library(RaMS)
@@ -426,7 +426,7 @@ reduce file size and read times. Sharp-eyed users will have noticed that the
 demo files are already gzipped, which is part of the reason they are so small.
 
 `zlib` compression is slightly trickier, and is most often performed with tools
-such as [Proteowizard](http://proteowizard.sourceforge.net/doc_users.html)'s 
+such as [Proteowizard](https://proteowizard.sourceforge.io/doc_users.html)'s 
 `msconvert` tool with the option ""-z"". 
 
 Read times may also be slow if files are being accessed via the Internet, either

---FILE: vignettes/Minifying-files-with-RaMS.Rmd---
@@ -179,7 +179,7 @@ minifyMSdata(files = init_files, output_files = out_files, warn = FALSE,
 
 Now we have four minified mzXML files in our inst/extdata folder. However, we'd
 like to be able to demo the mzML functionality as well as that of mzXMLs, so
-we can use [Proteowizard's](http://proteowizard.sourceforge.net/tools.shtml) 
+we can use [Proteowizard's](https://proteowizard.sourceforge.io/tools/msconvert.html) 
 `msconvert` tool because `RaMS` can't convert between mzML and mzXML or vice 
 versa. You'll need to install `msconvert` and add it to your path for this
 step.",False,True,Rendering / Conversion,6
wkumler,RaMS,d3d1fea174a7d81a6406a52b94d8b7bf609e578a,wkumler,wkumler@uw.edu,2022-11-10T19:01:04Z,wkumler,wkumler@uw.edu,2022-11-10T19:01:04Z,Fixing v1.3 bug with extra_grabs and unique(),R/grabMzmlFunctions.R;R/grabMzxmlFunctions.R,False,True,True,False,5,5,10,"---FILE: R/grabMzmlFunctions.R---
@@ -103,12 +103,12 @@ grabMzmlData <- function(filename, grab_what, verbosity=0,
 
   if(""everything""%in%grab_what){
     extra_grabs <- setdiff(grab_what, ""everything"")
-    if(c(""MS1"", ""MS2"", ""BPC"", ""TIC"", ""metadata"")%in%extra_grabs&&verbosity>0){
+    if(any(c(""MS1"", ""MS2"", ""BPC"", ""TIC"", ""metadata"")%in%extra_grabs)&&verbosity>0){
       message(paste(""Heads-up: grab_what = `everything` includes"",
                     ""MS1, MS2, BPC, TIC, and meta data""))
       message(""Ignoring duplicate specification"")
     }
-    grab_what <- c(""MS1"", ""MS2"", ""BPC"", ""TIC"", ""metadata"", extra_grabs)
+    grab_what <- unique(c(""MS1"", ""MS2"", ""BPC"", ""TIC"", ""metadata"", extra_grabs))
   }
 
   if(any(c(""MS1"", ""MS2"", ""DAD"", ""EIC"", ""EIC_MS2"", ""chroms"")%in%grab_what)){

---FILE: R/grabMzxmlFunctions.R---
@@ -94,15 +94,15 @@ grabMzxmlData <- function(filename, grab_what, verbosity=0,
 
   if(""everything""%in%grab_what){
     extra_grabs <- setdiff(grab_what, ""everything"")
-    if(c(""MS1"", ""MS2"", ""BPC"", ""TIC"", ""metadata"")%in%extra_grabs&&verbosity>0){
+    if(any(c(""MS1"", ""MS2"", ""BPC"", ""TIC"", ""metadata"")%in%extra_grabs)&&verbosity>0){
       message(paste(""Heads-up: grab_what = `everything` includes"",
                     ""MS1, MS2, BPC, TIC, and meta data""))
       message(""Ignoring duplicate specification"")
     }
-    grab_what <- c(""MS1"", ""MS2"", ""BPC"", ""TIC"", ""metadata"", extra_grabs)
+    grab_what <- unique(c(""MS1"", ""MS2"", ""BPC"", ""TIC"", ""metadata"", extra_grabs))
   }
 
-  if(any(c(""MS1"", ""MS2"", ""EIC"", ""EIC_MS2"", ""chroms"")%in%grab_what)){
+  if(any(c(""MS1"", ""MS2"", ""EIC"", ""EIC_MS2"")%in%grab_what)){
     file_metadata <- grabMzxmlEncodingData(xml_data)
   }
 ",True,False,Implementation / Logic,3
wkumler,RaMS,355336b761bcbf5c8ea2ed35846aa7e5b64a09ee,wkumler,wkumler@uw.edu,2022-11-10T18:26:07Z,wkumler,wkumler@uw.edu,2022-11-10T18:26:07Z,Fixing tests with new unit test file,tests/testthat/setup-load.R;tests/testthat/test_DAD.R;tests/testthat/test_tmzML_things.R,False,True,True,False,3,3,6,"---FILE: tests/testthat/setup-load.R---
@@ -4,7 +4,7 @@ library(data.table)
 
 # Load the defaults ----
 mzML_filenames <- list.files(system.file(""extdata"", package = ""RaMS""),
-                             pattern = ""mzML"", full.names = TRUE)[c(2:6, 1)]
+                             pattern = ""mzML"", full.names = TRUE)
 mzXML_filenames <- list.files(system.file(""extdata"", package = ""RaMS""),
                               pattern = ""mzXML"", full.names = TRUE)
 

---FILE: tests/testthat/test_DAD.R---
@@ -1,7 +1,7 @@
 
 ext_filepath <- system.file(""extdata"", package = ""RaMS"")
 DAD_filepath <- list.files(ext_filepath, full.names = TRUE,
-                           pattern = ""20220404_CirA_D5_30_mini.mzML"")
+                           pattern = ""uv_test_mini.mzML"")
 msdata_DAD <- grabMSdata(files = DAD_filepath, grab_what = c(""everything"", ""DAD""))
 msdata_DAD_only <- grabMSdata(files = DAD_filepath, grab_what = ""DAD"")
 

---FILE: tests/testthat/test_tmzML_things.R---
@@ -10,7 +10,7 @@ tmzml_filenames <- gsub(x = output_filenames, ""\\.mzML.*"", "".tmzML"")
 mapply(tmzmlMaker, mzML_filenames[1:4], tmzml_filenames[1:4], verbosity=0)
 
 test_that(""tmzML conversion warns if no spectra found"", {
-  expect_warning(expect_error(tmzmlMaker(mzML_filenames[5])))
+  expect_warning(expect_error(tmzmlMaker(mzML_filenames[6])))
 })
 
 test_that(""tmzML conversion works for mzMLs"", {",True,False,Implementation / Logic,6
wkumler,RaMS,3523e17ea5bf055304b29b79fed58cf69a3c7b28,wkumler,wkumler@uw.edu,2022-11-08T00:52:23Z,wkumler,wkumler@uw.edu,2022-11-08T00:52:23Z,Fix issue with incorrect voltage encoding of tmzML documents (Github issue #9),R/tmzMLFunctions.R,False,True,True,False,1,1,2,"---FILE: R/tmzMLFunctions.R---
@@ -10,7 +10,7 @@
 addEncNode <- function(parent_node, dubset, name){
   new_node <- xml2::xml_add_child(parent_node, name)
   xml2::xml_text(new_node) <- giveEncoding(
-    dubset[[name]], compression_type = ""gzip"",
+    as.numeric(dubset[[name]]), compression_type = ""gzip"",
     bin_precision = 8, endi_enc = ""little""
   )
 }",True,False,Implementation / Logic,3
wkumler,RaMS,e650f278e398ee006157f78e4a801634e3004ed3,wkumler,wkumler@uw.edu,2022-11-05T00:02:30Z,wkumler,wkumler@uw.edu,2022-11-05T00:02:30Z,Fixing documentation w new chroms request syntax,doc/Intro-to-RaMS.Rmd;doc/Intro-to-RaMS.html;vignettes/Intro-to-RaMS.Rmd,True,False,True,False,60,49,109,"---FILE: doc/Intro-to-RaMS.Rmd---
@@ -290,16 +290,16 @@ a similar neutral loss: one with a mass of 104.0710.
 
 mzMLs can also contain precompiled chromatograms. Version 1.3 of RaMS enabled
 the extraction of these chromatograms just like MS^1^ or MS^2^ data and added
-the new `chroms` slot to hold them. Now, asking for `grab_what = ""everything""`
-or `grab_what = ""chroms""` will create this new slot in the returned object.
+the new `chroms` slot to hold them. However, these need to be requested using
+`grab_what = ""chroms""`and will create this new slot in the returned object.
 Chromatograms are returned as a `data.table` with seven columns: chromatogram 
 type (usually TIC, BPC or SRM info), chromatogram index, target mz, product mz, 
 retention time (rt), and intensity (int). This allows simple plotting of
 various chromatograms such as those returned by MRM:
 
 ```{r, fig.height=3}
 chrom_file <- system.file(""extdata"", ""wk_chrom.mzML.gz"", package = ""RaMS"")
-msdata_chroms <- grabMSdata(chrom_file, verbosity = 0)
+msdata_chroms <- grabMSdata(chrom_file, verbosity = 0, grab_what = ""chroms"")
 given_chrom <- msdata_chroms$chroms[chrom_type==""SRM iletter1""]
 ptitle <- with(given_chrom, paste0(
   unique(chrom_type), "": Target m/z = "", unique(target_mz), ""; Product m/z = "", 

---FILE: doc/Intro-to-RaMS.html---
@@ -26,6 +26,7 @@
     </style>
 
 
+
 <style type=""text/css"">
   code {
     white-space: pre;
@@ -107,13 +108,20 @@
   for (var i = 0; i < sheets.length; i++) {
     if (sheets[i].ownerNode.dataset[""origin""] !== ""pandoc"") continue;
     try { var rules = sheets[i].cssRules; } catch (e) { continue; }
-    for (var j = 0; j < rules.length; j++) {
+    var j = 0;
+    while (j < rules.length) {
       var rule = rules[j];
       // check if there is a div.sourceCode rule
-      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== ""div.sourceCode"") continue;
+      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== ""div.sourceCode"") {
+        j++;
+        continue;
+      }
       var style = rule.style.cssText;
       // check if color or background-color is set
-      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
+      if (rule.style.color === '' && rule.style.backgroundColor === '') {
+        j++;
+        continue;
+      }
       // replace div.sourceCode by a pre.sourceCode rule
       sheets[i].deleteRule(j);
       sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
@@ -185,8 +193,8 @@ <h3>TICs, BPCs, and metadata</h3>
 <span id=""cb2-3""><a href=""#cb2-3"" aria-hidden=""true"" tabindex=""-1""></a>msdata <span class=""ot"">&lt;-</span> <span class=""fu"">grabMSdata</span>(single_file, <span class=""at"">grab_what =</span> <span class=""st"">&quot;TIC&quot;</span>)</span>
 <span id=""cb2-4""><a href=""#cb2-4"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; </span></span>
 <span id=""cb2-5""><a href=""#cb2-5"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading file LB12HL_AB.mzML.gz... 0.04 secs </span></span>
-<span id=""cb2-6""><a href=""#cb2-6"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading TIC...0.06 secs </span></span>
-<span id=""cb2-7""><a href=""#cb2-7"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 0.1 secs</span></span>
+<span id=""cb2-6""><a href=""#cb2-6"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading TIC...0.09 secs </span></span>
+<span id=""cb2-7""><a href=""#cb2-7"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 0.14 secs</span></span>
 <span id=""cb2-8""><a href=""#cb2-8"" aria-hidden=""true"" tabindex=""-1""></a></span>
 <span id=""cb2-9""><a href=""#cb2-9"" aria-hidden=""true"" tabindex=""-1""></a>knitr<span class=""sc"">::</span><span class=""fu"">kable</span>(<span class=""fu"">head</span>(msdata<span class=""sc"">$</span>TIC, <span class=""dv"">3</span>))</span></code></pre></div>
 <table>
@@ -222,9 +230,9 @@ <h3>TICs, BPCs, and metadata</h3>
 <p>A BPC is just like a TIC except that it records the <em>maximum</em> intensity measured, rather than the sum of all intensities. This data is also collected by the mass analyzer and doesn’t need to be calculated.</p>
 <div class=""sourceCode"" id=""cb4""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb4-1""><a href=""#cb4-1"" aria-hidden=""true"" tabindex=""-1""></a>msdata <span class=""ot"">&lt;-</span> <span class=""fu"">grabMSdata</span>(single_file, <span class=""at"">grab_what =</span> <span class=""st"">&quot;BPC&quot;</span>)</span>
 <span id=""cb4-2""><a href=""#cb4-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; </span></span>
-<span id=""cb4-3""><a href=""#cb4-3"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading file LB12HL_AB.mzML.gz... 0.06 secs </span></span>
-<span id=""cb4-4""><a href=""#cb4-4"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading BPC...0.09 secs </span></span>
-<span id=""cb4-5""><a href=""#cb4-5"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 0.15 secs</span></span></code></pre></div>
+<span id=""cb4-3""><a href=""#cb4-3"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading file LB12HL_AB.mzML.gz... 0.04 secs </span></span>
+<span id=""cb4-4""><a href=""#cb4-4"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading BPC...0.06 secs </span></span>
+<span id=""cb4-5""><a href=""#cb4-5"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 0.1 secs</span></span></code></pre></div>
 <p>Since the data is parsed in a <a href=""https://r4ds.had.co.nz/tidy-data.html"">“tidy” format</a>, it plays nicely with popular packages such as <code>ggplot2</code>. Let’s use that to plot our BPC instead of the base R plotting system:</p>
 <div class=""sourceCode"" id=""cb5""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb5-1""><a href=""#cb5-1"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">library</span>(tidyverse)</span>
 <span id=""cb5-2""><a href=""#cb5-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">ggplot</span>(msdata<span class=""sc"">$</span>BPC) <span class=""sc"">+</span> <span class=""fu"">geom_line</span>(<span class=""fu"">aes</span>(<span class=""at"">x=</span>rt, <span class=""at"">y=</span>int))</span></code></pre></div>
@@ -240,7 +248,7 @@ <h3>TICs, BPCs, and metadata</h3>
 <span id=""cb6-8""><a href=""#cb6-8"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""er"">|===============================================</span>                       <span class=""er"">|</span>  <span class=""dv"">67</span>%</span>
 <span id=""cb6-9""><a href=""#cb6-9"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""sc"">|</span>                                                                            </span>
 <span id=""cb6-10""><a href=""#cb6-10"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""er"">|======================================================================|</span> <span class=""dv"">100</span>%</span>
-<span id=""cb6-11""><a href=""#cb6-11"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 0.38 secs</span></span>
+<span id=""cb6-11""><a href=""#cb6-11"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 0.3 secs</span></span>
 <span id=""cb6-12""><a href=""#cb6-12"" aria-hidden=""true"" tabindex=""-1""></a></span>
 <span id=""cb6-13""><a href=""#cb6-13"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">ggplot</span>(msdata<span class=""sc"">$</span>BPC) <span class=""sc"">+</span> <span class=""fu"">geom_line</span>(<span class=""fu"">aes</span>(<span class=""at"">x=</span>rt, <span class=""at"">y=</span>int, <span class=""at"">color=</span>filename))</span></code></pre></div>
 <p><img src=""data:image/png;base64,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"" width=""80%"" style=""display: block; margin: auto;"" /></p>
@@ -260,16 +268,18 @@ <h3>TICs, BPCs, and metadata</h3>
 <span id=""cb8-2""><a href=""#cb8-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co""># less-minified DDA file here</span></span>
 <span id=""cb8-3""><a href=""#cb8-3"" aria-hidden=""true"" tabindex=""-1""></a><span class=""fu"">grabMSdata</span>(<span class=""at"">files =</span> data_files[<span class=""dv"">1</span>], <span class=""at"">grab_what =</span> <span class=""st"">&quot;metadata&quot;</span>)</span>
 <span id=""cb8-4""><a href=""#cb8-4"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; </span></span>
-<span id=""cb8-5""><a href=""#cb8-5"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading file DDApos_2.mzML.gz... 0.17 secs </span></span>
-<span id=""cb8-6""><a href=""#cb8-6"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading file metadata...0.35 secs </span></span>
-<span id=""cb8-7""><a href=""#cb8-7"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 0.52 secs</span></span>
+<span id=""cb8-5""><a href=""#cb8-5"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading file DDApos_2.mzML.gz... 0.12 secs </span></span>
+<span id=""cb8-6""><a href=""#cb8-6"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading file metadata...0.39 secs </span></span>
+<span id=""cb8-7""><a href=""#cb8-7"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 0.51 secs</span></span>
 <span id=""cb8-8""><a href=""#cb8-8"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; $metadata</span></span>
 <span id=""cb8-9""><a href=""#cb8-9"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt;                                   source_file  inst_data       config_data</span></span>
 <span id=""cb8-10""><a href=""#cb8-10"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; 1: 170223_Poo_AllCyanoAqExtracts_DDApos_2.raw None found &lt;data.frame[1x3]&gt;</span></span>
-<span id=""cb8-11""><a href=""#cb8-11"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt;    timestamp n_spectra n_chromatograms ms_levels mz_lowest mz_highest rt_start</span></span>
-<span id=""cb8-12""><a href=""#cb8-12"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; 1:      &lt;NA&gt;      1994               0  MS1, MS2   50.0298    613.158  240.051</span></span>
-<span id=""cb8-13""><a href=""#cb8-13"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt;     rt_end centroided polarity         filename</span></span>
-<span id=""cb8-14""><a href=""#cb8-14"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; 1: 899.827       TRUE positive DDApos_2.mzML.gz</span></span></code></pre></div>
+<span id=""cb8-11""><a href=""#cb8-11"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt;    timestamp n_spectra n_chromatograms ms_levels mz_lowest mz_highest</span></span>
+<span id=""cb8-12""><a href=""#cb8-12"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; 1:      &lt;NA&gt;      1994               0  MS1, MS2   50.0298    613.158</span></span>
+<span id=""cb8-13""><a href=""#cb8-13"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt;    lambda_lowest lambda_highest rt_start   rt_end centroided polarity</span></span>
+<span id=""cb8-14""><a href=""#cb8-14"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; 1:            NA             NA  4.00085 14.99712       TRUE positive</span></span>
+<span id=""cb8-15""><a href=""#cb8-15"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt;            filename</span></span>
+<span id=""cb8-16""><a href=""#cb8-16"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; 1: DDApos_2.mzML.gz</span></span></code></pre></div>
 </div>
 <div id=""adding-a-column-ms1-data"" class=""section level3"">
 <h3>Adding a column: MS1 data</h3>
@@ -284,7 +294,7 @@ <h3>Adding a column: MS1 data</h3>
 <span id=""cb9-8""><a href=""#cb9-8"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""er"">|===============================================</span>                       <span class=""er"">|</span>  <span class=""dv"">67</span>%</span>
 <span id=""cb9-9""><a href=""#cb9-9"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""sc"">|</span>                                                                            </span>
 <span id=""cb9-10""><a href=""#cb9-10"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""er"">|======================================================================|</span> <span class=""dv"">100</span>%</span>
-<span id=""cb9-11""><a href=""#cb9-11"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 1.1 secs</span></span>
+<span id=""cb9-11""><a href=""#cb9-11"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 0.72 secs</span></span>
 <span id=""cb9-12""><a href=""#cb9-12"" aria-hidden=""true"" tabindex=""-1""></a></span>
 <span id=""cb9-13""><a href=""#cb9-13"" aria-hidden=""true"" tabindex=""-1""></a>knitr<span class=""sc"">::</span><span class=""fu"">kable</span>(<span class=""fu"">head</span>(msdata<span class=""sc"">$</span>MS1, <span class=""dv"">3</span>))</span></code></pre></div>
 <table>
@@ -347,15 +357,16 @@ <h3>Moving along: MS2 data</h3>
 <p><code>RaMS</code> also handles MS<sup>2</sup> data elegantly. Request it with the “MS2” option for <code>grab_what</code>, although it’s often a good idea to grab the MS1 data alongside.</p>
 <div class=""sourceCode"" id=""cb12""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb12-1""><a href=""#cb12-1"" aria-hidden=""true"" tabindex=""-1""></a>msdata <span class=""ot"">&lt;-</span> <span class=""fu"">grabMSdata</span>(data_files[<span class=""dv"">1</span>], <span class=""at"">grab_what =</span> <span class=""st"">&quot;everything&quot;</span>)</span>
 <span id=""cb12-2""><a href=""#cb12-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; </span></span>
-<span id=""cb12-3""><a href=""#cb12-3"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading file DDApos_2.mzML.gz... 0.54 secs </span></span>
-<span id=""cb12-4""><a href=""#cb12-4"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading MS1 data...0.32 secs </span></span>
-<span id=""cb12-5""><a href=""#cb12-5"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading MS2 data...0.13 secs </span></span>
-<span id=""cb12-6""><a href=""#cb12-6"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading BPC...0.2 secs </span></span>
-<span id=""cb12-7""><a href=""#cb12-7"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading TIC...0.21 secs </span></span>
-<span id=""cb12-8""><a href=""#cb12-8"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading chromatograms...0.01 secs </span></span>
-<span id=""cb12-9""><a href=""#cb12-9"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading file metadata...0.29 secs </span></span>
-<span id=""cb12-10""><a href=""#cb12-10"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 1.7 secs</span></span>
-<span id=""cb12-11""><a href=""#cb12-11"" aria-hidden=""true"" tabindex=""-1""></a>knitr<span class=""sc"">::</span><span class=""fu"">kable</span>(<span class=""fu"">head</span>(msdata<span class=""sc"">$</span>MS2, <span class=""dv"">3</span>))</span></code></pre></div>
+<span id=""cb12-3""><a href=""#cb12-3"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading file DDApos_2.mzML.gz... 0.44 secs </span></span>
+<span id=""cb12-4""><a href=""#cb12-4"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading MS1 data...0.28 secs </span></span>
+<span id=""cb12-5""><a href=""#cb12-5"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading MS2 data...0.11 secs </span></span>
+<span id=""cb12-6""><a href=""#cb12-6"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading BPC...0.14 secs </span></span>
+<span id=""cb12-7""><a href=""#cb12-7"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading TIC...0.15 secs </span></span>
+<span id=""cb12-8""><a href=""#cb12-8"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading file metadata...0.37 secs</span></span>
+<span id=""cb12-9""><a href=""#cb12-9"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Warning in checkOutputQuality(output_data = all_file_data_output, grab_what =</span></span>
+<span id=""cb12-10""><a href=""#cb12-10"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; grab_what): Not all data collected; missing chroms</span></span>
+<span id=""cb12-11""><a href=""#cb12-11"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 1.49 secs</span></span>
+<span id=""cb12-12""><a href=""#cb12-12"" aria-hidden=""true"" tabindex=""-1""></a>knitr<span class=""sc"">::</span><span class=""fu"">kable</span>(<span class=""fu"">head</span>(msdata<span class=""sc"">$</span>MS2, <span class=""dv"">3</span>))</span></code></pre></div>
 <table>
 <thead>
 <tr class=""header"">
@@ -578,9 +589,9 @@ <h3>Moving along: MS2 data</h3>
 </div>
 <div id=""continuing-chromatograms"" class=""section level3"">
 <h3>Continuing: chromatograms!</h3>
-<p>mzMLs can also contain precompiled chromatograms. Version 1.3 of RaMS enabled the extraction of these chromatograms just like MS<sup>1</sup> or MS<sup>2</sup> data and added the new <code>chroms</code> slot to hold them. Now, asking for <code>grab_what = &quot;everything&quot;</code> or <code>grab_what = &quot;chroms&quot;</code> will create this new slot in the returned object. Chromatograms are returned as a <code>data.table</code> with seven columns: chromatogram type (usually TIC, BPC or SRM info), chromatogram index, target mz, product mz, retention time (rt), and intensity (int). This allows simple plotting of various chromatograms such as those returned by MRM:</p>
+<p>mzMLs can also contain precompiled chromatograms. Version 1.3 of RaMS enabled the extraction of these chromatograms just like MS<sup>1</sup> or MS<sup>2</sup> data and added the new <code>chroms</code> slot to hold them. However, these need to be requested using <code>grab_what = &quot;chroms&quot;</code>and will create this new slot in the returned object. Chromatograms are returned as a <code>data.table</code> with seven columns: chromatogram type (usually TIC, BPC or SRM info), chromatogram index, target mz, product mz, retention time (rt), and intensity (int). This allows simple plotting of various chromatograms such as those returned by MRM:</p>
 <div class=""sourceCode"" id=""cb17""><pre class=""sourceCode r""><code class=""sourceCode r""><span id=""cb17-1""><a href=""#cb17-1"" aria-hidden=""true"" tabindex=""-1""></a>chrom_file <span class=""ot"">&lt;-</span> <span class=""fu"">system.file</span>(<span class=""st"">&quot;extdata&quot;</span>, <span class=""st"">&quot;wk_chrom.mzML.gz&quot;</span>, <span class=""at"">package =</span> <span class=""st"">&quot;RaMS&quot;</span>)</span>
-<span id=""cb17-2""><a href=""#cb17-2"" aria-hidden=""true"" tabindex=""-1""></a>msdata_chroms <span class=""ot"">&lt;-</span> <span class=""fu"">grabMSdata</span>(chrom_file, <span class=""at"">verbosity =</span> <span class=""dv"">0</span>)</span>
+<span id=""cb17-2""><a href=""#cb17-2"" aria-hidden=""true"" tabindex=""-1""></a>msdata_chroms <span class=""ot"">&lt;-</span> <span class=""fu"">grabMSdata</span>(chrom_file, <span class=""at"">verbosity =</span> <span class=""dv"">0</span>, <span class=""at"">grab_what =</span> <span class=""st"">&quot;chroms&quot;</span>)</span>
 <span id=""cb17-3""><a href=""#cb17-3"" aria-hidden=""true"" tabindex=""-1""></a>given_chrom <span class=""ot"">&lt;-</span> msdata_chroms<span class=""sc"">$</span>chroms[chrom_type<span class=""sc"">==</span><span class=""st"">&quot;SRM iletter1&quot;</span>]</span>
 <span id=""cb17-4""><a href=""#cb17-4"" aria-hidden=""true"" tabindex=""-1""></a>ptitle <span class=""ot"">&lt;-</span> <span class=""fu"">with</span>(given_chrom, <span class=""fu"">paste0</span>(</span>
 <span id=""cb17-5""><a href=""#cb17-5"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""fu"">unique</span>(chrom_type), <span class=""st"">&quot;: Target m/z = &quot;</span>, <span class=""fu"">unique</span>(target_mz), <span class=""st"">&quot;; Product m/z = &quot;</span>, </span>
@@ -610,7 +621,7 @@ <h3>Saving space: EICs and rtrange</h3>
 <span id=""cb18-10""><a href=""#cb18-10"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""er"">|====================================================</span>                  <span class=""er"">|</span>  <span class=""dv"">75</span>%</span>
 <span id=""cb18-11""><a href=""#cb18-11"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""sc"">|</span>                                                                            </span>
 <span id=""cb18-12""><a href=""#cb18-12"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""er"">|======================================================================|</span> <span class=""dv"">100</span>%</span>
-<span id=""cb18-13""><a href=""#cb18-13"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 1.99 secs</span></span>
+<span id=""cb18-13""><a href=""#cb18-13"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 1.87 secs</span></span>
 <span id=""cb18-14""><a href=""#cb18-14"" aria-hidden=""true"" tabindex=""-1""></a></span>
 <span id=""cb18-15""><a href=""#cb18-15"" aria-hidden=""true"" tabindex=""-1""></a>mzs_of_interest <span class=""ot"">&lt;-</span> <span class=""fu"">c</span>(<span class=""at"">adenine=</span><span class=""fl"">136.06232</span>, <span class=""at"">valine=</span><span class=""fl"">118.0865</span>)</span>
 <span id=""cb18-16""><a href=""#cb18-16"" aria-hidden=""true"" tabindex=""-1""></a>small_data <span class=""ot"">&lt;-</span> <span class=""fu"">grabMSdata</span>(data_files, <span class=""at"">grab_what =</span> <span class=""fu"">c</span>(<span class=""st"">&quot;EIC&quot;</span>, <span class=""st"">&quot;EIC_MS2&quot;</span>),</span>
@@ -626,7 +637,7 @@ <h3>Saving space: EICs and rtrange</h3>
 <span id=""cb18-26""><a href=""#cb18-26"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""er"">|====================================================</span>                  <span class=""er"">|</span>  <span class=""dv"">75</span>%</span>
 <span id=""cb18-27""><a href=""#cb18-27"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""sc"">|</span>                                                                            </span>
 <span id=""cb18-28""><a href=""#cb18-28"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""er"">|======================================================================|</span> <span class=""dv"">100</span>%</span>
-<span id=""cb18-29""><a href=""#cb18-29"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 1.93 secs</span></span>
+<span id=""cb18-29""><a href=""#cb18-29"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 1.45 secs</span></span>
 <span id=""cb18-30""><a href=""#cb18-30"" aria-hidden=""true"" tabindex=""-1""></a></span>
 <span id=""cb18-31""><a href=""#cb18-31"" aria-hidden=""true"" tabindex=""-1""></a>all_data<span class=""sc"">$</span>MS1 <span class=""sc"">%&gt;%</span></span>
 <span id=""cb18-32""><a href=""#cb18-32"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""fu"">mutate</span>(<span class=""at"">type=</span><span class=""st"">&quot;All data&quot;</span>) <span class=""sc"">%&gt;%</span></span>
@@ -657,7 +668,7 @@ <h3>Saving space: EICs and rtrange</h3>
 <span id=""cb20-10""><a href=""#cb20-10"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""er"">|====================================================</span>                  <span class=""er"">|</span>  <span class=""dv"">75</span>%</span>
 <span id=""cb20-11""><a href=""#cb20-11"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""sc"">|</span>                                                                            </span>
 <span id=""cb20-12""><a href=""#cb20-12"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""er"">|======================================================================|</span> <span class=""dv"">100</span>%</span>
-<span id=""cb20-13""><a href=""#cb20-13"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 1.58 secs</span></span>
+<span id=""cb20-13""><a href=""#cb20-13"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 1.2 secs</span></span>
 <span id=""cb20-14""><a href=""#cb20-14"" aria-hidden=""true"" tabindex=""-1""></a></span>
 <span id=""cb20-15""><a href=""#cb20-15"" aria-hidden=""true"" tabindex=""-1""></a>all_data<span class=""sc"">$</span>MS1 <span class=""sc"">%&gt;%</span></span>
 <span id=""cb20-16""><a href=""#cb20-16"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""fu"">mutate</span>(<span class=""at"">type=</span><span class=""st"">&quot;All data&quot;</span>) <span class=""sc"">%&gt;%</span></span>
@@ -683,31 +694,31 @@ <h3>Speeding things up</h3>
 <span id=""cb22-2""><a href=""#cb22-2"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; </span></span>
 <span id=""cb22-3""><a href=""#cb22-3"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""sc"">|</span>                                                                            </span>
 <span id=""cb22-4""><a href=""#cb22-4"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""er"">|</span>                                                                      <span class=""er"">|</span>   <span class=""dv"">0</span>%</span>
-<span id=""cb22-5""><a href=""#cb22-5"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading file DDApos_2.mzML.gz... 0.48 secs </span></span>
-<span id=""cb22-6""><a href=""#cb22-6"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading MS1 data...0.4 secs </span></span>
-<span id=""cb22-7""><a href=""#cb22-7"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading MS2 data...0.16 secs </span></span>
+<span id=""cb22-5""><a href=""#cb22-5"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading file DDApos_2.mzML.gz... 0.45 secs </span></span>
+<span id=""cb22-6""><a href=""#cb22-6"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading MS1 data...0.25 secs </span></span>
+<span id=""cb22-7""><a href=""#cb22-7"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading MS2 data...0.11 secs </span></span>
 <span id=""cb22-8""><a href=""#cb22-8"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; </span></span>
 <span id=""cb22-9""><a href=""#cb22-9"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""sc"">|</span>                                                                            </span>
 <span id=""cb22-10""><a href=""#cb22-10"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""er"">|==================</span>                                                    <span class=""er"">|</span>  <span class=""dv"">25</span>%</span>
-<span id=""cb22-11""><a href=""#cb22-11"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading file LB12HL_AB.mzML.gz... 0.2 secs </span></span>
-<span id=""cb22-12""><a href=""#cb22-12"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading MS1 data...0.1 secs </span></span>
+<span id=""cb22-11""><a href=""#cb22-11"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading file LB12HL_AB.mzML.gz... 0.13 secs </span></span>
+<span id=""cb22-12""><a href=""#cb22-12"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading MS1 data...0.09 secs </span></span>
 <span id=""cb22-13""><a href=""#cb22-13"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading MS2 data...0.01 secs </span></span>
 <span id=""cb22-14""><a href=""#cb22-14"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; </span></span>
 <span id=""cb22-15""><a href=""#cb22-15"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""sc"">|</span>                                                                            </span>
 <span id=""cb22-16""><a href=""#cb22-16"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""er"">|===================================</span>                                   <span class=""er"">|</span>  <span class=""dv"">50</span>%</span>
-<span id=""cb22-17""><a href=""#cb22-17"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading file LB12HL_CD.mzML.gz... 0.15 secs </span></span>
-<span id=""cb22-18""><a href=""#cb22-18"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading MS1 data...0.1 secs </span></span>
-<span id=""cb22-19""><a href=""#cb22-19"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading MS2 data...0.02 secs </span></span>
+<span id=""cb22-17""><a href=""#cb22-17"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading file LB12HL_CD.mzML.gz... 0.12 secs </span></span>
+<span id=""cb22-18""><a href=""#cb22-18"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading MS1 data...0.11 secs </span></span>
+<span id=""cb22-19""><a href=""#cb22-19"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading MS2 data...0.01 secs </span></span>
 <span id=""cb22-20""><a href=""#cb22-20"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; </span></span>
 <span id=""cb22-21""><a href=""#cb22-21"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""sc"">|</span>                                                                            </span>
 <span id=""cb22-22""><a href=""#cb22-22"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""er"">|====================================================</span>                  <span class=""er"">|</span>  <span class=""dv"">75</span>%</span>
-<span id=""cb22-23""><a href=""#cb22-23"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading file LB12HL_EF.mzML.gz... 0.22 secs </span></span>
-<span id=""cb22-24""><a href=""#cb22-24"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading MS1 data...0.11 secs </span></span>
+<span id=""cb22-23""><a href=""#cb22-23"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading file LB12HL_EF.mzML.gz... 0.13 secs </span></span>
+<span id=""cb22-24""><a href=""#cb22-24"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading MS1 data...0.1 secs </span></span>
 <span id=""cb22-25""><a href=""#cb22-25"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Reading MS2 data...0.01 secs </span></span>
 <span id=""cb22-26""><a href=""#cb22-26"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; </span></span>
 <span id=""cb22-27""><a href=""#cb22-27"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""sc"">|</span>                                                                            </span>
 <span id=""cb22-28""><a href=""#cb22-28"" aria-hidden=""true"" tabindex=""-1""></a>  <span class=""er"">|======================================================================|</span> <span class=""dv"">100</span>%</span>
-<span id=""cb22-29""><a href=""#cb22-29"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 1.98 secs</span></span></code></pre></div>
+<span id=""cb22-29""><a href=""#cb22-29"" aria-hidden=""true"" tabindex=""-1""></a><span class=""co"">#&gt; Total time: 1.52 secs</span></span></code></pre></div>
 <p>In general, slow file read times can be improved by compressing the data. mzML files are highly compressible, with options to compress both the data itself using the <code>zlib</code> method and the files as a whole using <code>gzip</code>.</p>
 <p><code>gzip</code> is the simplest one to use, as a plethora of methods exist to compress files this way, including online sites. <code>RaMS</code> can read the data directly from a gzipped file, no decompression necessary, so this is an easy way to reduce file size and read times. Sharp-eyed users will have noticed that the demo files are already gzipped, which is part of the reason they are so small.</p>
 <p><code>zlib</code> compression is slightly trickier, and is most often performed with tools such as <a href=""http://proteowizard.sourceforge.net/doc_users.html"">Proteowizard</a>’s <code>msconvert</code> tool with the option “-z”.</p>
@@ -755,7 +766,7 @@ <h3>The nitty-gritty details</h3>
 <p>This ragged shape is also the reason that subsetting mass-spec data by retention time is trivial - grab the scans that correspond to the desired retention times and you’re done. Subsetting by mass, on the other hand, requires decoding each and every scan’s <em>m/z</em> and intensity data. If you’re reading a book and only want a couple chapters, it’s easy to flip to those sections. If you’re looking instead for every time a specific word shows up, you’ve gotta read the whole thing.</p>
 <p>For more information about the mzML data format and its history, check out the specification at <a href=""https://www.psidev.info/mzML"" class=""uri"">https://www.psidev.info/mzML</a>.</p>
 <hr />
-<p>Vignette last built on 2022-08-11</p>
+<p>Vignette last built on 2022-11-04</p>
 </div>
 </div>
 

---FILE: vignettes/Intro-to-RaMS.Rmd---
@@ -290,16 +290,16 @@ a similar neutral loss: one with a mass of 104.0710.
 
 mzMLs can also contain precompiled chromatograms. Version 1.3 of RaMS enabled
 the extraction of these chromatograms just like MS^1^ or MS^2^ data and added
-the new `chroms` slot to hold them. Now, asking for `grab_what = ""everything""`
-or `grab_what = ""chroms""` will create this new slot in the returned object.
+the new `chroms` slot to hold them. However, these need to be requested using
+`grab_what = ""chroms""`and will create this new slot in the returned object.
 Chromatograms are returned as a `data.table` with seven columns: chromatogram 
 type (usually TIC, BPC or SRM info), chromatogram index, target mz, product mz, 
 retention time (rt), and intensity (int). This allows simple plotting of
 various chromatograms such as those returned by MRM:
 
 ```{r, fig.height=3}
 chrom_file <- system.file(""extdata"", ""wk_chrom.mzML.gz"", package = ""RaMS"")
-msdata_chroms <- grabMSdata(chrom_file, verbosity = 0)
+msdata_chroms <- grabMSdata(chrom_file, verbosity = 0, grab_what = ""chroms"")
 given_chrom <- msdata_chroms$chroms[chrom_type==""SRM iletter1""]
 ptitle <- with(given_chrom, paste0(
   unique(chrom_type), "": Target m/z = "", unique(target_mz), ""; Product m/z = "", ",False,True,Rendering / Conversion,6
wkumler,RaMS,1caf9e22621a195be84859158818a1389c8664ac,Ethan Bass,ethanbass@gmail.com,2022-09-17T16:42:42Z,Ethan Bass,ethanbass@gmail.com,2022-09-17T16:42:42Z,"change missing data error to warning

I don't see why the whole function has to error out if it fails to find one of the requested data types",R/grabMSdataCode.R;tests/testthat/test_errors_n_messes.R,False,True,True,False,2,2,4,"---FILE: R/grabMSdataCode.R---
@@ -244,7 +244,7 @@ checkOutputQuality <- function(output_data, grab_what){
   }
   missing_data <- !grab_what%in%names(output_data)
   if(any(missing_data)){
-    stop(paste(""Not all data collected; missing"",
+    warning(paste(""Not all data collected; missing"",
                   paste(grab_what[missing_data], collapse = "", "")))
   }
 

---FILE: tests/testthat/test_errors_n_messes.R---
@@ -25,7 +25,7 @@ test_that(""error if grab_what is weird"", {
 test_that(""checkOutputQuality detects things"", {
   grab_what <- ""everything""
   output_data <- list(MS1=data.table(runif(100)))
-  expect_error(checkOutputQuality(output_data, grab_what))
+  expect_warning(checkOutputQuality(output_data, grab_what))
 
   grab_what <- c(""MS1"", ""MS2"")
   output_data <- list(MS1=data.table(runif(100)), MS2=data.table())",True,False,Implementation / Logic,6
wkumler,RaMS,a421ee5b200a46bbbb8cf8f57fe1a14d080a168e,wkumler,wkumler@uw.edu,2022-08-11T18:33:38Z,wkumler,wkumler@uw.edu,2022-08-11T18:33:38Z,Adding helpful error handling for missing metadata extraction node,R/grabMzmlFunctions.R,False,True,True,False,4,0,4,"---FILE: R/grabMzmlFunctions.R---
@@ -316,6 +316,10 @@ grabMzmlMetadata <- function(xml_data){
 grabMzmlEncodingData <- function(xml_data){
   init_xpath <- ""//*[self::d1:spectrum or self::d1:chromatogram]""
   init_node <- xml2::xml_find_first(xml_data, xpath = init_xpath)
+  if(length(init_node)==0){
+    stop(paste(""Unable to find a spectrum or chromatogram node from"",
+               ""which to extract metadata""))
+  }
   compr_xpath <- paste0('//d1:cvParam[@accession=""MS:1000574""]|',
                         '//d1:cvParam[@accession=""MS:1000576""]')
   compr_node <- xml2::xml_find_first(init_node, compr_xpath)",True,False,Implementation / Logic,6
wkumler,RaMS,a07fc7644ffd13f7ed3127159e00671863a66e6d,Ricardo Cunha,64540212+ricardobachertdacunha@users.noreply.github.com,2022-08-10T09:56:51Z,Ricardo Cunha,64540212+ricardobachertdacunha@users.noreply.github.com,2022-08-10T09:56:51Z,"Getting encoding for mzML only when needed

Getting file metadata, BPC/TIC does not require encoding. Also getting chromatograms (to be suggested) can require different encoding. An error is given if no spectra are present, such as the case of mzML files with only chromatograms (SRM, MRM, or SIM). This would prevents the error but a better solution could be implemented.",R/grabMzmlFunctions.R,False,True,True,False,4,1,5,"---FILE: R/grabMzmlFunctions.R---
@@ -83,7 +83,6 @@ grabMzmlData <- function(filename, grab_what, verbosity=0,
   checkFileType(xml_data, ""mzML"")
   rtrange <- checkRTrange(rtrange)
   prefilter <- checkProvidedPrefilter(prefilter)
-  file_metadata <- grabMzmlEncodingData(xml_data)
 
   output_data <- list()
 
@@ -96,6 +95,10 @@ grabMzmlData <- function(filename, grab_what, verbosity=0,
     grab_what <- c(""MS1"", ""MS2"", ""BPC"", ""TIC"", ""metadata"")
   }
 
+  if(TRUE%in%(c(""MS1"", ""MS2"", ""EIC"", ""EIC_MS2"")%in%grab_what)){
+    file_metadata <- grabMzmlEncodingData(xml_data)
+  }
+
   if(""MS1""%in%grab_what){
     if(verbosity>1)last_time <- timeReport(last_time, text = ""Reading MS1 data..."")
     output_data$MS1 <- grabMzmlMS1(xml_data = xml_data, rtrange = rtrange,",True,False,Implementation / Logic,3
wkumler,RaMS,fbc2d5d1a2015d4a262040faf04f59cfd01a1fe2,wkumler,wkumler@uw.edu,2022-04-23T01:00:32Z,wkumler,wkumler@uw.edu,2022-04-23T01:00:32Z,Fixing the missing data in the .wiff files,R/grabMSdataCode.R;R/grabMzmlFunctions.R,False,True,True,False,5,6,11,"---FILE: R/grabMSdataCode.R---
@@ -117,10 +117,11 @@ grabMSdata <- function(files, grab_what=""everything"", verbosity=NULL,
     }
 
     # Check for missing files before creating object
-    file_exists <- file.exists(files)
+    url_files <- grepl(x = files, ""^(http|ftp)"")
+    file_exists <- file.exists(files[!url_files])
     if(!all(file_exists)){
       stop(paste(""Unable to find all files, e.g.\n"",
-                 paste(head(files[!file_exists]), collapse = ""\n "")))
+                 paste(head(files[!url_files][!file_exists]), collapse = ""\n "")))
     }
 
     # Create a list object to hide connection values and allow

---FILE: R/grabMzmlFunctions.R---
@@ -304,8 +304,7 @@ grabMzmlEncodingData <- function(xml_data){
 #' @return A `data.table` with columns for retention time (rt), m/z (mz), and
 #'   intensity (int).
 grabMzmlMS1 <- function(xml_data, rtrange, file_metadata, prefilter){
-  ms1_xpath <- paste0('//d1:spectrum[d1:cvParam[@name=""ms level"" and ',
-                      '@value=""1""]][d1:cvParam[@name=""base peak intensity""]]')
+  ms1_xpath <- '//d1:spectrum[d1:cvParam[@name=""ms level"" and @value=""1""]]'
   ms1_nodes <- xml2::xml_find_all(xml_data, ms1_xpath)
   if(!length(ms1_nodes)){
     return(data.table(rt=numeric(), mz=numeric(), int=numeric()))
@@ -342,8 +341,7 @@ grabMzmlMS1 <- function(xml_data, rtrange, file_metadata, prefilter){
 #'   (mz), fragment m/z (fragmz), collision energy (voltage), and intensity
 #'   (int).
 grabMzmlMS2 <- function(xml_data, rtrange, file_metadata){
-  ms2_xpath <- paste0('//d1:spectrum[d1:cvParam[@name=""ms level"" and ',
-                      '@value=""2""]][d1:cvParam[@name=""base peak intensity""]]')
+  ms2_xpath <- '//d1:spectrum[d1:cvParam[@name=""ms level"" and @value=""2""]]'
 
   ms2_nodes <- xml2::xml_find_all(xml_data, ms2_xpath)
   if(!length(ms2_nodes)){",True,False,Implementation / Logic,6
wkumler,RaMS,146fe2b5e1ba7802306607df200db42a7bd04a9e,wkumler,wkumler@uw.edu,2022-02-14T23:23:48Z,wkumler,wkumler@uw.edu,2022-02-14T23:23:48Z,"Fixed prefilter check, now defaults don't throw warning",R/grabMSdataCode.R,False,True,True,False,3,3,6,"---FILE: R/grabMSdataCode.R---
@@ -104,12 +104,12 @@ grabMSdata <- function(files, grab_what=""everything"", verbosity=NULL,
     if(!is.null(ppm)){
       warning(""Argument 'ppm' has no function when used with tmzML files, ignoring"")
     }
-    if(!is.null(prefilter)){
-      warning(""Argument 'prefilter' has no function when used with tmzML files, ignoring"")
-    }
     if(!is.null(rtrange)){
       warning(""Argument 'rtrange' has no function when used with tmzML files, ignoring"")
     }
+    if(prefilter>-1){
+      warning(""Argument 'prefilter' has no function when used with tmzML files, ignoring"")
+    }
 
     # Handle null verbosity flag with intelligent defaults
     if(is.null(verbosity)){",True,False,Implementation / Logic,6
wkumler,RaMS,bc2238b8a4efc1c1869f8511e84f0c282fc07c37,wkumler,wkumler@uw.edu,2022-02-14T23:20:24Z,wkumler,wkumler@uw.edu,2022-02-14T23:20:24Z,Fixed error bar bug when no MS2 data found,R/tmzMLFunctions.R;tests/testthat/test_tmzML_things.R,False,True,True,False,2,2,4,"---FILE: R/tmzMLFunctions.R---
@@ -82,7 +82,7 @@ tmzmlMaker <- function(input_filename, output_filename=NULL,
     message(""Indexing MS2 data by m/z..."")
   }
   split_MS2_mzs <- split(msdata$MS2, msdata$MS2$cat)
-  if(verbosity>1){
+  if(verbosity>1 & nrow(msdata$MS2)>0){
     pb <- txtProgressBar(max = length(split_MS2_mzs), style = 3)
     for(i in seq_along(split_MS2_mzs)){
       addMS2(split_MS2_mzs[[i]], ms2_node)

---FILE: tests/testthat/test_tmzML_things.R---
@@ -7,7 +7,7 @@ tmzml_filename <- gsub(x = output_filename, ""\\.mzML.*"", "".tmzML"")
 output_filenames <- paste(output_folder, basename(mzML_filenames), sep = ""/"")
 tmzml_filenames <- gsub(x = output_filenames, ""\\.mzML.*"", "".tmzML"")
 
-mapply(tmzmlMaker, mzML_filenames, tmzml_filenames, verbosity==2)
+mapply(tmzmlMaker, mzML_filenames, tmzml_filenames, verbosity=2)
 
 test_that(""tmzML conversion works for mzMLs"", {
   expect_identical(tmzmlMaker(",True,False,Implementation / Logic,6
wkumler,RaMS,93c1cf6da45709632388275de994fd54ee41058d,wkumler,wkumler@uw.edu,2022-02-14T22:41:11Z,wkumler,wkumler@uw.edu,2022-02-14T22:41:11Z,Now throws error when msdata object is made with missing files,R/grabMSdataCode.R;tests/testthat/test_tmzML_things.R,False,True,True,False,16,3,19,"---FILE: R/grabMSdataCode.R---
@@ -104,6 +104,13 @@ grabMSdata <- function(files, grab_what=""everything"", verbosity=NULL,
       verbosity <- ifelse(length(files)==1, 0, 1)
     }
 
+    # Check for missing files before creating object
+    file_exists <- file.exists(files)
+    if(!all(file_exists)){
+      stop(paste(""Unable to find all files, e.g.\n"",
+                 paste(head(files[!file_exists]), collapse = ""\n "")))
+    }
+
     # Create a list object to hide connection values and allow
     # RStudio to autocomplete MS1 and MS2
     msdata_con <- vector(""list"", length = length(grab_what)+1)

---FILE: tests/testthat/test_tmzML_things.R---
@@ -50,9 +50,6 @@ test_that(""Requesting connection returns expected"", {
   expect_named(msdata$connection, c(""files"", ""grab_what"", ""verbosity""))
 })
 
-
-
-
 test_that(""Verbosity flags work"", {
   expect_silent(grabMSdata(tmzml_filename)$MS1[mz%between%pmppm(118.0865)])
   expect_silent(grabMSdata(tmzml_filename, verbosity = 0)$MS1[mz%between%pmppm(118.0865)])
@@ -62,4 +59,13 @@ test_that(""Verbosity flags work"", {
   expect_output(grabMSdata(tmzml_filenames)$MS1[mz%between%pmppm(118.0865)])
 })
 
+test_that(""tmzML files not found throw error"", {
+  expect_error(grabMSdata(""blah.tmzML""))
+  expect_error(grabMSdata(c(""blah.tmzML"", ""blah2.tmzML"")))
+})
+
+test_that(""mz(X)ML and tmzML mixing throws error"", {
+  expect_error(grabMSdata(c(mzML_filenames, tmzml_filename)))
+})
+
 unlink(output_folder, recursive = TRUE, force = TRUE)",True,False,Implementation / Logic,6
wkumler,RaMS,c6d60b9db1b0789e43570fd6e1370a9706eabd25,wkumler,wkumler@uw.edu,2022-02-14T19:15:33Z,wkumler,wkumler@uw.edu,2022-02-14T19:15:33Z,Improving missing error message,R/tmzMLFunctions.R,False,True,True,False,2,2,4,"---FILE: R/tmzMLFunctions.R---
@@ -186,8 +186,8 @@ node2dt <- function(dubset_node, ms_level){
   if(ms_level%in%msdata_obj[[""grab_what""]]){
     msdata_obj[[""grab_what""]] <- ms_level
   } else {
-    stop(paste0(""It doesn't look like you requested grab_what = '"", ms_level,
-                ""'when you created this object.""))
+    stop(paste0(""It doesn't look like you requested '"", ms_level,
+                ""' with grab_what when you created this object.""))
   }
   return(msdata_obj)
 }",True,False,Implementation / Logic,6
wkumler,RaMS,fa4ae85890ee4838e0f0f31fc7ffd5356d9cdd2c,wkumler,wkumler@uw.edu,2021-11-09T23:19:20Z,wkumler,wkumler@uw.edu,2021-11-09T23:34:35Z,"Fixing typos, yikes",R/tmzMLFunctions.R,False,True,True,False,4,4,8,"---FILE: R/tmzMLFunctions.R---
@@ -36,7 +36,7 @@ addMS2 <- function(dubset, ms2_node){
 tmzmlMaker <- function(input_filename, output_filename=NULL,
                        verbosity=0, binwidth=3){
   if(is.null(output_filename)){
-    output_filename <- gsub(""\\.mzML"", ""\\.tmzML"", input_filename)
+    output_filename <- gsub(""\\.mzX?ML"", "".tmzML"", input_filename)
   }
 
   if(verbosity>0){
@@ -80,14 +80,14 @@ tmzmlMaker <- function(input_filename, output_filename=NULL,
   }
   split_MS2_mzs <- split(msdata$MS2, msdata$MS2$cat)
   if(verbosity>1){
-    pb <- txtProgressBar(max = length(split_MS1_mzs), style = 3)
-    for(i in seq_along(split_MS1_mzs)){
+    pb <- txtProgressBar(max = length(split_MS2_mzs), style = 3)
+    for(i in seq_along(split_MS2_mzs)){
       addMS2(split_MS2_mzs[[i]], ms2_node)
       setTxtProgressBar(pb, i)
     }
     close(pb)
   } else {
-    for(i in seq_along(split_MS1_mzs)){
+    for(i in seq_along(split_MS2_mzs)){
       addMS2(split_MS2_mzs[[i]], ms2_node)
     }
   }",True,False,Implementation / Logic,6
wkumler,RaMS,8611319ec26a4a0e1809d0eb168f38333f6b8356,wkumler,wkumler@uw.edu,2021-10-21T23:35:46Z,wkumler,wkumler@uw.edu,2021-10-21T23:35:46Z,Fixed somehow corrupted mzML file,inst/extdata/LB12HL_AB.mzML.gz,False,False,False,False,0,0,0,,False,False,Rendering / Conversion,0
wkumler,RaMS,b5b2960bb4c3ecb7d673224f93f63533dc708bd0,wkumler,wkumler@uw.edu,2021-10-20T19:24:51Z,wkumler,wkumler@uw.edu,2021-10-20T19:24:51Z,"Fixed missing nodes when empty binary string by searching only for the binary, not for binary nodes that contain text",R/minifyMSFunctions.R,False,True,True,False,2,2,4,"---FILE: R/minifyMSFunctions.R---
@@ -163,9 +163,9 @@ minifyMzml <- function(filename, output_filename, ppm,
   ms1_xpath <- paste0('//d1:spectrum[d1:cvParam[@name=""ms level"" and ',
                       '@value=""1""]][d1:cvParam[@name=""base peak intensity""]]')
   ms1_nodes <- xml2::xml_find_all(xml_data, ms1_xpath)
-  mz_xpath <- 'd1:binaryDataArrayList/d1:binaryDataArray[1]/d1:binary//text()'
+  mz_xpath <- 'd1:binaryDataArrayList/d1:binaryDataArray[1]/d1:binary'
   ms1_mz_nodes <- xml2::xml_find_all(ms1_nodes, mz_xpath)
-  int_xpath <- 'd1:binaryDataArrayList/d1:binaryDataArray[2]/d1:binary//text()'
+  int_xpath <- 'd1:binaryDataArrayList/d1:binaryDataArray[2]/d1:binary'
   ms1_int_nodes <- xml2::xml_find_all(ms1_nodes, int_xpath)
 
   # Convert MS1 nodes into data.tables",True,False,Implementation / Logic,3
wkumler,RaMS,53819939c4af5522249f22c58be1ee43a68cc233,wkumler,wkumler@uw.edu,2021-10-19T16:30:30Z,wkumler,wkumler@uw.edu,2021-10-19T16:30:30Z,Fixed NULL ppm error,R/minifyMSFunctions.R,False,True,True,False,15,12,27,"---FILE: R/minifyMSFunctions.R---
@@ -23,14 +23,19 @@ minifyMSdata <- function(files, output_filenames=NULL, mz_blacklist=NULL,
     }
   }
 
+  # Check that ppm is not NULL
+  if(is.null(ppm)){
+    stop(""`ppm` must be provided by the user, but seems to still be NULL."")
+  }
+
   # Warn if originals are going to be overwritten
   if(is.null(output_filenames)){
     output_filenames <- files
   }
   if(all(sort(files)==sort(output_filenames))){
     warning(paste(""Output files would overwrite originals:"",
                   ""adding '_mini' to each output filename""))
-    output_filenames <- gsub(""\\.(?=mz[X]ML$)"", replacement = ""_mini\\."",
+    output_filenames <- gsub(""\\.(?=mz[X]?ML)"", replacement = ""_mini\\."",
                              output_filenames, perl = TRUE)
   }
 
@@ -59,18 +64,16 @@ minifyMSdata <- function(files, output_filenames=NULL, mz_blacklist=NULL,
     start_time <- Sys.time()
   }
   for(i in seq_along(files)){
-    filename <- files[i]
-
-    if(grepl(""mzML"", basename(filename), ignore.case = TRUE)){
-      minifyMzml(filename, output_filename = output_filenames[i],
+    if(grepl(""mzML"", basename(files[i]), ignore.case = TRUE)){
+      minifyMzml(files[i], output_filename = output_filenames[i],
                  mz_blacklist = mz_blacklist, mz_whitelist = mz_whitelist,
                  ppm = ppm, warn = warn, prefilter = prefilter)
-    } else if(grepl(""mzXML"", basename(filename), ignore.case = TRUE)){
-      minifyMzxml(filename, output_filename = output_filenames[i],
+    } else if(grepl(""mzXML"", basename(files[i]), ignore.case = TRUE)){
+      minifyMzxml(files[i], output_filename = output_filenames[i],
                   mz_blacklist = mz_blacklist, mz_whitelist = mz_whitelist,
                   ppm = ppm, prefilter = prefilter)
     } else {
-      stop(paste(""Unable to determine file type for"", filename))
+      stop(paste(""Unable to determine file type for"", files[i]))
     }
     if(verbosity>0 & length(files)>=2){
       setTxtProgressBar(pb, i)
@@ -137,9 +140,9 @@ minifyMSdata <- function(files, output_filenames=NULL, mz_blacklist=NULL,
 #' minifyMzml(filename, output_filename, mz_blacklist=exclude_mzs, ppm=5)
 #' unlink(output_filename)
 #' }
-minifyMzml <- function(filename, output_filename,
+minifyMzml <- function(filename, output_filename, ppm,
                        mz_blacklist=NULL, mz_whitelist=NULL,
-                       ppm=NULL, warn=TRUE, prefilter=-1){
+                       warn=TRUE, prefilter=-1){
   xml_data <- xml2::read_xml(filename)
 
   checkFileType(xml_data, ""mzML"")
@@ -358,8 +361,8 @@ minifyMzml <- function(filename, output_filename,
 #' minifyMzxml(filename, output_filename, mz_blacklist=exclude_mzs, ppm=5)
 #' unlink(output_filename)
 #' }
-minifyMzxml <- function(filename, output_filename, mz_blacklist=NULL,
-                        mz_whitelist=NULL, ppm=NULL, prefilter=-1){
+minifyMzxml <- function(filename, output_filename, ppm, mz_blacklist=NULL,
+                        mz_whitelist=NULL, prefilter=-1){
   xml_data <- xml2::read_xml(filename)
 
   checkFileType(xml_data, ""mzXML"")",True,False,Implementation / Logic,6
wkumler,RaMS,b9d7f078462d29607e8f22cc5f387abfd572dc42,wkumler,wkumler@uw.edu,2021-10-14T22:28:36Z,wkumler,wkumler@uw.edu,2021-10-14T22:28:36Z,Fixed bug with wrong column name,R/minifyMSFunctions.R,False,True,True,False,2,5,7,"---FILE: R/minifyMSFunctions.R---
@@ -198,13 +198,10 @@ minifyMzml <- function(filename, output_filename,
         iterated_ints <- iterated_ints[!iterate_idxs]
       }
       output_mat <- cbind(mzs=iterated_mzs, ints=iterated_ints)
-      if(any(is.na(output_mat))){
-        browser(""Found you an NA:"")
-      }
     } else {
       stop(""Either `mz_whitelist` or `mz_blacklist` must not be NULL"")
     }
-    subfilter_idxs <- output_mat[,""int""]<prefilter
+    subfilter_idxs <- output_mat[,""ints""]<prefilter
     output_mat <- output_mat[!subfilter_idxs,]
     if(nrow(output_mat)==0){
       recoded_mzs <- """"
@@ -409,7 +406,7 @@ minifyMzxml <- function(filename, output_filename, mz_blacklist=NULL,
     } else {
       stop(""Either `mz_whitelist` or `mz_blacklist` must not be NULL"")
     }
-    subfilter_idxs <- output_mat[,""int""]<prefilter
+    subfilter_idxs <- output_mat[,""ints""]<prefilter
     output_mat <- output_mat[!subfilter_idxs,]
     if(nrow(output_mat)==0){
       recoded_mzints <- """"",True,False,Implementation / Logic,6
wkumler,RaMS,09742bb4f671a436d2508680354495f1181588a1,wkumler,wkumler@uw.edu,2021-10-07T23:12:38Z,wkumler,wkumler@uw.edu,2021-10-07T23:12:38Z,"Fixed bug where warn=TRUE disabled index drop, not just warning",R/minifyMzmlFunctions.R,False,True,True,False,7,6,13,"---FILE: R/minifyMzmlFunctions.R---
@@ -58,10 +58,12 @@ minifyMzml <- function(filename, output_filename,
   file_metadata <- RaMS:::grabMzmlEncodingData(xml_data)
 
   # Check for indexed mzML and drop index if present, with warning
-  if(xml2::xml_name(xml_data)==""indexedmzML"" && warn){
-    warning(paste0(""mzML file "", basename(filename), "" contains an index. "",
-                   ""I don't know how to recompile indices so it's "",
-                   ""getting dropped for the minified file.""))
+  if(xml2::xml_name(xml_data)==""indexedmzML""){
+    if(warn){
+      warning(paste0(""mzML file "", basename(filename), "" contains an index. "",
+                     ""I don't know how to recompile indices so it's "",
+                     ""getting dropped for the minified file.""))
+    }
     xml_data <- xml2::xml_new_root(xml2::xml_find_first(xml_data, ""//d1:mzML""))
   }
 
@@ -214,7 +216,7 @@ minifyMzml <- function(filename, output_filename,
 
 
 
-
+# Helper functions ----
 #' Convert from compressed binary to R numeric vector
 #'
 #' @param mzint_nodes The XML nodes containing the compressed binary string
@@ -241,4 +243,3 @@ giveEncoding <- function(mzint_vals, compression_type, bin_precision){
   new_raw_ints <- memCompress(comp_ints, type=compression_type)
   base64enc::base64encode(new_raw_ints)
 }
-",True,False,Implementation / Logic,6
wkumler,RaMS,58d7e551f8b4ad0a860461f8f87a601cd5b91e2c,wkumler,wkumler@uw.edu,2021-10-07T22:17:04Z,wkumler,wkumler@uw.edu,2021-10-07T22:17:55Z,Still fixing n==2 progressbar bug!,R/grabMSdataCode.R,False,True,True,False,2,2,4,"---FILE: R/grabMSdataCode.R---
@@ -141,12 +141,12 @@ grabMSdata <- function(files, grab_what=""everything"", verbosity=NULL,
     }, dt_i=out_data, fname_i=basename(filename), SIMPLIFY = FALSE)
     all_file_data[[i]] <- out_data_filenamed
     names(all_file_data)[[i]] <- basename(filename)
-    if(verbosity>0 & length(files)>2){
+    if(verbosity>0 & length(files)>=2){
       setTxtProgressBar(pb, i)
     }
   }
   if(verbosity>0){
-    if(length(files)>2){
+    if(length(files)>=2){
       close(pb)
     }
   }",True,False,Implementation / Logic,6
wkumler,RaMS,09ce15b4df5ace2732274a4bbc72262ec0023272,wkumler,wkumler@uw.edu,2021-10-07T20:14:57Z,wkumler,wkumler@uw.edu,2021-10-07T20:14:57Z,"Fixed `output_mat[, ""mzs""] subscript oob` bug",R/minifyMzmlFunctions.R,False,True,True,False,1,1,2,"---FILE: R/minifyMzmlFunctions.R---
@@ -88,7 +88,7 @@ minifyMzml <- function(filename, output_filename,
         mz_idxs <- mzs>min(range_i)&mzs<max(range_i)
         ints <- ints[mz_idxs]
         mzs <- mzs[mz_idxs]
-        c(mzs=mzs, ints=ints)
+        cbind(mzs=mzs, ints=ints)
       })
       if(all(sapply(whitelist_data, length)==0)){
         output_mat <- cbind(mzs=numeric(0), ints=numeric(0))",True,False,Implementation / Logic,3
wkumler,RaMS,47e41c327b7655ec97ce9de5b48d8ebc986227ea,wkumler,wkumler@uw.edu,2021-10-06T00:07:50Z,wkumler,wkumler@uw.edu,2021-10-06T00:07:50Z,Fixed bug where progress bar wouldn't render with exactly 2 files,R/grabMSdataCode.R,False,True,True,False,1,1,2,"---FILE: R/grabMSdataCode.R---
@@ -97,7 +97,7 @@ grabMSdata <- function(files, grab_what=""everything"", verbosity=NULL,
     verbosity <- ifelse(length(files)==1, 2, 1)
   }
   if(verbosity>0){
-    if(length(files)>2){
+    if(length(files)>=2){
       pb <- txtProgressBar(min = 0, max = length(files), style = 3)
     }
     start_time <- Sys.time()",True,False,Implementation / Logic,6
wkumler,RaMS,8040c782c8c5cd6be4c5ac6e093b02d1afe7964f,wkumler,wkumler@uw.edu,2021-03-18T01:11:34Z,wkumler,wkumler@uw.edu,2021-03-18T01:11:34Z,Removing incorrect whitespace?,.github/workflows/r-check-cran.yml,False,False,False,False,1,1,2,"---FILE: .github/workflows/r-check-cran.yml---
@@ -64,7 +64,7 @@ jobs:
           done < <(Rscript -e 'writeLines(remotes::system_requirements(""ubuntu"", ""20.04""))')
       - name: Install dependencies
         run: |
-	  install.packages(""stringi"")
+          install.packages(""stringi"")
           remotes::install_deps(dependencies = TRUE)
           remotes::install_cran(""rcmdcheck"")
         shell: Rscript {0}",False,False,Data / Input Handling,3
wkumler,RaMS,46e9400a2e8403451b89aa3030bf27936696129c,wkumler,wkumler@uw.edu,2021-03-18T01:07:37Z,wkumler,wkumler@uw.edu,2021-03-18T01:07:37Z,"Updated GitHub workflow to install stringi manually, hopefully solving compile error on Ubuntu",.github/workflows/r-check-cran.yml,False,False,False,False,1,0,1,"---FILE: .github/workflows/r-check-cran.yml---
@@ -64,6 +64,7 @@ jobs:
           done < <(Rscript -e 'writeLines(remotes::system_requirements(""ubuntu"", ""20.04""))')
       - name: Install dependencies
         run: |
+	  install.packages(""stringi"")
           remotes::install_deps(dependencies = TRUE)
           remotes::install_cran(""rcmdcheck"")
         shell: Rscript {0}",False,False,Dependency / Package,4
wkumler,RaMS,e44d6381df40a3e12af4449c82f92f2b7295d4a3,wkumler,wkumler@uw.edu,2021-03-17T18:34:54Z,wkumler,wkumler@uw.edu,2021-03-17T18:34:54Z,Added chunk names to correct warnings== error,README.md;man/figures/README-isoexampleplot-1.png;man/figures/README-plotfragdata-1.png;man/figures/README-showbaseplot-1.png;man/figures/README-showggplot-1.png,False,False,False,False,80,15,95,"---FILE: README.md---
@@ -88,7 +88,7 @@ knitr::kable(head(msdata$BPC, 3))
 plot(msdata$BPC$rt, msdata$BPC$int, type = ""l"")
 ```
 
-![](man/figures/README-unnamed-chunk-5-1.png)<!-- -->
+![](man/figures/README-showbaseplot-1.png)<!-- -->
 
 ``` r
 library(ggplot2)
@@ -98,7 +98,7 @@ ggplot(msdata$BPC) + geom_line(aes(x = rt, y=int, color=filename)) +
   theme(legend.position=""top"")
 ```
 
-![](man/figures/README-unnamed-chunk-6-1.png)<!-- -->
+![](man/figures/README-showggplot-1.png)<!-- -->
 
 #### MS1 data:
 
@@ -123,11 +123,7 @@ giving us some clue as to its molecular formula.
 ``` r
 library(data.table)
 library(tidyverse)
-```
-
-    ## Warning: package 'tibble' was built under R version 4.0.4
 
-``` r
 M <- 118.0865
 M_13C <- M + 1.003355
 M_15N <- M + 0.997035
@@ -151,20 +147,27 @@ iso_data %>%
   knitr::kable()
 ```
 
-    ## `summarise()` has grouped output by 'filename'. You can override using the `.groups` argument.
-
 | isotope | avg\_ratio | sd\_ratio |
 |:--------|-----------:|----------:|
 | 13C     |  0.0543929 | 0.0006015 |
 | 15N     |  0.0033375 | 0.0001846 |
 
+With [natural
+abundances](https://en.wikipedia.org/wiki/Natural_abundance) for
+<sup>13</sup>C and <sup>15</sup>N of 1.11% and 0.36%, respectively, we
+can conclude that this molecule likely has five carbons and a single
+nitrogen.
+
+Of course, it’s always a good idea to plot the peaks and perform a
+manual check of data quality:
+
 ``` r
 ggplot(iso_data) +
   geom_line(aes(x=rt, y=int, color=filename)) +
   facet_wrap(~isotope, scales = ""free_y"", ncol = 1)
 ```
 
-![](man/figures/README-warning==FALSE-1.png)<!-- -->
+![](man/figures/README-isoexampleplot-1.png)<!-- -->
 
 #### MS2 data:
 
@@ -183,7 +186,7 @@ msdata$MS2[premz%between%pmppm(118.0865) & int>mean(int)] %>%
   plot(int~fragmz, type=""h"", data=., ylab=""Intensity"", xlab=""Fragment m/z"")
 ```
 
-![](man/figures/README-unnamed-chunk-9-1.png)<!-- -->
+![](man/figures/README-plotfragdata-1.png)<!-- -->
 
 Or want to search for a specific neutral loss:
 
@@ -192,10 +195,72 @@ msdata$MS2[, neutral_loss:=premz-fragmz] %>%
   filter(neutral_loss%between%pmppm(60.02064, 5))
 ```
 
-    ##         rt    premz    fragmz        int voltage         filename neutral_loss
-    ## 1: 4.13587 169.1222 109.10166   5582.765      35 DDApos_2.mzML.gz     60.02054
-    ## 2: 7.04086 118.0865  58.06591 214222.156      35 DDApos_2.mzML.gz     60.02064
-    ## 3: 8.09109 132.1020  72.08141   1248.639      35 DDApos_2.mzML.gz     60.02058
+    ##           rt    premz    fragmz          int voltage         filename
+    ##  1: 4.182333 118.0864  58.06590   390179.500      35 DDApos_2.mzML.gz
+    ##  2: 4.276100 116.0709  56.05036     1093.988      35 DDApos_2.mzML.gz
+    ##  3: 4.521367 118.0864  58.06589   343084.000      35 DDApos_2.mzML.gz
+    ##  4: 4.649867 170.0810 110.06034     4792.479      35 DDApos_2.mzML.gz
+    ##  5: 4.857983 118.0865  58.06590   314075.312      35 DDApos_2.mzML.gz
+    ##  6: 5.195617 118.0865  58.06590   282611.688      35 DDApos_2.mzML.gz
+    ##  7: 5.536383 118.0865  58.06592   300432.906      35 DDApos_2.mzML.gz
+    ##  8: 5.642417 116.0709  56.05035     1985.602      35 DDApos_2.mzML.gz
+    ##  9: 5.719433 138.0550  78.03460     1749.604      35 DDApos_2.mzML.gz
+    ## 10: 5.876633 118.0865  58.06593   336346.625      35 DDApos_2.mzML.gz
+    ## 11: 6.063700 138.0549  78.03448  4783814.000      35 DDApos_2.mzML.gz
+    ## 12: 6.197033 119.0899  59.06926     1459.779      35 DDApos_2.mzML.gz
+    ## 13: 6.214217 118.0865  58.06592    87062.281      35 DDApos_2.mzML.gz
+    ## 14: 6.399933 138.0549  78.03451  4311163.000      35 DDApos_2.mzML.gz
+    ## 15: 6.552300 118.0865  58.06591   188614.250      35 DDApos_2.mzML.gz
+    ## 16: 6.569983 174.1125 114.09184     4416.066      35 DDApos_2.mzML.gz
+    ## 17: 6.648017 119.0899  59.06929     7744.978      35 DDApos_2.mzML.gz
+    ## 18: 6.739650 138.0550  78.03453    45146.910      35 DDApos_2.mzML.gz
+    ## 19: 6.889233 118.0865  58.06590   247183.109      35 DDApos_2.mzML.gz
+    ## 20: 7.080050 138.0550  78.03455    15764.113      35 DDApos_2.mzML.gz
+    ## 21: 7.232333 118.0865  58.06590   317423.344      35 DDApos_2.mzML.gz
+    ## 22: 7.418867 138.0550  78.03444     5292.677      35 DDApos_2.mzML.gz
+    ## 23: 7.571183 118.0865  58.06591  1110205.500      35 DDApos_2.mzML.gz
+    ## 24: 7.913200 118.0863  58.06591 53963628.000      35 DDApos_2.mzML.gz
+    ## 25: 8.094183 148.0425  88.02216     1632.094      35 DDApos_2.mzML.gz
+    ## 26: 8.197183 162.1124 102.09158     1861.552      35 DDApos_2.mzML.gz
+    ## 27: 8.250383 118.0864  58.06590  3601956.250      35 DDApos_2.mzML.gz
+    ## 28: 8.262433 119.0835  59.06298    17410.162      35 DDApos_2.mzML.gz
+    ## 29: 8.576400 130.0863  70.06579     7045.373      35 DDApos_2.mzML.gz
+    ## 30: 8.585383 118.0864  58.06588  1340395.125      35 DDApos_2.mzML.gz
+    ## 31: 8.925200 118.0864  58.06589   920915.938      35 DDApos_2.mzML.gz
+    ##           rt    premz    fragmz          int voltage         filename
+    ##     neutral_loss
+    ##  1:     60.02055
+    ##  2:     60.02050
+    ##  3:     60.02056
+    ##  4:     60.02070
+    ##  5:     60.02057
+    ##  6:     60.02057
+    ##  7:     60.02060
+    ##  8:     60.02058
+    ##  9:     60.02043
+    ## 10:     60.02057
+    ## 11:     60.02037
+    ## 12:     60.02066
+    ## 13:     60.02054
+    ## 14:     60.02039
+    ## 15:     60.02060
+    ## 16:     60.02068
+    ## 17:     60.02063
+    ## 18:     60.02046
+    ## 19:     60.02060
+    ## 20:     60.02043
+    ## 21:     60.02058
+    ## 22:     60.02058
+    ## 23:     60.02056
+    ## 24:     60.02042
+    ## 25:     60.02038
+    ## 26:     60.02086
+    ## 27:     60.02052
+    ## 28:     60.02054
+    ## 29:     60.02052
+    ## 30:     60.02055
+    ## 31:     60.02052
+    ##     neutral_loss
 
 ## File types
 
@@ -238,4 +303,4 @@ Issues page](https://github.com/wkumler/RaMS/issues).
 
 ------------------------------------------------------------------------
 
-README last built on 2021-03-14
+README last built on 2021-03-17",False,False,Documentation / Formatting,6
wkumler,RaMS,9a0f60bab85481cab4a7ff94e7961299377e6b35,wkumler,wkumler@uw.edu,2021-03-17T16:18:12Z,wkumler,wkumler@uw.edu,2021-03-17T16:18:12Z,Minor corrections pre-publication,vignettes/RaMS-and-friends.Rmd,True,False,True,False,9,3,12,"---FILE: vignettes/RaMS-and-friends.Rmd---
@@ -9,9 +9,15 @@ vignette: >
 
 ```{r setup, include = FALSE}
 options(rmarkdown.html_vignette.check_title = FALSE)
-
 ```
 
+**Table of contents:**
+
+* [Standard export to CSV]
+* [Fancier export to Excel]
+* [Exporting to SQL database]
+* [Interfacing with Python via `reticulate`]
+
 
 The strength of `RaMS` is its simple data format. Table-like data structures are
 common in most programming languages, and they can always be converted to the
@@ -32,10 +38,10 @@ library(RaMS)
 single_file <- system.file(""extdata"", ""LB12HL_AB.mzML.gz"", package = ""RaMS"")
 
 # Grab the MS data
-file_data <- grabMSdata(single_file, grab_what = ""everything"")
+msdata <- grabMSdata(single_file, grab_what = ""everything"")
 
 # Write out MS1 data to .csv file
-write.csv(x = file_data$MS1, file = ""MS1_data.csv"")
+write.csv(x = msdata$MS1, file = ""MS1_data.csv"")
 
 # Clean up afterward
 file.remove(""MS1_data.csv"")",False,True,Rendering / Conversion,3
wkumler,RaMS,662dc6b634a2b1caad5dc488d0c490e389caf5a1,wkumler,wkumler@uw.edu,2021-03-16T16:42:37Z,wkumler,wkumler@uw.edu,2021-03-16T16:42:37Z,Giving up on Python demo - too many weird conda issues during CHECK on GitHub Actions,.github/workflows/r-check-cran.yml;vignettes/RaMS-and-friends.Rmd,True,False,True,False,5,10,15,"---FILE: .github/workflows/r-check-cran.yml---
@@ -24,6 +24,7 @@ jobs:
         config:
           - {os: windows-latest, r: 'release'}
           - {os: macOS-latest, r: 'release'}
+          - {os: ubuntu-latest, r: 'release'}
 
     env:
       R_REMOTES_NO_ERRORS_FROM_WARNINGS: true
@@ -39,15 +40,6 @@ jobs:
 
       - uses: r-lib/actions/setup-pandoc@v1
 
-      - name: Set up Python ${{ matrix.python-version }}
-        uses: actions/setup-python@v2
-        with:
-          python-version: ${{ matrix.python-version }}
-      - name: Install python dependencies
-        run: |
-          python -m pip install --upgrade pip
-          pip install matplotlib seaborn
-
       - name: Query dependencies
         run: |
           install.packages('remotes')

---FILE: vignettes/RaMS-and-friends.Rmd---
@@ -122,7 +122,10 @@ msdata <- grabMSdata(files = file_paths, grab_what = ""BPC"")$BPC
 
 ### Python code chunk: {python}
 
-```{python, fig.height=3}
+```{python, fig.height=3, eval=FALSE}
+# Not run to pass R CMD check on GitHub
+# Make sure python, matplotlib, and seaborn are installed
+
 import seaborn as sns
 import matplotlib.pyplot as plt
 ",False,True,Rendering / Conversion,6
wkumler,RaMS,76e16682b2885c981c64bb4758bd6da36cb33f09,wkumler,wkumler@uw.edu,2021-03-16T16:26:13Z,wkumler,wkumler@uw.edu,2021-03-16T16:29:38Z,Updating .yml to fix CRAN warnings and unable to find python errors,.github/workflows/r-check-cran.yml;vignettes/Intro-to-RaMS.Rmd;vignettes/RaMS-and-friends.Rmd,True,False,True,False,21,5,26,"---FILE: .github/workflows/r-check-cran.yml---
@@ -39,6 +39,15 @@ jobs:
 
       - uses: r-lib/actions/setup-pandoc@v1
 
+      - name: Set up Python ${{ matrix.python-version }}
+        uses: actions/setup-python@v2
+        with:
+          python-version: ${{ matrix.python-version }}
+      - name: Install python dependencies
+        run: |
+          python -m pip install --upgrade pip
+          pip install matplotlib seaborn
+
       - name: Query dependencies
         run: |
           install.packages('remotes')
@@ -66,28 +75,28 @@ jobs:
           remotes::install_deps(dependencies = TRUE)
           remotes::install_cran(""rcmdcheck"")
         shell: Rscript {0}
-      
+
       - name: Install BiocManager
         run: |
           remotes::install_cran(""BiocManager"")
         shell: Rscript {0}
-      
+
       - name: Install mzR manually to avoid weird error
         run: |
           BiocManager::install(""mzR"")
         shell: Rscript {0}
-      
+
       - name: Install MSnbase manually to avoid weird error
         run: |
           BiocManager::install(""MSnbase"")
         shell: Rscript {0}
-      
+
       - name: Install covr and test coverage
         run: |
           remotes::install_cran(""covr"")
           covr::codecov()
         shell: Rscript {0}
-              
+
       - name: Check
         env:
           _R_CHECK_CRAN_INCOMING_REMOTE_: false

---FILE: vignettes/Intro-to-RaMS.Rmd---
@@ -10,6 +10,7 @@ vignette: >
 <!-- This vignette is created from a .Rmd file: please edit that instead. -->
 
 ```{r, include = FALSE}
+options(rmarkdown.html_vignette.check_title = FALSE)
 options(tidyverse.quiet = TRUE)
 
 knitr::opts_chunk$set(

---FILE: vignettes/RaMS-and-friends.Rmd---
@@ -7,6 +7,12 @@ vignette: >
   %\VignetteEncoding{UTF-8}
 ---
 
+```{r setup, include = FALSE}
+options(rmarkdown.html_vignette.check_title = FALSE)
+
+```
+
+
 The strength of `RaMS` is its simple data format. Table-like data structures are
 common in most programming languages, and they can always be converted to the
 nigh-universal matrix format. The goal of this vignette is to illustrate this",False,True,Rendering / Conversion,6
wkumler,RaMS,8187f359272318d260f8e057088e5cfffb3dd9a4,wkumler,wkumler@uw.edu,2021-03-16T16:26:13Z,wkumler,wkumler@uw.edu,2021-03-16T16:26:13Z,Updating .yml to fix CRAN warnings and unable to find python errors,.github/workflows/r-check-cran.yml;vignettes/Intro-to-RaMS.Rmd;vignettes/RaMS-and-friends.Rmd,True,False,True,False,22,5,27,"---FILE: .github/workflows/r-check-cran.yml---
@@ -39,6 +39,16 @@ jobs:
 
       - uses: r-lib/actions/setup-pandoc@v1
 
+      - name: Set up Python ${{ matrix.python-version }}
+        uses: actions/setup-python@v2
+        with:
+          python-version: ${{ matrix.python-version }}
+      - name: Install python dependencies
+        run: |
+          python -m pip install --upgrade pip
+          pip install matplotlib seaborn
+          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
+
       - name: Query dependencies
         run: |
           install.packages('remotes')
@@ -66,28 +76,28 @@ jobs:
           remotes::install_deps(dependencies = TRUE)
           remotes::install_cran(""rcmdcheck"")
         shell: Rscript {0}
-      
+
       - name: Install BiocManager
         run: |
           remotes::install_cran(""BiocManager"")
         shell: Rscript {0}
-      
+
       - name: Install mzR manually to avoid weird error
         run: |
           BiocManager::install(""mzR"")
         shell: Rscript {0}
-      
+
       - name: Install MSnbase manually to avoid weird error
         run: |
           BiocManager::install(""MSnbase"")
         shell: Rscript {0}
-      
+
       - name: Install covr and test coverage
         run: |
           remotes::install_cran(""covr"")
           covr::codecov()
         shell: Rscript {0}
-              
+
       - name: Check
         env:
           _R_CHECK_CRAN_INCOMING_REMOTE_: false

---FILE: vignettes/Intro-to-RaMS.Rmd---
@@ -10,6 +10,7 @@ vignette: >
 <!-- This vignette is created from a .Rmd file: please edit that instead. -->
 
 ```{r, include = FALSE}
+options(rmarkdown.html_vignette.check_title = FALSE)
 options(tidyverse.quiet = TRUE)
 
 knitr::opts_chunk$set(

---FILE: vignettes/RaMS-and-friends.Rmd---
@@ -7,6 +7,12 @@ vignette: >
   %\VignetteEncoding{UTF-8}
 ---
 
+```{r setup, include = FALSE}
+options(rmarkdown.html_vignette.check_title = FALSE)
+
+```
+
+
 The strength of `RaMS` is its simple data format. Table-like data structures are
 common in most programming languages, and they can always be converted to the
 nigh-universal matrix format. The goal of this vignette is to illustrate this",False,True,Rendering / Conversion,6
wkumler,RaMS,f1887655425047b2c0096af1fdd037caf518a704,wkumler,wkumler@uw.edu,2021-03-16T06:26:04Z,wkumler,wkumler@uw.edu,2021-03-16T06:26:04Z,Fixed incomplete change causing error,vignettes/RaMS-and-friends.Rmd,True,False,True,False,2,2,4,"---FILE: vignettes/RaMS-and-friends.Rmd---
@@ -77,8 +77,8 @@ library(DBI)
 MSdb <- dbConnect(RSQLite::SQLite(), ""MSdata.sqlite"")
 
 # Export MS1 and MS2 data to sqlite tables
-dbWriteTable(MSdb, ""MS1"", MS2_data$MS1)
-dbWriteTable(MSdb, ""MS2"", MS2_data$MS2)
+dbWriteTable(MSdb, ""MS1"", msdata$MS1)
+dbWriteTable(MSdb, ""MS2"", msdata$MS2)
 dbListTables(MSdb)
 
 # Perform a simple query to ensure data was exported correctly",False,True,Rendering / Conversion,3
wkumler,RaMS,8c220dbab4530a573547bc9b1e9eb058d21eaa59,wkumler,wkumler@uw.edu,2021-03-16T06:06:20Z,wkumler,wkumler@uw.edu,2021-03-16T06:06:20Z,Fixed failing unit test due to single file no longer using errorbar,tests/testthat/test_errors_n_messes.R,False,True,True,False,1,1,2,"---FILE: tests/testthat/test_errors_n_messes.R---
@@ -46,6 +46,6 @@ test_that(""checkProvidedMzPpm detects things"", {
 test_that(""default verbosity works"", {
   expect_output(
     grabMSdata(files = mzML_filenames[2], grab_what = ""everything""),
-    regexp = ""Reading MS1.*=""
+    regexp = ""Reading MS1""
   )
 })",True,False,Implementation / Logic,3
wkumler,RaMS,5721d4b43f66eaf8d212b134bbd1f1e5d3d6949c,wkumler,wkumler@uw.edu,2021-03-16T06:05:13Z,wkumler,wkumler@uw.edu,2021-03-16T06:05:13Z,Fixed bug in MS2 example data by rerunning msdata_maker,inst/extdata/DDApos_2.mzML.gz;inst/extdata/DDApos_2.mzXML.gz,False,False,False,False,0,0,0,,False,False,Rendering / Conversion,0
wkumler,RaMS,d3f420d33d688145ca571481308dab13282d5fab,wkumler,wkumler@uw.edu,2021-03-01T06:58:27Z,wkumler,wkumler@uw.edu,2021-03-01T06:58:27Z,"Added rtrange support for mzXMLs, fixed issues with switching to minutes, added unit tests",R/grabMSdataCode.R;R/grabMzmlFunctions.R;R/grabMzxmlFunctions.R;tests/testthat/helper-load.R;tests/testthat/test_trimming_works.R,False,True,True,False,98,52,150,"---FILE: R/grabMSdataCode.R---
@@ -327,6 +327,21 @@ timeReport <- function(last_time, text=NULL){
   Sys.time()
 }
 
+checkRTrange <- function(rtrange){
+  if(!is.null(rtrange)){
+    if(""matrix""%in%class(rtrange)){
+      rtrange <- as.vector(rtrange)
+    }
+    if(length(rtrange)!=2){
+      stop(""Please provide an rtrange of length 2"")
+    }
+    if(class(rtrange)!=""numeric""&&class(rtrange)!=""integer""){
+      stop(""Please provide a numeric rtrange"")
+    }
+  }
+  rtrange
+}
+
 
 # Import area ----
 

---FILE: R/grabMzmlFunctions.R---
@@ -293,15 +293,16 @@ grabMzmlMS1 <- function(xml_data, rtrange, file_metadata){
   ms1_xpath <- paste0('//d1:spectrum[d1:cvParam[@name=""ms level"" and ',
                       '@value=""1""]][d1:cvParam[@name=""base peak intensity""]]')
   ms1_nodes <- xml2::xml_find_all(xml_data, ms1_xpath)
-  if(!is.null(rtrange)){
-    ms1_nodes <- shrinkRTrange(ms1_nodes, rtrange)
-  }
   if(!length(ms1_nodes)){
     return(data.table(rt=numeric(), mz=numeric(), int=numeric()))
   }
 
-
   rt_vals <- grabSpectraRt(ms1_nodes)
+  if(!is.null(rtrange)){
+    ms1_nodes <- ms1_nodes[rt_vals%between%rtrange]
+    rt_vals <- rt_vals[rt_vals%between%rtrange]
+  }
+
   mz_vals <- grabSpectraMz(ms1_nodes, file_metadata)
   int_vals <- grabSpectraInt(ms1_nodes, file_metadata)
 
@@ -330,15 +331,17 @@ grabMzmlMS2 <- function(xml_data, rtrange, file_metadata){
                       '@value=""2""]][d1:cvParam[@name=""base peak intensity""]]')
 
   ms2_nodes <- xml2::xml_find_all(xml_data, ms2_xpath)
-  if(!is.null(rtrange)){
-    ms2_nodes <- shrinkRTrange(ms2_nodes, rtrange)
-  }
   if(!length(ms2_nodes)){
     return(data.table(rt=numeric(), premz=numeric(), fragmz=numeric(),
                       int=numeric(), voltage=integer()))
   }
 
   rt_vals <- grabSpectraRt(ms2_nodes)
+  if(!is.null(rtrange)){
+    ms2_nodes <- ms2_nodes[rt_vals%between%rtrange]
+    rt_vals <- rt_vals[rt_vals%between%rtrange]
+  }
+
   premz_vals <- grabSpectraPremz(ms2_nodes)
   voltage <- grabSpectraVoltage(ms2_nodes)
   mz_vals <- grabSpectraMz(ms2_nodes, file_metadata)
@@ -372,11 +375,12 @@ grabMzmlBPC <- function(xml_data, rtrange, TIC=FALSE){
                       '@value=""1""]][d1:cvParam[@name=""base peak intensity""]]')
 
   ms1_nodes <- xml2::xml_find_all(xml_data, ms1_xpath)
-  if(!is.null(rtrange)){
-    ms1_nodes <- shrinkRTrange(ms1_nodes, rtrange)
-  }
 
   rt_vals <- grabSpectraRt(ms1_nodes)
+  if(!is.null(rtrange)){
+    ms1_nodes <- ms1_nodes[rt_vals%between%rtrange]
+    rt_vals <- rt_vals[rt_vals%between%rtrange]
+  }
 
   int_xpath <- ifelse(TIC, ""total ion current"", ""base peak intensity"")
   int_xpath_full <- paste0('d1:cvParam[@name=""', int_xpath, '""]')
@@ -400,7 +404,7 @@ grabSpectraRt <- function(xml_nodes){
   rt_xpath <- 'd1:scanList/d1:scan/d1:cvParam[@name=""scan start time""]'
   rt_nodes <- xml2::xml_find_all(xml_nodes, rt_xpath)
   rt_vals <- as.numeric(xml2::xml_attr(rt_nodes, ""value""))
-  if(any(rt_vals)>150){
+  if(any(rt_vals>150)){
     # Guess RT is in seconds if the run is more than 150 long
     # A 2.5 minute run is unheard of, and a 2.5 hour run is unheard of
     rt_vals <- rt_vals/60
@@ -505,29 +509,14 @@ grabSpectraInt <- function(xml_nodes, file_metadata){
 
 
 # Other helper functions ----
-checkRTrange <- function(rtrange){
-  if(!is.null(rtrange)){
-    if(""matrix""%in%class(rtrange)){
-      rtrange <- as.vector(rtrange)
-    }
-    if(length(rtrange)!=2){
-      stop(""Please provide an rtrange of length 2"")
-    }
-    if(class(rtrange)!=""numeric""&&class(rtrange)!=""integer""){
-      stop(""Please provide a numeric rtrange"")
-    }
+shrinkRTrangemzML <- function(xml_nodes, rtrange){
+  rt_xpath <- 'd1:scanList/d1:scan/d1:cvParam[@name=""scan start time""]'
+  rt_nodes <- xml2::xml_find_all(xml_nodes, rt_xpath)
+  rt_vals <- as.numeric(xml2::xml_attr(rt_nodes, ""value""))
+  if(any(rt_vals>150)){
+    # Guess RT is in seconds if the run is more than 150 long
+    # A 2.5 minute run is unheard of, and a 2.5 hour run is unheard of
+    rt_vals <- rt_vals/60
   }
-  rtrange
-}
-
-shrinkRTrange <- function(xml_nodes, rtrange){
-  # Xpath is magic. Basically we walk down from each spectrum node to find its
-  # ""scan start time"" node and can filter directly on that.
-  rtrange_xpath <- paste0(""d1:scanList/d1:scan/d1:cvParam["",
-                          '@name=""scan start time""',
-                          "" and @value>="", min(rtrange),
-                          "" and @value<="", max(rtrange), ""]"",
-                          ""/parent::d1:scan/parent::d1:scanList/"",
-                          ""parent::d1:spectrum"")
-  xml2::xml_find_all(xml_nodes, rtrange_xpath)
+  xml_nodes[rt_vals%between%rtrange]
 }

---FILE: R/grabMzxmlFunctions.R---
@@ -61,16 +61,14 @@
 #'
 grabMzxmlData <- function(filename, grab_what, verbose=FALSE,
                           rtrange=NULL, mz=NULL, ppm=NULL){
-  if(!is.null(rtrange)){
-    message(""\n`rtrange` argument not supported for mzXML files, ignoring"")
-  }
   if(verbose){
     cat(paste0(""\nReading file "", basename(filename), ""... ""))
     last_time <- Sys.time()
   }
   xml_data <- xml2::read_xml(filename)
 
   checkFileType(xml_data, ""mzXML"")
+  rtrange <- checkRTrange(rtrange)
   file_metadata <- grabMzxmlEncodingData(xml_data)
 
   output_data <- list()
@@ -86,31 +84,33 @@ grabMzxmlData <- function(filename, grab_what, verbose=FALSE,
 
   if(""MS1""%in%grab_what){
     if(verbose)last_time <- timeReport(last_time, text = ""Reading MS1 data..."")
-    output_data$MS1 <- grabMzxmlMS1(xml_data = xml_data,
+    output_data$MS1 <- grabMzxmlMS1(xml_data = xml_data, rtrange=rtrange,
                                     file_metadata = file_metadata)
   }
 
   if(""MS2""%in%grab_what){
     if(verbose)last_time <- timeReport(last_time, text = ""Reading MS2 data..."")
-    output_data$MS2 <- grabMzxmlMS2(xml_data = xml_data,
+    output_data$MS2 <- grabMzxmlMS2(xml_data = xml_data, rtrange=rtrange,
                                     file_metadata = file_metadata)
   }
 
   if(""BPC""%in%grab_what){
     if(verbose)last_time <- timeReport(last_time, text = ""Reading BPC..."")
-    output_data$BPC <- grabMzxmlBPC(xml_data = xml_data)
+    output_data$BPC <- grabMzxmlBPC(xml_data = xml_data, rtrange=rtrange)
   }
 
   if(""TIC""%in%grab_what){
     if(verbose)last_time <- timeReport(last_time, text = ""Reading TIC..."")
-    output_data$TIC <- grabMzxmlBPC(xml_data = xml_data, TIC = TRUE)
+    output_data$TIC <- grabMzxmlBPC(xml_data = xml_data, rtrange=rtrange,
+                                    TIC = TRUE)
   }
 
   if(""EIC""%in%grab_what){
     checkProvidedMzPpm(mz, ppm)
     if(verbose)last_time <- timeReport(last_time, text = ""Extracting EIC..."")
     if(!""MS1""%in%grab_what){
-      init_dt <- grabMzxmlMS1(xml_data=xml_data, file_metadata = file_metadata)
+      init_dt <- grabMzxmlMS1(xml_data=xml_data, file_metadata = file_metadata,
+                              rtrange=rtrange)
     } else {
       init_dt <- output_data$MS1
       if(!nrow(init_dt))stop(""Something weird - can't find MS1 data to subset"")
@@ -127,7 +127,8 @@ grabMzxmlData <- function(filename, grab_what, verbose=FALSE,
       last_time <- timeReport(last_time, text = ""Extracting EIC MS2..."")
       }
     if(!""MS2""%in%grab_what){
-      init_dt <- grabMzxmlMS2(xml_data=xml_data, file_metadata = file_metadata)
+      init_dt <- grabMzxmlMS2(xml_data=xml_data, file_metadata = file_metadata,
+                              rtrange=rtrange)
     } else {
       init_dt <- output_data$MS2
     }
@@ -242,11 +243,16 @@ grabMzxmlEncodingData <- function(xml_data){
 #'
 #' @return A `data.table` with columns for retention time (rt), m/z (mz),
 #' and intensity (int).
-grabMzxmlMS1 <- function(xml_data, file_metadata){
+grabMzxmlMS1 <- function(xml_data, file_metadata, rtrange){
   ms1_xpath <- '//d1:scan[@msLevel=""1"" and @peaksCount>0]'
   ms1_nodes <- xml2::xml_find_all(xml_data, ms1_xpath)
 
   rt_vals <- grabMzxmlSpectraRt(ms1_nodes)
+  if(!is.null(rtrange)){
+    ms1_nodes <- ms1_nodes[rt_vals%between%rtrange]
+    rt_vals <- rt_vals[rt_vals%between%rtrange]
+  }
+
   mz_int_vals <- grabMzxmlSpectraMzInt(ms1_nodes, file_metadata)
 
   dt_data <- mapply(cbind, rt_vals, mz_int_vals, SIMPLIFY = FALSE)
@@ -265,7 +271,7 @@ grabMzxmlMS1 <- function(xml_data, file_metadata){
 #'
 #' @return A `data.table` with columns for retention time (rt),  precursor m/z (mz),
 #' fragment m/z (fragmz), collision energy (voltage), and intensity (int).
-grabMzxmlMS2 <- function(xml_data, file_metadata){
+grabMzxmlMS2 <- function(xml_data, file_metadata, rtrange){
   ms2_xpath <- '//d1:scan[@msLevel=""2"" and @peaksCount>0]'
   ms2_nodes <- xml2::xml_find_all(xml_data, ms2_xpath)
   if(!length(ms2_nodes)){
@@ -276,6 +282,11 @@ grabMzxmlMS2 <- function(xml_data, file_metadata){
   ms2_nodes <- ms2_nodes[as.numeric(xml2::xml_attr(ms2_nodes, ""peaksCount""))>0]
 
   rt_vals <- grabMzxmlSpectraRt(ms2_nodes)
+  if(!is.null(rtrange)){
+    ms2_nodes <- ms2_nodes[rt_vals%between%rtrange]
+    rt_vals <- rt_vals[rt_vals%between%rtrange]
+  }
+
   premz_vals <- grabMzxmlSpectraPremz(ms2_nodes)
   voltage_vals <- grabMzxmlSpectraVoltage(ms2_nodes)
   mz_int_vals <- grabMzxmlSpectraMzInt(ms2_nodes, file_metadata)
@@ -300,15 +311,21 @@ grabMzxmlMS2 <- function(xml_data, file_metadata){
 #' @param TIC Boolean. If TRUE, the TIC is extracted rather than the BPC.
 #'
 #' @return A `data.table` with columns for retention time (rt), and intensity (int).
-grabMzxmlBPC <- function(xml_data, TIC=FALSE){
+grabMzxmlBPC <- function(xml_data, TIC=FALSE, rtrange){
   scan_nodes <- xml2::xml_find_all(
     xml_data, '//d1:scan[@msLevel=""1"" and @peaksCount>0]'
   )
   rt_chrs <- xml2::xml_attr(scan_nodes, ""retentionTime"")
   rt_vals <- as.numeric(gsub(pattern = ""PT|S"", replacement = """", rt_chrs))
+  if(any(rt_vals>150)){rt_vals <- rt_vals/60}
 
   int_attr <- ifelse(TIC, ""totIonCurrent"", ""basePeakIntensity"")
   int_vals <- as.numeric(xml2::xml_attr(scan_nodes, int_attr))
+  if(!is.null(rtrange)){
+    int_vals <- int_vals[rt_vals%between%rtrange]
+    rt_vals <- rt_vals[rt_vals%between%rtrange]
+  }
+
 
   return(data.table(rt=rt_vals, int=int_vals))
 }
@@ -328,7 +345,7 @@ grabMzxmlBPC <- function(xml_data, TIC=FALSE){
 grabMzxmlSpectraRt <- function(xml_nodes){
   rt_attrs <- xml2::xml_attr(xml_nodes, ""retentionTime"")
   rt_vals <- as.numeric(gsub(""PT|S"", """", rt_attrs))
-  if(any(rt_vals)>150){
+  if(any(rt_vals>150)){
     # Guess RT is in seconds if the run is more than 150 long
     # A 2.5 minute run is unheard of, and a 2.5 hour run is unheard of
     rt_vals <- rt_vals/60
@@ -405,5 +422,14 @@ grabMzxmlSpectraMzInt <- function(xml_nodes, file_metadata){
 
 
 # Other helper functions ----
-
-
+shrinkRTrangemzXML <- function(xml_nodes, rtrange){
+  rt_xpath <- 'd1:scanList/d1:scan/d1:cvParam[@name=""scan start time""]'
+  rt_nodes <- xml2::xml_find_all(xml_nodes, rt_xpath)
+  rt_vals <- as.numeric(xml2::xml_attr(rt_nodes, ""value""))
+  if(any(rt_vals>150)){
+    # Guess RT is in seconds if the run is more than 150 long
+    # A 2.5 minute run is unheard of, and a 2.5 hour run is unheard of
+    rt_vals <- rt_vals/60
+  }
+  xml_nodes[rt_vals%between%rtrange]
+}

---FILE: tests/testthat/helper-load.R---
@@ -22,12 +22,16 @@ mzML_EIC_data <- grabMSdata(mzML_filenames[1:2], grab_what = c(""EIC"", ""EIC_MS2"")
 mzXML_EIC_data <- grabMSdata(mzXML_filenames[1:2], grab_what = c(""EIC"", ""EIC_MS2""),
                              mz = EIC_mz, ppm = EIC_ppm, verbosity = ""very"")
 
-test_rtrange <- c(300, 360)
+test_rtrange <- c(5, 6)
 mzML_trimmed <- grabMSdata(files = mzML_filenames[1:2],
                            grab_what = c(""MS1"", ""MS2"", ""TIC"", ""BPC""),
                            rtrange = test_rtrange)
+mzXML_trimmed <- grabMSdata(files = mzXML_filenames[1],
+                           grab_what = c(""MS1"", ""MS2"", ""TIC"", ""BPC""),
+                           rtrange = test_rtrange)
+
 
-test_zerorange <- c(300, 300)
+test_zerorange <- c(5, 5)
 mzML_zeroed <- grabMSdata(files = mzML_filenames[1:2],
                           grab_what = c(""MS1"", ""MS2"", ""TIC"", ""BPC""),
                           rtrange = test_zerorange)

---FILE: tests/testthat/test_trimming_works.R---
@@ -1,4 +1,16 @@
 
+test_that(""trim didn't ruin things"", {
+  expect_gt(nrow(mzML_data$MS1), 0)
+  expect_gt(nrow(mzML_data$MS2), 0)
+  expect_gt(nrow(mzML_data$BPC), 0)
+  expect_gt(nrow(mzML_data$TIC), 0)
+
+  expect_gt(nrow(mzXML_data$MS1), 0)
+  expect_gt(nrow(mzXML_data$MS2), 0)
+  expect_gt(nrow(mzXML_data$BPC), 0)
+  expect_gt(nrow(mzXML_data$TIC), 0)
+})
+
 test_that(""trim edges within data"", {
   expect_gte(min(test_rtrange), min(mzML_data$MS1$rt))
   expect_lte(max(test_rtrange), max(mzML_data$MS1$rt))",True,False,Implementation / Logic,6
wkumler,RaMS,5fa09fcf1cb8093055d67ba19ccd649081af0ead,wkumler,wkumler@uw.edu,2021-03-01T06:15:19Z,wkumler,wkumler@uw.edu,2021-03-01T06:15:19Z,Fixing EIC mz ppm sanity check and trusting xml2's warning about missing files rather than providing my own,R/grabMSdataCode.R,False,True,True,False,5,34,39,"---FILE: R/grabMSdataCode.R---
@@ -112,17 +112,17 @@
 #' file_data <- grabMSdata(sample_url, grab_what=""everything"",
 #'                         check_exists=FALSE, verbosity=""very"")
 #' }
-grabMSdata <- function(files, grab_what=c(""MS1"", ""MS2""), verbosity=""none"",
+grabMSdata <- function(files, grab_what=""everything"", verbosity=""none"",
                        mz=NULL, ppm=NULL, rtrange=NULL, check_exists=TRUE){
-  # Check that files can be found
-  if(check_exists)checkFiles(files)
+  # Check that files were provided
+  if(!length(files))stop(""No files provided"")
 
   # Add sanity check for EIC extraction
-  if(!is.null(mz) & !c(""EIC"", ""EIC_MS2"")%in%grab_what){
+  if(!is.null(mz) & !any(c(""EIC"", ""EIC_MS2"")%in%grab_what)){
     warning(paste0('Argument ""mz"" should be used with grab_what = ""EIC"" or',
             '""EIC_MS2"" and will be ignored in the current call'))
   }
-  if(!is.null(ppm) & !c(""EIC"", ""EIC_MS2"")%in%grab_what){
+  if(!is.null(ppm) & !any(c(""EIC"", ""EIC_MS2"")%in%grab_what)){
     warning(paste0('Argument ""mz"" should be used with grab_what = ""EIC"" or',
                    '""EIC_MS2"" and will be ignored in the current call'))
   }
@@ -177,35 +177,6 @@ grabMSdata <- function(files, grab_what=c(""MS1"", ""MS2""), verbosity=""none"",
   all_file_data_output
 }
 
-# checkFiles ----
-
-#' Check that filenames are acceptable.
-#'
-#' @param files The vector of files provided to grabMSdata.
-#'
-#' @return NULL (invisibly). The goal of this function is its side effects, i.e.
-#'   throwing errors and providing info when the files are not found.
-#'
-checkFiles <- function(files){
-  # Check that files were actually provided
-  if(!length(files))stop(""No files provided"")
-  # Check that files exist and stop with messages if not
-  # I could be nicer here and just read in the files that exist but I think not
-  files_exist <- file.exists(files)
-  if(any(!files_exist)){
-    message(""Error: Unable to find all files:"")
-    if(sum(!files_exist)>6){
-      # Avoid spamming output if lots of files missing
-      message(paste(""Couldn't find file"", head(files[!files_exist]), ""\n""))
-      message(paste(""... and"", sum(!files_exist)-6, ""others""))
-    } else {
-      message(paste(""Couldn't find file"", files[!files_exist], ""\n""))
-    }
-    stopQuietly()
-  }
-  return(invisible(NULL))
-}
-
 # checkOutputQuality ----
 
 #' Check that the output data is properly formatted.",True,False,Implementation / Logic,6
wkumler,RaMS,1896c0afba4eeecbc1ea89fcc5b250bb8edcca1d,wkumler,wkumler@uw.edu,2021-03-01T00:19:48Z,wkumler,wkumler@uw.edu,2021-03-01T00:19:48Z,"Missing mz_precision cvParam caused errors, now corrected by assuming mz_precision = int_precision if not provided explicitly",R/grabMzmlFunctions.R,False,True,True,False,1,0,1,"---FILE: R/grabMzmlFunctions.R---
@@ -269,6 +269,7 @@ grabMzmlEncodingData <- function(xml_data){
   int_precision <- as.numeric(int_precision)/8
 
   if(is.na(int_precision))int_precision <- mz_precision
+  if(is.na(mz_precision))mz_precision <- int_precision
 
   list(compression=compr, mz_precision=mz_precision,
        int_precision=int_precision)",True,False,Implementation / Logic,6
wkumler,RaMS,d251e5aefed9f042f24165c5dbb8332ab9501e01,wkumler,wkumler@uw.edu,2021-02-01T00:40:55Z,wkumler,wkumler@uw.edu,2021-02-01T00:40:55Z,Creating tests for error messages now that codecov is active,tests/testthat/test_errors_n_messes.R,False,True,True,False,39,0,39,"---FILE: tests/testthat/test_errors_n_messes.R---
@@ -0,0 +1,39 @@
+
+test_that(""error if unable to find files"", {
+  expect_error(grabMSdata(files = rep(tempfile(), 7), verbosity=""very""))
+})
+
+test_that(""error if no files"", {
+  expect_error(grabMSdata(files = character(), verbosity=""very""))
+})
+
+test_that(""error if weird files"", {
+  file.create(""blah.txt"")
+  expect_error(grabMSdata(files = ""blah.txt"", verbosity=""very""))
+  file.remove(""blah.txt"")
+})
+
+
+
+test_that(""checkOutputQuality detects things"", {
+  grab_what <- ""everything""
+  output_data <- list(MS1=data.table(runif(100)))
+  expect_error(checkOutputQuality(output_data, grab_what))
+
+  grab_what <- c(""MS1"", ""MS2"")
+  output_data <- list(MS1=data.table(runif(100)), MS2=data.table())
+  expect_message(checkOutputQuality(output_data, grab_what))
+})
+
+
+
+test_that(""checkProvidedMzPpm detects things"", {
+  expect_error(checkProvidedMzPpm(mz=NULL))
+  expect_error(checkProvidedMzPpm(mz=""banana""))
+  expect_error(checkProvidedMzPpm(mz=c(100, NA_integer_, 3)))
+  expect_error(checkProvidedMzPpm(mz=-3))
+
+  expect_error(checkProvidedMzPpm(mz=100, ppm = NULL))
+  expect_error(checkProvidedMzPpm(mz=100, ppm = ""banana""))
+  expect_error(checkProvidedMzPpm(mz=100, ppm = -3))
+})",True,False,Implementation / Logic,6
wkumler,RaMS,366335154dfef62ed27f4a5d7862a7e4492a0902,William,43116923+wkumler@users.noreply.github.com,2021-01-31T23:14:51Z,GitHub,noreply@github.com,2021-01-31T23:14:51Z,"Found actual syntax error, probably fixed

Also added covr install",.github/workflows/r-check-cran.yml,False,False,False,False,7,0,7,"---FILE: .github/workflows/r-check-cran.yml---
@@ -77,6 +77,13 @@ jobs:
       - name: Install MSnbase manually to avoid weird error
         run: |
           BiocManager::install(""MSnbase"")
+        shell: Rscript {0}
+      
+      - name: Install covr to
+        run: |
+          remotes::install_cran(""covr"")
+        shell: Rscript {0}
+        
       - name: Check
         env:
           _R_CHECK_CRAN_INCOMING_REMOTE_: false",False,False,Dependency / Package,4
wkumler,RaMS,7a0af2e5aae79b1987bffe2b81559043b9f4407d,wkumler,wkumler@uw.edu,2020-12-08T19:52:10Z,wkumler,wkumler@uw.edu,2020-12-08T19:52:10Z,Fixed vignette path to reflect new location,README.md,False,False,False,False,3,6,9,"---FILE: README.md---
@@ -22,14 +22,14 @@ other [tidy data packages](https://www.tidyverse.org/).
 Until `RaMS` is on CRAN, the easiest way to install is via `devtools`:
 
 ``` r
-devtools::install_github(""wkumler/RaMS"", build_vignettes = TRUE)
+devtools::install_github(""wkumler/RaMS"")
 
 library(RaMS)
 ```
 
 ## Usage
 
-(For more usage examples, see the [vignette](doc/RaMS-vignette.pdf).)
+(For more usage examples, see the [vignette](vignettes/RaMS-vignette.pdf).)
 
 There’s only one main function in `RaMS`: the aptly named `grabMSdata`.
 This function accepts the names of mass-spectrometry files as well as
@@ -141,11 +141,8 @@ output$EIC %>%
 
 ![](man/figures/plotlyplot.png)
 
-For more usage examples, see [the vignette](doc/RaMS-vignette.pdf).
+For more usage examples, see [the vignette](vignettes/RaMS-vignette.pdf).
 
-``` r
-vignette(""RaMS-vignette"", package = ""RaMS"")
-```
 
 ## File types
 ",False,False,Documentation / Formatting,7
wkumler,RaMS,4d3943550e50eb4b8af67631ba897ecd60ea355b,wkumler,wkumler@uw.edu,2020-12-04T00:02:10Z,wkumler,wkumler@uw.edu,2020-12-04T00:02:10Z,Fixing missing call to data.table in examples,R/grabMSdataCode.R;man/grabMSdata.Rd,False,True,True,False,2,0,2,"---FILE: R/grabMSdataCode.R---
@@ -82,6 +82,7 @@
 #'                         mz=c(118.0865, 146.118104, 189.123918))
 #'
 #' # Extract MS2 data and search for specific fragment masses
+#' library(data.table)
 #' MS2_file <- list.files(sample_dir, pattern=""DDA.*mzML"", full.names=TRUE)
 #' file_data <- grabMSdata(MS2_file, grab_what=c(""MS1"", ""MS2""))
 #' fragment_mass <- 59.0739

---FILE: man/grabMSdata.Rd---
@@ -97,6 +97,7 @@ file_data <- grabMSdata(sample_files, grab_what=""EIC"", ppm=5,
                         mz=c(118.0865, 146.118104, 189.123918))
 
 # Extract MS2 data and search for specific fragment masses
+library(data.table)
 MS2_file <- list.files(sample_dir, pattern=""DDA.*mzML"", full.names=TRUE)
 file_data <- grabMSdata(MS2_file, grab_what=c(""MS1"", ""MS2""))
 fragment_mass <- 59.0739",True,False,Documentation / Formatting,6
wkumler,RaMS,88bc3f3add93eb2b128191208648d617e9f7092d,wkumler,wkumler@uw.edu,2020-12-03T17:46:42Z,wkumler,wkumler@uw.edu,2020-12-03T17:46:42Z,Fixing up metadata output,R/grabMSdataCode.R;R/grabMzmlFunctions.R;R/grabMzxmlFunctions.R,False,True,True,False,14,4,18,"---FILE: R/grabMSdataCode.R---
@@ -139,7 +139,7 @@ grabMSdata <- function(files, grab_what=c(""MS1"", ""MS2""), verbosity=""none"",
   }
 
   # Bind all the similar pieces together (e.g. stack MS1 from different files)
-  all_file_data_output <- Reduce(function(x,y) Map(rbind, x, y), all_file_data)
+  all_file_data_output <- Reduce(function(x,y) Map(rbind, x, y, fill=TRUE), all_file_data)
   invisible(checkOutputQuality(
     output_data = all_file_data_output, grab_what = grab_what
   ))

---FILE: R/grabMzmlFunctions.R---
@@ -194,7 +194,7 @@ grabMzmlMetadata <- function(xml_data){
   time_node <- xml2::xml_find_first(xml_data, xpath = ""//d1:run"")
   time_val <- xml2::xml_attr(time_node, ""startTimeStamp"")
   if(!is.na(time_val)){
-    time_stamp <- as.POSIXct(strptime(time_node, ""%Y-%m-%dT%H:%M:%SZ""))
+    time_stamp <- as.POSIXct(strptime(time_val, ""%Y-%m-%dT%H:%M:%SZ""))
   } else {
     time_stamp <- ""None found""
   }

---FILE: R/grabMzxmlFunctions.R---
@@ -175,9 +175,18 @@ grabMzxmlMetadata <- function(xml_data){
     names(inst_vals) <- ""Instrument data""
   }
 
+  mslevel_nodes <- xml2::xml_find_all(xml_data, xpath = ""//d1:scan"")
+  if(length(mslevel_nodes)>0){
+    mslevels <- paste0(""MS"", unique(xml_attr(mslevel_nodes, ""msLevel"")), collapse = "", "")
+  } else {
+    mslevels <- ""None found""
+  }
+
+
   metadata <- data.table(
     source_file=source_file,
-    inst_data=list(inst_vals)
+    inst_data=list(inst_vals),
+    mslevels=mslevels
   )
 }
 
@@ -215,7 +224,8 @@ grabMzxmlEncodingData <- function(xml_data){
 #' @param file_metadata Information about the file used to decode the binary
 #'   arrays containing m/z and intensity information.
 #'
-#' @return A `data.table` with columns for retention time (rt), m/z (mz), and intensity (int).
+#' @return A `data.table` with columns for retention time (rt), m/z (mz),
+#' and intensity (int).
 grabMzxmlMS1 <- function(xml_data, file_metadata){
   ms1_xpath <- '//d1:scan[@msLevel=""1""]'
   ms1_nodes <- xml2::xml_find_all(xml_data, ms1_xpath)",True,False,Implementation / Logic,6
wkumler,RaMS,1e66c6edd08a74e5af34e941796e2e084b701b5a,wkumler,wkumler@uw.edu,2020-12-03T02:30:07Z,wkumler,wkumler@uw.edu,2020-12-03T02:30:07Z,Fixed warnings when cbind()ing empty peak node,R/grabMzxmlFunctions.R,False,True,True,False,2,0,2,"---FILE: R/grabMzxmlFunctions.R---
@@ -237,6 +237,8 @@ grabMzxmlMS2 <- function(xml_data, file_metadata){
     return(data.table(rt=numeric(), premz=numeric(), fragmz=numeric(),
                       int=numeric(), voltage=integer()))
   }
+  # Remove all nodes with zero peaks
+  ms2_nodes <- ms2_nodes[as.numeric(xml2::xml_attr(ms2_nodes, ""peaksCount""))>0]
 
   rt_vals <- grabMzxmlSpectraRt(ms2_nodes)
   premz_vals <- grabMzxmlSpectraPremz(ms2_nodes)",True,False,Implementation / Logic,3
wkumler,RaMS,d3fd9edf568092d98d053a25bc6c3a7e153c9e3b,wkumler,wkumler@uw.edu,2020-11-30T22:40:38Z,wkumler,wkumler@uw.edu,2020-11-30T22:40:38Z,Fixed bug due to wrong xpath for mzXML voltage,R/grabMzxmlFunctions.R,False,True,True,False,2,3,5,"---FILE: R/grabMzxmlFunctions.R---
@@ -267,7 +267,7 @@ grabMzxmlSpectraRt <- function(xml_nodes){
 
 grabMzxmlSpectraPremz <- function(xml_nodes){
   premz_nodes <- xml2::xml_find_all(xml_nodes, xpath = ""d1:precursorMz"")
-  as.numeric(xml_text(premz_nodes))
+  as.numeric(xml2::xml_text(premz_nodes))
 }
 
 
@@ -285,8 +285,7 @@ grabMzxmlSpectraPremz <- function(xml_nodes){
 #'
 
 grabMzxmlSpectraVoltage <- function(xml_nodes){
-  filterline_data <- xml2::xml_attr(xml_nodes, ""filterLine"")
-  as.integer(gsub("".*cid| .*"", """", filterline_data))
+  as.numeric(xml2::xml_attr(xml_nodes, ""collisionEnergy""))
 }
 
 ",True,False,Documentation / Formatting,3
wkumler,RaMS,0c7693fcf56cc1715df4476a6200ffe6f984f9e3,wkumler,wkumler@uw.edu,2020-11-30T22:26:35Z,wkumler,wkumler@uw.edu,2020-11-30T22:26:35Z,Fixing bug where empty binary caused error when decompressing,R/grabMzmlFunctions.R;R/grabMzxmlFunctions.R,False,True,True,False,3,0,3,"---FILE: R/grabMzmlFunctions.R---
@@ -349,6 +349,7 @@ grabSpectraMz <- function(xml_nodes, file_metadata){
   mz_xpath <- 'd1:binaryDataArrayList/d1:binaryDataArray[1]/d1:binary'
   mz_vals <- xml2::xml_text(xml2::xml_find_all(xml_nodes, mz_xpath))
   lapply(mz_vals, function(binary){
+    if(!nchar(binary))return(numeric(0))
     decoded_binary <- base64enc::base64decode(binary)
     raw_binary <- as.raw(decoded_binary)
     decomp_binary <- memDecompress(raw_binary, type = file_metadata$compression)
@@ -378,6 +379,7 @@ grabSpectraInt <- function(xml_nodes, file_metadata){
   int_xpath <- 'd1:binaryDataArrayList/d1:binaryDataArray[2]/d1:binary'
   int_vals <- xml2::xml_text(xml2::xml_find_all(xml_nodes, int_xpath))
   int_vals <- lapply(int_vals, function(binary){
+    if(!nchar(binary))return(numeric(0))
     decoded_binary <- base64enc::base64decode(binary)
     raw_binary <- as.raw(decoded_binary)
     decomp_binary <- memDecompress(raw_binary, type = file_metadata$compression)

---FILE: R/grabMzxmlFunctions.R---
@@ -311,6 +311,7 @@ grabMzxmlSpectraVoltage <- function(xml_nodes){
 grabMzxmlSpectraMzInt <- function(xml_nodes, file_metadata){
   all_peak_nodes <- xml2::xml_text(xml2::xml_find_all(xml_nodes, xpath = ""d1:peaks""))
   vals <- lapply(all_peak_nodes, function(binary){
+    if(!nchar(binary))return(matrix(ncol = 2, nrow = 0))
     decoded_binary <- base64enc::base64decode(binary)
     raw_binary <- as.raw(decoded_binary)
     decomp_binary <- memDecompress(raw_binary, type = file_metadata$compression)",True,False,Implementation / Logic,3
wkumler,RaMS,4520518b696872cdb39e6e25eaef696751fecefe,wkumler,wkumler@uw.edu,2020-11-25T21:40:24Z,wkumler,wkumler@uw.edu,2020-11-25T21:40:24Z,Fixed ifelse bug for column naming,R/grabMSdataCode.R,False,True,True,False,8,4,12,"---FILE: R/grabMSdataCode.R---
@@ -78,10 +78,14 @@ grabMSdata <- function(files, grab_what=c(""MS1"", ""MS2""), verbosity=""very"",
       message(paste(""Unable to determine file type for"", filename))
       stopQuietly()
     }
-    out_data_filenamed <- lapply(out_data, function(dt, filename){
-      dt$filename <- ifelse(nrow(dt), filename, character())
-      return(dt)
-    }, filename=basename(filename))
+    out_data_filenamed <- mapply(function(dt_i, fname_i){
+      if(nrow(dt_i)){
+        dt_i$filename <- fname_i
+      } else {
+        dt_i$filename <- character()
+      }
+      dt_i
+    }, dt_i=out_data, fname_i=basename(filename))
     all_file_data[[i]] <- out_data_filenamed
     names(all_file_data)[[i]] <- basename(filename)
     if(verbosity==""very""|verbosity==""minimal""){",True,False,Implementation / Logic,3
wkumler,RaMS,ca94cb4f538d68d0e6d56af48c2da5f32dc56f7e,wkumler,wkumler@uw.edu,2020-11-11T22:10:56Z,wkumler,wkumler@uw.edu,2020-11-11T22:10:56Z,Adding progress bar and fixing bug with empty data tables,DESCRIPTION;R/grabMzmlCode.R,False,True,True,False,8,4,12,"---FILE: DESCRIPTION---
@@ -15,7 +15,8 @@ LazyData: true
 Imports: 
     xml2, 
     base64enc,
-    data.table
+    data.table,
+    pbapply
 RoxygenNote: 7.1.1
 Suggests: 
     testthat, 

---FILE: R/grabMzmlCode.R---
@@ -1,6 +1,7 @@
 
 #' @import xml2
 #' @import data.table
+#' @importFrom pbapply pbsapply
 #' @importFrom base64enc base64decode
 NULL
 
@@ -136,13 +137,15 @@ grabMzmlMS2 <- function(filename){
 #' grabMzmlEIC(mass=444.22, ppm=50, filenames=c(msdata_1, msdata_2))
 grabMzmlEIC <- function(mass, ppm, filenames){
   if(any(!grepl(""\\.mzML|\\.mzML.gz$"", filenames))){
-    stop(""This function is currently only has support for mzML files"")
+    stop(""This function currently only has support for mzML files"")
   }
-  raw_eics <- sapply(filenames, function(filename){
+  raw_eics <- pbsapply(filenames, function(filename){
     all_data <- grabMzmlData(filename)
+    if(!nrow(all_data))return(data.table(rt=numeric(0), mz=numeric(0), int=numeric(0)))
     all_data[mz%between%pmppm(mass, ppm = ppm)]
   }, simplify = FALSE)
-  clean_filenames <- sub(pattern = ""\\.mzML.*$"", replacement = """", basename(filenames))
+  raw_eics <- raw_eics[which(as.logical(sapply(raw_eics, nrow)))]
+  clean_filenames <- sub(pattern = ""\\.mzML.*$"", replacement = """", basename(names(raw_eics)))
   filenamed <- mapply(FUN = cbind, raw_eics, clean_filenames, SIMPLIFY = FALSE)
   out_eic <- do.call(what=rbind, filenamed)
   names(out_eic) <- c(""rt"", ""mz"", ""int"", ""filename"")",True,False,Dependency / Package,6
wkumler,RaMS,6edf257bdd515740790e76df570dc76b7c50b8ab,wkumler,wkumler@uw.edu,2020-11-11T21:44:06Z,wkumler,wkumler@uw.edu,2020-11-11T21:44:06Z,Fixed up bugs from switch to data.table,DESCRIPTION;tests/testthat/test-grabMzmlCode.R;tests/testthat/test-grabMzmlMs2Code.R,False,True,True,False,4,3,7,"---FILE: DESCRIPTION---
@@ -14,7 +14,8 @@ Encoding: UTF-8
 LazyData: true
 Imports: 
     xml2, 
-    base64enc
+    base64enc,
+    data.table
 RoxygenNote: 7.1.1
 Suggests: 
     testthat, 

---FILE: tests/testthat/test-grabMzmlCode.R---
@@ -21,7 +21,7 @@ test_that(""BPC can be read"", {
 test_that(""new matches MSnbase"", {
   MSnExp <- readMSData(mzML_filename, msLevel. = 1)
   parsed_spectra <- lapply(as.list(MSnExp@assayData), function(spectrum){
-    data.frame(rt=spectrum@rt, mz=spectrum@mz, int=spectrum@intensity)
+    data.table(rt=spectrum@rt, mz=spectrum@mz, int=spectrum@intensity)
   })
   all_df <- do.call(rbind, parsed_spectra)
   all_df <- all_df[order(all_df$rt),]

---FILE: tests/testthat/test-grabMzmlMs2Code.R---
@@ -8,7 +8,7 @@ test_that(""file can be read"", {
 test_that(""new matches MSnbase"", {
   MSnExp <- readMSData(mzML_filename, msLevel. = 2)
   parsed_spectra <- lapply(as.list(MSnExp@assayData), function(spectrum){
-    data.frame(rt=spectrum@rt, premz=spectrum@precursorMz,
+    data.table(rt=spectrum@rt, premz=spectrum@precursorMz,
                fragmz=spectrum@mz, int=spectrum@intensity)
   })
   all_df <- do.call(rbind, parsed_spectra)",True,False,Dependency / Package,6
wkumler,RaMS,80aa66419f4c3676731ed6148532788f28208c37,wkumler,wkumler@uw.edu,2020-11-11T09:37:13Z,wkumler,wkumler@uw.edu,2020-11-11T09:37:13Z,Fixed tests and examples to pass R CMD check,R/grabMzmlCode.R;man/grabMzmlMS2.Rd;tests/testthat.R,False,True,True,False,4,3,7,"---FILE: R/grabMzmlCode.R---
@@ -91,7 +91,8 @@ grabMzmlData <- function(filename){
 #' @export
 #'
 #' @examples
-#' mzML_MS2_filename <- system.file(""proteomics"", ""TMT_Erwinia_1uLSike_Top10HCD_isol2_45stepped_60min_01.mzML.gz"", package = ""msdata"")
+#' sf <- ""TMT_Erwinia_1uLSike_Top10HCD_isol2_45stepped_60min_01.mzML.gz""
+#' mzML_MS2_filename <- system.file(""proteomics"", sf, package = ""msdata"")
 #' grabMzmlMS2(mzML_MS2_filename)
 grabMzmlMS2 <- function(filename){
   xml_data <- xml2::read_xml(filename)

---FILE: man/grabMzmlMS2.Rd---
@@ -24,6 +24,7 @@ Retention time and precursor mass information can be read directly, while *m/z*
 information must be decoded from binary.
 }
 \examples{
-mzML_MS2_filename <- system.file(""proteomics"", ""TMT_Erwinia_1uLSike_Top10HCD_isol2_45stepped_60min_01.mzML.gz"", package = ""msdata"")
+sf <- ""TMT_Erwinia_1uLSike_Top10HCD_isol2_45stepped_60min_01.mzML.gz""
+mzML_MS2_filename <- system.file(""proteomics"", sf, package = ""msdata"")
 grabMzmlMS2(mzML_MS2_filename)
 }

---FILE: tests/testthat.R---
@@ -1,5 +1,4 @@
 library(testthat)
-library(RaMS)
 library(MSnbase)
 
 mzML_filename <- system.file(""proteomics"", ""MS3TMT11.mzML"", package = ""msdata"")",True,False,Documentation / Formatting,6
wkumler,RaMS,336c37b22f1d0fb215e5b551667f7efebca8c982,wkumler,wkumler@uw.edu,2020-11-11T08:56:31Z,wkumler,wkumler@uw.edu,2020-11-11T08:56:31Z,Fixed unit test to use MSnbase instead of custom code,R/grabMzmlCode.R;tests/testthat/test-grabMzmlCode.R,False,True,True,False,26,33,59,"---FILE: R/grabMzmlCode.R---
@@ -66,9 +66,7 @@ grabMzmlData <- function(filename){
   )
 
   rt_vals <- grabSpectraRt(ms1_nodes)
-
   mz_vals <- grabSpectraMz(ms1_nodes, file_metadata)
-
   int_vals <- grabSpectraInt(ms1_nodes, file_metadata)
 
   data.frame(rt=rep(rt_vals, sapply(mz_vals, length)),

---FILE: tests/testthat/test-grabMzmlCode.R---
@@ -18,24 +18,19 @@ test_that(""BPC can be read"", {
   expect_true(all(TIC$int>=BPC$int))
 })
 
-test_that(""new matches previous"", {
-  old_grabData_fun <- function(filename){
-    msdata <- mzR:::openMSfile(filename)
-    fullhd <- mzR::header(msdata)
-    spectra_list <- lapply(seq_len(nrow(fullhd)), function(x){
-      given_peaks <- mzR::peaks(msdata, x)
-      rtime <- fullhd[x, ""retentionTime""]
-      return(cbind(rtime, given_peaks))
-    })
-    all_data <- `names<-`(as.data.frame(do.call(rbind, spectra_list)),
-                          c(""rt"", ""mz"", ""int""))
-    return(all_data)
-  }
-  old_mzML_data <- old_grabData_fun(mzML_filename)
-  old_mzML_data$rt <- old_mzML_data$rt/60
+test_that(""new matches MSnbase"", {
+  MSnExp <- readMSData(mzML_filename, msLevel. = 1)
+  parsed_spectra <- lapply(as.list(MSnExp@assayData), function(spectrum){
+    data.frame(rt=spectrum@rt, mz=spectrum@mz, int=spectrum@intensity)
+  })
+  all_df <- do.call(rbind, parsed_spectra)
+  all_df <- all_df[order(all_df$rt),]
+  all_df$rt <- all_df$rt/60
+  rownames(all_df) <- NULL
+
   mzML_data <- grabMzmlData(mzML_filename)
 
-  expect_equal(old_mzML_data, mzML_data)
+  expect_equal(all_df, mzML_data)
 })
 
 # Except it doesn't - the sum of the individual intensities is less than the
@@ -52,18 +47,18 @@ test_that(""new matches previous"", {
 #   expect_equal(old_mzML_data, mzML_data)
 # })
 
-test_that(""mzML matches mzXML"", {
-  mzML_data <- grabMzmlData(mzML_filename)
-  mzXML_data <- grabMzxmlData(mzXML_filename)
-  all.equal(mzML_data, mzXML_data)
-
-  mzML_BPC <- grabMzmlBPC(mzML_filename)
-  mzXML_BPC <- grabMzxmlBPC(mzXML_filename)
-  all.equal(mzML_BPC$rt, mzXML_BPC$rt, tolerance = 1e-3)
-  all.equal(mzML_BPC$int, mzXML_BPC$int, tolerance = 1)
-
-  mzML_TIC <- grabMzmlBPC(mzML_filename, TIC = TRUE)
-  mzXML_TIC <- grabMzxmlBPC(mzXML_filename, TIC = TRUE)
-  all.equal(mzML_TIC$rt, mzXML_TIC$rt, tolerance = 1e-3)
-  all.equal(mzML_TIC$int, mzXML_TIC$int, tolerance = 1)
-})
+# test_that(""mzML matches mzXML"", {
+#   mzML_data <- grabMzmlData(mzML_filename)
+#   mzXML_data <- grabMzxmlData(mzXML_filename)
+#   all.equal(mzML_data, mzXML_data)
+#
+#   mzML_BPC <- grabMzmlBPC(mzML_filename)
+#   mzXML_BPC <- grabMzxmlBPC(mzXML_filename)
+#   all.equal(mzML_BPC$rt, mzXML_BPC$rt, tolerance = 1e-3)
+#   all.equal(mzML_BPC$int, mzXML_BPC$int, tolerance = 1)
+#
+#   mzML_TIC <- grabMzmlBPC(mzML_filename, TIC = TRUE)
+#   mzXML_TIC <- grabMzxmlBPC(mzXML_filename, TIC = TRUE)
+#   all.equal(mzML_TIC$rt, mzXML_TIC$rt, tolerance = 1e-3)
+#   all.equal(mzML_TIC$int, mzXML_TIC$int, tolerance = 1)
+# })",True,False,Implementation / Logic,6
wkumler,RaMS,7d7cc346977bcdf55f181c39a9b3f5bed18ccc90,wkumler,wkumler@uw.edu,2020-11-11T07:28:57Z,wkumler,wkumler@uw.edu,2020-11-11T07:29:55Z,Fixed bug in MSn grab due to looking at wrong xpath target,R/grabMzmlCode.R,False,True,True,False,3,2,5,"---FILE: R/grabMzmlCode.R---
@@ -79,7 +79,7 @@ grabMzmlData <- function(filename){
 #' @details This function reads an mzML file's MSn data into R's working memory. mzML files
 #' are fundamentally XML documents, which allows rapid access to the data by
 #' parsing the XML. The R package `xml2::` is used for this purpose here.
-#' Retention time information can be read directly, while *m/z* and intensity
+#' Retention time and precursor mass information can be read directly, while *m/z* and intensity
 #' information must be decoded from binary.
 #'
 #' @param filename The name of the mzML file to be read.
@@ -148,7 +148,8 @@ grabSpectraRt <- function(xml_nodes){
 }
 
 grabSpectraPremz <- function(xml_nodes){
-  premz_xpath <- 'd1:scanList/d1:scan/d1:userParam'
+  premz_xpath <- paste0('d1:precursorList/d1:precursor/d1:selectedIonList',
+                        '/d1:selectedIon/d1:cvParam[@name=""selected ion m/z""]')
   premz_nodes <- xml2::xml_find_all(xml_nodes, premz_xpath)
   as.numeric(xml2::xml_attr(premz_nodes, ""value""))
 }",True,False,Documentation / Formatting,3
wkumler,RaMS,1f183c87572b884aa719ef7c4180124bd21a8784,wkumler,wkumler@uw.edu,2020-10-29T20:52:45Z,wkumler,wkumler@uw.edu,2020-10-29T20:52:45Z,Fixing R CMD check warnings,DESCRIPTION;R/grabData.R;inst/extdata/180205_Poo_TruePoo_Full2.mzML,False,True,True,False,1,3,4,"---FILE: DESCRIPTION---
@@ -8,4 +8,4 @@ Description: R-based access to mass-spectrometry (MS) data
 License: MIT + file LICENSE
 Encoding: UTF-8
 LazyData: true
-Imports: data.table
+Imports: data.table, mzR, xml2

---FILE: R/grabData.R---
@@ -1,6 +1,4 @@
 # Requires xml2, mzR, data.table
-library(data.table)
-
 
 #' Read an mzML file into a data.frame
 #'",True,False,Dependency / Package,7
