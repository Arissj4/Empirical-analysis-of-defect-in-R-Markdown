repo_owner,repo_name,commit_hash,author_name,author_email,author_date,committer_name,committer_email,committer_date,message,filenames,touches_rmd,touches_r,touches_r_or_rmd,is_merge,added,deleted,changed,diff
Polkas,pacs,99a9b4927570d5630e78a7aa454b6446a921666a,Maciej Nasinski,nasinski.maciej@gmail.com,2024-09-27T20:17:19Z,GitHub,noreply@github.com,2024-09-27T20:17:19Z,"make a fix of pac_deps_timemachine and checked_packages (#36)

* make a fix for pac_deps_timemachine
* fix checked_packages",NEWS.md;R/check.R;R/deps_timemachine.R;tests/testthat/test-check.R;tests/testthat/test-deps.R,False,True,True,False,35,13,48,"---FILE: NEWS.md---
@@ -1,8 +1,10 @@
 # pacs 0.5.1.9000
 
+* fix `checked_packages` as there is a new DOM structure.
+* fix `pac_deps_timemachine` which not works in some cases.
+* fix a problem with app_deps on R 3.6.
 * add new functions: pac_news and pac_compare_news. Functions are NEWS file related.
 * update the tinyverse vignette with a new badge url.
-* fix a problem with app_deps on R 3.6.
 * improve code base.
 
 # pacs 0.5.1

---FILE: R/check.R---
@@ -137,11 +137,27 @@ read_checkred_packages_raw <- function(url = ""https://cran.r-project.org/web/che
     header_machines <- trimws(gsub(""check_flavors.html#"", """", xml_attr(xml_find_all(header_raw, ""//a""), ""href"")))
     which_machines <- grep(""r-"", header)
     header[which_machines] <- header_machines
-    result_raw <- matrix(trimws(xml_text(xml_find_all(read_html(paste0(rrr[2:length_rrr], collapse = ""\n"")), ""/html/body//tr/td""))),
-      ncol = length(header),
-      byrow = TRUE
-    )
-    result_raw <- as.data.frame(result_raw)
+
+    nmachines <- length(header_machines)
+    nmachines_empty <- rep("""", nmachines)
+    checks_text <- lapply(rrr[2:length_rrr], function(e) {
+      res_true <- trimws(xml_text(xml_find_all(read_html(paste0(e, collapse = ""\n"")), ""/html/body//tr/td[@class]"")))
+      if (length(res_true) == nmachines) {
+        res_true
+      } else {
+        nmachines_empty
+      }
+    })
+    checks_text_bind <- do.call(rbind, checks_text)
+
+    html_base <- suppressWarnings(read_html(paste0(rrr[2:length_rrr], collapse = ""\n"")))
+    xml_base <- xml_find_all(html_base, ""/html/body//tr"")
+    package_names <- trimws(xml_text(xml_find_all(xml_base, ""td[1]"")))
+    package_versions <- trimws(xml_text(xml_find_all(xml_base, ""td[2]"")))
+    package_maintainer <- trimws(xml_text(xml_find_all(xml_base, ""td[last()-1]"")))
+    package_priority <- trimws(xml_text(xml_find_all(xml_base, ""td[last()]"")))
+
+    result_raw <- as.data.frame(cbind(package_names, package_versions, checks_text_bind, package_maintainer, package_priority))
     colnames(result_raw) <- header
   } else {
     result_raw <- NA

---FILE: R/deps_timemachine.R---
@@ -69,8 +69,10 @@ pac_deps_timemachine <- function(pac,
       # not care about many versions for certain apckage as we taking the newset version
       if (isTRUE(r != ""R"" && r != pac && (!r %in% paks_global))) {
         pks <- pac_description(r, at = at, local = FALSE)
-        paks_global <<- c(stats::setNames(r, pks$Version), paks_global[paks_global != r])
-        if (recursive) deps(r, at, pks[fields])
+        if (is.list(pks)) {
+          paks_global <<- c(stats::setNames(r, pks$Version), paks_global[paks_global != r])
+          if (recursive) deps(r, at, pks[fields])
+        }
       }
     }
   }

---FILE: tests/testthat/test-check.R---
@@ -16,12 +16,12 @@ test_that(""pac_isin"", {
 
 test_that(""pacs::pac_checkred online"", {
   skip_if_offline()
-
+  skip_on_cran()
   expect_error(pac_checkred(""dplyr"", scope = """"), """")
   skip_if(isNA(checked_packages()))
-  expect_true(is.logical(pac_checkred(""dplyr"")))
+  expect_true(is.logical(pac_checkred(""dplyr"")) || isNA(pac_checkred(""dplyr"")))
   expect_message(pac_checkred(""WRONG""), ""WRONG package is not on CRAN"")
-  expect_true(is.na(suppressMessages(pac_checkred(""WRONG""))))
+  expect_true(isNA(suppressMessages(pac_checkred(""WRONG""))))
   expect_true(isNA(loc <- pac_checkred(""dplyr"",
     scope = c(""ERROR"", ""FAIL"", ""WARN""),
     flavors = c(

---FILE: tests/testthat/test-deps.R---
@@ -86,8 +86,9 @@ test_that(""pacs::pac_deps_timemachine"", {
   skip_if_offline()
   expect_message(pac_deps_timemachine(""WRONG"", ""0.8.0""), ""WRONG package is not on CRAN"")
   expect_identical(suppressMessages(pac_deps_timemachine(""WRONG"", ""0.8.0"")), NA)
-  expect_true(length(pac_deps_timemachine(""memoise"", ""0.2.1"")) == 1)
-  expect_true(length(pac_deps_timemachine(""memoise"", at = as.Date(""2019-01-01""))) == 1)
+  expect_length(pac_deps_timemachine(""memoise"", ""0.2.1""), 1)
+  expect_length(pac_deps_timemachine(""memoise"", at = as.Date(""2019-01-01"")),  1)
+  expect_true(length(pac_deps_timemachine(""ggplot2"", at = as.Date(""2020-10-10""))) > 0)
 })
 
 test_that(""pacs::pac_deps_timemachine offline"", {
@@ -188,6 +189,7 @@ test_that(""pac_deps_heavy with base"", {
 })
 
 test_that(""pac_deps_heavy 0 deps pac"", {
+  skip_on_cran()
   expect_identical(
     pac_deps_heavy(""base"", local = TRUE),
     structure(list(Package = character(0), NrDeps = integer(0), NrUniqueDeps = integer(0)), class = ""data.frame"", row.names = integer(0))"
Polkas,pacs,3359c624b169d7936a387174a142c9da54eee89f,Maciej Nasinski,nasinski.maciej@gmail.com,2024-09-08T22:43:56Z,Maciej Nasinski,nasinski.maciej@gmail.com,2024-09-08T22:43:56Z,fix app_deps on R 3.6,NEWS.md;R/deps.R,False,True,True,False,7,1,8,"---FILE: NEWS.md---
@@ -1,6 +1,7 @@
 # pacs 0.5.1.9000
 
 * update the tinyverse vignette with a new badge url.
+* fix a problem with app_deps on R 3.6.
 
 # pacs 0.5.1
 

---FILE: R/deps.R---
@@ -254,7 +254,12 @@ app_deps <- function(path = ""."",
       if (nrow(app_deps_recursive) == 0) {
         return(NA)
       }
-      app_deps_recursive <- stats::aggregate(app_deps_recursive[, c(""Version""), drop = FALSE], list(Package = app_deps_recursive$Package), pacs::compareVersionsMax)
+      app_deps_recursive$Version <- as.character(app_deps_recursive$Version)
+      app_deps_recursive <- stats::aggregate(
+        app_deps_recursive[, c(""Version""), drop = FALSE],
+        list(Package = app_deps_recursive$Package),
+        pacs::compareVersionsMax
+      )
       app_deps_recursive$Package <- as.character(app_deps_recursive$Package)
       app_deps_recursive$Direct <- app_deps_recursive$Package %in% app_deps
       return(app_deps_recursive)"
Polkas,pacs,f05bf96fedf367ec8cf8727361f3ace1d52928f0,Florian Kohrt,fkohrt@anche.no,2024-09-08T22:22:01Z,GitHub,noreply@github.com,2024-09-08T22:22:01Z,"Fix typo (#31)

* Fix typo
* Prepare 0.5.1.9000
---------

Co-authored-by: BlaubÃ¤r <blaubaer@blaubar-pc.fritz.box>",vignettes/tinyverse.Rmd,True,False,True,False,1,1,2,"---FILE: vignettes/tinyverse.Rmd---
@@ -60,7 +60,7 @@ miceFast:
 
 * badges are reevaluated daily.
 
-## tidyverse vs tidyverse
+## tinyverse vs tidyverse
 
 The `tidyverse` is an opinionated collection of R packages designed for data science. 
 All packages share an underlying design philosophy, grammar, and data structures. "
Polkas,pacs,eb9b628201a47f6756df8fc3ffb169b9d5c8acc1,Maciej Nasinski,nasinski.maciej@gmail.com,2022-06-24T17:42:42Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-06-24T17:42:42Z,fix url,DESCRIPTION;NEWS.md;vignettes/tinyverse.Rmd,True,False,True,False,6,2,8,"---FILE: DESCRIPTION---
@@ -1,6 +1,6 @@
 Package: pacs
 Title: Supplementary Tools for R Packages Developers
-Version: 0.4.6
+Version: 0.4.6.9000
 Authors@R: 
     person(given = ""Maciej"",
            family = ""Nasinski"",

---FILE: NEWS.md---
@@ -1,3 +1,7 @@
+# pacs 0.4.6.9000
+
+* fix the ""how-r-searches-and-finds-stuff"" url.
+
 # pacs 0.4.6
 
 * a new function `pac_deps_heavy`, the demand revealed during the `useR` 2022 Conference. The direct package dependencies and counts of dependencies for each of them. Help to identify heavy packages.

---FILE: vignettes/tinyverse.Rmd---
@@ -278,5 +278,5 @@ pac_deps_heavy(""devtools"")
 Please read in the order all of the 3 sources to become a R packages developer guru :=)
 
 - https://r-pkgs.org/
-- http://blog.obeautifulcode.com/R/How-R-Searches-And-Finds-Stuff/
+- https://blog.thatbuthow.com/how-r-searches-and-finds-stuff/
 - https://cran.r-project.org/doc/manuals/r-release/R-exts.html"
Polkas,pacs,b821e6b6b18ac1a317f0b78d5ccf88dfe21691ad,Maciej Nasinski,nasinski.maciej@gmail.com,2022-04-21T21:25:43Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-04-21T21:25:43Z,fix 2,DESCRIPTION;pacs-Ex.Rout;pacs-Ex.pdf;vignettes/Poster.Rmd,True,False,True,False,2,709,711,"---FILE: DESCRIPTION---
@@ -33,6 +33,7 @@ Imports:
     xml2,
     stringi
 Suggests: 
+    nomnoml,
     remotes,
     renv,
     withr,

---FILE: pacs-Ex.Rout---
@@ -1,707 +0,0 @@
-
-R version 4.1.3 (2022-03-10) -- ""One Push-Up""
-Copyright (C) 2022 The R Foundation for Statistical Computing
-Platform: aarch64-apple-darwin20 (64-bit)
-
-R is free software and comes with ABSOLUTELY NO WARRANTY.
-You are welcome to redistribute it under certain conditions.
-Type 'license()' or 'licence()' for distribution details.
-
-  Natural language support but running in an English locale
-
-R is a collaborative project with many contributors.
-Type 'contributors()' for more information and
-'citation()' on how to cite R or R packages in publications.
-
-Type 'demo()' for some demos, 'help()' for on-line help, or
-'help.start()' for an HTML browser interface to help.
-Type 'q()' to quit R.
-
-> pkgname <- ""pacs""
-> source(file.path(R.home(""share""), ""R"", ""examples-header.R""))
-> options(warn = 1)
-> library('pacs')
-> 
-> base::assign("".oldSearch"", base::search(), pos = 'CheckExEnv')
-> base::assign("".old_wd"", base::getwd(), pos = 'CheckExEnv')
-> cleanEx()
-> nameEx(""app_deps"")
-> ### * app_deps
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: app_deps
-> ### Title: The shiny app dependencies
-> ### Aliases: app_deps
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D library(renv)
-> ##D # Please update the path to the custom shiny app
-> ##D app_path <- system.file(""examples/04_mpg"", package = ""shiny"")
-> ##D pacs::app_deps(app_path)
-> ##D pacs::app_deps(app_path, recursive = FALSE)
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""app_size"")
-> ### * app_size
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: app_size
-> ### Title: Size of the shiny app
-> ### Aliases: app_size
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D library(renv)
-> ##D # Please update the path to the shiny app
-> ##D cat(pacs::app_size(system.file(""examples/04_mpg"", package = ""shiny"")) / 10**6, ""MB"")
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""bio_releases"")
-> ### * bio_releases
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: bio_releases
-> ### Title: Retrieving all Bioconductor releases
-> ### Aliases: bio_releases
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pacs::bio_releases()
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""biocran_repos"")
-> ### * biocran_repos
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: biocran_repos
-> ### Title: CRAN and Bioconductor repositories
-> ### Aliases: biocran_repos
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D biocran_repos()
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""checked_packages"")
-> ### * checked_packages
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: checked_packages
-> ### Title: Retrieving all R CRAN packages check pages statuses.
-> ### Aliases: checked_packages
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pacs::checked_packages()
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""compareVersionsMax"")
-> ### * compareVersionsMax
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: compareVersionsMax
-> ### Title: Maximum version across the vector
-> ### Aliases: compareVersionsMax
-> 
-> ### ** Examples
-> 
-> compareVersionsMax(c(""1.1.1"", ""0.2.0""))
-[1] ""1.1.1""
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""compareVersionsMin"")
-> ### * compareVersionsMin
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: compareVersionsMin
-> ### Title: Minimum version across the vector
-> ### Aliases: compareVersionsMin
-> 
-> ### ** Examples
-> 
-> compareVersionsMin(c(""1.1.1"", ""0.2.0""))
-[1] ""0.2.0""
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""cran_flavors"")
-> ### * cran_flavors
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: cran_flavors
-> ### Title: Retrieving all R CRAN servers flavors
-> ### Aliases: cran_flavors
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pacs::cran_flavors()
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""dir_size"")
-> ### * dir_size
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: dir_size
-> ### Title: Size of the package
-> ### Aliases: dir_size
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D cat(pacs::dir_size(system.file(package = ""stats"")) / 10**6, ""MB"")
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""lib_validate"")
-> ### * lib_validate
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: lib_validate
-> ### Title: Validate the local library
-> ### Aliases: lib_validate
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pacs::lib_validate()
-> ##D pacs::lib_validate(checkred = list(scope = c(""ERROR"", ""FAIL"", ""WARN"")))
-> ##D pacs::lib_validate(checkred = list(
-> ##D   scope = c(""ERROR"", ""FAIL""),
-> ##D   flavors = cran_flavors()$Flavor[1:2]
-> ##D ))
-> ##D # activate lifeduration argument, could be time consuming for bigger libraries.
-> ##D pacs::lib_validate(
-> ##D   lifeduration = TRUE,
-> ##D   checkred = list(scope = c(""ERROR"", ""FAIL""))
-> ##D )
-> ##D # only R CRAN repository
-> ##D pacs::lib_validate(repos = ""https://cran.rstudio.com/"")
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""lock_validate"")
-> ### * lock_validate
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: lock_validate
-> ### Title: Validate a specific renv lock file
-> ### Aliases: lock_validate
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D # path or url
-> ##D url <- ""https://raw.githubusercontent.com/Polkas/pacs/master/tests/testthat/files/renv_test.lock""
-> ##D pacs::lock_validate(url)
-> ##D 
-> ##D pacs::lock_validate(
-> ##D   url,
-> ##D   checkred = list(scope = c(""ERROR"", ""FAIL""), flavors = NULL)
-> ##D )
-> ##D 
-> ##D pacs::lock_validate(
-> ##D   url,
-> ##D   lifeduration = TRUE,
-> ##D   checkred = list(scope = c(""ERROR"", ""FAIL""), flavors = NULL)
-> ##D )
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pac_checkpage"")
-> ### * pac_checkpage
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pac_checkpage
-> ### Title: Retrieving the R CRAN package check page
-> ### Aliases: pac_checkpage
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pacs::pac_checkpage(""dplyr"")
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pac_checkred"")
-> ### * pac_checkred
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pac_checkred
-> ### Title: Checking the R CRAN package check page status
-> ### Aliases: pac_checkred
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pacs::pac_checkred(""dplyr"")
-> ##D pacs::pac_checkred(""dplyr"", scope = c(""ERROR""))
-> ##D pacs::pac_checkred(""dplyr"",
-> ##D   scope = c(""ERROR"", ""FAIL"", ""WARN""),
-> ##D   flavors = c(
-> ##D     ""r-devel-linux-x86_64-debian-clang"",
-> ##D     ""r-devel-linux-x86_64-debian-gcc""
-> ##D   )
-> ##D )
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pac_compare_namespace"")
-> ### * pac_compare_namespace
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pac_compare_namespace
-> ### Title: Compare NAMESPACE exports between specific CRAN packages
-> ###   versions
-> ### Aliases: pac_compare_namespace
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pacs::pac_compare_namespace(""shiny"", ""1.0.0"", ""1.6.0"")
-> ##D pacs::pac_compare_namespace(""shiny"", ""1.0.0"", ""1.6.0"")$exports
-> ##D # local version to newest one
-> ##D pacs::pac_compare_namespace(""shiny"")
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pac_compare_versions"")
-> ### * pac_compare_versions
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pac_compare_versions
-> ### Title: Compare DESCRIPTION files dependencies between specific CRAN
-> ###   packages versions
-> ### Aliases: pac_compare_versions
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pacs::pac_compare_versions(""memoise"", ""0.2.1"", ""2.0.0"")
-> ##D pacs::pac_compare_versions(""memoise"", ""0.2.1"")
-> ##D # local version to newest one
-> ##D pacs::pac_compare_versions(""memoise"")
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pac_deps"")
-> ### * pac_deps
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pac_deps
-> ### Title: Package dependencies
-> ### Aliases: pac_deps
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pacs::pac_deps(""stats"", base = TRUE)$Package
-> ##D pacs::pac_deps(""memoise"")$Package
-> ##D pacs::pac_deps(""memoise"", description_v = FALSE)
-> ##D # raw dependencies from DESCRIPTION file
-> ##D pacs::pac_deps(""memoise"", description_v = TRUE, recursive = FALSE)
-> ##D # raw dependencies from DESCRIPTION file - last release
-> ##D pacs::pac_deps(""memoise"", description_v = TRUE, local = FALSE, recursive = FALSE)
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pac_deps_dev"")
-> ### * pac_deps_dev
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pac_deps_dev
-> ### Title: Package dependencies - developer perspective
-> ### Aliases: pac_deps_dev
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pacs::pac_deps_dev(""dplyr"")
-> ##D pacs::pac_deps_dev(""pacs"")
-> ##D # with the main package in the list
-> ##D pacs::pac_deps_dev(""pacs"", attr = FALSE)
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pac_deps_timemachine"")
-> ### * pac_deps_timemachine
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pac_deps_timemachine
-> ### Title: R CRAN package dependencies for a certain version or time point
-> ### Aliases: pac_deps_timemachine
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pacs::pac_deps_timemachine(""memoise"", ""0.2.1"")
-> ##D pacs::pac_deps_timemachine(""memoise"", at = as.Date(""2019-01-01""))
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pac_deps_user"")
-> ### * pac_deps_user
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pac_deps_user
-> ### Title: Package dependencies - user perspective
-> ### Aliases: pac_deps_user
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pacs::pac_deps_user(""dplyr"")
-> ##D pacs::pac_deps_user(""pacs"")
-> ##D # with the main package in the list
-> ##D pacs::pac_deps_user(""pacs"", attr = FALSE)
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pac_description"")
-> ### * pac_description
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pac_description
-> ### Title: package DESCRIPTION file
-> ### Aliases: pac_description
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D   pacs::pac_description(""dplyr"", version = ""0.8.0"")
-> ##D   pacs::pac_description(""dplyr"", at = as.Date(""2019-02-01""))
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pac_health"")
-> ### * pac_health
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pac_health
-> ### Title: CRAN package health state at a specific Date or for a specific
-> ###   version
-> ### Aliases: pac_health
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pacs::pac_health(""memoise"")
-> ##D pacs::pac_health(""dplyr"", version = ""0.8.0"", limit = 14)
-> ##D pacs::pac_health(""dplyr"", at = as.Date(""2019-02-14""))
-> ##D pacs::pac_health(""dplyr"", limit = 14, scope = c(""ERROR"", ""FAIL""))
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pac_isin"")
-> ### * pac_isin
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pac_isin
-> ### Title: Checking if a package is in repositories
-> ### Aliases: pac_isin
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pac_isin(""dplyr"")
-> ##D pac_isin(""dplyr"", repos = ""https://cran.rstudio.com/"")
-> ##D pac_isin(""dplyr"", repos = biocran_repos()[grep(""Bio"", names(biocran_repos()))])
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pac_islast"")
-> ### * pac_islast
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pac_islast
-> ### Title: Checking if a package version is the most recent one
-> ### Aliases: pac_islast
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pac_islast(""memoise"")
-> ##D pac_islast(""dplyr"", version = ""1.0.0"")
-> ##D pac_islast(""S4Vectors"")
-> ##D pac_islast(""S4Vectors"", version = pac_last(""S4Vectors""))
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pac_last"")
-> ### * pac_last
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pac_last
-> ### Title: Getting the most recent package version
-> ### Aliases: pac_last
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pac_last(""dplyr"")
-> ##D pac_last(""S4Vectors"")
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pac_lifeduration"")
-> ### * pac_lifeduration
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pac_lifeduration
-> ### Title: Package version life duration at specific Date or for a specific
-> ###   version
-> ### Aliases: pac_lifeduration
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pacs::pac_lifeduration(""memoise"")
-> ##D pacs::pac_lifeduration(""memoise"", source = ""cran"")
-> ##D pacs::pac_lifeduration(""dplyr"", version = ""0.8.0"")
-> ##D pacs::pac_lifeduration(""dplyr"", at = as.Date(""2019-02-14""))
-> ##D # For Bioconductor packages it will work only for the newest per R version and installed ones.
-> ##D pacs::pac_lifeduration(""S4Vectors"")
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pac_namespace"")
-> ### * pac_namespace
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pac_namespace
-> ### Title: package NAMESPACE file
-> ### Aliases: pac_namespace
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pacs::pac_namespace(""dplyr"", version = ""0.8.0"")
-> ##D pacs::pac_namespace(""dplyr"", at = as.Date(""2019-02-01""))
-> ##D pacs::pac_namespace(""memoise"", local = TRUE)
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pac_size"")
-> ### * pac_size
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pac_size
-> ### Title: Size of the package
-> ### Aliases: pac_size
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D cat(pacs::pac_size(""stats"") / 10**6, ""MB"")
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pac_timemachine"")
-> ### * pac_timemachine
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pac_timemachine
-> ### Title: Package metadata for all releases
-> ### Aliases: pac_timemachine
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pacs::pac_timemachine(""dplyr"", at = as.Date(""2017-02-02""))
-> ##D pacs::pac_timemachine(""dplyr"", from = as.Date(""2017-02-02""), to = as.Date(""2018-04-02""))
-> ##D pacs::pac_timemachine(""dplyr"", at = Sys.Date())
-> ##D pacs::pac_timemachine(""tidyr"", from = as.Date(""2020-06-01""), to = Sys.Date())
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pac_true_size"")
-> ### * pac_true_size
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pac_true_size
-> ### Title: True size of the package
-> ### Aliases: pac_true_size
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D # size in MB, with all its dependencies
-> ##D pacs::pac_true_size(""memoise"") / 10**6
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pac_validate"")
-> ### * pac_validate
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pac_validate
-> ### Title: Validate a specific local package
-> ### Aliases: pac_validate
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pacs::pac_validate(""memoise"")
-> ##D pacs::pac_validate(
-> ##D   ""memoise"",
-> ##D   lifeduration = TRUE,
-> ##D   checkred = list(scope = c(""ERROR"", ""FAIL""), flavors = NULL)
-> ##D )
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pacs_base"")
-> ### * pacs_base
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pacs_base
-> ### Title: List of base R packages
-> ### Aliases: pacs_base
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pacs_base()
-> ##D pacs_base(startup = TRUE)
-> ## End(Not run)
-> 
-> 
-> 
-> cleanEx()
-> nameEx(""pacs_lifeduration"")
-> ### * pacs_lifeduration
-> 
-> flush(stderr()); flush(stdout())
-> 
-> ### Name: pacs_lifeduration
-> ### Title: Packages life duration for a specific version
-> ### Aliases: pacs_lifeduration
-> 
-> ### ** Examples
-> 
-> ## Not run: 
-> ##D pacs::pacs_lifeduration(c(""dplyr"", ""tidyr""), c(""1.0.0"", ""1.2.0""))
-> ##D pacs::pacs_lifeduration(c(""dplyr"", ""tidyr""), c(""1.0.0"", ""1.2.0""), source = ""loop_cran"")
-> ##D # last versions
-> ##D pacs::pacs_lifeduration(c(""dplyr"", ""tidyr""), sapply(c(""dplyr"", ""tidyr""), pacs::pac_last))
-> ## End(Not run)
-> 
-> 
-> 
-> ### * <FOOTER>
-> ###
-> cleanEx()
-> options(digits = 7L)
-> base::cat(""Time elapsed: "", proc.time() - base::get(""ptime"", pos = 'CheckExEnv'),""\n"")
-Time elapsed:  0.096 0.008 0.107 0 0 
-> grDevices::dev.off()
-null device 
-          1 
-> ###
-> ### Local variables: ***
-> ### mode: outline-minor ***
-> ### outline-regexp: ""\\(> \\)?### [*]+"" ***
-> ### End: ***
-> quit('no')

---FILE: vignettes/Poster.Rmd---
@@ -34,7 +34,7 @@ output:
   posterdown::posterdown_html:
     self_contained: TRUE
 vignette: >
-    %\VignetteIndexEntry{tinyverse}
+    %\VignetteIndexEntry{Poster}
     %\VignetteEngine{knitr::rmarkdown}
     %\VignetteEncoding{UTF-8}
 ---
@@ -49,7 +49,6 @@ knitr::opts_chunk$set(
   fig.align = ""center""
 )
 library(nomnoml)
-library(fontawesome)
 ```
 
 # Introduction"
Polkas,pacs,1936c6a0ac9a783f36cc2a77f2862bacd10b5ac6,Maciej Nasinski,nasinski.maciej@gmail.com,2022-04-21T21:13:14Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-04-21T21:13:14Z,fix,.Rbuildignore;R/deps.R;_pkgdown.yml;man/pac_deps_dev.Rd;pacs-Ex.Rout;pacs-Ex.pdf;vignettes/Poster.Rmd,True,True,True,False,715,29,744,"---FILE: .Rbuildignore---
@@ -8,3 +8,4 @@
 ^renv$
 ^renv\.lock$
 ^_pkgdown\.yaml$
+^_pkgdown\.yml$

---FILE: R/deps.R---
@@ -148,6 +148,7 @@ pac_deps_user <- function(pac, base = FALSE, local = FALSE, attr = TRUE, repos =
 #'  Dependencies are taken remotely for the newest version.
 #' @param pac character a package name.
 #' @param base logical if to add base packages too.
+#' @param local logical if to use local repository or newest CRAN packages, where by default local packages are used. Default: TRUE
 #' @param attr logical specify if a package and its version should be added as a attribute of data.frame or for FALSE as an additional record. Default: TRUE
 #' @param repos character vector URLs of the repositories to use. By default checking CRAN and newest Bioconductor per R version. Default `pacs::biocran_repos()`
 #' If `TRUE` then `pacs::pacs_base()` are taken into account. Default: FALSE

---FILE: _pkgdown.yml---
@@ -1,28 +0,0 @@
-reference:
-- title: ""Validate the library""
-  desc: >
-    Checking if packages have correct versions taking into account all DESCRIPTION files requirements.
-    Moreover identifying which packages are newest releases.
-    Optionally we could add life duration and CRAN check page status for each package.
-  contents:
-  - lib_validate
-  - lock_validate
-- title: ""Per package utils""
-  desc: """"
-  contents:
-  -
-- title: ""Compare different package versions""
-  desc: >
-    "".""
-  contents:
-  -
-- title: ""The shiny app utils""
-  desc: >
-    "".""
-  contents:
-  -
-
-
-Package Weight Case Study: devtools
-The shiny app utils
-Base packages

---FILE: man/pac_deps_dev.Rd---
@@ -17,6 +17,8 @@ pac_deps_dev(
 
 \item{base}{logical if to add base packages too.}
 
+\item{local}{logical if to use local repository or newest CRAN packages, where by default local packages are used. Default: TRUE}
+
 \item{attr}{logical specify if a package and its version should be added as a attribute of data.frame or for FALSE as an additional record. Default: TRUE}
 
 \item{repos}{character vector URLs of the repositories to use. By default checking CRAN and newest Bioconductor per R version. Default \code{pacs::biocran_repos()}

---FILE: pacs-Ex.Rout---
@@ -0,0 +1,707 @@
+
+R version 4.1.3 (2022-03-10) -- ""One Push-Up""
+Copyright (C) 2022 The R Foundation for Statistical Computing
+Platform: aarch64-apple-darwin20 (64-bit)
+
+R is free software and comes with ABSOLUTELY NO WARRANTY.
+You are welcome to redistribute it under certain conditions.
+Type 'license()' or 'licence()' for distribution details.
+
+  Natural language support but running in an English locale
+
+R is a collaborative project with many contributors.
+Type 'contributors()' for more information and
+'citation()' on how to cite R or R packages in publications.
+
+Type 'demo()' for some demos, 'help()' for on-line help, or
+'help.start()' for an HTML browser interface to help.
+Type 'q()' to quit R.
+
+> pkgname <- ""pacs""
+> source(file.path(R.home(""share""), ""R"", ""examples-header.R""))
+> options(warn = 1)
+> library('pacs')
+> 
+> base::assign("".oldSearch"", base::search(), pos = 'CheckExEnv')
+> base::assign("".old_wd"", base::getwd(), pos = 'CheckExEnv')
+> cleanEx()
+> nameEx(""app_deps"")
+> ### * app_deps
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: app_deps
+> ### Title: The shiny app dependencies
+> ### Aliases: app_deps
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D library(renv)
+> ##D # Please update the path to the custom shiny app
+> ##D app_path <- system.file(""examples/04_mpg"", package = ""shiny"")
+> ##D pacs::app_deps(app_path)
+> ##D pacs::app_deps(app_path, recursive = FALSE)
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""app_size"")
+> ### * app_size
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: app_size
+> ### Title: Size of the shiny app
+> ### Aliases: app_size
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D library(renv)
+> ##D # Please update the path to the shiny app
+> ##D cat(pacs::app_size(system.file(""examples/04_mpg"", package = ""shiny"")) / 10**6, ""MB"")
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""bio_releases"")
+> ### * bio_releases
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: bio_releases
+> ### Title: Retrieving all Bioconductor releases
+> ### Aliases: bio_releases
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pacs::bio_releases()
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""biocran_repos"")
+> ### * biocran_repos
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: biocran_repos
+> ### Title: CRAN and Bioconductor repositories
+> ### Aliases: biocran_repos
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D biocran_repos()
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""checked_packages"")
+> ### * checked_packages
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: checked_packages
+> ### Title: Retrieving all R CRAN packages check pages statuses.
+> ### Aliases: checked_packages
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pacs::checked_packages()
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""compareVersionsMax"")
+> ### * compareVersionsMax
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: compareVersionsMax
+> ### Title: Maximum version across the vector
+> ### Aliases: compareVersionsMax
+> 
+> ### ** Examples
+> 
+> compareVersionsMax(c(""1.1.1"", ""0.2.0""))
+[1] ""1.1.1""
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""compareVersionsMin"")
+> ### * compareVersionsMin
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: compareVersionsMin
+> ### Title: Minimum version across the vector
+> ### Aliases: compareVersionsMin
+> 
+> ### ** Examples
+> 
+> compareVersionsMin(c(""1.1.1"", ""0.2.0""))
+[1] ""0.2.0""
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""cran_flavors"")
+> ### * cran_flavors
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: cran_flavors
+> ### Title: Retrieving all R CRAN servers flavors
+> ### Aliases: cran_flavors
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pacs::cran_flavors()
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""dir_size"")
+> ### * dir_size
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: dir_size
+> ### Title: Size of the package
+> ### Aliases: dir_size
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D cat(pacs::dir_size(system.file(package = ""stats"")) / 10**6, ""MB"")
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""lib_validate"")
+> ### * lib_validate
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: lib_validate
+> ### Title: Validate the local library
+> ### Aliases: lib_validate
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pacs::lib_validate()
+> ##D pacs::lib_validate(checkred = list(scope = c(""ERROR"", ""FAIL"", ""WARN"")))
+> ##D pacs::lib_validate(checkred = list(
+> ##D   scope = c(""ERROR"", ""FAIL""),
+> ##D   flavors = cran_flavors()$Flavor[1:2]
+> ##D ))
+> ##D # activate lifeduration argument, could be time consuming for bigger libraries.
+> ##D pacs::lib_validate(
+> ##D   lifeduration = TRUE,
+> ##D   checkred = list(scope = c(""ERROR"", ""FAIL""))
+> ##D )
+> ##D # only R CRAN repository
+> ##D pacs::lib_validate(repos = ""https://cran.rstudio.com/"")
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""lock_validate"")
+> ### * lock_validate
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: lock_validate
+> ### Title: Validate a specific renv lock file
+> ### Aliases: lock_validate
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D # path or url
+> ##D url <- ""https://raw.githubusercontent.com/Polkas/pacs/master/tests/testthat/files/renv_test.lock""
+> ##D pacs::lock_validate(url)
+> ##D 
+> ##D pacs::lock_validate(
+> ##D   url,
+> ##D   checkred = list(scope = c(""ERROR"", ""FAIL""), flavors = NULL)
+> ##D )
+> ##D 
+> ##D pacs::lock_validate(
+> ##D   url,
+> ##D   lifeduration = TRUE,
+> ##D   checkred = list(scope = c(""ERROR"", ""FAIL""), flavors = NULL)
+> ##D )
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pac_checkpage"")
+> ### * pac_checkpage
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pac_checkpage
+> ### Title: Retrieving the R CRAN package check page
+> ### Aliases: pac_checkpage
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pacs::pac_checkpage(""dplyr"")
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pac_checkred"")
+> ### * pac_checkred
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pac_checkred
+> ### Title: Checking the R CRAN package check page status
+> ### Aliases: pac_checkred
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pacs::pac_checkred(""dplyr"")
+> ##D pacs::pac_checkred(""dplyr"", scope = c(""ERROR""))
+> ##D pacs::pac_checkred(""dplyr"",
+> ##D   scope = c(""ERROR"", ""FAIL"", ""WARN""),
+> ##D   flavors = c(
+> ##D     ""r-devel-linux-x86_64-debian-clang"",
+> ##D     ""r-devel-linux-x86_64-debian-gcc""
+> ##D   )
+> ##D )
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pac_compare_namespace"")
+> ### * pac_compare_namespace
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pac_compare_namespace
+> ### Title: Compare NAMESPACE exports between specific CRAN packages
+> ###   versions
+> ### Aliases: pac_compare_namespace
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pacs::pac_compare_namespace(""shiny"", ""1.0.0"", ""1.6.0"")
+> ##D pacs::pac_compare_namespace(""shiny"", ""1.0.0"", ""1.6.0"")$exports
+> ##D # local version to newest one
+> ##D pacs::pac_compare_namespace(""shiny"")
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pac_compare_versions"")
+> ### * pac_compare_versions
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pac_compare_versions
+> ### Title: Compare DESCRIPTION files dependencies between specific CRAN
+> ###   packages versions
+> ### Aliases: pac_compare_versions
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pacs::pac_compare_versions(""memoise"", ""0.2.1"", ""2.0.0"")
+> ##D pacs::pac_compare_versions(""memoise"", ""0.2.1"")
+> ##D # local version to newest one
+> ##D pacs::pac_compare_versions(""memoise"")
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pac_deps"")
+> ### * pac_deps
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pac_deps
+> ### Title: Package dependencies
+> ### Aliases: pac_deps
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pacs::pac_deps(""stats"", base = TRUE)$Package
+> ##D pacs::pac_deps(""memoise"")$Package
+> ##D pacs::pac_deps(""memoise"", description_v = FALSE)
+> ##D # raw dependencies from DESCRIPTION file
+> ##D pacs::pac_deps(""memoise"", description_v = TRUE, recursive = FALSE)
+> ##D # raw dependencies from DESCRIPTION file - last release
+> ##D pacs::pac_deps(""memoise"", description_v = TRUE, local = FALSE, recursive = FALSE)
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pac_deps_dev"")
+> ### * pac_deps_dev
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pac_deps_dev
+> ### Title: Package dependencies - developer perspective
+> ### Aliases: pac_deps_dev
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pacs::pac_deps_dev(""dplyr"")
+> ##D pacs::pac_deps_dev(""pacs"")
+> ##D # with the main package in the list
+> ##D pacs::pac_deps_dev(""pacs"", attr = FALSE)
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pac_deps_timemachine"")
+> ### * pac_deps_timemachine
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pac_deps_timemachine
+> ### Title: R CRAN package dependencies for a certain version or time point
+> ### Aliases: pac_deps_timemachine
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pacs::pac_deps_timemachine(""memoise"", ""0.2.1"")
+> ##D pacs::pac_deps_timemachine(""memoise"", at = as.Date(""2019-01-01""))
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pac_deps_user"")
+> ### * pac_deps_user
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pac_deps_user
+> ### Title: Package dependencies - user perspective
+> ### Aliases: pac_deps_user
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pacs::pac_deps_user(""dplyr"")
+> ##D pacs::pac_deps_user(""pacs"")
+> ##D # with the main package in the list
+> ##D pacs::pac_deps_user(""pacs"", attr = FALSE)
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pac_description"")
+> ### * pac_description
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pac_description
+> ### Title: package DESCRIPTION file
+> ### Aliases: pac_description
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D   pacs::pac_description(""dplyr"", version = ""0.8.0"")
+> ##D   pacs::pac_description(""dplyr"", at = as.Date(""2019-02-01""))
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pac_health"")
+> ### * pac_health
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pac_health
+> ### Title: CRAN package health state at a specific Date or for a specific
+> ###   version
+> ### Aliases: pac_health
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pacs::pac_health(""memoise"")
+> ##D pacs::pac_health(""dplyr"", version = ""0.8.0"", limit = 14)
+> ##D pacs::pac_health(""dplyr"", at = as.Date(""2019-02-14""))
+> ##D pacs::pac_health(""dplyr"", limit = 14, scope = c(""ERROR"", ""FAIL""))
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pac_isin"")
+> ### * pac_isin
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pac_isin
+> ### Title: Checking if a package is in repositories
+> ### Aliases: pac_isin
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pac_isin(""dplyr"")
+> ##D pac_isin(""dplyr"", repos = ""https://cran.rstudio.com/"")
+> ##D pac_isin(""dplyr"", repos = biocran_repos()[grep(""Bio"", names(biocran_repos()))])
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pac_islast"")
+> ### * pac_islast
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pac_islast
+> ### Title: Checking if a package version is the most recent one
+> ### Aliases: pac_islast
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pac_islast(""memoise"")
+> ##D pac_islast(""dplyr"", version = ""1.0.0"")
+> ##D pac_islast(""S4Vectors"")
+> ##D pac_islast(""S4Vectors"", version = pac_last(""S4Vectors""))
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pac_last"")
+> ### * pac_last
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pac_last
+> ### Title: Getting the most recent package version
+> ### Aliases: pac_last
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pac_last(""dplyr"")
+> ##D pac_last(""S4Vectors"")
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pac_lifeduration"")
+> ### * pac_lifeduration
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pac_lifeduration
+> ### Title: Package version life duration at specific Date or for a specific
+> ###   version
+> ### Aliases: pac_lifeduration
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pacs::pac_lifeduration(""memoise"")
+> ##D pacs::pac_lifeduration(""memoise"", source = ""cran"")
+> ##D pacs::pac_lifeduration(""dplyr"", version = ""0.8.0"")
+> ##D pacs::pac_lifeduration(""dplyr"", at = as.Date(""2019-02-14""))
+> ##D # For Bioconductor packages it will work only for the newest per R version and installed ones.
+> ##D pacs::pac_lifeduration(""S4Vectors"")
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pac_namespace"")
+> ### * pac_namespace
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pac_namespace
+> ### Title: package NAMESPACE file
+> ### Aliases: pac_namespace
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pacs::pac_namespace(""dplyr"", version = ""0.8.0"")
+> ##D pacs::pac_namespace(""dplyr"", at = as.Date(""2019-02-01""))
+> ##D pacs::pac_namespace(""memoise"", local = TRUE)
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pac_size"")
+> ### * pac_size
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pac_size
+> ### Title: Size of the package
+> ### Aliases: pac_size
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D cat(pacs::pac_size(""stats"") / 10**6, ""MB"")
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pac_timemachine"")
+> ### * pac_timemachine
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pac_timemachine
+> ### Title: Package metadata for all releases
+> ### Aliases: pac_timemachine
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pacs::pac_timemachine(""dplyr"", at = as.Date(""2017-02-02""))
+> ##D pacs::pac_timemachine(""dplyr"", from = as.Date(""2017-02-02""), to = as.Date(""2018-04-02""))
+> ##D pacs::pac_timemachine(""dplyr"", at = Sys.Date())
+> ##D pacs::pac_timemachine(""tidyr"", from = as.Date(""2020-06-01""), to = Sys.Date())
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pac_true_size"")
+> ### * pac_true_size
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pac_true_size
+> ### Title: True size of the package
+> ### Aliases: pac_true_size
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D # size in MB, with all its dependencies
+> ##D pacs::pac_true_size(""memoise"") / 10**6
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pac_validate"")
+> ### * pac_validate
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pac_validate
+> ### Title: Validate a specific local package
+> ### Aliases: pac_validate
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pacs::pac_validate(""memoise"")
+> ##D pacs::pac_validate(
+> ##D   ""memoise"",
+> ##D   lifeduration = TRUE,
+> ##D   checkred = list(scope = c(""ERROR"", ""FAIL""), flavors = NULL)
+> ##D )
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pacs_base"")
+> ### * pacs_base
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pacs_base
+> ### Title: List of base R packages
+> ### Aliases: pacs_base
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pacs_base()
+> ##D pacs_base(startup = TRUE)
+> ## End(Not run)
+> 
+> 
+> 
+> cleanEx()
+> nameEx(""pacs_lifeduration"")
+> ### * pacs_lifeduration
+> 
+> flush(stderr()); flush(stdout())
+> 
+> ### Name: pacs_lifeduration
+> ### Title: Packages life duration for a specific version
+> ### Aliases: pacs_lifeduration
+> 
+> ### ** Examples
+> 
+> ## Not run: 
+> ##D pacs::pacs_lifeduration(c(""dplyr"", ""tidyr""), c(""1.0.0"", ""1.2.0""))
+> ##D pacs::pacs_lifeduration(c(""dplyr"", ""tidyr""), c(""1.0.0"", ""1.2.0""), source = ""loop_cran"")
+> ##D # last versions
+> ##D pacs::pacs_lifeduration(c(""dplyr"", ""tidyr""), sapply(c(""dplyr"", ""tidyr""), pacs::pac_last))
+> ## End(Not run)
+> 
+> 
+> 
+> ### * <FOOTER>
+> ###
+> cleanEx()
+> options(digits = 7L)
+> base::cat(""Time elapsed: "", proc.time() - base::get(""ptime"", pos = 'CheckExEnv'),""\n"")
+Time elapsed:  0.096 0.008 0.107 0 0 
+> grDevices::dev.off()
+null device 
+          1 
+> ###
+> ### Local variables: ***
+> ### mode: outline-minor ***
+> ### outline-regexp: ""\\(> \\)?### [*]+"" ***
+> ### End: ***
+> quit('no')

---FILE: vignettes/Poster.Rmd---
@@ -24,7 +24,6 @@ affiliation_textsize: ""25px""
 affiliation_textcol: 'white'
 caption_fontsize: ""16pt""
 body_textsize: ""40pt""
-#Middle of the poster
 middle_fontfamily: ""Special Elite""
 middle_textcol: ""#FFFFFF""
 middle:textalpha: 90
@@ -34,6 +33,10 @@ logoleft_name: https&#58;//github.com/Polkas/pacs/raw/7779b249843a5423ca735f7bc4
 output: 
   posterdown::posterdown_html:
     self_contained: TRUE
+vignette: >
+    %\VignetteIndexEntry{tinyverse}
+    %\VignetteEngine{knitr::rmarkdown}
+    %\VignetteEncoding{UTF-8}
 ---
 
 ```{r setup, include=FALSE}"
Polkas,pacs,4d4f7a9a5d9a0d92a53b84293873bb563a037106,Maciej Nasinski,nasinski.maciej@gmail.com,2022-04-02T21:43:17Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-04-02T21:43:17Z,fix 3.6,tests/testthat/test-deps.R,False,True,True,False,1,1,2,"---FILE: tests/testthat/test-deps.R---
@@ -127,5 +127,5 @@ test_that(""pac_deps_dev"", {
   expect_identical(sort(pp), sort(rrr))
 
   expect_true(isNA(pac_deps_dev(""WRONG"")))
-  expect_true(nrow(pac_deps_dev(""tinytest"")) >= 0)
+  expect_true(nrow(pac_deps_dev(""tinytest"", repos = ""https://cran.rstudio.com/"")) >= 0)
 })"
Polkas,pacs,3cafae3e270551813e87086f1f2b049021d79add,Maciej Nasinski,nasinski.maciej@gmail.com,2022-04-02T13:29:24Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-04-02T13:29:24Z,fix,R/comapre.R;R/deps.R;R/description.R;R/lifeduration.R;R/namespace.R;R/utils.R;R/valid.R;man/app_deps.Rd;man/available_packages.Rd;man/pac_compare_namespace.Rd;man/pac_compare_versions.Rd;man/pac_deps.Rd;man/pac_deps_dev.Rd;man/pac_deps_user.Rd;man/pac_description.Rd;man/pac_health.Rd;man/pac_lifeduration.Rd;man/pac_namespace.Rd;man/pac_validate.Rd;man/pacs_lifeduration.Rd;tests/testthat/test-deps.R,False,True,True,False,40,34,74,"---FILE: R/comapre.R---
@@ -7,7 +7,7 @@
 #' Character string ""all"" is shorthand for that vector, character string ""most"" for the same vector without ""Enhances"", character string ""strong"" (default) for the first three elements of that vector.
 #' Default: `c(""Depends"", ""Imports"", ""LinkingTo"")`
 #' @param lib.loc character vector. Default: `.libPaths()`
-#' @param repos character the base URL of the CRAN repository to use. Default ""https://cran.rstudio.org""
+#' @param repos character vector URLs of the repositories to use. Used only for the validation. Default `https://cran.rstudio.com/`
 #' @return data.frame with 4 columns.
 #' \describe{
 #' \item{Package}{character package names.}
@@ -88,7 +88,7 @@ pac_compare_versions <- function(pac,
 #' @param old character an old version of package.
 #' @param new character a new version of package.
 #' @param lib.loc character vector. Default:
-#' @param repos character the base URL of the CRAN repository to use. Used only for the validation. Default `https://cran.rstudio.com/`
+#' @param repos character vector URLs of the repositories to use. Used only for the validation. Default `https://cran.rstudio.com/`
 #' @return list with `c(""imports"", ""exports"", ""exportPatterns"", ""importClasses"", ""importMethods"", ""exportClasses"", ""exportMethods"", ""exportClassPatterns"", ""dynlibs"", ""S3methods"")` slots, and added and removed ones for each of them.
 #' @export
 #' @examples

---FILE: R/deps.R---
@@ -10,7 +10,7 @@
 #' @param description_v if the dependencies version should be taken from description files, minimal required. By default installed versions are taken. Default: FALSE
 #' @param attr logical specify if a package and its version should be added as a attribute of data.frame or for FALSE as a additional record. Default: TRUE
 #' @param recursive logical If to assess the dependencies recursively. Default: TRUE
-#' @param repos character the base URL of the CRAN repository to use. Used only for the validation. Default `pacs::biocran_repos()`
+#' @param repos character vector URLs of the repositories to use. By default checking CRAN and newest Bioconductor per R version. Default `pacs::biocran_repos()`
 #' @return data.frame with packages and their versions. Versions are taken from `installed.packages` or newest released.
 #' @note When function is invoked in the loop afterwards results could be aggregated like,
 #' `stats::aggregate(results[, c(""Version""), drop = FALSE], list(Package = results$Package), pacs::compareVersionsMax)`.
@@ -125,14 +125,15 @@ pac_deps <- function(pac,
 #' @param pac character a package name.
 #' @param base logical if to add base packages too.
 #' @param attr logical specify if a package and its version should be added as a attribute of data.frame or for FALSE as a additional record. Default: TRUE
+#' @param repos character vector URLs of the repositories to use. By default checking CRAN and newest Bioconductor per R version. Default `pacs::biocran_repos()`
 #' If `TRUE` then `pacs::pacs_base()` are taken into account. Default: FALSE
 #' @export
 #' @examples
 #' \dontrun{
 #' pacs::pac_deps_user(""dplyr"")
 #' pacs::pac_deps_user(""cat2cat"")
 #' }
-pac_deps_user <- function(pac, base = FALSE, attr = TRUE) {
+pac_deps_user <- function(pac, base = FALSE, attr = TRUE, repos = pacs::biocran_repos()) {
   pac_deps(pac, recursive = TRUE, description_v = TRUE, local = FALSE, base = base, attr = attr)
 }
 
@@ -145,14 +146,15 @@ pac_deps_user <- function(pac, base = FALSE, attr = TRUE) {
 #' @param pac character a package name.
 #' @param base logical if to add base packages too.
 #' @param attr logical specify if a package and its version should be added as a attribute of data.frame or for FALSE as a additional record. Default: TRUE
+#' @param repos character vector URLs of the repositories to use. By default checking CRAN and newest Bioconductor per R version. Default `pacs::biocran_repos()`
 #' If `TRUE` then `pacs::pacs_base()` are taken into account. Default: FALSE
 #' @export
 #' @examples
 #' \dontrun{
 #' pacs::pac_deps_dev(""dplyr"")
 #' pacs::pac_deps_dev(""cat2cat"")
 #' }
-pac_deps_dev <- function(pac, base = FALSE, attr = TRUE) {
+pac_deps_dev <- function(pac, base = FALSE, attr = TRUE, repos = pacs::biocran_repos()) {
   top <- pac_deps(pac, recursive = TRUE, description_v = TRUE, local = FALSE, base = base, attr = attr)
   suggs <- pac_deps(pac, recursive = FALSE, description_v = TRUE, local = FALSE, fields = ""Suggests"", base = base)
   suggs_r <- do.call(rbind, lapply(suggs$Package, function(x) pac_deps(x, description_v = TRUE, local = FALSE, base = base)))
@@ -173,7 +175,7 @@ pac_deps_dev <- function(pac, base = FALSE, attr = TRUE) {
 #' @param local logical if to use local repository or newest CRAN packages, where by default local packages are used. Default: TRUE
 #' @param description_v if the dependencies version should be taken from description files, minimal required. By default installed versions are taken. Default: FALSE
 #' @param recursive logical if to assess the dependencies recursively. Default: TRUE
-#' @param repos character the base URL of the CRAN repository to use. Used only for the validation. Default `pacs::biocran_repos()`
+#' @param repos character vector URLs of the repositories to use. By default checking CRAN and newest Bioconductor per R version. Default `pacs::biocran_repos()`
 #' @return character vector with dependency packages or data.frame when checking recursively.
 #' @note `renv` package has to be installed. `base` packages are not taken into account.
 #' @export

---FILE: R/description.R---
@@ -5,7 +5,7 @@
 #' @param at Date. Default: NULL
 #' @param local logical if to use local library. Default: FALSE
 #' @param lib.loc character vector, used optionally when local is equal TRUE. Default: `.libPaths()`
-#' @param repos character the base URL of the CRAN repository to use. Used only for the validation. Default `https://cran.rstudio.com/`
+#' @param repos character vector URLs of the repositories to use. Used only for the validation. Default `https://cran.rstudio.com/`
 #' @return list with names proper for DESCRIPTION file fields.
 #' @note Results are cached for 30 minutes with `memoise` package.
 #' @export

---FILE: R/lifeduration.R---
@@ -5,7 +5,7 @@
 #' The local repository has priority, it version is available. Default: NULL
 #' @param at Date old version of package. Default: NULL
 #' @param lib.loc character vector. Is omitted for non NULL version. Default: `.libPaths()`
-#' @param repos character vector base URLs of the repositories to use. By default checking CRAN and newest Bioconductor. Default `pacs::biocran_repos()`
+#' @param repos character vector URLs of the repositories to use. By default checking CRAN and newest Bioconductor per R version. Default `pacs::biocran_repos()`
 #' @param source character one of `c(""crandb"", ""cran"")`. Using the `MEATCRAN  CRANDB` or the direct web page download from CRAN. Default: `""crandb""`
 #' @return `difftime`, number of days package version was the newest one.
 #' @note
@@ -100,7 +100,7 @@ pac_lifeduration <- function(pac,
 #' @param scope character vector scope of R CRAN check pages statuses to consider, any of `c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")`. Default `c(""ERROR"", ""FAIL"")`
 #' @param flavors character vector of CRAN machines to consider, which might be retrieved with `pacs::cran_flavors()$Flavor`. By default all CRAN machines are considered, NULL value. Default NULL
 #' @param lib.loc character vector. Is omitted for non NULL version. Default: `.libPaths()`
-#' @param repos character the base CRAN URL of the repository to use. Default ""https://cran.rstudio.org""
+#' @param repos character vector URLs of the repositories to use. Default `https://cran.rstudio.com/`
 #' @param source character one of `c(""crandb"", ""cran"")`. Using the `MEATCRAN` DB or the direct web page download from CRAN. Default: `""crandb""`
 #' @return logical if a package is healthy.
 #' @note
@@ -161,8 +161,8 @@ pac_health <- function(pac,
 #' The `""crandb""` works if less than `getOption(""pacs.crandb_limit"")` (currently 500) packages are looked for.
 #' Default: `""crandb""`
 #' @param lib.loc character vector. Is omitted for non NULL version. Default: `.libPaths()`
-#' @param repos character the base CRAN URL of the repository to use. Default `""https://cran.rstudio.org""`
-#' @param pacs character vector packages names.
+#' @param repos character vector repositories. Default `https://cran.rstudio.org`
+#' @param pacs character vector packages names.``
 #' @return data.frame with two columns package name and life duration.
 #' @note
 #' Results are cached for 30 minutes with `memoise` package.

---FILE: R/namespace.R---
@@ -5,7 +5,7 @@
 #' @param at Date. Default: NULL
 #' @param local logical if to use local library. Default: FALSE
 #' @param lib.loc character vector, used optionally when local is equal TRUE. Default: `.libPaths()`
-#' @param repos character the base URL of the CRAN repository to use. Used only for the validation. Default `https://cran.rstudio.com/`
+#' @param repos character vector URLs of the repositories to use. Used only for the validation. Default `https://cran.rstudio.com/`
 #' @return list with names proper for NAMESPACE file, the same as format as returned by `base::parseNamespaceFile`.
 #' @note Results are cached for 30 minutes with `memoise` package.
 #' This function is mainly built under source code from `base::parseNamespaceFile`.

---FILE: R/utils.R---
@@ -164,7 +164,7 @@ installed_agg_fun <- memoise::memoise(installed_agg_fun_raw, cache = cachem::cac
 
 #' List Available Packages at CRAN-like Repositories
 #' @description available_packages returns a matrix of details corresponding to packages currently available at one or more repositories. The current list of packages is downloaded over the internet (or copied from a local mirror).
-#' @param repos character vector, the base URL(s) of the repositories to use. Default `pacs::biocran_repos()`
+#' @param repos character vector URLs of the repositories to use. By default checking CRAN and newest Bioconductor per R version. Default `pacs::biocran_repos()`
 #' @keywords internal
 available_packages <- function(repos) {
   tryCatch(available_packages_raw(repos = repos), error = function(e) NA)

---FILE: R/valid.R---
@@ -102,7 +102,7 @@ lib_validate <- function(lib.loc = .libPaths(),
 #' Default: `c(""Depends"", ""Imports"", ""LinkingTo"")`
 #' @param lifeduration logical if to assess life duration for each package in the library. `MEATCRAN CRANDB` is used for less than 500 packages. The direct web page download from CRAN or local evaluation for newest packages otherwise. Default: FALSE
 #' @param checkred list with two named fields, `scope` and `flavor`. `scope` of R CRAN check pages statuses to consider, any of `c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")`. `flavor` vector of machines to consider, which might be retrieved with `pacs::cran_flavors()$Flavor`. By default an empty scope field deactivated assessment for `checkred` column, and NULL flavor will results in checking all machines. Default `list(scope = character(0), flavor = NULL)`
-#' @param repos character vector base URLs of the repositories to use. By default checking CRAN and newest Bioconductor per R version. Default `pacs::biocran_repos()`
+#' @param repos character vector URLs of the repositories to use. By default checking CRAN and newest Bioconductor per R version. Default `pacs::biocran_repos()`
 #' @return data.frame with 5/7/8/9 columns.
 #' \describe{
 #' \item{Package}{character a package name.}

---FILE: man/app_deps.Rd---
@@ -29,7 +29,7 @@ Default: \code{c(""Depends"", ""Imports"", ""LinkingTo"")}}
 
 \item{recursive}{logical if to assess the dependencies recursively. Default: TRUE}
 
-\item{repos}{character the base URL of the CRAN repository to use. Used only for the validation. Default \code{pacs::biocran_repos()}}
+\item{repos}{character vector URLs of the repositories to use. By default checking CRAN and newest Bioconductor per R version. Default \code{pacs::biocran_repos()}}
 }
 \value{
 character vector with dependency packages or data.frame when checking recursively.

---FILE: man/available_packages.Rd---
@@ -7,7 +7,7 @@
 available_packages(repos)
 }
 \arguments{
-\item{repos}{character vector, the base URL(s) of the repositories to use. Default \code{pacs::biocran_repos()}}
+\item{repos}{character vector URLs of the repositories to use. By default checking CRAN and newest Bioconductor per R version. Default \code{pacs::biocran_repos()}}
 }
 \description{
 available_packages returns a matrix of details corresponding to packages currently available at one or more repositories. The current list of packages is downloaded over the internet (or copied from a local mirror).

---FILE: man/pac_compare_namespace.Rd---
@@ -21,7 +21,7 @@ pac_compare_namespace(
 
 \item{lib.loc}{character vector. Default:}
 
-\item{repos}{character the base URL of the CRAN repository to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
+\item{repos}{character vector URLs of the repositories to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
 }
 \value{
 list with \code{c(""imports"", ""exports"", ""exportPatterns"", ""importClasses"", ""importMethods"", ""exportClasses"", ""exportMethods"", ""exportClassPatterns"", ""dynlibs"", ""S3methods"")} slots, and added and removed ones for each of them.

---FILE: man/pac_compare_versions.Rd---
@@ -26,7 +26,7 @@ Default: \code{c(""Depends"", ""Imports"", ""LinkingTo"")}}
 
 \item{lib.loc}{character vector. Default: \code{.libPaths()}}
 
-\item{repos}{character the base URL of the CRAN repository to use. Default ""https://cran.rstudio.org""}
+\item{repos}{character vector URLs of the repositories to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
 }
 \value{
 data.frame with 4 columns.

---FILE: man/pac_deps.Rd---
@@ -35,7 +35,7 @@ Default: \code{c(""Depends"", ""Imports"", ""LinkingTo"")}}
 
 \item{recursive}{logical If to assess the dependencies recursively. Default: TRUE}
 
-\item{repos}{character the base URL of the CRAN repository to use. Used only for the validation. Default \code{pacs::biocran_repos()}}
+\item{repos}{character vector URLs of the repositories to use. By default checking CRAN and newest Bioconductor per R version. Default \code{pacs::biocran_repos()}}
 }
 \value{
 data.frame with packages and their versions. Versions are taken from \code{installed.packages} or newest released.

---FILE: man/pac_deps_dev.Rd---
@@ -4,14 +4,16 @@
 \alias{pac_deps_dev}
 \title{Package dependencies - developer perspective}
 \usage{
-pac_deps_dev(pac, base = FALSE, attr = TRUE)
+pac_deps_dev(pac, base = FALSE, attr = TRUE, repos = pacs::biocran_repos())
 }
 \arguments{
 \item{pac}{character a package name.}
 
 \item{base}{logical if to add base packages too.}
 
-\item{attr}{logical specify if a package and its version should be added as a attribute of data.frame or for FALSE as a additional record. Default: TRUE
+\item{attr}{logical specify if a package and its version should be added as a attribute of data.frame or for FALSE as a additional record. Default: TRUE}
+
+\item{repos}{character vector URLs of the repositories to use. By default checking CRAN and newest Bioconductor per R version. Default \code{pacs::biocran_repos()}
 If \code{TRUE} then \code{pacs::pacs_base()} are taken into account. Default: FALSE}
 }
 \description{

---FILE: man/pac_deps_user.Rd---
@@ -4,14 +4,16 @@
 \alias{pac_deps_user}
 \title{Package dependencies - user perspective}
 \usage{
-pac_deps_user(pac, base = FALSE, attr = TRUE)
+pac_deps_user(pac, base = FALSE, attr = TRUE, repos = pacs::biocran_repos())
 }
 \arguments{
 \item{pac}{character a package name.}
 
 \item{base}{logical if to add base packages too.}
 
-\item{attr}{logical specify if a package and its version should be added as a attribute of data.frame or for FALSE as a additional record. Default: TRUE
+\item{attr}{logical specify if a package and its version should be added as a attribute of data.frame or for FALSE as a additional record. Default: TRUE}
+
+\item{repos}{character vector URLs of the repositories to use. By default checking CRAN and newest Bioconductor per R version. Default \code{pacs::biocran_repos()}
 If \code{TRUE} then \code{pacs::pacs_base()} are taken into account. Default: FALSE}
 }
 \description{

---FILE: man/pac_description.Rd---
@@ -24,7 +24,7 @@ pac_description(
 
 \item{lib.loc}{character vector, used optionally when local is equal TRUE. Default: \code{.libPaths()}}
 
-\item{repos}{character the base URL of the CRAN repository to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
+\item{repos}{character vector URLs of the repositories to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
 }
 \value{
 list with names proper for DESCRIPTION file fields.

---FILE: man/pac_health.Rd---
@@ -31,7 +31,7 @@ pac_health(
 
 \item{lib.loc}{character vector. Is omitted for non NULL version. Default: \code{.libPaths()}}
 
-\item{repos}{character the base CRAN URL of the repository to use. Default ""https://cran.rstudio.org""}
+\item{repos}{character vector URLs of the repositories to use. Default \verb{https://cran.rstudio.com/}}
 
 \item{source}{character one of \code{c(""crandb"", ""cran"")}. Using the \code{MEATCRAN} DB or the direct web page download from CRAN. Default: \code{""crandb""}}
 }

---FILE: man/pac_lifeduration.Rd---
@@ -23,7 +23,7 @@ The local repository has priority, it version is available. Default: NULL}
 
 \item{lib.loc}{character vector. Is omitted for non NULL version. Default: \code{.libPaths()}}
 
-\item{repos}{character vector base URLs of the repositories to use. By default checking CRAN and newest Bioconductor. Default \code{pacs::biocran_repos()}}
+\item{repos}{character vector URLs of the repositories to use. By default checking CRAN and newest Bioconductor per R version. Default \code{pacs::biocran_repos()}}
 
 \item{source}{character one of \code{c(""crandb"", ""cran"")}. Using the \verb{MEATCRAN  CRANDB} or the direct web page download from CRAN. Default: \code{""crandb""}}
 }

---FILE: man/pac_namespace.Rd---
@@ -24,7 +24,7 @@ pac_namespace(
 
 \item{lib.loc}{character vector, used optionally when local is equal TRUE. Default: \code{.libPaths()}}
 
-\item{repos}{character the base URL of the CRAN repository to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
+\item{repos}{character vector URLs of the repositories to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
 }
 \value{
 list with names proper for NAMESPACE file, the same as format as returned by \code{base::parseNamespaceFile}.

---FILE: man/pac_validate.Rd---
@@ -26,7 +26,7 @@ Default: \code{c(""Depends"", ""Imports"", ""LinkingTo"")}}
 
 \item{checkred}{list with two named fields, \code{scope} and \code{flavor}. \code{scope} of R CRAN check pages statuses to consider, any of \code{c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")}. \code{flavor} vector of machines to consider, which might be retrieved with \code{pacs::cran_flavors()$Flavor}. By default an empty scope field deactivated assessment for \code{checkred} column, and NULL flavor will results in checking all machines. Default \code{list(scope = character(0), flavor = NULL)}}
 
-\item{repos}{character vector base URLs of the repositories to use. By default checking CRAN and newest Bioconductor per R version. Default \code{pacs::biocran_repos()}}
+\item{repos}{character vector URLs of the repositories to use. By default checking CRAN and newest Bioconductor per R version. Default \code{pacs::biocran_repos()}}
 }
 \value{
 data.frame with 5/7/8/9 columns.

---FILE: man/pacs_lifeduration.Rd---
@@ -13,7 +13,7 @@ pacs_lifeduration(
 )
 }
 \arguments{
-\item{pacs}{character vector packages names.}
+\item{pacs}{character vector packages names.``}
 
 \item{versions}{character vector packages versions.}
 
@@ -23,7 +23,7 @@ Default: \code{""crandb""}}
 
 \item{lib.loc}{character vector. Is omitted for non NULL version. Default: \code{.libPaths()}}
 
-\item{repos}{character the base CRAN URL of the repository to use. Default \code{""https://cran.rstudio.org""}}
+\item{repos}{character vector repositories. Default \verb{https://cran.rstudio.org}}
 }
 \value{
 data.frame with two columns package name and life duration.

---FILE: tests/testthat/test-deps.R---
@@ -107,19 +107,19 @@ test_that(""pacs::app_deps"", {
 
 test_that(""pac_deps_user"", {
   skip_if_offline()
-  pp <- pacs::pac_deps_user(""memoise"", base = FALSE, attr = FALSE)$Package
+  pp <- pacs::pac_deps_user(""memoise"", base = FALSE, attr = FALSE, repos = ""https://cran.rstudio.com/"")$Package
   rr <- remotes:::find_deps(""memoise"",
-                            available = pacs:::available_packages(repos = pacs::biocran_repos()),
+                            available = pacs:::available_packages(repos = ""https://cran.rstudio.com/""),
                             top_dep = NA)
   rrr <- setdiff(rr, pacs::pacs_base())
   expect_identical(sort(pp), sort(rrr))
 })
 
 test_that(""pac_deps_dev"", {
   skip_if_offline()
-  pp <- pacs::pac_deps_dev(""memoise"", base = FALSE, attr = FALSE)$Package
+  pp <- pacs::pac_deps_dev(""memoise"", base = FALSE, attr = FALSE, repos = ""https://cran.rstudio.com/"")$Package
   rr <- remotes:::find_deps(""memoise"",
-                            available = pacs:::available_packages(repos = pacs::biocran_repos()),
+                            available = pacs:::available_packages(repos = ""https://cran.rstudio.com/""),
                             top_dep = TRUE)
   rrr <- setdiff(rr, pacs::pacs_base())
   expect_identical(sort(pp), sort(rrr))"
Polkas,pacs,18d218e80d7cf27820ef4f1ab8a91f779b4363aa,Maciej Nasinski,nasinski.maciej@gmail.com,2022-04-01T17:51:05Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-04-01T17:51:05Z,new functions and fix,NAMESPACE;NEWS.md;R/deps.R;R/utils.R;_pkgdown.yaml;man/pac_deps_dev.Rd;man/pac_deps_user.Rd,False,True,True,False,85,9,94,"---FILE: NAMESPACE---
@@ -16,7 +16,9 @@ export(pac_checkred)
 export(pac_compare_namespace)
 export(pac_compare_versions)
 export(pac_deps)
+export(pac_deps_dev)
 export(pac_deps_timemachine)
+export(pac_deps_user)
 export(pac_description)
 export(pac_health)
 export(pac_isin)

---FILE: NEWS.md---
@@ -1,6 +1,9 @@
 # pacs 0.4.3.9000
 
 * `tinyverse` vignette.
+* fixed edge cases for `pacs::pac_deps`.
+* two new functions `pacs::pac_deps_user` and `pacs::pac_deps_dev`.
+* updated pkgdown website.
 
 # pacs 0.4.3
 

---FILE: R/deps.R---
@@ -116,6 +116,36 @@ pac_deps <- function(pac,
   res_df_f
 }
 
+#' package dependencies - user perspective
+#' @description Package dependencies installed when run `installed.packages`.
+#' @param pac character a package name.
+#' @export
+#' @examples
+#' \dontrun{
+#'   pac_deps_user(""dplyr"")
+#'   pac_deps_user(""cat2cat"")
+#' }
+pac_deps_user <- function(pac) {
+  pac_deps(pac, recursive = TRUE, description_v = TRUE, local = FALSE)
+}
+
+#' package dependencies - developer perspective
+#' @description Package dependencies installed when checking the package.
+#' @param pac character a package name.
+#' @export
+#' @examples
+#' \dontrun{
+#'   pac_deps_dev(""dplyr"")
+#'   pac_deps_dev(""cat2cat"")
+#' }
+pac_deps_dev <- function(pac) {
+  base <- pac_deps(pac, recursive = TRUE, description_v = TRUE, local = FALSE)
+  suggs <- pac_deps(""dplyr"", recursive = FALSE, description_v = TRUE, local = FALSE, fields = ""Suggests"")$Package
+  suggs_r <- do.call(rbind, lapply(suggs, function(x) pac_deps(x, description_v = TRUE, local = FALSE)))
+  results <- rbind(base, suggs_r)
+  stats::aggregate(results[, c(""Version""), drop = FALSE], list(Package = results$Package), pacs::compareVersionsMax)
+}
+
 #' The shiny app dependencies
 #' @description the shiny app dependencies packages are checked recursively.
 #' The `c(""Depends"", ""Imports"", ""LinkingTo"")` DESCRIPTION files fields are checked recursively.

---FILE: R/utils.R---
@@ -119,11 +119,11 @@ pacs_base_all <- memoise::memoise(pacs_base_all_raw)
 installed_descriptions <- function(lib.loc, fields, deps = NULL) {
   installed_agg <- installed_agg_fun(lib.loc, fields)
 
-  paks <- installed_agg[, fields]
+  paks <- installed_agg[, fields, drop = FALSE]
 
   if (!is.null(deps)) {
     nams <- installed_agg[, c(""Package"")]
-    paks <- paks[nams %in% deps, ]
+    paks <- paks[nams %in% deps, , drop = FALSE]
   }
 
   joint_cols <- apply(paks, 1, function(x) paste(x, collapse = "",""))
@@ -138,7 +138,7 @@ installed_descriptions <- function(lib.loc, fields, deps = NULL) {
     Package = unlist(lapply(seq_along(packages), function(x) replace(packages[[x]], packages[[x]] == ""NA"", NA))),
     stringsAsFactors = FALSE
   )
-
+browser()
   res_agg <- stats::aggregate(
     joint[, c(""Version""), drop = FALSE],
     list(Package = joint$Package),
@@ -203,11 +203,11 @@ extract_deps <- function(x) {
 available_descriptions <- function(repos, fields, deps = NULL) {
   available_agg <- available_agg_fun(repos, fields)
 
-  paks <- available_agg[, fields]
+  paks <- available_agg[, fields, drop = FALSE]
 
   if (!is.null(deps)) {
     nams <- available_agg[, c(""Package"")]
-    paks <- paks[nams %in% deps, ]
+    paks <- paks[nams %in% deps, , drop = FALSE]
   }
 
   joint_cols <- apply(paks, 1, function(x) paste(x, collapse = "",""))
@@ -218,8 +218,8 @@ available_descriptions <- function(repos, fields, deps = NULL) {
   versions <- desc_e$versions
 
   joint <- data.frame(
-    Version = unlist(sapply(seq_along(packages), function(x) replaceNA(versions[[x]], """"))),
-    Package = unlist(sapply(seq_along(packages), function(x) replace(packages[[x]], packages[[x]] == ""NA"", NA))),
+    Version = unlist(lapply(seq_along(packages), function(x) replaceNA(versions[[x]], """"))),
+    Package = unlist(lapply(seq_along(packages), function(x) replace(packages[[x]], packages[[x]] == ""NA"", NA))),
     stringsAsFactors = FALSE
   )
 
@@ -247,8 +247,7 @@ available_agg_fun_raw <- function(repos, fields) {
 available_agg_fun <- memoise::memoise(available_agg_fun_raw, cache = cachem::cache_mem(max_age = 30 * 60))
 
 expand_dependency <- function(fields) {
-  if (length(fields) == 1) {
-    stopifnot(all(fields %in% c(""strong"", ""all"", ""most"")))
+  if (length(fields) == 1 && fields %in% c(""strong"", ""all"", ""most"")) {
     switch(fields,
       strong = c(""Depends"", ""Imports"", ""LinkingTo""),
       most = c(""Depends"", ""Imports"", ""LinkingTo"", ""Suggests""),

---FILE: _pkgdown.yaml---
@@ -3,6 +3,8 @@ reference:
 - contents:
   - pac_deps
   - pac_deps_timemachine
+  - pac_deps_dev
+  - pac_deps_user
 - title: Size of R Package
 - contents:
   - pac_size

---FILE: man/pac_deps_dev.Rd---
@@ -0,0 +1,20 @@
+% Generated by roxygen2: do not edit by hand
+% Please edit documentation in R/deps.R
+\name{pac_deps_dev}
+\alias{pac_deps_dev}
+\title{package dependencies - developer perspective}
+\usage{
+pac_deps_dev(pac)
+}
+\arguments{
+\item{pac}{character a package name.}
+}
+\description{
+Package dependencies installed when checking the package.
+}
+\examples{
+\dontrun{
+  pac_deps_dev(""dplyr"")
+  pac_deps_dev(""cat2cat"")
+}
+}

---FILE: man/pac_deps_user.Rd---
@@ -0,0 +1,20 @@
+% Generated by roxygen2: do not edit by hand
+% Please edit documentation in R/deps.R
+\name{pac_deps_user}
+\alias{pac_deps_user}
+\title{package dependencies - user perspective}
+\usage{
+pac_deps_user(pac)
+}
+\arguments{
+\item{pac}{character a package name.}
+}
+\description{
+Package dependencies installed when run \code{installed.packages}.
+}
+\examples{
+\dontrun{
+  pac_deps_user(""dplyr"")
+  pac_deps_user(""cat2cat"")
+}
+}"
Polkas,pacs,556951ae710c3ffbfd7c603ae19f7ec1e9ccd29f,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-27T16:49:00Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-27T16:49:00Z,fix test,tests/testthat/test-validate.R,False,True,True,False,1,1,2,"---FILE: tests/testthat/test-validate.R---
@@ -74,7 +74,7 @@ test_that(""offline validate"", {
 
 test_that(""lock_validate skip crandb if the limit is exceeded"", {
   expect_message(withr::with_options(list(pacs.crandb_limit = 1), {
-    lock_validate(""tests/testthat/files/renv_test.lock"")
+    lock_validate(""files/renv_test.lock"")
   }), ""There is more than"")
 })
 "
Polkas,pacs,0e46f23f382b5c8aad8d75abb9acd098d7a8a1a5,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-26T20:05:57Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-26T20:05:57Z,fix,R/valid.R;man/lib_validate.Rd;man/lock_validate.Rd;man/pac_validate.Rd;vignettes/GettingStarted.Rmd,True,True,True,False,8,7,15,"---FILE: R/valid.R---
@@ -23,7 +23,7 @@
 #' \item{lifeduration}{(Optional) (Internet needed) integer number of days a package was released.}
 #' }
 #' @note Version.expected.min column not count packages which are not a dependency for any package, so could not be find in DESCRIPTION files.
-#' When turn on the `lifeduration` options, calculations might be time consuming.
+#' When turn on the `lifeduration` options, calculations might be time consuming for libraries bigger than 500 packages.
 #' Results are cached for 30 minutes with `memoise` package.
 #' `BioConductor` packages are tested only in available scope, `checkred` is not assessed for them.
 #' The `crandb` R packages database is a part of `METACRAN` project, source:
@@ -117,7 +117,7 @@ lib_validate <- function(lib.loc = .libPaths(),
 #' \item{lifeduration}{(Optional) (Internet needed) integer number of days a package was released.}
 #' }
 #' @note Version.expected.min column not count packages which are not a dependency for any package, so could not be find in DESCRIPTION files.
-#' When turn on the `lifeduration` option, calculations might be time consuming.
+#' When turn on the `lifeduration` option, calculations might be time consuming when there is more than 500 packages.
 #' Please as a courtesy to the R CRAN, don't overload their server by constantly using this function with `lifeduration` or `checkred` turned on.
 #' Results are cached with `memoise` package, memory cache.
 #' The `crandb` R packages database is a part of `METACRAN` project, source:
@@ -200,6 +200,7 @@ pac_validate <- function(pac,
 #' \item{lifeduration}{(Optional) (Internet needed) integer number of days a package was released.}
 #' }
 #' @note Version.expected.min column not count packages which are not a dependency for any package, so could not be find in DESCRIPTION files.
+#' When turn on the `lifeduration` option, calculations might be time consuming when there is more than 500 packages.
 #' The `crandb` R packages database is a part of `METACRAN` project, source:
 #' CsÃ¡rdi G, Salmon M (2022). `pkgsearch`: Search and Query CRAN R Packages. `https://github.com/r-hub/pkgsearch`, `https://r-hub.github.io/pkgsearch/`.
 #' @export
@@ -211,7 +212,6 @@ lock_validate <- function(path,
                           lifeduration = FALSE,
                           checkred = list(scope = character(0), flavors = NULL),
                           repos = biocran_repos()) {
-  stopifnot(file.exists(path))
   stopifnot(is.list(checkred) &&
     (length(checkred) %in% c(1, 2)) &&
     (c(""scope"") %in% names(checkred)) &&
@@ -245,7 +245,7 @@ lock_validate <- function(path,
   result <- result[!is.na(result$Package) & !(result$Package %in% c("""", ""NA"", pacs_base())), ]
 
   if (is_online()) {
-    get_validate_online(result, ""Version.expected"", lifeduration, checkred, repos)
+    result <- get_validate_online(result, ""Version.expected"", lifeduration, checkred, repos)
   } else {
     warning(""There is no Internet connection."")
   }

---FILE: man/lib_validate.Rd---
@@ -46,7 +46,7 @@ Optionally we could add life duration and CRAN check page status for each packag
 }
 \note{
 Version.expected.min column not count packages which are not a dependency for any package, so could not be find in DESCRIPTION files.
-When turn on the \code{lifeduration} options, calculations might be time consuming.
+When turn on the \code{lifeduration} options, calculations might be time consuming for libraries bigger than 500 packages.
 Results are cached for 30 minutes with \code{memoise} package.
 \code{BioConductor} packages are tested only in available scope, \code{checkred} is not assessed for them.
 The \code{crandb} R packages database is a part of \code{METACRAN} project, source:

---FILE: man/lock_validate.Rd---
@@ -43,6 +43,7 @@ Optionally we could add life duration and CRAN check page status for each depend
 }
 \note{
 Version.expected.min column not count packages which are not a dependency for any package, so could not be find in DESCRIPTION files.
+When turn on the \code{lifeduration} option, calculations might be time consuming when there is more than 500 packages.
 The \code{crandb} R packages database is a part of \code{METACRAN} project, source:
 CsÃ¡rdi G, Salmon M (2022). \code{pkgsearch}: Search and Query CRAN R Packages. \verb{https://github.com/r-hub/pkgsearch}, \verb{https://r-hub.github.io/pkgsearch/}.
 }

---FILE: man/pac_validate.Rd---
@@ -50,7 +50,7 @@ Optionally we could add life duration and CRAN check page status for each depend
 }
 \note{
 Version.expected.min column not count packages which are not a dependency for any package, so could not be find in DESCRIPTION files.
-When turn on the \code{lifeduration} option, calculations might be time consuming.
+When turn on the \code{lifeduration} option, calculations might be time consuming when there is more than 500 packages.
 Please as a courtesy to the R CRAN, don't overload their server by constantly using this function with \code{lifeduration} or \code{checkred} turned on.
 Results are cached with \code{memoise} package, memory cache.
 The \code{crandb} R packages database is a part of \code{METACRAN} project, source:

---FILE: vignettes/GettingStarted.Rmd---
@@ -168,7 +168,7 @@ There is a way to validate the `renv` lock file in the same way the local librar
 
 ```r
 # Path has to be updated 
-pacs::lock_validate(""path/renv.lock"")
+pacs::lock_validate(""https://raw.githubusercontent.com/Polkas/pacs/master/tests/testthat/files/renv_test.lock"")
 ```
 
 ### R CRAN packages check page statuses"
Polkas,pacs,b596a42e11a606e17002616859a77dee49dc4e91,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-23T22:26:26Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-23T22:33:56Z,fix,R/description.R;R/lifeduration.R;R/timemachine.R,False,True,True,False,8,19,27,"---FILE: R/description.R---
@@ -47,9 +47,9 @@ pac_description <- function(pac,
     version <- if (!version_null) {
       version
     } else if (!is.null(at)) {
-      version <- utils::tail(pac_timemachine(pac, at = at)$Version, 1)
-      if (isNA(version) || is.null(version)) return(NA)
-      version
+      vv <- utils::tail(pac_timemachine(pac, at = at)$Version, 1)
+      if (isNA(vv) || is.null(vv)) return(NA)
+      vv
     } else {
       last_version
     }

---FILE: R/lifeduration.R---
@@ -71,7 +71,7 @@ pac_lifeduration <- function(pac,
       1, 10
     )))
   } else if (ison_cran) {
-    life <- pac_timemachine(pac, version = version)
+    life <- pac_timemachine(pac, version = version, source = source)
     if (isNA(life) || isTRUE(nrow(life) == 0)) {
       return(NA)
     }
@@ -128,25 +128,13 @@ pac_health <- function(pac,
     return(TRUE)
   }
 
-  last_version <- pac_last(pac, repos = repos)
-  version <- if (!is.null(version)) {
-    version
-  } else if (!is.null(at)) {
-    utils::tail(pac_timemachine(pac, at = at)$Version, 1)
-  } else {
-    last_version
-  }
-  if (isTRUE(is.na(version)) || isTRUE(length(version) == 0)) {
-    return(NA)
-  }
-
-  life <- pac_lifeduration(pac, version = version, lib.loc = lib.loc, repos = repos)
+  life <- pac_lifeduration(pac, version = version, at = at, lib.loc = lib.loc, source = source, repos = repos)
   if (isNA(life)) {
     return(NA)
   }
   res <- life >= limit
 
-  if ((length(scope) > 0) && identical(last_version, version)) {
+  if ((length(scope) > 0) && identical(pac_last(pac, repos = repos), version)) {
     if (isTRUE(pac_checkred(pac, scope = scope, flavors = flavors))) FALSE else res
   } else {
     res

---FILE: R/timemachine.R---
@@ -153,7 +153,8 @@ pac_timemachine_table <- function(pac, source) {
       Package = pac,
       Released = unlist(result_json[[pac]]$timeline),
       Archived = c(utils::tail(unlist(result_json[[pac]]$timeline), -1), NA),
-      Version = names(result_json[[pac]]$timeline)
+      Version = names(result_json[[pac]]$timeline),
+      stringsAsFactors = FALSE
     )
     result$Released <- as.Date(substr(result$Released, 1, 10))
     result$Archived <- as.Date(substr(result$Archived, 1, 10))"
Polkas,pacs,16f94b7fe8bf40e3d7969730a71505c92b3fc1aa,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-22T20:34:47Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-22T20:34:47Z,a few fixes,R/timemachine.R;R/valid.R;tests/testthat/test-timemachine.R,False,True,True,False,15,2,17,"---FILE: R/timemachine.R---
@@ -134,6 +134,7 @@ pac_archived_raw <- function(pac) {
     result$URL <- paste0(sprintf(""Archive/%s/"", pac), result$Package)
     result$Package <- pac_name
     result$Version <- pac_v
+    result <- result[!is.na(result$Version), ]
     result <- result[order(result$Released), ]
   } else {
     result <- NA

---FILE: R/valid.R---
@@ -134,7 +134,11 @@ lib_validate <- function(lib.loc = .libPaths(),
 
     if (lifeduration) {
       message(""Please wait, Packages life durations are assessed.\n"")
-      result$lifeduration <- vapply(seq_len(nrow(result)), function(x) pac_lifeduration(result[x, ""Package"", drop = TRUE], as.character(result[x, ""Version.have"", drop = TRUE]), repos = repos, lib.loc = lib.loc), numeric(1))
+      result$lifeduration <- vapply(seq_len(nrow(result)), function(x)
+        pac_lifeduration(result[x, ""Package"", drop = TRUE],
+                         `if`(isNA(as.character(result[x, ""Version.have"", drop = TRUE])), NULL, as.character(result[x, ""Version.have"", drop = TRUE])),
+                         repos = repos,
+                         lib.loc = lib.loc), numeric(1))
     }
 
     not_installed <- is.na(result$Version.have)
@@ -232,7 +236,12 @@ pac_validate <- function(pac,
       }
 
       if (lifeduration) {
-        result$lifeduration <- vapply(seq_len(nrow(result)), function(x) pac_lifeduration(result[x, ""Package"", drop = TRUE], as.character(result[x, ""Version.have"", drop = TRUE]), repos = repos, lib.loc = lib.loc), numeric(1))
+        result$lifeduration <- vapply(seq_len(nrow(result)),
+                                      function(x) pac_lifeduration(
+                                        result[x, ""Package"", drop = TRUE],
+                                        `if`(isNA(as.character(result[x, ""Version.have"", drop = TRUE])), NULL, as.character(result[x, ""Version.have"", drop = TRUE])),
+                                        repos = repos,
+                                        lib.loc = lib.loc), numeric(1))
       }
 
       not_installed <- is.na(result$Version.have)

---FILE: tests/testthat/test-timemachine.R---
@@ -9,4 +9,7 @@ test_that(""pacs::pac_timemachine"", {
   expect_true(nrow(pac_timemachine(""memoise"", from = as.Date(""2017-02-02""), to = as.Date(""2018-04-02""))) == 2)
   expect_identical(nrow(pac_timemachine(""dplyr"", version = ""999.1.1.1"")), 0L)
   expect_true(nrow(pac_timemachine(""dplyr"")) >= 0)
+  expect_true(nrow(pac_timemachine(""memoise"", at = as.Date(""2100-01-01""))) == 1)
+  expect_true(nrow(pac_timemachine(""memoise"", from = as.Date(""2100-01-01""), to = as.Date(""2200-01-01""))) == 1)
+  expect_true(isNA(pac_archived_raw(""WRONG"")))
 })"
Polkas,pacs,304f96aedb8465ba7b5eb26e6b36d112ea0e4624,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-21T23:17:55Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-21T23:17:55Z,fix,R/utils.R,False,True,True,False,1,1,2,"---FILE: R/utils.R---
@@ -316,7 +316,7 @@ read_html_table <- function(table) {
   if (length(rr_range) != 2) {
     return(NA)
   }
-  rrr <- rr[(rr_range[1] + 1):(rr_range[2] - 1)]
+  rrr <- table[(rr_range[1] + 1):(rr_range[2] - 1)]
   rrr_all <- paste(rrr, collapse = ""\n"")
   rrr_html <- read_html(rrr_all)
   rrr_html"
Polkas,pacs,85f7e5d673e2d890b038ce1465084b34b1aabe40,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-19T21:49:02Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-19T21:49:02Z,fix covr,R/lifeduration.R,False,True,True,False,3,3,6,"---FILE: R/lifeduration.R---
@@ -35,7 +35,7 @@ pac_lifeduration <- function(pac,
   version <- if (!is.null(version)) {
     version
   } else if (!is.null(at)) {
-    tail(pac_timemachine(pac, at = at)$Version, 1)
+    utils::tail(pac_timemachine(pac, at = at)$Version, 1)
   } else {
     last_version
   }
@@ -53,7 +53,7 @@ pac_lifeduration <- function(pac,
   } else if (ison_cran && is_the_last_version) {
     return(Sys.Date() - as.Date(substr(
       pac_description(pac,
-        version = last_version_cran,
+        version = last_version,
         lib.loc = lib.loc
       )[[""Date/Publication""]],
       1, 10
@@ -115,7 +115,7 @@ pac_health <- function(pac,
   version <- if (!is.null(version)) {
     version
   } else if (!is.null(at)) {
-    tail(pac_timemachine(pac, at = at)$Version, 1)
+    utils::tail(pac_timemachine(pac, at = at)$Version, 1)
   } else {
     last_version
   }"
Polkas,pacs,4e957c29bebe7ef3e043014c190a0a0fbc23b4f3,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-18T20:19:58Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-18T20:19:58Z,fix biocran 3,NEWS.md;R/deps.R;R/utils.R;man/pac_deps.Rd;tests/testthat/test-base.R,False,True,True,False,27,15,42,"---FILE: NEWS.md---
@@ -1,6 +1,7 @@
 # pacs 0.4.0.9000
 
 * `pacs::biocran_repos` not includes the `BioCbooks` field for `Bioc` versions smaller than ""3.12"".
+* The `pacs::pac_deps` recursive option is fully supported only on the R version "">=4.1"", added a validation.
 
 # pacs 0.4.0
 

---FILE: R/deps.R---
@@ -7,7 +7,7 @@
 #' @param local logical if to use local repository or newest CRAN packages, where by default local packages are used. Default: TRUE
 #' @param description_v if the dependencies version should be taken from description files, minimal required. By default installed versions are taken. Default: FALSE
 #' @param attr logical specify if a package and its version should be added as a attribute of data.frame or for FALSE as a additional record. Default: TRUE
-#' @param recursive logical if to assess the dependencies recursively. Default: TRUE
+#' @param recursive logical If to assess the dependencies recursively. Default: TRUE
 #' @param repos character the base URL of the CRAN repository to use. Used only for the validation. Default `pacs::biocran_repos()`
 #' @return data.frame with packages and their versions. Versions are taken from `installed.packages` or newest released.
 #' @note When function is invoked in the loop afterwards binded results could be aggregated like,

---FILE: R/utils.R---
@@ -239,7 +239,7 @@ available_descriptions <- function(repos, fields, deps = NULL) {
   res_agg
 }
 
-available_agg_fun_raw <- function(repos = ""https://cran.rstudio.com/"", fields) {
+available_agg_fun_raw <- function(repos, fields) {
   available_df <- as.data.frame(available_packages(repos = repos))
   available_agg <- stats::aggregate(
     available_df[, c(""Version"", fields), drop = FALSE],

---FILE: man/pac_deps.Rd---
@@ -31,7 +31,7 @@ pac_deps(
 
 \item{attr}{logical specify if a package and its version should be added as a attribute of data.frame or for FALSE as a additional record. Default: TRUE}
 
-\item{recursive}{logical if to assess the dependencies recursively. Default: TRUE}
+\item{recursive}{logical If to assess the dependencies recursively. Default: TRUE}
 
 \item{repos}{character the base URL of the CRAN repository to use. Used only for the validation. Default \code{pacs::biocran_repos()}}
 }

---FILE: tests/testthat/test-base.R---
@@ -115,38 +115,49 @@ if (is_online() && TRUE) {
     })
 
     test_that(""pacs::pac_deps cols"", {
-      expect_true(ncol(pacs::pac_deps(""memoise"", description_v = TRUE, recursive = FALSE, local = FALSE)) == 2)
+      expect_true(ncol(pacs::pac_deps(""memoise"", description_v = TRUE, recursive = FALSE, local = FALSE, repos = ""https://cran.rstudio.com/"")) == 2)
     })
 
     test_that(""pacs::pac_deps"", {
       deps1 <- pacs::pac_deps(""memoise"",
                               description_v = TRUE,
                               recursive = FALSE,
-                              local = FALSE)
+                              local = FALSE,
+                              repos = ""https://cran.rstudio.com/"")
       deps2 <- setdiff(tools::package_dependencies(""memoise"",
-                                                   db = available_packages(),
-                                                   recursive = FALSE)[[1]], pacs::pacs_base())
+                                                   db = available_packages(repos = ""https://cran.rstudio.com/""),
+                                                   recursive = FALSE)[[1]],
+                       pacs::pacs_base())
 
+      expect_true(nrow(deps1) == length(deps2))
+    })
+
+    test_that(""pacs::pac_deps recursive"", {
       deps1_recursive <- pacs::pac_deps(""memoise"",
                                         description_v = TRUE,
                                         recursive = TRUE,
-                                        local = FALSE)
+                                        local = FALSE,
+                                        repos = ""https://cran.rstudio.com/"")
       deps2_recursive <- setdiff(tools::package_dependencies(""memoise"",
-                                                             db = available_packages(),
-                                                             recursive = TRUE)[[1]], pacs::pacs_base())
+                                                             db = available_packages(repos = ""https://cran.rstudio.com/""),
+                                                             recursive = TRUE)[[1]],
+                                 pacs::pacs_base())
+      expect_true(nrow(deps1_recursive) == length(deps2_recursive))
+})
 
+    test_that(""pacs::pac_deps recursive long field"", {
       deps3_recursive <- pacs::pac_deps(""memoise"",
                                         description_v = FALSE,
                                         fields = c(""Depends"", ""Imports"", ""LinkingTo"", ""Suggests"", ""Enhances""),
                                         recursive = TRUE,
-                                        local = FALSE)
+                                        local = FALSE,
+                                        repos = ""https://cran.rstudio.com/"")
       deps4_recursive <- setdiff(tools::package_dependencies(""memoise"",
                                                              which = c(""Depends"", ""Imports"", ""LinkingTo"", ""Suggests"", ""Enhances""),
-                                                             db = available_packages(),
-                                                             recursive = TRUE)[[1]], pacs::pacs_base())
+                                                             db = available_packages(repos = ""https://cran.rstudio.com/""),
+                                                             recursive = TRUE)[[1]],
+                                 pacs::pacs_base())
 
-      expect_true(nrow(deps1) == length(deps2))
-      expect_true(nrow(deps1_recursive) == length(deps2_recursive))
       expect_true(nrow(deps3_recursive) == length(deps4_recursive))
     })
 "
Polkas,pacs,7808fcef0960958dd7441256a176c4e9692d40d1,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-18T18:59:48Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-18T18:59:48Z,fix biocran 2,R/check.R,False,True,True,False,2,0,2,"---FILE: R/check.R---
@@ -193,6 +193,8 @@ read_bio_releases_raw <- function() {
     ))
     colnames(result_raw) <- header
     result_raw$Date <- as.Date(result_raw$Date, format = ""%B %d, %Y"")
+    result_raw$Release <- as.character(result_raw$Release)
+    result_raw$R <- as.character(result_raw$R)
   } else {
     result_raw <- NA
   }"
Polkas,pacs,d01c4d925a5334fd62180bfb157c83e32be2a357,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-18T18:47:03Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-18T18:47:03Z,fix biocran,DESCRIPTION;NEWS.md;R/check.R;inst/WORDLIST,False,True,True,False,7,2,9,"---FILE: DESCRIPTION---
@@ -1,6 +1,6 @@
 Package: pacs
 Title: Supplementary Tools for R Packages Developers
-Version: 0.4.0
+Version: 0.4.0.9000
 Authors@R: 
     person(given = ""Maciej"",
            family = ""Nasinski"",

---FILE: NEWS.md---
@@ -1,3 +1,7 @@
+# pacs 0.4.0.9000
+
+* `pacs::biocran_repos` not includes the `BioCbooks` field for `Bioc` versions smaller than ""3.12"".
+
 # pacs 0.4.0
 
 * `pac_deps` fully depends on `tools::package_dependencies`.

---FILE: R/check.R---
@@ -241,7 +241,7 @@ biocran_repos <- function(version = NULL) {
       BioCann = sprintf(""https://bioconductor.org/packages/%s/data/annotation"", version),
       BioCexp = sprintf(""https://bioconductor.org/packages/%s/data/experiment"", version),
       BioCworkflows = sprintf(""https://bioconductor.org/packages/%s/workflows"", version),
-      BioCbooks = sprintf(""https://bioconductor.org/packages/%s/books"", version),
+      BioCbooks = if (utils::compareVersion(version, ""3.12"") >= 0) sprintf(""https://bioconductor.org/packages/%s/books"", version) else NULL,
       CRAN = ""https://cran.rstudio.com/""
     )
   }

---FILE: inst/WORDLIST---
@@ -44,6 +44,7 @@ bGraph
 bindCache
 binded
 bindEvent
+Bioc
 BioConductor
 biomaRt
 bookmarkButton"
Polkas,pacs,488cd8e7d3c442708448fc1c522c9d8bbe6edcc9,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-17T19:15:54Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-17T19:15:54Z,polish the fix,.Rbuildignore;R/size.R;man/shiny_app_size.Rd;vignettes/GettingStarted.Rmd,True,True,True,False,31,7,38,"---FILE: .Rbuildignore---
@@ -3,6 +3,7 @@
 ^\.github$
 ^\.pre-commit-config\.yaml$
 ^cran-comments\.md$
+^inst/WORDLIST$
 ^pacs\.Rproj$
 ^renv$
 ^renv\.lock$

---FILE: R/size.R---
@@ -75,19 +75,20 @@ shiny_app_deps <- function(path = ""."", recursive = TRUE) {
   if (length(app_deps) == 0) return(data.frame(Package = NA, Version = NA, Direct = NA)[0, ])
   not_installed <- setdiff(app_deps, rownames(installed_packages(lib.loc = .libPaths())))
   if (length(not_installed)) {
-    stop(sprintf(""Some of the dependency packages are not installed, %s"", not_installed))
+    stop(sprintf(""Some of the dependency packages are not installed, %s"", paste(not_installed, collapse = ""; "")))
   }
   if (recursive) {
     app_deps_recursive <- do.call(rbind, lapply(app_deps, function(x) pac_deps(x, attr = FALSE)))
+    app_deps_recursive$Package <- as.character(app_deps_recursive$Package)
     app_deps_recursive$Direct <- app_deps_recursive$Package %in% app_deps
     return(app_deps_recursive)
   } else {
-    return(data.frame(Package = app_deps, Version = """", Direct = TRUE))
+    return(data.frame(Package = app_deps, Version = """", Direct = TRUE, stringsAsFactors = FALSE))
   }
 }
 
 #' Size of the shiny app
-#' @description size of the shiny app dependencies packages and the app directory.
+#' @descriptionThe size of shiny app is a sum of dependencies packages and the app directory.
 #' The app dependencies packages are checked recursively.
 #' @param path path to the shiny app. Default: `"".""`
 #' @return numeric size in bytes, to get MB ten divide by `10**6`.
@@ -99,8 +100,9 @@ shiny_app_deps <- function(path = ""."", recursive = TRUE) {
 #' }
 shiny_app_size <- function(path = ""."") {
   stopifnot(dir.exists(path))
-  app_deps_recursive <- shiny_app_deps(path, recursive = TRUE)$Package
-  if (length(app_deps_recursive) > 0 && is.character(app_deps_recursive)) {
+  # as.character for older R versions, stringAsFactors
+  app_deps_recursive <- as.character(shiny_app_deps(path, recursive = TRUE)$Package)
+  if (length(app_deps_recursive) > 0) {
     sum(vapply(app_deps_recursive, pac_size, numeric(1)) + dir_size(path))
   } else {
     dir_size(path)

---FILE: man/shiny_app_size.Rd---
@@ -13,8 +13,7 @@ shiny_app_size(path = ""."")
 numeric size in bytes, to get MB ten divide by \code{10**6}.
 }
 \description{
-size of the shiny app dependencies packages and the app directory.
-The app dependencies packages are checked recursively.
+Size of the shiny app
 }
 \examples{
 \dontrun{

---FILE: vignettes/GettingStarted.Rmd---
@@ -393,6 +393,28 @@ Might be useful to check the number of dependencies too:
 pacs::pac_deps(""devtools"", local = TRUE)$Package
 ```
 
+## shiny app utils
+
+The shiny app dependencies packages are checked recursively.
+The `c(""Depends"", ""Imports"", ""LinkingTo"")` DESCRIPTION files fields are check recursively.
+The required dependencies have to be installed in the local repository.
+
+```r
+pacs::shiny_app_deps(system.file(""examples/04_mpg"", package = ""shiny""))
+```
+
+When we want to check only direct dependencies, `recursive` argument has to be set to `FALSE`.
+
+```r
+pacs::shiny_app_deps(system.file(""examples/04_mpg"", package = ""shiny""), recursive = FALSE)
+```
+
+The size of shiny app is a sum of dependencies packages and the app directory. The app dependencies packages are checked recursively.
+
+```r
+cat(pacs::shiny_app_size(system.file(""examples/04_mpg"", package = ""shiny"")) / 10**6, ""MB"")
+```
+
 ## Base packages 
 
 Useful functions to get a list of base packages. "
Polkas,pacs,900ecca3454f021aa8fa943633513937d6b7d811,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-17T18:32:19Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-17T18:32:19Z,try to fix 2,R/size.R;tests/testthat/files/shiny_app/app.R,False,True,True,False,2,2,4,"---FILE: R/size.R---
@@ -100,7 +100,7 @@ shiny_app_deps <- function(path = ""."", recursive = TRUE) {
 shiny_app_size <- function(path = ""."") {
   stopifnot(dir.exists(path))
   app_deps_recursive <- shiny_app_deps(path, recursive = TRUE)$Package
-  if (length(app_deps_recursive) > 0) {
+  if (length(app_deps_recursive) > 0 && is.character(app_deps_recursive)) {
     sum(vapply(app_deps_recursive, pac_size, numeric(1)) + dir_size(path))
   } else {
     dir_size(path)

---FILE: tests/testthat/files/shiny_app/app.R---
@@ -1,2 +1,2 @@
 library(memoise)
-library(renv)
+library(xml2)"
Polkas,pacs,4cb0ee6ced0cd6a86f11f5e1777fa66305cc10c8,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-17T18:14:41Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-17T18:14:41Z,try to fix,R/size.R,False,True,True,False,7,2,9,"---FILE: R/size.R---
@@ -71,7 +71,8 @@ pac_true_size <- function(pac,
 shiny_app_deps <- function(path = ""."", recursive = TRUE) {
   stopifnot(dir.exists(path))
   stopifnot(is.logical(recursive))
-  app_deps <- setdiff(renv::dependencies(path, progress = FALSE)$Package, pacs_base())
+  app_deps <- setdiff(renv::dependencies(path, progress = FALSE)$Package, c(pacs_base(), ""R""))
+  if (length(app_deps) == 0) return(data.frame(Package = NA, Version = NA, Direct = NA)[0, ])
   not_installed <- setdiff(app_deps, rownames(installed_packages(lib.loc = .libPaths())))
   if (length(not_installed)) {
     stop(sprintf(""Some of the dependency packages are not installed, %s"", not_installed))
@@ -99,5 +100,9 @@ shiny_app_deps <- function(path = ""."", recursive = TRUE) {
 shiny_app_size <- function(path = ""."") {
   stopifnot(dir.exists(path))
   app_deps_recursive <- shiny_app_deps(path, recursive = TRUE)$Package
-  sum(vapply(app_deps_recursive, pac_size, numeric(1)) + dir_size(path))
+  if (length(app_deps_recursive) > 0) {
+    sum(vapply(app_deps_recursive, pac_size, numeric(1)) + dir_size(path))
+  } else {
+    dir_size(path)
+  }
 }"
Polkas,pacs,20ac61c9a3f4aeca6ea062d77c325bfa12c91c5f,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-15T21:17:07Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-15T21:17:07Z,devel - fix tests,NEWS.md;tests/testthat/test-base.R,False,True,True,False,2,1,3,"---FILE: NEWS.md---
@@ -2,7 +2,7 @@
 
 * accepting `""Enhances""` field in all related functions.
 * improve the code for reading html tables.
-* improve testthat tests.
+* fix testthat tests.
 
 # pacs 0.3.7
 

---FILE: tests/testthat/test-base.R---
@@ -217,3 +217,4 @@ if (is_online() && TRUE) {
     })
   }
 }
+"
Polkas,pacs,8547b922a82c4f42191c6a0efb199f03c9048360,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-15T20:12:19Z,Maciej Nasinski,nasinski.maciej@gmail.com,2022-02-15T20:12:19Z,devel - fix tests,NEWS.md;R/valid.R;README.md;tests/testthat/test-base.R,False,True,True,False,8,8,16,"---FILE: NEWS.md---
@@ -2,6 +2,7 @@
 
 * accepting `""Enhances""` field in all related functions.
 * improve the code for reading html tables.
+* improve testthat tests.
 
 # pacs 0.3.7
 

---FILE: R/valid.R---
@@ -220,9 +220,7 @@ pac_validate <- function(pac,
     result <- result[!is.na(result$Package) & !(result$Package %in% c(""NA"", pacs_base())), ]
 
     result$direct <- result$Package %in% descriptions_pac_direct$Package
-
     result$newest <- apply(result, 1, function(x) isTRUE(pac_islast(x[""Package""], version = x[""Version.have""], repos = repos)))
-
     result$cran <- apply(result, 1, function(x) isTRUE(pac_isin(x[""Package""], ""https://cran.rstudio.com/"")))
 
     if (length(checkred$scope)) {

---FILE: README.md---
@@ -44,7 +44,8 @@ install.packages(""pacs"")
 This procedure will be crucial for R developers as clearly showing the possible broken packages inside the local library.  
 Thus we could assess which packages require versions update.
 
-Default validation of the library.
+Default validation of the library with the `pacs::lib_validate` function.  
+The `field` argument is equal to `c(""Depends"", ""Imports"", ""LinkingTo"")` on default as these are the dependencies installed when `install.packages` is used.
 
 ```r
 pacs::lib_validate()
@@ -94,7 +95,7 @@ nrow(red)
 head(red)
 ```
 
-Packages which are not a dependency of any other package:
+Packages which are not a dependency (default Depends/Imports/LinkingTo) of any other package:
 
 ```r
 lib[is.na(lib$Version.expected.min), ]
@@ -114,9 +115,9 @@ lib[(!is.na(lib$newest)) & (lib$newest == FALSE), ]
 
 ### renv
 
-When project is based on `renv` and all needed dependencies are installed (`options(renv.settings = list(snapshot.type = ""all""))`).
-Warning, at least `rsconnect` (and its `packrat` connected dependencies) related packages could still not be in `renv` library.
-Then we mostly want to validate only the isolated `renv` library.
+When project is based on `renv` and all needed dependencies are installed (`options(renv.settings = list(snapshot.type = ""all""))`).  
+Warning, at least `rsconnect` (and its `packrat` connected dependencies) related packages could still not be in `renv` library.  
+Then we mostly want to validate only the isolated `renv` library.  
 Please remember to limit the library path when using `pacs::lib_validate`, in such scenario.
 
 ```r

---FILE: tests/testthat/test-base.R---
@@ -103,7 +103,7 @@ if (is_online() && TRUE) {
     })
     test_that(""pacs::lib_validate"", {
       expect_identical(
-        sort(unique(rownames(installed_packages()))),
+        sort(unique(rownames(installed_packages(lib.loc = .libPaths())))),
         sort(unique(setdiff(c(lib_validate()[!is.na(lib_validate()$Version.have), ]$Package, pacs_base()), ""R"")))
       )
       expect_error(lib_validate(lib.loc = ""wrong""))"
Polkas,pacs,1012ee1320656155b81577cde4c1b95ad02aeb16,Maciej Nasinski,nasinski.maciej@gmail.com,2021-09-11T10:42:43Z,Maciej Nasinski,nasinski.maciej@gmail.com,2021-09-11T10:42:43Z,docs and fix tests,NEWS.md;R/comapre.R;man/pac_compare_namespace.Rd;man/pac_compare_versions.Rd;man/pac_timemachine.Rd,False,True,True,False,15,7,22,"---FILE: NEWS.md---
@@ -1,8 +1,9 @@
 # 0.3.5
 
 * Fixed `pac_timemachine` when from and to arguments are used and to is bigger than last Archived Date.
-* `pac_timemachine` has a well ordered `rownames`.
-* Fixed `pac_compare_namespace` and how S3methods are handled.
+* `pac_timemachine` has a well ordered `rownames` now.
+* Fixed `pac_compare_namespace`, how S3methods are handled.
+* 
 
 # 0.3.4
 

---FILE: R/comapre.R---
@@ -19,6 +19,7 @@
 #' \dontrun{
 #' pac_compare_versions(""memoise"", ""0.2.1"", ""2.0.0"")
 #' pac_compare_versions(""memoise"", ""0.2.1"")
+#' # local version to newest one
 #' pac_compare_versions(""memoise"")
 #' }
 pac_compare_versions <- function(pac,
@@ -88,6 +89,7 @@ pac_compare_versions <- function(pac,
 #' \dontrun{
 #' pac_compare_namespace(""shiny"", ""1.0.0"", ""1.6.0"")
 #' pac_compare_namespace(""shiny"", ""1.0.0"", ""1.6.0"")$exports
+#' # local version to newest one
 #' pac_compare_namespace(""shiny"")
 #' }
 pac_compare_namespace <- function(pac,
@@ -122,11 +124,11 @@ pac_compare_namespace <- function(pac,
   if (length(two_nam) == 0) stop(sprintf(""Version %s is not exists for %s."", new, pac))
 
   for (f in fields) {
-    if (f == ""S3methods"") {
+    if ((f == ""S3methods"") && (nrow(one_nam[[f]]) > 0 || nrow(two_nam[[f]]) > 0)) {
       old_f <- as.data.frame(one_nam[[f]])
-      old_f$id <- 1:nrow(old_f)
+      old_f$id <- seq_len(nrow(old_f))
       new_f <- as.data.frame(two_nam[[f]])
-      new_f$id <- 1:nrow(new_f)
+      new_f$id <- seq_len(nrow(new_f))
 
       merged <- merge(old_f, new_f, by = c(""V1"", ""V2"", ""V3"", ""V4""), all = TRUE)
       added <- merged[is.na(merged$id.x) & !is.na(merged$id.y), 1:4]

---FILE: man/pac_compare_namespace.Rd---
@@ -33,5 +33,7 @@ using the remote github CRAN mirror to compare NAMESPACE exports between specifi
 \dontrun{
 pac_compare_namespace(""shiny"", ""1.0.0"", ""1.6.0"")
 pac_compare_namespace(""shiny"", ""1.0.0"", ""1.6.0"")$exports
+# local version to newest one
+pac_compare_namespace(""shiny"")
 }
 }

---FILE: man/pac_compare_versions.Rd---
@@ -43,5 +43,7 @@ using the remote github CRAN mirror to compare DESCRIPTION files dependencies be
 \dontrun{
 pac_compare_versions(""memoise"", ""0.2.1"", ""2.0.0"")
 pac_compare_versions(""memoise"", ""0.2.1"")
+# local version to newest one
+pac_compare_versions(""memoise"")
 }
 }

---FILE: man/pac_timemachine.Rd---
@@ -2,7 +2,7 @@
 % Please edit documentation in R/timemachine.R
 \name{pac_timemachine}
 \alias{pac_timemachine}
-\title{Package version at a specific Date or a Date interval}
+\title{Package metadata for all releases}
 \usage{
 pac_timemachine(pac, at = NULL, from = NULL, to = NULL, version = NULL)
 }
@@ -30,7 +30,7 @@ data.frame with 7 columns
 }
 }
 \description{
-using CRAN website to get a package version/versions used at a specific Date or a Date interval.
+Using CRAN website to get a package metadata used at a specific Date or a Date interval or for specific version.
 }
 \note{
 Function will scrap two CRAN URLS. Works only with CRAN packages.
@@ -43,5 +43,6 @@ Results are cached for 1 hour with \code{memoise} package.
 pac_timemachine(""dplyr"", at = as.Date(""2017-02-02""))
 pac_timemachine(""dplyr"", from = as.Date(""2017-02-02""), to = as.Date(""2018-04-02""))
 pac_timemachine(""dplyr"", at = Sys.Date())
+pac_timemachine(""tidyr"", from = as.Date(""2020-06-01""), to = Sys.Date())
 }
 }"
Polkas,pacs,db96b7ad5e56d57132609232e6098bbe8309ff5c,Maciej Nasinski,nasinski.maciej@gmail.com,2021-09-11T10:05:07Z,Maciej Nasinski,nasinski.maciej@gmail.com,2021-09-11T10:05:07Z,fix timemachine and compare namespace S3methods,NEWS.md;R/comapre.R;R/timemachine.R;README.md,False,True,True,False,32,6,38,"---FILE: NEWS.md---
@@ -1,3 +1,9 @@
+# 0.3.5
+
+* Fixed `pac_timemachine` when from and to arguments are used and to is bigger than last Archived Date.
+* `pac_timemachine` has a well ordered `rownames`.
+* Fixed `pac_compare_namespace` and how S3methods are handled.
+
 # 0.3.4
 
 * `pac_deps` might show duplicated values if package was installed under a few different `libPaths`, now it is fixed.

---FILE: R/comapre.R---
@@ -19,6 +19,7 @@
 #' \dontrun{
 #' pac_compare_versions(""memoise"", ""0.2.1"", ""2.0.0"")
 #' pac_compare_versions(""memoise"", ""0.2.1"")
+#' pac_compare_versions(""memoise"")
 #' }
 pac_compare_versions <- function(pac,
                                  old = NULL,
@@ -87,6 +88,7 @@ pac_compare_versions <- function(pac,
 #' \dontrun{
 #' pac_compare_namespace(""shiny"", ""1.0.0"", ""1.6.0"")
 #' pac_compare_namespace(""shiny"", ""1.0.0"", ""1.6.0"")$exports
+#' pac_compare_namespace(""shiny"")
 #' }
 pac_compare_namespace <- function(pac,
                                   old = NULL,
@@ -120,10 +122,25 @@ pac_compare_namespace <- function(pac,
   if (length(two_nam) == 0) stop(sprintf(""Version %s is not exists for %s."", new, pac))
 
   for (f in fields) {
-    old_f <- unlist(one_nam[[f]])
-    new_f <- unlist(two_nam[[f]])
+    if (f == ""S3methods"") {
+      old_f <- as.data.frame(one_nam[[f]])
+      old_f$id <- 1:nrow(old_f)
+      new_f <- as.data.frame(two_nam[[f]])
+      new_f$id <- 1:nrow(new_f)
 
-    result[[f]] <- list(removed = setdiff(old_f, new_f), added = setdiff(new_f, old_f))
+      merged <- merge(old_f, new_f, by = c(""V1"", ""V2"", ""V3"", ""V4""), all = TRUE)
+      added <- merged[is.na(merged$id.x) & !is.na(merged$id.y), 1:4]
+      rownames(added) <- NULL
+      removed <- merged[!is.na(merged$id.x) & is.na(merged$id.y), 1:4]
+      rownames(removed) <- NULL
+
+      result[[f]] <- list(removed = removed, added = added)
+    } else {
+      old_f <- unlist(one_nam[[f]])
+      new_f <- unlist(two_nam[[f]])
+
+      result[[f]] <- list(removed = setdiff(old_f, new_f), added = setdiff(new_f, old_f))
+    }
   }
 
   structure(result, package = pac, old = old, new = new)

---FILE: R/timemachine.R---
@@ -1,5 +1,5 @@
-#' Package version at a specific Date or a Date interval
-#' @description using CRAN website to get a package version/versions used at a specific Date or a Date interval.
+#' Package metadata for all releases
+#' @description Using CRAN website to get a package metadata used at a specific Date or a Date interval or for specific version.
 #' @param pac character a package name.
 #' @param at Date old version of package. Default: NULL
 #' @param from Date new version of package. Default: NULL
@@ -25,6 +25,7 @@
 #' pac_timemachine(""dplyr"", at = as.Date(""2017-02-02""))
 #' pac_timemachine(""dplyr"", from = as.Date(""2017-02-02""), to = as.Date(""2018-04-02""))
 #' pac_timemachine(""dplyr"", at = Sys.Date())
+#' pac_timemachine(""tidyr"", from = as.Date(""2020-06-01""), to = Sys.Date())
 #' }
 pac_timemachine <- function(pac,
                             at = NULL,
@@ -55,6 +56,7 @@ pac_timemachine <- function(pac,
   f_cols <- c(""Package"", ""Version"", ""Released"", ""Archived"", ""LifeDuration"", ""URL"", ""Size"")
   result <- rbind(result[, f_cols], cran_page[, f_cols])
   result <- result[, f_cols]
+  rownames(result) <- NULL
 
   if (isTRUE(!is.null(at))) {
     if (isTRUE(all(at >= result$Released))) {
@@ -66,7 +68,7 @@ pac_timemachine <- function(pac,
     if (all(from >= result$Released)) {
       utils::tail(result, 1)
     } else {
-      result[to >= result$Released & from <= result$Archived, ]
+      result[(to >= result$Released) & (is.na(result$Archived) | from <= result$Archived), ]
     }
   } else if (isTRUE(!is.null(version))) {
     result[result$Version == version, ]

---FILE: README.md---
@@ -148,6 +148,7 @@ pacs::pac_timemachine(""dplyr"", version = ""0.8.0"")
 pacs::pac_timemachine(""dplyr"", at = as.Date(""2017-02-02""))
 pacs::pac_timemachine(""dplyr"", from = as.Date(""2017-02-02""), to = as.Date(""2018-04-02""))
 pacs::pac_timemachine(""dplyr"", at = Sys.Date())
+pacs::pac_timemachine(""tidyr"", from = as.Date(""2020-06-01""), to = Sys.Date())
 ```
 
 ## Package health"
Polkas,pacs,a9db69af7cbb83b8ab9e066575395c0e59557399,Maciej Nasinski,nasinski.maciej@gmail.com,2021-08-16T23:05:18Z,Maciej Nasinski,nasinski.maciej@gmail.com,2021-08-16T23:05:18Z,health fix,R/lifeduration.R,False,True,True,False,8,1,9,"---FILE: R/lifeduration.R---
@@ -142,7 +142,14 @@ pac_health <- function(pac,
 
   res <- isTRUE(life >= limit)
 
-  if (pac_islast(pac, version, at)) {
+  if (is.null(version) && !is.null(at)) {
+    pac_tm <- pac_timemachine(pac, at = at)
+    if (isNA(pac_tm)) NA
+    pac_tm <- utils::tail(pac_tm, 1)
+    vesion <- pac_tm$Version
+  }
+
+  if (pac_islast(pac, version)) {
     if (isTRUE(pac_checkred(pac, scope = scope, flavors = flavors))) FALSE else res
   } else {
     res"
Polkas,pacs,fb0248986bb6d342adfd0d0db4fb27b9e5fa0655,Maciej Nasinski,nasinski.maciej@gmail.com,2021-08-16T14:41:09Z,Maciej Nasinski,nasinski.maciej@gmail.com,2021-08-16T14:41:09Z,"fix pacs::bio_releases(), Date",R/check.R;tests/testthat/test-base.R,False,True,True,False,4,3,7,"---FILE: R/check.R---
@@ -183,7 +183,7 @@ read_bio_releases_raw <- function() {
       ncol = length(header), byrow = TRUE
     ))
     colnames(result_raw) <- header
-    result_raw$Date <- as.Date(result_raw$Date, format = ""%B %d, %y"")
+    result_raw$Date <- as.Date(result_raw$Date, format = ""%B %d, %Y"")
   } else {
     result_raw <- NA
   }

---FILE: tests/testthat/test-base.R---
@@ -35,7 +35,6 @@ test_that(""pacs::pac_deps"", {
   expect_true(ncol(stats_deps2) > 0)
   expect_true(length(stats_deps2$Package) > 0)
   expect_true(ncol(pacs::pac_deps(""memoise"", description_v = TRUE, recursive = FALSE)) == 2)
-  expect_true(ncol(pacs::pac_deps(""memoise"", description_v = TRUE, recursive = FALSE, local = FALSE)) == 2)
 })
 
 test_that(""pacs::dir_size"", {
@@ -82,7 +81,9 @@ if (is_online()) {
   test_that(""pacs::pac_deps_timemachine"", {
     expect_true(length(pac_deps_timemachine(""memoise"", ""0.2.1"")) == 1)
   })
-
+  test_that(""pacs::pac_deps"", {
+    expect_true(ncol(pacs::pac_deps(""memoise"", description_v = TRUE, recursive = FALSE, local = FALSE)) == 2)
+  })
   test_that(""pacs::lib_validate"", {
     expect_identical(
       sort(unique(rownames(installed_packages()))),"
Polkas,pacs,6443a8b376b49dc2dd28c129ce806f5f156cdb64,Maciej Nasinski,nasinski.maciej@gmail.com,2021-08-14T10:41:27Z,Maciej Nasinski,nasinski.maciej@gmail.com,2021-08-14T16:52:56Z,"any not all for flavors

new fixes

life duration

new fixes",NAMESPACE;R/check.R;R/lifeduration.R;R/onlast.R;README.md;man/biocran_repos.Rd;man/pac_bioreleases.Rd;man/pac_islast.Rd;man/pac_lifeduration.Rd;tests/testthat/test-base.R,False,True,True,False,102,42,144,"---FILE: NAMESPACE---
@@ -6,6 +6,7 @@ export(compareVersionsMax)
 export(compareVersionsMin)
 export(cran_flavors)
 export(lib_validate)
+export(pac_bioreleases)
 export(pac_checkpage)
 export(pac_checkred)
 export(pac_compare_namespace)

---FILE: R/check.R---
@@ -138,7 +138,7 @@ read_cran_flavours_raw <- function() {
   result_raw
 }
 
-read_cran_flavours <- memoise::memoise(read_cran_flavours_raw)
+read_cran_flavours <- memoise::memoise(read_cran_flavours_raw, cache = cachem::cache_mem(max_age = 60*60))
 
 #' Retrieving all R CRAN servers flavors
 #' @description Retrieving all R CRAN servers flavors.
@@ -151,3 +151,50 @@ read_cran_flavours <- memoise::memoise(read_cran_flavours_raw)
 cran_flavors <- function() {
   read_cran_flavours()
 }
+
+
+read_bio_releases_raw <- function() {
+  base_url <- ""https://www.bioconductor.org/about/release-announcements/""
+  rr <- try(readLines(base_url, warn = FALSE), silent = TRUE)
+  if (!inherits(rr, ""try-error"")) {
+    rr_range <- grep(""</?table[^>]*>"", rr)
+    rrr <- rr[(rr_range[1] + 1):(rr_range[2] - 1)]
+    rrr_all <- paste(rrr, collapse = ""\n"")
+    header <- trimws(xml_text(xml_find_all(read_html(rrr_all), ""//th"")))
+    result_raw <- as.data.frame(matrix(trimws(xml_text(xml_find_all(read_html(paste(rrr_all, collapse = ""\n"")), ""//td""))),
+                                       ncol = length(header), byrow = TRUE))
+    colnames(result_raw) <- header
+    result_raw$Date <- as.Date(result_raw$Date, format = ""%B %d, %y"")
+  } else {
+    result_raw <- NA
+  }
+
+  result_raw
+}
+
+read_bio_releases <- memoise::memoise(read_bio_releases_raw, cache = cachem::cache_mem(max_age = 60*60))
+
+#' Retrieving all Bioconductor releases
+#' @description Retrieving all Bioconductor releases.
+#' The data is downloaded from `https://www.bioconductor.org/about/release-announcements/`.
+#' @return data.frame with the same structure as the html table on `https://www.bioconductor.org/about/release-announcements/`.
+#' @note Results are cached for 1 hour with `memoise` package.
+#' @export
+#' @examples
+#' pac_bioreleases()
+pac_bioreleases <- function() {
+  read_bio_releases()
+}
+
+#' Simple wrapper around `BiocManager::repositories`
+#' @description Simple wrapper around `BiocManager::repositories`, suppress messages which are expected e.g. for RStudio users.
+#' @param ... optional `BiocManager::repositories` arguments.
+#' @return named character vector of repositories.
+#' @export
+#' @examples
+#' biocran_repos()
+#' biocran_repos(version = ""3.13"")
+biocran_repos <- function(...) {
+  suppressMessages(BiocManager::repositories(...))
+}
+

---FILE: R/lifeduration.R---
@@ -1,12 +1,12 @@
 #' Package version life duration at specific Date or for a specific version
 #' @description using CRAN website to get a package life duration for certain version or at a specific Date.
 #' @param pac character a package name.
-#' @param version character package version, By default the newest version in taken if failed tried to give local one if installed. Default: NULL
+#' @param version character package version, By default the newest version is taken. Default: NULL
 #' @param at Date old version of package. Default: NULL
 #' @param lib.loc character vector. Is omitted for non NULL version. Default: NULL
 #' @param repos character vector base URLs of the repository to use. Default `biocran_repos()`
 #' @return `difftime`, number of days package version was the newest one.
-#' @note Function will scrap two CRAN URLS. Works only with CRAN packages.
+#' @note Function will scrap two github CRAN mirror and CRAN URL. Works mainly with CRAN packages.
 #' Please as a courtesy to the R CRAN, don't overload their server by constantly using this function.
 #' Results are cached for 1 hour with `memoise` package, memory cache.
 #' @export
@@ -37,18 +37,13 @@ pac_lifeduration <- function(pac,
 
   if ((is.null(version) && is.null(at)) ||
     (!is.null(version) && isTRUE(utils::compareVersion(version, last_version) == 0))) {
-
-    if (is_installed) {
-    descr <- utils::packageDescription(pac, lib.loc = lib.loc)
-      if (isTRUE(utils::compareVersion(descr[[""Version""]], last_version) == 0)) {
-        base_date <- descr[[""Date/Publication""]]
-        if (is.null(base_date)) base_date <- descr[[""Date""]]
-        life <- Sys.Date() - as.Date(as.character(substr(base_date, 1, 10)))
-        if (identical(life, structure(numeric(0), class = ""difftime"", units = ""days""))) life <- NA
-        return(life)
-      } else {
-        return(NA)
-      }
+    if (is_installed) descr <- utils::packageDescription(pac, lib.loc = lib.loc)
+    if (is_installed && pac_islast(pac, descr[[""Version""]])) {
+      base_date <- descr[[""Date/Publication""]]
+      if (is.null(base_date)) base_date <- descr[[""Date""]]
+      life <- Sys.Date() - as.Date(as.character(substr(base_date, 1, 10)))
+      if (identical(life, structure(numeric(0), class = ""difftime"", units = ""days""))) life <- NA
+      return(life)
     } else {
       life <- Sys.Date() - as.Date(substr(pac_description(pac,
                                                    version = last_version,
@@ -62,18 +57,18 @@ pac_lifeduration <- function(pac,
   if (ison_cran) {
     if (is.null(version) && !is.null(at)) {
       pac_tm <- utils::tail(pac_timemachine(pac, at = at), 1)
-      pac_tm$LifeDuration
+      return(pac_tm$LifeDuration)
     } else {
       if (isTRUE(utils::compareVersion(version, last_version) == 1)) {
         return(NA)
       }
       pac_tm <- pac_timemachine(pac)
       if (isTRUE(all(vapply(pac_tm$Version, function(v) isFALSE(utils::compareVersion(v, version) == 0), logical(1))))) return(NA)
       pac_tm <- pac_tm[vapply(pac_tm$Version, function(v) isTRUE(utils::compareVersion(v, version) == 0), logical(1)), ]
-      pac_tm$LifeDuration
+      return(pac_tm$LifeDuration)
     }
   } else{
-    NA
+    return(NA)
   }
 }
 

---FILE: R/onlast.R---
@@ -57,9 +57,9 @@ is_on_raw <- function(pac, repos = biocran_repos()) {
 is_on <- memoise::memoise(is_on_raw)
 
 #' Checking if a packge version is the most recent one
-#' @description .
+#' @description checking if a package version is the most recent one, by default the installed version is compared.
 #' @param pac character a package name.
-#' @param version character package version, By default the newest version in taken if failed tried to give local one if installed. Default: NULL
+#' @param version character package version, by default the installed version is taken. Default: NULL
 #' @param lib.loc character vector. Is omitted for non NULL version. Default: NULL
 #' @param repos character vector base URLs of the repositories to use. By default checking CRAN and Bioconductor. Default `pacs::biocran_repos()`
 #' @return logical if a package is inside ropositories.
@@ -96,15 +96,3 @@ pac_islast <- function(pac, version = NULL, lib.loc = NULL, repos = c(""https://b
 
   isTRUE(utils::compareVersion(last_version, version) == 0)
 }
-
-#' Simple wrapper around `BiocManager::repositories`
-#' @description Simple wrapper around `BiocManager::repositories`, suppress messages which are expected e.g. for RStudio users.
-#' @param ... optional `BiocManager::repositories` arguments.
-#' @return named character vector of repositories.
-#' @export
-#' @examples
-#' biocran_repos()
-#' biocran_repos(version = ""3.13"")
-biocran_repos <- function(...) {
-  suppressMessages(BiocManager::repositories(...))
-}

---FILE: README.md---
@@ -32,13 +32,14 @@
 |`pac_true_size`                      | True size of the package (with dependencies)| 
 |`pacs_base`                          | R base packages                               |
 |`pac_last`|The most recent package version|
-|`pac_islast`| Checking if a package vecion is the most recent one|
+|`pac_islast`| Checking if a package version is the most recent one|
 |`pac_on`| Checking if a package is currently inside provided repositories|
 |`pac_checkred` | Checking the R CRAN package check page status for any errors and warnings|
-|`checked_packages`| Downloading all R CRAN packages check page statuses|
+|`pac_bioreleases`|Retrieving all Bioconductor releases|
 |`pac_checkpage` |   Retrieving the package R CRAN check page|
+|`checked_packages`| Retrieving all R CRAN packages check page statuses|
 |`cran_flavors`|  Retrieving all R CRAN servers flavors|
-|`biocran_repos()`| Display current Bioconductor and CRAN repositories|
+|`biocran_repos`| Display current Bioconductor and CRAN repositories|
 
 **Hint1**: `Version` variable is mostly a minimal required i.e. max(version1, version2 , ...)
 

---FILE: man/biocran_repos.Rd---
@@ -1,5 +1,5 @@
 % Generated by roxygen2: do not edit by hand
-% Please edit documentation in R/onlast.R
+% Please edit documentation in R/check.R
 \name{biocran_repos}
 \alias{biocran_repos}
 \title{Simple wrapper around \code{BiocManager::repositories}}

---FILE: man/pac_bioreleases.Rd---
@@ -0,0 +1,21 @@
+% Generated by roxygen2: do not edit by hand
+% Please edit documentation in R/check.R
+\name{pac_bioreleases}
+\alias{pac_bioreleases}
+\title{Retrieving all Bioconductor releases}
+\usage{
+pac_bioreleases()
+}
+\value{
+data.frame with the same structure as the html table on \verb{https://www.bioconductor.org/about/release-announcements/}.
+}
+\description{
+Retrieving all Bioconductor releases.
+The data is downloaded from \verb{https://www.bioconductor.org/about/release-announcements/}.
+}
+\note{
+Results are cached for 1 hour with \code{memoise} package.
+}
+\examples{
+pac_bioreleases()
+}

---FILE: man/pac_islast.Rd---
@@ -18,7 +18,7 @@ pac_islast(
 \arguments{
 \item{pac}{character a package name.}
 
-\item{version}{character package version, By default the newest version in taken if failed tried to give local one if installed. Default: NULL}
+\item{version}{character package version, by default the installed version is taken. Default: NULL}
 
 \item{lib.loc}{character vector. Is omitted for non NULL version. Default: NULL}
 
@@ -28,7 +28,7 @@ pac_islast(
 logical if a package is inside ropositories.
 }
 \description{
-.
+checking if a package version is the most recent one, by default the installed version is compared.
 }
 \note{
 Results are cached for 1 hour with \code{memoise} package.

---FILE: man/pac_lifeduration.Rd---
@@ -15,7 +15,7 @@ pac_lifeduration(
 \arguments{
 \item{pac}{character a package name.}
 
-\item{version}{character package version, By default the newest version in taken if failed tried to give local one if installed. Default: NULL}
+\item{version}{character package version, By default the newest version is taken. Default: NULL}
 
 \item{at}{Date old version of package. Default: NULL}
 
@@ -30,7 +30,7 @@ pac_lifeduration(
 using CRAN website to get a package life duration for certain version or at a specific Date.
 }
 \note{
-Function will scrap two CRAN URLS. Works only with CRAN packages.
+Function will scrap two github CRAN mirror and CRAN URL. Works mainly with CRAN packages.
 Please as a courtesy to the R CRAN, don't overload their server by constantly using this function.
 Results are cached for 1 hour with \code{memoise} package, memory cache.
 }

---FILE: tests/testthat/test-base.R---
@@ -174,15 +174,22 @@ if (is_online()) {
 
   flavs <- pacs::cran_flavors()
   test_that(""pacs::cran_flavors()"", {
-    expect_true(all(flavs$Flavor %in% colnames(checked)))
+    expect_true(any(flavs$Flavor %in% colnames(checked)))
     expect_true(nrow(flavs) > 0)
     expect_true(is.data.frame(flavs))
   })
 
   test_that(""pacs::pac_checkpage"", {
     dplyr_checkpage <- pacs::pac_checkpage(""dplyr"")
-    expect_true(all(dplyr_checkpage$Flavor %in% flavs$Flavor))
+    expect_true(any(dplyr_checkpage$Flavor %in% flavs$Flavor))
     expect_true(nrow(dplyr_checkpage) > 0)
     expect_true(is.data.frame(dplyr_checkpage))
   })
+
+  test_that(""pacs::pac_bioreleases()"", {
+    bioreleases <- pac_bioreleases()
+    expect_true(nrow(bioreleases) > 0)
+    expect_true(is.data.frame(bioreleases))
+    expect_identical(colnames(bioreleases), c(""Release"", ""Date"", ""Software packages"", ""R""))
+  })
 }"
Polkas,pacs,d2b634b1bca4ffc0771ccf82ff8eb80e353f22ee,Maciej Nasinski,nasinski.maciej@gmail.com,2021-08-13T17:29:20Z,Maciej Nasinski,nasinski.maciej@gmail.com,2021-08-14T16:52:53Z,"CRAN servers might stop working, and buck up for description and namesapce functions

a few fixes, bioconductor mainly

a few fixes, bioconductor mainly",NAMESPACE;NEWS.md;R/check.R;R/comapre.R;R/deps.R;R/description.R;R/lifeduration.R;R/namespace.R;R/onlast.R;R/timemachine.R;R/utils.R;R/valid.R;README.md;man/biocran_repos.Rd;man/lib_validate.Rd;man/pac_compare_namespace.Rd;man/pac_compare_versions.Rd;man/pac_deps.Rd;man/pac_description.Rd;man/pac_health.Rd;man/pac_islast.Rd;man/pac_last.Rd;man/pac_lifeduration.Rd;man/pac_namespace.Rd;man/pac_on.Rd;man/pac_validate.Rd;tests/testthat/test-base.R,False,True,True,False,283,164,447,"---FILE: NAMESPACE---
@@ -14,9 +14,11 @@ export(pac_deps)
 export(pac_deps_timemachine)
 export(pac_description)
 export(pac_health)
+export(pac_islast)
 export(pac_last)
 export(pac_lifeduration)
 export(pac_namespace)
+export(pac_on)
 export(pac_size)
 export(pac_timemachine)
 export(pac_true_size)

---FILE: NEWS.md---
@@ -5,6 +5,8 @@
 * Fix `lib_validate` as it not take into account statuses for not fully performed tests, it was case for less than 1% of all packages.
 * Add note that `checked_packages` could return duplicated observations which is expected.
 * Improve merge in `lib_validate` to show non-CRAN packages too.
+* Rewrite some tests as some R CRAN servers might shut down.
+* Polishing code of `pac_lifeduration`.
 
 # 0.3.2
 

---FILE: R/check.R---
@@ -31,7 +31,7 @@ read_checkpage <- memoise::memoise(read_checkpage_raw, cache = cachem::cache_mem
 pac_checkpage <- function(pac) {
   stopifnot((length(pac) == 1) && is.character(pac))
 
-  if (!pac %in% rownames(available_packages(repos = ""https://cran.rstudio.com/""))) {
+  if (!pac_on(pac, ""https://cran.rstudio.com/"")) {
     return(NA)
   }
 
@@ -63,7 +63,7 @@ pac_checkred <- function(pac, scope = c(""ERROR"", ""FAIL""), flavors = NULL) {
             is.null(flavors) || all(flavors %in% cran_flavors()$Flavor)
   )
 
-  if (!pac %in% rownames(available_packages(repos = ""https://cran.rstudio.com/""))) {
+  if (!pac_on(pac, ""https://cran.rstudio.com/"")) {
     return(NA)
   }
 

---FILE: R/comapre.R---
@@ -5,7 +5,7 @@
 #' @param new character a new version of package, default newest version. Default: NULL
 #' @param fields character a vector with possible values `c(""Depends"", ""Imports"", ""LinkingTo"", ""Suggests"")`. Default: `c(""Depends"", ""Imports"", ""LinkingTo"")`
 #' @param lib.loc character. Default: NULL
-#' @param repos character the base URL of the repository to use. Default ""https://cran.rstudio.org""
+#' @param repos character the base URL of the CRAN repository to use. Default ""https://cran.rstudio.org""
 #' @return data.frame with 4 columns.
 #' \describe{
 #' \item{Package}{character package names.}
@@ -27,7 +27,7 @@ pac_compare_versions <- function(pac,
                                  lib.loc = NULL,
                                  repos = ""https://cran.rstudio.com/"") {
   stopifnot((length(pac) == 1) && is.character(pac))
-  stopifnot(pac %in% rownames(available_packages(repos = repos)))
+  stopifnot(pac_on(pac, repos))
   stopifnot(is.null(old) || (length(old) == 1) && is.character(old))
   stopifnot(is.null(new) || (length(new) == 1) && is.character(new))
   stopifnot(all(fields %in% c(""Depends"", ""Imports"", ""Suggests"", ""LinkingTo"")))
@@ -80,7 +80,7 @@ pac_compare_versions <- function(pac,
 #' @param old character an old version of package.
 #' @param new character a new version of package.
 #' @param lib.loc character. Default: NULL
-#' @param repos character the base URL of the repository to use. Used only for the validation. Default `https://cran.rstudio.com/`
+#' @param repos character the base URL of the CRAN repository to use. Used only for the validation. Default `https://cran.rstudio.com/`
 #' @return list with `c(""imports"", ""exports"", ""exportPatterns"", ""importClasses"", ""importMethods"", ""exportClasses"", ""exportMethods"", ""exportClassPatterns"", ""dynlibs"", ""S3methods"")` slots, and added and removed ones for each of them.
 #' @note The comparison is only about exports.
 #' @export
@@ -95,7 +95,7 @@ pac_compare_namespace <- function(pac,
                                 lib.loc = NULL,
                                 repos = ""https://cran.rstudio.com/"") {
   stopifnot((length(pac) == 1) && is.character(pac))
-  stopifnot(pac %in% rownames(available_packages(repos = repos)))
+  stopifnot(pac_on(pac, repos))
   stopifnot(is.null(old) || (length(old) == 1) && is.character(old))
   stopifnot(is.null(new) || (length(new) == 1) && is.character(new))
   stopifnot(is.character(repos))

---FILE: R/deps.R---
@@ -8,7 +8,7 @@
 #' @param description_v if the dependencies version should be taken from description files, minimal required. Default: FALSE
 #' @param attr logical specify if a package and its version should be added as a attribute of data.frame or for FALSE as a additional record. Default: TRUE
 #' @param recursive logical if to assess the dependencies recursively. Default: TRUE
-#' @param repos character the base URL of the repository to use. Used only for the validation. Default `https://cran.rstudio.com/`
+#' @param repos character the base URL of the CRAN repository to use. Used only for the validation. Default `https://cran.rstudio.com/`
 #' @return data.frame with packages and their versions. Versions are taken from `installed.packages` or newest released.
 #' @note When function is invoked in the loop afterwards binded results could be aggregated like,
 #' `stats::aggregate(results[, c(""Version""), drop = FALSE], list(Package = results$Package), pacs::compareVersionsMax)`.
@@ -74,7 +74,7 @@ pac_deps <- function(pac,
     deps(pac, fields)
     v_base <- installed_packages(lib.loc = lib.loc)
   } else {
-    stopifnot(pac %in% rownames(available_packages(repos)))
+    stopifnot(pac_on(pac, repos))
     paks_global <- tools::package_dependencies(pac,
       db = available_packages(repos),
       which = fields,

---FILE: R/description.R---
@@ -1,11 +1,11 @@
-#' CRAN package DESCRIPTION file
+#' package DESCRIPTION file
 #' @description CRAN package DESCRIPTION file taken locally or remotely from GITHUB CRAN mirror or CRAN website.
 #' @param pac character a package name.
-#' @param version character package version. Default: NULL
+#' @param version character package version, By default the newest version in taken if failed tried to give local one if installed. Default: NULL
 #' @param at Date. Default: NULL
 #' @param local logical if to use local library. Default: FALSE
 #' @param lib.loc character used optionally when local is equal TRUE. Default: NULL
-#' @param repos character the base URL of the repository to use. Used only for the validation. Default `https://cran.rstudio.com/`
+#' @param repos character the base URL of the CRAN repository to use. Used only for the validation. Default `https://cran.rstudio.com/`
 #' @return list with names proper for DESCRIPTION file fields.
 #' @note Results are cached for 1 hour with `memoise` package.
 #' @export
@@ -30,15 +30,23 @@ pac_description <- function(pac,
 
   is_installed <- isTRUE(pac %in% rownames(installed_packages(lib.loc = lib.loc)))
 
-  if (!is_installed && (!pac %in% rownames(available_packages(repos = repos)) || (!is.null(version) && isTRUE(utils::compareVersion(version, pac_last(pac)) == 1)))) {
-    return(list())
+  if (!is_installed && (!pac_on(pac, repos) || (!is.null(version) && isTRUE(utils::compareVersion(version, pac_last(pac)) == 1)))) {
+    return(structure(list(), package = pac, version = version))
   }
 
-  if ((local || is_installed) && (is.null(version) || (!is.null(version) && isTRUE(utils::packageDescription(pac)$Version == version)))) {
-    if (!is_installed) return(list())
-    return(utils::packageDescription(pac, lib.loc))
+  if ((local) && (is.null(version) || (!is.null(version) && isTRUE(utils::packageDescription(pac)$Version == version)))) {
+    if (!is_installed) return(structure(list(), package = pac, version = version))
+    result <- utils::packageDescription(pac, lib.loc)
+    return(structure(result, package = pac, version = result$version))
   } else {
-    pac_description_dcf(pac, version, at)
+    result <- pac_description_dcf(pac, version, at)
+    if (length(result) == 0 && is_installed && is.null(version)) {
+      result <- utils::packageDescription(pac, lib.loc)
+      version <- result$Version
+      return(structure(result, package = pac, version = version))
+    } else {
+      return(structure(result, package = pac, version = attr(result, ""version"")))
+    }
   }
 }
 
@@ -91,7 +99,7 @@ pac_description_dcf_raw <- function(pac, version, at) {
         quiet = TRUE
       )}, silent = TRUE)
 
-    if (inherits(download, ""try-error"")) return(list())
+    if (inherits(download, ""try-error"")) return(structure(list(), package = pac, version = version))
 
     temp_dir <- tempdir(check = TRUE)
     utils::untar(temp_tar, exdir = temp_dir)
@@ -103,7 +111,7 @@ pac_description_dcf_raw <- function(pac, version, at) {
     unlink(ee)
   }
 
-  result
+  structure(result, package = pac, version = version)
 }
 
 pac_description_dcf <- memoise::memoise(pac_description_dcf_raw, cache = cachem::cache_mem(max_age = 60 * 60))

---FILE: R/lifeduration.R---
@@ -1,10 +1,10 @@
 #' Package version life duration at specific Date or for a specific version
 #' @description using CRAN website to get a package life duration for certain version or at a specific Date.
 #' @param pac character a package name.
-#' @param version character version of package, by default the local version is taken if not available then the newest is assumed. Default: NULL
+#' @param version character package version, By default the newest version in taken if failed tried to give local one if installed. Default: NULL
 #' @param at Date old version of package. Default: NULL
 #' @param lib.loc character vector. Is omitted for non NULL version. Default: NULL
-#' @param repos character the base URL of the repository to use. Default `biocran_repos()`
+#' @param repos character vector base URLs of the repository to use. Default `biocran_repos()`
 #' @return `difftime`, number of days package version was the newest one.
 #' @note Function will scrap two CRAN URLS. Works only with CRAN packages.
 #' Please as a courtesy to the R CRAN, don't overload their server by constantly using this function.
@@ -15,6 +15,7 @@
 #' pac_lifeduration(""memoise"")
 #' pac_lifeduration(""dplyr"", version = ""0.8.0"")
 #' pac_lifeduration(""dplyr"", at = as.Date(""2019-02-14""))
+#' pac_lifeduration(""S4Vectors"")
 #' }
 pac_lifeduration <- function(pac,
                              version = NULL,
@@ -28,31 +29,26 @@ pac_lifeduration <- function(pac,
 
   is_installed <- isTRUE(pac %in% rownames(installed_packages(lib.loc = lib.loc)))
 
-  if (!pac %in% rownames(available_packages(repos = repos)) && !is_installed) {
+  if (!pac_on(pac, repos) && !is_installed) {
     return(NA)
   } else {
     last_version <- pac_last(pac, repos = repos)
   }
 
-
   if ((is.null(version) && is.null(at)) ||
     (!is.null(version) && isTRUE(utils::compareVersion(version, last_version) == 0))) {
 
     if (is_installed) {
     descr <- utils::packageDescription(pac, lib.loc = lib.loc)
-    if (isTRUE(utils::compareVersion(descr[[""Version""]], last_version) == 0)) {
-      base_date <- descr[[""Date/Publication""]]
-      if (is.null(base_date)) base_date <- descr[[""Date""]]
-      life <- Sys.Date() - as.Date(as.character(substr(base_date, 1, 10)))
-      if (identical(life, structure(numeric(0), class = ""difftime"", units = ""days""))) life <- NA
-      return(life)
-    } else {
-      life <- Sys.Date() - as.Date(substr(pac_description(pac,
-                                                   version = descr[[""Version""]],
-                                                   lib.loc = lib.loc)[[""Date/Publication""]], 1, 10))
-      if (identical(life, structure(numeric(0), class = ""difftime"", units = ""days""))) life <- NA
-      return(life)
-    }
+      if (isTRUE(utils::compareVersion(descr[[""Version""]], last_version) == 0)) {
+        base_date <- descr[[""Date/Publication""]]
+        if (is.null(base_date)) base_date <- descr[[""Date""]]
+        life <- Sys.Date() - as.Date(as.character(substr(base_date, 1, 10)))
+        if (identical(life, structure(numeric(0), class = ""difftime"", units = ""days""))) life <- NA
+        return(life)
+      } else {
+        return(NA)
+      }
     } else {
       life <- Sys.Date() - as.Date(substr(pac_description(pac,
                                                    version = last_version,
@@ -61,7 +57,7 @@ pac_lifeduration <- function(pac,
     }
   }
 
-  ison_cran <- is_cran(pac)
+  ison_cran <- is_on(pac, ""https://cran.rstudio.com/"")
 
   if (ison_cran) {
     if (is.null(version) && !is.null(at)) {
@@ -92,7 +88,7 @@ pac_lifeduration <- function(pac,
 #' @param scope character vector scope of R CRAN check pages statuses to consider, any of `c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")`. Default `c(""ERROR"", ""FAIL"")`
 #' @param flavors character vector of CRAN machines to consider, which might be retrieved with `pacs::cran_flavors()$Flavor`. By default all CRAN machines are considered, NULL value. Default NULL
 #' @param lib.loc character vector. Is omitted for non NULL version. Default: NULL
-#' @param repos character the base URL of the repository to use. Default ""https://cran.rstudio.org""
+#' @param repos character the base CRAN URL of the repository to use. Default ""https://cran.rstudio.org""
 #' @return logical if package is healthy.
 #' @note Function will scrap two/tree CRAN URLS. Works only with CRAN packages.
 #' The newest release are checked for warnings/errors on R CRAN check page.
@@ -116,12 +112,13 @@ pac_health <- function(pac,
   stopifnot(length(pac) == 1 && is.character(pac))
   stopifnot(!all(c(!is.null(version), !is.null(at))))
   stopifnot(is.null(version) || (length(version) == 1 && is.character(version)))
+  stopifnot(length(repos) == 1 && is.character(repos))
 
   if (pac %in% pacs_base()) {
     return(TRUE)
   }
 
-  if (any(c(!is.null(version), !is.null(at))) && !pac %in% rownames(available_packages(repos = repos))) {
+  if (any(c(!is.null(version), !is.null(at))) && !pac_on(pac, repos)) {
     return(NA)
   }
 
@@ -140,7 +137,7 @@ pac_health <- function(pac,
 
   res <- isTRUE(life >= limit)
 
-  if (is_last_release(pac, version, at)) {
+  if (pac_islast(pac, version, at)) {
     if (isTRUE(pac_checkred(pac, scope = scope, flavors = flavors))) FALSE else res
   } else {
     res

---FILE: R/namespace.R---
@@ -1,11 +1,11 @@
-#' CRAN package NAMESPACE file
+#' package NAMESPACE file
 #' @description CRAN package NAMESPACE file taken locally or remotely from GITHUB CRAN mirror or CRAN website.
 #' @param pac character a package name.
-#' @param version character package version. Default: NULL
+#' @param version character package version, By default the newest version in taken if failed tried to give local one if installed. Default: NULL
 #' @param at Date. Default: NULL
 #' @param local logical if to use local library. Default: FALSE
 #' @param lib.loc character used optionally when local is equal TRUE. Default: NULL
-#' @param repos character the base URL of the repository to use. Used only for the validation. Default `https://cran.rstudio.com/`
+#' @param repos character the base URL of the CRAN repository to use. Used only for the validation. Default `https://cran.rstudio.com/`
 #' @return list with names proper for NAMESPACE file, the same as format as returned by `base::parseNamespaceFile`.
 #' @note Results are cached for 1 hour with `memoise` package.
 #' This function is mainly built under source code from `base::parseNamespaceFile`.
@@ -27,19 +27,26 @@ pac_namespace <- function(pac, version = NULL, at = NULL, local = FALSE, lib.loc
 
   is_installed <- isTRUE(pac %in% rownames(installed_packages(lib.loc = lib.loc)))
 
-  if (!is_installed && (!pac %in% rownames(available_packages(repos = repos)) || (!is.null(version) && isTRUE(utils::compareVersion(version, pac_last(pac)) == 1)))) {
-    return(list())
+  if (!is_installed && (!pac_on(pac, repos) || (!is.null(version) && isTRUE(utils::compareVersion(version, pac_last(pac)) == 1)))) {
+    return(structure(list(), package = pac, version = version))
   }
 
-  if ((local || is_installed) && (is.null(version) || (!is.null(version) && isTRUE(utils::packageDescription(pac)$Version == version)))) {
-    if (!is_installed) return(list())
+  if ((local) && (is.null(version) || (!is.null(version) && isTRUE(is_installed && utils::packageDescription(pac)$Version == version)))) {
+    if (!is_installed) return(structure(list(), package = pac, version = version))
     namespace_lines <- readLines(system.file(package = pac, ""NAMESPACE""), warn = FALSE)
+    version <- pac_description(pac, local = TRUE)$Version
   } else {
     namespace_lines <- pac_readnamespace(pac, version, at)
-    if (length(namespace_lines) == 0) return(list())
+    if (length(namespace_lines) == 0 && is_installed && is.null(version)) {
+      namespace_lines <- readLines(system.file(package = pac, ""NAMESPACE""), warn = FALSE)
+      version <- pac_description(pac, local = TRUE)$Version
+    } else if (length(namespace_lines) == 0) {
+      version <- attr(namespace_lines, ""version"")
+      return(structure(list(), package = pac, version = version))
+    }
   }
 
-  enc <- suppressWarnings(pacs::pac_description(pac = pac, version = version, at = at, lib.loc = lib.loc, repos = repos))$Encoding
+  enc <- suppressWarnings(pacs::pac_description(pac = pac, version = version, at = at, lib.loc = lib.loc, repos = repos)$Encoding)
   if (is.null(enc) || is.na(enc)) enc <- ""UTF-8""
 
   directives <- if (!is.na(enc) && !Sys.getlocale(""LC_CTYPE"") %in%
@@ -232,11 +239,12 @@ pac_namespace <- function(pac, version = NULL, at = NULL, local = FALSE, lib.loc
   }
   for (e in directives) parseDirective(e)
   dynlibs <- dynlibs[!duplicated(dynlibs)]
-  list(imports = imports, exports = exports, exportPatterns = unique(exportPatterns),
+  result <- list(imports = imports, exports = exports, exportPatterns = unique(exportPatterns),
        importClasses = importClasses, importMethods = importMethods,
        exportClasses = unique(exportClasses), exportMethods = unique(exportMethods),
        exportClassPatterns = unique(exportClassPatterns), dynlibs = dynlibs, S3methods = unique(S3methods[seq_len(nS3),
                                                                                                           , drop = FALSE]))
+  structure(result, package = pac, version = version)
 }
 
 pac_readnamespace_raw <- function(pac, version, at) {
@@ -288,7 +296,7 @@ pac_readnamespace_raw <- function(pac, version, at) {
                            quiet = TRUE
       )}, silent = TRUE)
 
-    if (inherits(download, ""try-error"")) return(list())
+    if (inherits(download, ""try-error"")) return(structure(list(), package = pac, version = version))
 
     temp_dir <- tempdir(check = TRUE)
     utils::untar(temp_tar, exdir = temp_dir)
@@ -300,7 +308,7 @@ pac_readnamespace_raw <- function(pac, version, at) {
     unlink(ee)
   }
 
-  result
+  structure(result, package = pac, version = version)
 }
 
 pac_readnamespace <- memoise::memoise(pac_readnamespace_raw, cache = cachem::cache_mem(max_age = 60 * 60))

---FILE: R/onlast.R---
@@ -0,0 +1,110 @@
+last_version_raw <- function(pac , repos) {
+  which_p <- rownames(available_packages(repos = repos)) == pac
+  if (any(which_p)) {
+    available_packages(repos = repos)[which_p, ""Version""]
+  } else {
+    NA
+  }
+}
+
+last_version_fun <- memoise::memoise(last_version_raw, cache = cachem::cache_mem(max_age = 60*60))
+
+#' Getting the most recent package version
+#' @description using `utils::available.packages` to get the newest package version.
+#' @param pac character a package name.
+#' @param repos character vector base URLs of the repositories to use. By default checking CRAN and Bioconductor. Default `pacs::biocran_repos()`
+#' @return character most recent package version.
+#' @note Results are cached for 1 hour with `memoise` package.
+#' @export
+#' @examples
+#' pac_last(""dplyr"")
+pac_last <- function(pac, repos = biocran_repos()) {
+  stopifnot((length(pac) == 1) && is.character(pac))
+  stopifnot(is.character(repos))
+
+  if (!pac_on(pac, repos = repos)) {
+    return(NA)
+  }
+
+  last_version_fun(pac, repos = repos)
+}
+
+#' Checking if a packge is in repositories
+#' @description using `utils::available.packages` to check if package is in repoitories.
+#' @param pac character a package name.
+#' @param repos character vector base URLs of the repositories to use. By default checking CRAN and Bioconductor. Default `pacs::biocran_repos()`
+#' @return logical if a package is inside ropositories.
+#' @note Results are cached for 1 hour with `memoise` package.
+#' @export
+#' @examples
+#' pac_on(""dplyr"")
+#' pac_on(""dplyr"", ""https://cran.rstudio.com/"" )
+#' pac_on(""dplyr"", biocran_repos()[grep(""Bio"", names(biocran_repos()))])
+pac_on <- function(pac, repos = biocran_repos()) {
+  stopifnot((length(pac) == 1) && is.character(pac))
+  stopifnot(is.character(repos))
+  is_on(pac, repos = repos)
+}
+
+is_on_raw <- function(pac, repos = biocran_repos()) {
+  if (isTRUE(pac %in% rownames(available_packages(repos = repos)))) {
+    TRUE
+  } else {
+    FALSE
+  }
+}
+
+is_on <- memoise::memoise(is_on_raw)
+
+#' Checking if a packge version is the most recent one
+#' @description .
+#' @param pac character a package name.
+#' @param version character package version, By default the newest version in taken if failed tried to give local one if installed. Default: NULL
+#' @param lib.loc character vector. Is omitted for non NULL version. Default: NULL
+#' @param repos character vector base URLs of the repositories to use. By default checking CRAN and Bioconductor. Default `pacs::biocran_repos()`
+#' @return logical if a package is inside ropositories.
+#' @note Results are cached for 1 hour with `memoise` package.
+#' @export
+#' @examples
+#' \dontrun{
+#' pac_islast(""memoise"")
+#' pac_islast(""dplyr"", version = ""1.0.0"")
+#' pac_lifeduration(""S4Vectors"")
+#' pac_lifeduration(""S4Vectors"", version = pac_last(""S4Vectors""))
+#' }
+pac_islast <- function(pac, version = NULL, lib.loc = NULL, repos = c(""https://bioconductor.org/packages/3.13/bioc"",
+                                                                      ""https://bioconductor.org/packages/3.13/data/annotation"",
+                                                                      ""https://bioconductor.org/packages/3.13/data/experiment"",
+                                                                      ""https://bioconductor.org/packages/3.13/workflows"",
+                                                                      ""https://bioconductor.org/packages/3.13/books"",
+                                                                      ""https://cloud.r-project.org"")) {
+  if (!pac_on(pac, repos)) {
+    return(NA)
+  }
+
+  last_version <- pac_last(pac, repos = repos)
+
+  is_installed <- isTRUE(pac %in% rownames(installed_packages(lib.loc = lib.loc)))
+
+  if (isTRUE(is.null(version))) {
+    if (is_installed) {
+      version <- pac_description(pac, local = TRUE)$Version
+    } else {
+      return(FALSE)
+    }
+  }
+
+  isTRUE(utils::compareVersion(last_version, version) == 0)
+}
+
+#' Simple wrapper around `BiocManager::repositories`
+#' @description Simple wrapper around `BiocManager::repositories`, suppress messages which are expected e.g. for RStudio users.
+#' @param ... optional `BiocManager::repositories` arguments.
+#' @return named character vector of repositories.
+#' @export
+#' @examples
+#' biocran_repos()
+#' biocran_repos(version = ""3.13"")
+biocran_repos <- function(...) {
+  suppressMessages(BiocManager::repositories(...))
+}

---FILE: R/timemachine.R---
@@ -31,7 +31,7 @@ pac_timemachine <- function(pac,
                             from = NULL,
                             to = NULL,
                             version = NULL) {
-  stopifnot(pac %in% rownames(available_packages(repos = ""https://cran.rstudio.com/"")))
+  stopifnot(pac_on(pac, ""https://cran.rstudio.com/""))
   stopifnot(is.null(version) || (length(version) == 1 && is.character(version)))
   stopifnot(xor(
     !is.null(at) && inherits(at, ""Date"") && is.null(version),

---FILE: R/utils.R---
@@ -183,89 +183,6 @@ extract_deps <- function(x) {
   list(packages = pacs, versions = versions)
 }
 
-last_version_raw <- function(pac , repos) {
-  which_p <- rownames(available_packages(repos = repos)) == pac
-  if (sum(which_p, na.rm = TRUE) > 0) {
-    available_packages(repos = repos)[which_p, ""Version""]
-  } else {
-    NA
-  }
-}
-
-last_version_fun <- memoise::memoise(last_version_raw, cache = cachem::cache_mem(max_age = 60*60))
-
-#' Getting the most recent package version
-#' @description using `utils::available.packages` to get the newest package version.
-#' @param pac character a package name.
-#' @param repos character the base URL of the repository to use. Default `pacs::biocran_repos()`
-#' @return character most recent package version.
-#' @note Results are cached for 1 hour with `memoise` package.
-#' @export
-#' @examples
-#' pac_last(""dplyr"")
-pac_last <- function(pac, repos = biocran_repos()) {
-  stopifnot((length(pac) == 1) && is.character(pac))
-  stopifnot(is.character(repos))
-
-  if (isTRUE(!pac %in% rownames(available_packages(repos = repos)))) {
-    return(NA)
-  }
-
-  last_version_fun(pac, repos = repos)
-}
-
-
-is_cran <- function(pac) {
-  stopifnot((length(pac) == 1) && is.character(pac))
-  if (isTRUE(!pac %in% rownames(available_packages(repos = ""https://cloud.r-project.org"")))) {
-    FALSE
-  } else {
-    TRUE
-  }
-}
-
-#' Simple wrapper around `BiocManager::repositories`
-#' @description Simple wrapper around `BiocManager::repositories`, suppress messages which are expected e.g. for RStudio users.
-#' @param ... optional `BiocManager::repositories` arguments.
-#' @return named character vector of repositories.
-#' @export
-#' @examples
-#' biocran_repos()
-#' biocran_repos(version = ""3.13"")
-biocran_repos <- function(...) {
-  suppressMessages(BiocManager::repositories(...))
-}
-
-is_last_release <- function(pac, version = NULL, at = NULL, lib.loc = NULL, repos = c(""https://bioconductor.org/packages/3.13/bioc"",
-                                                                                      ""https://bioconductor.org/packages/3.13/data/annotation"",
-                                                                                      ""https://bioconductor.org/packages/3.13/data/experiment"",
-                                                                                      ""https://bioconductor.org/packages/3.13/workflows"",
-                                                                                      ""https://bioconductor.org/packages/3.13/books"",
-                                                                                      ""https://cloud.r-project.org"")) {
-  stopifnot(xor(!is.null(version), !is.null(at)) || (is.null(version) && is.null(at)))
-
-  if (!pac %in% rownames(available_packages(repos = repos))) {
-    return(NA)
-  }
-
-  last_version <- pac_last(pac, repos = repos)
-
-  is_installed <- isTRUE(pac %in% rownames(installed_packages(lib.loc = lib.loc)))
-
-  if (isTRUE(is.null(version) && is.null(at))) {
-    if (is_installed) {
-      version <- pac_description(pac, local = TRUE)$Version
-    } else {
-      return(FALSE)
-    }
-  } else if (isTRUE(is.null(version) && !is.null(at))) {
-    version <- utils::tail(pac_timemachine(pac = pac, at = at), 1)$Version
-  }
-
-  isTRUE(utils::compareVersion(last_version, version) == 0)
-}
-
-
 available_descriptions <- function(repos, fields, deps = NULL) {
   available_agg <- available_agg_fun(repos, fields)
 

---FILE: R/valid.R---
@@ -7,7 +7,7 @@
 #' @param fields character vector with possible values `c(""Depends"", ""Imports"", ""LinkingTo"", ""Suggests"")`. Default: `c(""Depends"", ""Imports"", ""LinkingTo"")`
 #' @param lifeduration logical if to add life duration column, might take some time. Default: FALSE
 #' @param checkred list with two named fields, `scope` and `flavor`. `scope` of R CRAN check pages statuses to consider, any of `c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")`. `flavor` is a vector of CRAN machines to consider, which might be retrieved with `pacs::cran_flavors()$Flavor`. By default an empty scope field deactivated assessment for `checkred` column, and NULL flavor will results in checking all machines. Default `list(scope = character(0), flavor = NULL)`
-#' @param repos character the base URL of the repository to use. Default `pacs::biocran_repos()`
+#' @param repos character vector base URLs of the repositories to use. Default `pacs::biocran_repos()`
 #' @return data.frame with 6/7/8 columns.
 #' \describe{
 #' \item{Package}{character a package name.}
@@ -49,6 +49,7 @@ lib_validate <- function(lib.loc = NULL,
               length(checkred$scope) == 0 || all(checkred$scope %in% c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")) &&
               is.null(checkred$flavors) || all(checkred$flavors %in% cran_flavors()$Flavor)
   )
+  stopifnot(is.character(repos))
 
   installed_agg <- installed_agg_fun(lib.loc, fields)
 
@@ -130,7 +131,7 @@ lib_validate <- function(lib.loc = NULL,
 #' @param fields character vector with possible values `c(""Depends"", ""Imports"", ""LinkingTo"", ""Suggests"")`. Default: `c(""Depends"", ""Imports"", ""LinkingTo"")`
 #' @param lifeduration logical if to add life duration column, might take some time. Default: FALSE
 #' @param checkred list with two named fields, `scope` and `flavor`. `scope` of R CRAN check pages statuses to consider, any of `c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")`. `flavor` vector of machines to consider, which might be retrieved with `pacs::cran_flavors()$Flavor`. By default an empty scope field deactivated assessment for `checkred` column, and NULL flavor will results in checking all machines. Default `list(scope = character(0), flavor = NULL)`
-#' @param repos character the base URL of the repository to use. Default `pacs::biocran_repos()`
+#' @param repos character vector base URLs of the repositories to use. Default `pacs::biocran_repos()`
 #' @return data.frame with 5/6/7 columns.
 #' \describe{
 #' \item{Package}{character a package name.}
@@ -171,6 +172,7 @@ pac_validate <- function(pac,
               length(checkred$scope) == 0 || all(checkred$scope %in% c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")) &&
               is.null(checkred$flavors) || all(checkred$flavors %in% cran_flavors()$Flavor)
   )
+  stopifnot(is.character(repos))
 
   descriptions_pac <- pac_deps(pac, lib.loc = lib.loc, fields = fields, description_v = TRUE)
   installed_pac <- pac_deps(pac, lib.loc = lib.loc, fields = fields)
@@ -187,9 +189,9 @@ pac_validate <- function(pac,
 
   result <- result[!is.na(result$Package) & !(result$Package %in% c(""NA"", pacs_base())), ]
 
-  result$newest <- apply(result, 1, function(x) isTRUE(pac_last(x[""Package""]) == x[""Version.have""]))
+  result$newest <- apply(result, 1, function(x) isTRUE(pac_islast(x[""Package""], version = x[""Version.have""],  repos = repos)))
 
-  result$cran <- apply(result, 1, function(x) isTRUE(is_cran(x[""Package""])))
+  result$cran <- apply(result, 1, function(x) isTRUE(pac_on(x[""Package""], ""https://cran.rstudio.com/"")))
 
   if (length(checkred$scope)) {
     result$checkred <- vapply(seq_len(nrow(result)), function(x) isTRUE(result$newest[x] && result$cran[x] && pac_checkred(result$Package[x], scope = checkred$scope, flavors = checkred$flavors)), logical(1))

---FILE: README.md---
@@ -32,6 +32,8 @@
 |`pac_true_size`                      | True size of the package (with dependencies)| 
 |`pacs_base`                          | R base packages                               |
 |`pac_last`|The most recent package version|
+|`pac_islast`| Checking if a package vecion is the most recent one|
+|`pac_on`| Checking if a package is currently inside provided repositories|
 |`pac_checkred` | Checking the R CRAN package check page status for any errors and warnings|
 |`checked_packages`| Downloading all R CRAN packages check page statuses|
 |`pac_checkpage` |   Retrieving the package R CRAN check page|

---FILE: man/biocran_repos.Rd---
@@ -1,5 +1,5 @@
 % Generated by roxygen2: do not edit by hand
-% Please edit documentation in R/utils.R
+% Please edit documentation in R/onlast.R
 \name{biocran_repos}
 \alias{biocran_repos}
 \title{Simple wrapper around \code{BiocManager::repositories}}

---FILE: man/lib_validate.Rd---
@@ -21,7 +21,7 @@ lib_validate(
 
 \item{checkred}{list with two named fields, \code{scope} and \code{flavor}. \code{scope} of R CRAN check pages statuses to consider, any of \code{c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")}. \code{flavor} is a vector of CRAN machines to consider, which might be retrieved with \code{pacs::cran_flavors()$Flavor}. By default an empty scope field deactivated assessment for \code{checkred} column, and NULL flavor will results in checking all machines. Default \code{list(scope = character(0), flavor = NULL)}}
 
-\item{repos}{character the base URL of the repository to use. Default \code{pacs::biocran_repos()}}
+\item{repos}{character vector base URLs of the repositories to use. Default \code{pacs::biocran_repos()}}
 }
 \value{
 data.frame with 6/7/8 columns.

---FILE: man/pac_compare_namespace.Rd---
@@ -21,7 +21,7 @@ pac_compare_namespace(
 
 \item{lib.loc}{character. Default: NULL}
 
-\item{repos}{character the base URL of the repository to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
+\item{repos}{character the base URL of the CRAN repository to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
 }
 \value{
 list with \code{c(""imports"", ""exports"", ""exportPatterns"", ""importClasses"", ""importMethods"", ""exportClasses"", ""exportMethods"", ""exportClassPatterns"", ""dynlibs"", ""S3methods"")} slots, and added and removed ones for each of them.

---FILE: man/pac_compare_versions.Rd---
@@ -24,7 +24,7 @@ pac_compare_versions(
 
 \item{lib.loc}{character. Default: NULL}
 
-\item{repos}{character the base URL of the repository to use. Default ""https://cran.rstudio.org""}
+\item{repos}{character the base URL of the CRAN repository to use. Default ""https://cran.rstudio.org""}
 }
 \value{
 data.frame with 4 columns.

---FILE: man/pac_deps.Rd---
@@ -33,7 +33,7 @@ pac_deps(
 
 \item{recursive}{logical if to assess the dependencies recursively. Default: TRUE}
 
-\item{repos}{character the base URL of the repository to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
+\item{repos}{character the base URL of the CRAN repository to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
 }
 \value{
 data.frame with packages and their versions. Versions are taken from \code{installed.packages} or newest released.

---FILE: man/pac_description.Rd---
@@ -2,7 +2,7 @@
 % Please edit documentation in R/description.R
 \name{pac_description}
 \alias{pac_description}
-\title{CRAN package DESCRIPTION file}
+\title{package DESCRIPTION file}
 \usage{
 pac_description(
   pac,
@@ -16,15 +16,15 @@ pac_description(
 \arguments{
 \item{pac}{character a package name.}
 
-\item{version}{character package version. Default: NULL}
+\item{version}{character package version, By default the newest version in taken if failed tried to give local one if installed. Default: NULL}
 
 \item{at}{Date. Default: NULL}
 
 \item{local}{logical if to use local library. Default: FALSE}
 
 \item{lib.loc}{character used optionally when local is equal TRUE. Default: NULL}
 
-\item{repos}{character the base URL of the repository to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
+\item{repos}{character the base URL of the CRAN repository to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
 }
 \value{
 list with names proper for DESCRIPTION file fields.

---FILE: man/pac_health.Rd---
@@ -30,7 +30,7 @@ pac_health(
 
 \item{lib.loc}{character vector. Is omitted for non NULL version. Default: NULL}
 
-\item{repos}{character the base URL of the repository to use. Default ""https://cran.rstudio.org""}
+\item{repos}{character the base CRAN URL of the repository to use. Default ""https://cran.rstudio.org""}
 }
 \value{
 logical if package is healthy.

---FILE: man/pac_islast.Rd---
@@ -0,0 +1,43 @@
+% Generated by roxygen2: do not edit by hand
+% Please edit documentation in R/onlast.R
+\name{pac_islast}
+\alias{pac_islast}
+\title{Checking if a packge version is the most recent one}
+\usage{
+pac_islast(
+  pac,
+  version = NULL,
+  lib.loc = NULL,
+  repos = c(""https://bioconductor.org/packages/3.13/bioc"",
+    ""https://bioconductor.org/packages/3.13/data/annotation"",
+    ""https://bioconductor.org/packages/3.13/data/experiment"",
+    ""https://bioconductor.org/packages/3.13/workflows"",
+    ""https://bioconductor.org/packages/3.13/books"", ""https://cloud.r-project.org"")
+)
+}
+\arguments{
+\item{pac}{character a package name.}
+
+\item{version}{character package version, By default the newest version in taken if failed tried to give local one if installed. Default: NULL}
+
+\item{lib.loc}{character vector. Is omitted for non NULL version. Default: NULL}
+
+\item{repos}{character vector base URLs of the repositories to use. By default checking CRAN and Bioconductor. Default \code{pacs::biocran_repos()}}
+}
+\value{
+logical if a package is inside ropositories.
+}
+\description{
+.
+}
+\note{
+Results are cached for 1 hour with \code{memoise} package.
+}
+\examples{
+\dontrun{
+pac_islast(""memoise"")
+pac_islast(""dplyr"", version = ""1.0.0"")
+pac_lifeduration(""S4Vectors"")
+pac_lifeduration(""S4Vectors"", version = pac_last(""S4Vectors""))
+}
+}

---FILE: man/pac_last.Rd---
@@ -1,5 +1,5 @@
 % Generated by roxygen2: do not edit by hand
-% Please edit documentation in R/utils.R
+% Please edit documentation in R/onlast.R
 \name{pac_last}
 \alias{pac_last}
 \title{Getting the most recent package version}
@@ -9,7 +9,7 @@ pac_last(pac, repos = biocran_repos())
 \arguments{
 \item{pac}{character a package name.}
 
-\item{repos}{character the base URL of the repository to use. Default \code{pacs::biocran_repos()}}
+\item{repos}{character vector base URLs of the repositories to use. By default checking CRAN and Bioconductor. Default \code{pacs::biocran_repos()}}
 }
 \value{
 character most recent package version.

---FILE: man/pac_lifeduration.Rd---
@@ -15,13 +15,13 @@ pac_lifeduration(
 \arguments{
 \item{pac}{character a package name.}
 
-\item{version}{character version of package, by default the local version is taken if not available then the newest is assumed. Default: NULL}
+\item{version}{character package version, By default the newest version in taken if failed tried to give local one if installed. Default: NULL}
 
 \item{at}{Date old version of package. Default: NULL}
 
 \item{lib.loc}{character vector. Is omitted for non NULL version. Default: NULL}
 
-\item{repos}{character the base URL of the repository to use. Default \code{biocran_repos()}}
+\item{repos}{character vector base URLs of the repository to use. Default \code{biocran_repos()}}
 }
 \value{
 \code{difftime}, number of days package version was the newest one.
@@ -39,5 +39,6 @@ Results are cached for 1 hour with \code{memoise} package, memory cache.
 pac_lifeduration(""memoise"")
 pac_lifeduration(""dplyr"", version = ""0.8.0"")
 pac_lifeduration(""dplyr"", at = as.Date(""2019-02-14""))
+pac_lifeduration(""S4Vectors"")
 }
 }

---FILE: man/pac_namespace.Rd---
@@ -2,7 +2,7 @@
 % Please edit documentation in R/namespace.R
 \name{pac_namespace}
 \alias{pac_namespace}
-\title{CRAN package NAMESPACE file}
+\title{package NAMESPACE file}
 \usage{
 pac_namespace(
   pac,
@@ -16,15 +16,15 @@ pac_namespace(
 \arguments{
 \item{pac}{character a package name.}
 
-\item{version}{character package version. Default: NULL}
+\item{version}{character package version, By default the newest version in taken if failed tried to give local one if installed. Default: NULL}
 
 \item{at}{Date. Default: NULL}
 
 \item{local}{logical if to use local library. Default: FALSE}
 
 \item{lib.loc}{character used optionally when local is equal TRUE. Default: NULL}
 
-\item{repos}{character the base URL of the repository to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
+\item{repos}{character the base URL of the CRAN repository to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
 }
 \value{
 list with names proper for NAMESPACE file, the same as format as returned by \code{base::parseNamespaceFile}.

---FILE: man/pac_on.Rd---
@@ -0,0 +1,27 @@
+% Generated by roxygen2: do not edit by hand
+% Please edit documentation in R/onlast.R
+\name{pac_on}
+\alias{pac_on}
+\title{Checking if a packge is in repositories}
+\usage{
+pac_on(pac, repos = biocran_repos())
+}
+\arguments{
+\item{pac}{character a package name.}
+
+\item{repos}{character vector base URLs of the repositories to use. By default checking CRAN and Bioconductor. Default \code{pacs::biocran_repos()}}
+}
+\value{
+logical if a package is inside ropositories.
+}
+\description{
+using \code{utils::available.packages} to check if package is in repoitories.
+}
+\note{
+Results are cached for 1 hour with \code{memoise} package.
+}
+\examples{
+pac_on(""dplyr"")
+pac_on(""dplyr"", ""https://cran.rstudio.com/"" )
+pac_on(""dplyr"", biocran_repos()[grep(""Bio"", names(biocran_repos()))])
+}

---FILE: man/pac_validate.Rd---
@@ -24,7 +24,7 @@ pac_validate(
 
 \item{checkred}{list with two named fields, \code{scope} and \code{flavor}. \code{scope} of R CRAN check pages statuses to consider, any of \code{c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")}. \code{flavor} vector of machines to consider, which might be retrieved with \code{pacs::cran_flavors()$Flavor}. By default an empty scope field deactivated assessment for \code{checkred} column, and NULL flavor will results in checking all machines. Default \code{list(scope = character(0), flavor = NULL)}}
 
-\item{repos}{character the base URL of the repository to use. Default \code{pacs::biocran_repos()}}
+\item{repos}{character vector base URLs of the repositories to use. Default \code{pacs::biocran_repos()}}
 }
 \value{
 data.frame with 5/6/7 columns.

---FILE: tests/testthat/test-base.R---
@@ -124,9 +124,9 @@ if (is_online()) {
     expect_true(length(pac_description(""dplyr"", version = ""0.8.0"")) == 23)
     expect_true(utils::compareVersion(pac_description(""memoise"", local = TRUE)$Version,
                                       pac_description(""memoise"", local = FALSE)$Version) %in% c(0, 1))
-    expect_identical(suppressWarnings(pac_description(""dplyr"", ""1.1.1.1"")), list())
-    expect_identical(pac_description(""WRONG""), list())
-    expect_identical(suppressWarnings(pac_description(""dplyr"", ""0.0.0.1"")), list())
+    expect_identical(suppressWarnings(pac_description(""dplyr"", ""1.1.1.1"")), structure(list(), package = ""dplyr"", version = ""1.1.1.1""))
+    expect_identical(pac_description(""WRONG""), structure(list(), package = ""WRONG""))
+    expect_identical(suppressWarnings(pac_description(""dplyr"", ""0.0.0.1"")), structure(list(), package = ""dplyr"", version = ""0.0.0.1""))
   })
 
   test_that(""pacs::pac_last"", {
@@ -159,9 +159,9 @@ if (is_online()) {
     expect_true(length(pac_namespace(""classGraph"")) >= 0)
     expect_true(length(pac_namespace(""mi"")) >= 0)
     expect_identical(sort(pac_namespace(""memoise"", local = TRUE)$exports), sort(base::getNamespaceExports(""memoise"")))
-    expect_identical(suppressWarnings(pac_namespace(""dplyr"", ""1.1.1.1"")), list())
-    expect_identical(pac_namespace(""WRONG""), list())
-    expect_identical(suppressWarnings(pac_namespace(""dplyr"", ""0.0.0.1"")), list())
+    expect_identical(suppressWarnings(pac_namespace(""dplyr"", ""1.1.1.1"")), structure(list(), package = ""dplyr"", version = ""1.1.1.1""))
+    expect_identical(pac_namespace(""WRONG""), structure(list(), package = ""WRONG""))
+    expect_identical(suppressWarnings(pac_namespace(""dplyr"", ""0.0.0.1"")), structure(list(), package = ""dplyr"", version = ""0.0.0.1""))
   })
 
   checked <-  suppressWarnings(pacs::checked_packages())
@@ -181,7 +181,7 @@ if (is_online()) {
 
   test_that(""pacs::pac_checkpage"", {
     dplyr_checkpage <- pacs::pac_checkpage(""dplyr"")
-    expect_true(all(flavs$Flavor %in% dplyr_checkpage$Flavor))
+    expect_true(all(dplyr_checkpage$Flavor %in% flavs$Flavor))
     expect_true(nrow(dplyr_checkpage) > 0)
     expect_true(is.data.frame(dplyr_checkpage))
   })"
Polkas,pacs,c93f7eb35107b200ab45e1d53f5c2b7edf4b059c,Maciej Nasinski,nasinski.maciej@gmail.com,2021-08-13T11:35:21Z,Maciej Nasinski,nasinski.maciej@gmail.com,2021-08-14T16:52:41Z,"Bioconductor revolution

Bioconductor BiocManager repositories

NEWS and version

docs

fix

fix",DESCRIPTION;NAMESPACE;NEWS.md;R/check.R;R/comapre.R;R/deps.R;R/description.R;R/lifeduration.R;R/namespace.R;R/pacs.R;R/timemachine.R;R/utils.R;R/valid.R;README.md;man/available_packages.Rd;man/biocran_repos.Rd;man/lib_validate.Rd;man/pac_checkpage.Rd;man/pac_checkred.Rd;man/pac_compare_namespace.Rd;man/pac_compare_versions.Rd;man/pac_deps.Rd;man/pac_description.Rd;man/pac_health.Rd;man/pac_last.Rd;man/pac_lifeduration.Rd;man/pac_namespace.Rd;man/pac_timemachine.Rd;man/pac_validate.Rd;tests/testthat/test-base.R,False,True,True,False,214,117,331,"---FILE: DESCRIPTION---
@@ -1,6 +1,6 @@
 Package: pacs
 Title: Supplementary Tools for R Packages Developers
-Version: 0.3.2
+Version: 0.3.3
 Authors@R: 
     person(given = ""Maciej"",
            family = ""Nasinski"",
@@ -16,6 +16,7 @@ Description:
   Retrieving a DESCRIPTION or NAMESPACE file for any package version. 
   Comparing DESCRIPTION or NAMESPACE files between different package versions.
   Getting a list of all releases for a specific package.
+  The Bioconductor is partly supported.
 License: GPL (>= 3)
 URL: https://github.com/Polkas/pacs
 BugReports: https://github.com/Polkas/pacs/issues
@@ -31,4 +32,5 @@ Config/testthat/edition: 3
 Imports:
     memoise,
     stringi,
-    xml2
+    xml2,
+    BiocManager

---FILE: NAMESPACE---
@@ -1,5 +1,6 @@
 # Generated by roxygen2: do not edit by hand
 
+export(biocran_repos)
 export(checked_packages)
 export(compareVersionsMax)
 export(compareVersionsMin)
@@ -21,6 +22,8 @@ export(pac_timemachine)
 export(pac_true_size)
 export(pac_validate)
 export(pacs_base)
+importFrom(BiocManager,repositories)
+importFrom(BiocManager,version)
 importFrom(memoise,memoise)
 importFrom(stringi,stri_match_all)
 importFrom(stringi,stri_split_fixed)

---FILE: NEWS.md---
@@ -1,5 +1,7 @@
 # 0.3.3
 
+* `BiocManager` added to Imports, so all BioConductor repositories and its last release might be easily retrieved.
+* Default repositories now consists of not only CRAN as BioConductor is considered too.
 * Fix `lib_validate` as it not take into account statuses for not fully performed tests, it was case for less than 1% of all packages.
 * Add note that `checked_packages` could return duplicated observations which is expected.
 * Improve merge in `lib_validate` to show non-CRAN packages too.

---FILE: R/check.R---
@@ -21,17 +21,20 @@ read_checkpage <- memoise::memoise(read_checkpage_raw, cache = cachem::cache_mem
 #' Retrieving the package R CRAN check page
 #' @description Retrieving the R CRAN package check page.
 #' @param pac character a package name.
-#' @param repos character the base URL of the repository to use. Used only for the validation. Default `https://cran.rstudio.com/`
 #' @return data.frame.
 #' @note Results are cached for 1 hour with `memoise` package.
 #' If you need to check many packages at once then is recommended usage of `pacs::checked_packages`.
 #' Please as a courtesy to the R CRAN, don't overload their server by constantly using this function.
 #' @export
 #' @examples
 #' pac_checkpage(""dplyr"")
-pac_checkpage <- function(pac, repos = ""https://cran.rstudio.com/"") {
+pac_checkpage <- function(pac) {
   stopifnot((length(pac) == 1) && is.character(pac))
-  stopifnot(pac %in% rownames(available_packages(repos = repos)))
+
+  if (!pac %in% rownames(available_packages(repos = ""https://cran.rstudio.com/""))) {
+    return(NA)
+  }
+
   read_checkpage(pac)
 }
 
@@ -40,10 +43,10 @@ pac_checkpage <- function(pac, repos = ""https://cran.rstudio.com/"") {
 #' @param pac character a package name.
 #' @param scope character vector scope of the check, accepted values c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE""). Default c(""ERROR"", ""FAIL"")
 #' @param flavors character vector of CRAN machines to consider, which might be retrieved with `pacs::cran_flavors()$Flavor`. By default all CRAN machines are considered, NULL value. Default NULL
-#' @param repos character the base URL of the repository to use. Used only for the validation. Default `https://cran.rstudio.com/`
 #' @return logical if the package fail under specified criteria.
 #' @note Results are cached for 1 hour with `memoise` package.
 #' If you need to check many packages at once then is recommended usage of `pacs::checked_packages`.
+#' The used repository `https://cran.rstudio.com/`.
 #' Please as a courtesy to the R CRAN, don't overload their server by constantly using this function.
 #' @export
 #' @examples
@@ -53,15 +56,14 @@ pac_checkpage <- function(pac, repos = ""https://cran.rstudio.com/"") {
 #'              scope = c(""ERROR"", ""FAIL"", ""WARN""),
 #'              flavors = c(""r-devel-linux-x86_64-debian-clang"",
 #'              ""r-devel-linux-x86_64-debian-gcc""))
-pac_checkred <- function(pac, scope = c(""ERROR"", ""FAIL""), flavors = NULL, repos = ""https://cran.rstudio.com/"") {
+pac_checkred <- function(pac, scope = c(""ERROR"", ""FAIL""), flavors = NULL) {
   stopifnot(all(scope %in% c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")))
   stopifnot((length(pac) == 1) && is.character(pac))
-  stopifnot(is.character(repos))
   stopifnot(length(scope) == 0 || all(scope %in% c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")) &&
             is.null(flavors) || all(flavors %in% cran_flavors()$Flavor)
   )
 
-  if (!pac %in% rownames(available_packages(repos = repos))) {
+  if (!pac %in% rownames(available_packages(repos = ""https://cran.rstudio.com/""))) {
     return(NA)
   }
 

---FILE: R/comapre.R---
@@ -1,11 +1,11 @@
-#' Compare DESCRIPTION files dependencies between specific packages versions
+#' Compare DESCRIPTION files dependencies between specific CRAN packages versions
 #' @description using the remote github CRAN mirror to compare DESCRIPTION files dependencies between specific packages versions.
 #' @param pac character a package name.
 #' @param old character an old version of package, default local version. Default: NULL
 #' @param new character a new version of package, default newest version. Default: NULL
 #' @param fields character a vector with possible values `c(""Depends"", ""Imports"", ""LinkingTo"", ""Suggests"")`. Default: `c(""Depends"", ""Imports"", ""LinkingTo"")`
 #' @param lib.loc character. Default: NULL
-#' @param repos character the base URL of the repository to use. Used only for the validation. Default `https://cran.rstudio.com/`
+#' @param repos character the base URL of the repository to use. Default ""https://cran.rstudio.org""
 #' @return data.frame with 4 columns.
 #' \describe{
 #' \item{Package}{character package names.}
@@ -74,7 +74,7 @@ pac_compare_versions <- function(pac,
   res
 }
 
-#' Compare NAMESPACE exports between specific packages versions
+#' Compare NAMESPACE exports between specific CRAN packages versions
 #' @description using the remote github CRAN mirror to compare NAMESPACE exports between specific packages versions.
 #' @param pac character a package name.
 #' @param old character an old version of package.

---FILE: R/deps.R---
@@ -1,4 +1,4 @@
-#' Package dependencies
+#' package dependencies
 #' @description Package dependencies from DESCRIPTION files with installed or expected versions or newest released.
 #' @param pac character a package name.
 #' @param fields character vector with possible values `c(""Depends"", ""Imports"", ""LinkingTo"", ""Suggests"")`. Default: `c(""Depends"", ""Imports"", ""LinkingTo"")`

---FILE: R/description.R---
@@ -1,5 +1,5 @@
-#' Package DESCRIPTION file
-#' @description package DESCRIPTION file taken locally or remotely from GITHUB CRAN mirror or CRAN website.
+#' CRAN package DESCRIPTION file
+#' @description CRAN package DESCRIPTION file taken locally or remotely from GITHUB CRAN mirror or CRAN website.
 #' @param pac character a package name.
 #' @param version character package version. Default: NULL
 #' @param at Date. Default: NULL
@@ -34,7 +34,7 @@ pac_description <- function(pac,
     return(list())
   }
 
-  if (local && (is.null(version) || (!is.null(version) && isTRUE(utils::packageDescription(pac)$Version == version)))) {
+  if ((local || is_installed) && (is.null(version) || (!is.null(version) && isTRUE(utils::packageDescription(pac)$Version == version)))) {
     if (!is_installed) return(list())
     return(utils::packageDescription(pac, lib.loc))
   } else {

---FILE: R/lifeduration.R---
@@ -4,7 +4,7 @@
 #' @param version character version of package, by default the local version is taken if not available then the newest is assumed. Default: NULL
 #' @param at Date old version of package. Default: NULL
 #' @param lib.loc character vector. Is omitted for non NULL version. Default: NULL
-#' @param repos character the base URL of the repository to use. Used only for the validation. Default `https://cran.rstudio.com/`
+#' @param repos character the base URL of the repository to use. Default `biocran_repos()`
 #' @return `difftime`, number of days package version was the newest one.
 #' @note Function will scrap two CRAN URLS. Works only with CRAN packages.
 #' Please as a courtesy to the R CRAN, don't overload their server by constantly using this function.
@@ -20,19 +20,20 @@ pac_lifeduration <- function(pac,
                              version = NULL,
                              at = NULL,
                              lib.loc = NULL,
-                             repos = ""https://cran.rstudio.com/"") {
+                             repos = biocran_repos()) {
   stopifnot(length(pac) == 1 && is.character(pac))
   stopifnot(!all(c(!is.null(version), !is.null(at))))
   stopifnot(is.null(lib.loc) || all(lib.loc %in% .libPaths()))
   stopifnot(is.null(version) || (length(version) == 1 && is.character(version)))
 
-  if (!pac %in% rownames(available_packages(repos = repos))) {
+  is_installed <- isTRUE(pac %in% rownames(installed_packages(lib.loc = lib.loc)))
+
+  if (!pac %in% rownames(available_packages(repos = repos)) && !is_installed) {
     return(NA)
   } else {
     last_version <- pac_last(pac, repos = repos)
   }
 
-  is_installed <- isTRUE(pac %in% rownames(installed_packages(lib.loc = lib.loc)))
 
   if ((is.null(version) && is.null(at)) ||
     (!is.null(version) && isTRUE(utils::compareVersion(version, last_version) == 0))) {
@@ -41,40 +42,46 @@ pac_lifeduration <- function(pac,
     descr <- utils::packageDescription(pac, lib.loc = lib.loc)
     if (isTRUE(utils::compareVersion(descr[[""Version""]], last_version) == 0)) {
       base_date <- descr[[""Date/Publication""]]
-      isUTC <- grepl(""UTC"", base_date)
-      life <- Sys.Date() - as.Date(as.character(base_date))
+      if (is.null(base_date)) base_date <- descr[[""Date""]]
+      life <- Sys.Date() - as.Date(as.character(substr(base_date, 1, 10)))
       if (identical(life, structure(numeric(0), class = ""difftime"", units = ""days""))) life <- NA
       return(life)
     } else {
-      life <- Sys.Date() - as.Date(pac_description(pac,
+      life <- Sys.Date() - as.Date(substr(pac_description(pac,
                                                    version = descr[[""Version""]],
-                                                   lib.loc = lib.loc)[[""Date/Publication""]])
+                                                   lib.loc = lib.loc)[[""Date/Publication""]], 1, 10))
       if (identical(life, structure(numeric(0), class = ""difftime"", units = ""days""))) life <- NA
       return(life)
     }
     } else {
-      life <- Sys.Date() - as.Date(pac_description(pac,
+      life <- Sys.Date() - as.Date(substr(pac_description(pac,
                                                    version = last_version,
-                                                   lib.loc = lib.loc)[[""Date/Publication""]])
+                                                   lib.loc = lib.loc)[[""Date/Publication""]], 1, 10))
       return(life)
     }
   }
 
-  if (is.null(version) && !is.null(at)) {
-    pac_tm <- utils::tail(pac_timemachine(pac, at = at), 1)
-    pac_tm$LifeDuration
-  } else {
-    if (isTRUE(utils::compareVersion(version, last_version) == 1)) {
-      return(NA)
+  ison_cran <- is_cran(pac)
+
+  if (ison_cran) {
+    if (is.null(version) && !is.null(at)) {
+      pac_tm <- utils::tail(pac_timemachine(pac, at = at), 1)
+      pac_tm$LifeDuration
+    } else {
+      if (isTRUE(utils::compareVersion(version, last_version) == 1)) {
+        return(NA)
+      }
+      pac_tm <- pac_timemachine(pac)
+      if (isTRUE(all(vapply(pac_tm$Version, function(v) isFALSE(utils::compareVersion(v, version) == 0), logical(1))))) return(NA)
+      pac_tm <- pac_tm[vapply(pac_tm$Version, function(v) isTRUE(utils::compareVersion(v, version) == 0), logical(1)), ]
+      pac_tm$LifeDuration
     }
-    pac_tm <- pac_timemachine(pac)
-    if (isTRUE(all(vapply(pac_tm$Version, function(v) isFALSE(utils::compareVersion(v, version) == 0), logical(1))))) return(NA)
-    pac_tm <- pac_tm[vapply(pac_tm$Version, function(v) isTRUE(utils::compareVersion(v, version) == 0), logical(1)), ]
-    pac_tm$LifeDuration
+  } else{
+    NA
   }
 }
 
-#' Package health state at a specific Date or for a specific version
+#' CRAN package health state at a specific Date or for a specific version
 #' @description using CRAN website to get a package version/versions used at a specific Date interval.
 #' A healthy package was published for more than x days, where default is 14 days.
 #' CRAN team gives around one/two week to resolved a package which gave errors under the check page.
@@ -85,7 +92,7 @@ pac_lifeduration <- function(pac,
 #' @param scope character vector scope of R CRAN check pages statuses to consider, any of `c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")`. Default `c(""ERROR"", ""FAIL"")`
 #' @param flavors character vector of CRAN machines to consider, which might be retrieved with `pacs::cran_flavors()$Flavor`. By default all CRAN machines are considered, NULL value. Default NULL
 #' @param lib.loc character vector. Is omitted for non NULL version. Default: NULL
-#' @param repos character the base URL of the repository to use. Used only for the validation. Default `https://cran.rstudio.com/`
+#' @param repos character the base URL of the repository to use. Default ""https://cran.rstudio.org""
 #' @return logical if package is healthy.
 #' @note Function will scrap two/tree CRAN URLS. Works only with CRAN packages.
 #' The newest release are checked for warnings/errors on R CRAN check page.
@@ -134,7 +141,7 @@ pac_health <- function(pac,
   res <- isTRUE(life >= limit)
 
   if (is_last_release(pac, version, at)) {
-    if (isTRUE(pac_checkred(pac, scope = scope, flavors = flavors, repos = repos))) FALSE else res
+    if (isTRUE(pac_checkred(pac, scope = scope, flavors = flavors))) FALSE else res
   } else {
     res
   }

---FILE: R/namespace.R---
@@ -1,5 +1,5 @@
-#' Package NAMESPACE file
-#' @description package NAMESPACE file taken locally or remotely from GITHUB CRAN mirror or CRAN website.
+#' CRAN package NAMESPACE file
+#' @description CRAN package NAMESPACE file taken locally or remotely from GITHUB CRAN mirror or CRAN website.
 #' @param pac character a package name.
 #' @param version character package version. Default: NULL
 #' @param at Date. Default: NULL
@@ -31,7 +31,7 @@ pac_namespace <- function(pac, version = NULL, at = NULL, local = FALSE, lib.loc
     return(list())
   }
 
-  if (local && (is.null(version) || (!is.null(version) && isTRUE(utils::packageDescription(pac)$Version == version)))) {
+  if ((local || is_installed) && (is.null(version) || (!is.null(version) && isTRUE(utils::packageDescription(pac)$Version == version)))) {
     if (!is_installed) return(list())
     namespace_lines <- readLines(system.file(package = pac, ""NAMESPACE""), warn = FALSE)
   } else {

---FILE: R/pacs.R---
@@ -1,5 +1,6 @@
 #' @importFrom memoise memoise
 #' @importFrom stringi stri_match_all stri_split_fixed stri_split_regex stri_trim
 #' @importFrom xml2 xml_find_all read_html xml_text xml_attr
+#' @importFrom BiocManager version repositories
 #'
 NULL

---FILE: R/timemachine.R---
@@ -5,7 +5,6 @@
 #' @param from Date new version of package. Default: NULL
 #' @param version character version of package. Default: NULL
 #' @param to Date CRAN URL. Default: NULL
-#' @param repos character the base URL of the repository to use. Used only for the validation. Default `https://cran.rstudio.com/`
 #' @return data.frame with 7 columns
 #' \describe{
 #' \item{Package}{character package name.}
@@ -31,9 +30,8 @@ pac_timemachine <- function(pac,
                             at = NULL,
                             from = NULL,
                             to = NULL,
-                            version = NULL,
-                            repos = ""https://cran.rstudio.com/"") {
-  stopifnot(pac %in% rownames(available_packages(repos = repos)))
+                            version = NULL) {
+  stopifnot(pac %in% rownames(available_packages(repos = ""https://cran.rstudio.com/"")))
   stopifnot(is.null(version) || (length(version) == 1 && is.character(version)))
   stopifnot(xor(
     !is.null(at) && inherits(at, ""Date"") && is.null(version),

---FILE: R/utils.R---
@@ -154,7 +154,10 @@ installed_agg_fun_raw <- function(lib.loc = NULL, fields) {
 
 installed_agg_fun <- memoise::memoise(installed_agg_fun_raw, cache = cachem::cache_mem(max_age = 60*60))
 
-available_packages <- function(repos = ""https://cran.rstudio.com/"") {
+#' List Available Packages at CRAN-like Repositories
+#' @description available_packages returns a matrix of details corresponding to packages currently available at one or more repositories. The current list of packages is downloaded over the internet (or copied from a local mirror).
+#' @param repos character vector, the base URL(s) of the repositories to use. Default `pacs::biocran_repos()`
+available_packages <- function(repos = biocran_repos()) {
   available_packages_raw(repos = repos)
 }
 
@@ -181,49 +184,82 @@ extract_deps <- function(x) {
 }
 
 last_version_raw <- function(pac , repos) {
-  available_packages()[rownames(available_packages()) == pac, ""Version""]
+  which_p <- rownames(available_packages(repos = repos)) == pac
+  if (sum(which_p, na.rm = TRUE) > 0) {
+    available_packages(repos = repos)[which_p, ""Version""]
+  } else {
+    NA
+  }
 }
 
 last_version_fun <- memoise::memoise(last_version_raw, cache = cachem::cache_mem(max_age = 60*60))
 
 #' Getting the most recent package version
 #' @description using `utils::available.packages` to get the newest package version.
 #' @param pac character a package name.
-#' @param repos character the base URL of the repository to use. Default `https://cran.rstudio.com/`
+#' @param repos character the base URL of the repository to use. Default `pacs::biocran_repos()`
 #' @return character most recent package version.
 #' @note Results are cached for 1 hour with `memoise` package.
 #' @export
 #' @examples
 #' pac_last(""dplyr"")
-pac_last <- function(pac, repos = ""https://cran.rstudio.com/"") {
+pac_last <- function(pac, repos = biocran_repos()) {
   stopifnot((length(pac) == 1) && is.character(pac))
   stopifnot(is.character(repos))
 
-  if (!pac %in% rownames(available_packages(repos = repos))) {
+  if (isTRUE(!pac %in% rownames(available_packages(repos = repos)))) {
     return(NA)
   }
+
   last_version_fun(pac, repos = repos)
 }
 
-is_last_release <- function(pac, version = NULL, at = NULL, lib.loc = NULL, repos = ""https://cran.rstudio.com/"") {
+
+is_cran <- function(pac) {
+  stopifnot((length(pac) == 1) && is.character(pac))
+  if (isTRUE(!pac %in% rownames(available_packages(repos = ""https://cloud.r-project.org"")))) {
+    FALSE
+  } else {
+    TRUE
+  }
+}
+
+#' Simple wrapper around `BiocManager::repositories`
+#' @description Simple wrapper around `BiocManager::repositories`, suppress messages which are expected e.g. for RStudio users.
+#' @param ... optional `BiocManager::repositories` arguments.
+#' @return named character vector of repositories.
+#' @export
+#' @examples
+#' biocran_repos()
+#' biocran_repos(version = ""3.13"")
+biocran_repos <- function(...) {
+  suppressMessages(BiocManager::repositories(...))
+}
+
+is_last_release <- function(pac, version = NULL, at = NULL, lib.loc = NULL, repos = c(""https://bioconductor.org/packages/3.13/bioc"",
+                                                                                      ""https://bioconductor.org/packages/3.13/data/annotation"",
+                                                                                      ""https://bioconductor.org/packages/3.13/data/experiment"",
+                                                                                      ""https://bioconductor.org/packages/3.13/workflows"",
+                                                                                      ""https://bioconductor.org/packages/3.13/books"",
+                                                                                      ""https://cloud.r-project.org"")) {
   stopifnot(xor(!is.null(version), !is.null(at)) || (is.null(version) && is.null(at)))
 
   if (!pac %in% rownames(available_packages(repos = repos))) {
     return(NA)
   }
 
-  last_version <- available_packages()[rownames(available_packages(repos = repos)) == pac, ""Version""]
+  last_version <- pac_last(pac, repos = repos)
 
   is_installed <- isTRUE(pac %in% rownames(installed_packages(lib.loc = lib.loc)))
 
-  if (is.null(version) && is.null(at)) {
+  if (isTRUE(is.null(version) && is.null(at))) {
     if (is_installed) {
       version <- pac_description(pac, local = TRUE)$Version
     } else {
       return(FALSE)
     }
-  } else if (is.null(version) && !is.null(at)) {
-    version <- utils::tail(pac_timemachine(pac = pac, at = at, repos = repos), 1)$Version
+  } else if (isTRUE(is.null(version) && !is.null(at))) {
+    version <- utils::tail(pac_timemachine(pac = pac, at = at), 1)$Version
   }
 
   isTRUE(utils::compareVersion(last_version, version) == 0)

---FILE: R/valid.R---
@@ -7,21 +7,23 @@
 #' @param fields character vector with possible values `c(""Depends"", ""Imports"", ""LinkingTo"", ""Suggests"")`. Default: `c(""Depends"", ""Imports"", ""LinkingTo"")`
 #' @param lifeduration logical if to add life duration column, might take some time. Default: FALSE
 #' @param checkred list with two named fields, `scope` and `flavor`. `scope` of R CRAN check pages statuses to consider, any of `c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")`. `flavor` is a vector of CRAN machines to consider, which might be retrieved with `pacs::cran_flavors()$Flavor`. By default an empty scope field deactivated assessment for `checkred` column, and NULL flavor will results in checking all machines. Default `list(scope = character(0), flavor = NULL)`
-#' @param repos character the base URL of the repository to use. Used only for the validation. Default `https://cran.rstudio.com/`
-#' @return data.frame with 5/6/7 columns.
+#' @param repos character the base URL of the repository to use. Default `pacs::biocran_repos()`
+#' @return data.frame with 6/7/8 columns.
 #' \describe{
 #' \item{Package}{character a package name.}
 #' \item{Version.expected.min}{character expected by DESCRIPTION files minimal version. """" means not specified so the newest version.}
 #' \item{Version.have}{character installed package version.}
 #' \item{version_status}{ numeric -1/0/1 which comes from `utils::compareVersion` function.
 #' 0 means that we have the same version as required by DESCRIPTION files. -1 means we have too low version installed, this is an error. 1 means we have higher version.}
 #' \item{newest}{logical if the installed version is the newest one.}
+#' \item{cran}{logical if the package is on CRAN, version is not taken into accout here.}
 #' \item{checkred}{(Optional) logical if the NEWEST package contains any specified statuses on CRAN check page. `pacs::checked_packages` is used to quickly retrieve all statuses at once.}
 #' \item{lifeduration}{(Optional) integer number of days a package was released.}
 #' }
 #' @note Version.expected.min column not count packages which are not a dependency for any package, so could not be find in DESCRIPTION files.
 #' When turn on the `lifeduration` options, calculations might be time consuming.
 #' Results are cached for 1 hour with `memoise` package.
+#' `BioConductor` packages are tested only in available scope, `checkred` is not assessed for them.
 #' @export
 #' @examples
 #' \dontrun{
@@ -37,7 +39,7 @@ lib_validate <- function(lib.loc = NULL,
                          fields = c(""Depends"", ""Imports"", ""LinkingTo""),
                          lifeduration = FALSE,
                          checkred = list(scope = character(0), flavors = NULL),
-                         repos = ""https://cran.rstudio.com/"") {
+                         repos = biocran_repos()) {
   stopifnot(is.null(lib.loc) || all(lib.loc %in% .libPaths()))
   stopifnot(all(fields %in% c(""Depends"", ""Imports"", ""Suggests"", ""LinkingTo"")))
   stopifnot(is.logical(lifeduration))
@@ -84,14 +86,30 @@ lib_validate <- function(lib.loc = NULL,
                   sort = FALSE,
                   all.x = TRUE)
 
+  cran_df <- merge(installed_agg[, c(""Package"", ""Version"")],
+                    available_packages(repos = ""https://cloud.r-project.org"")[, c(""Package"", ""Version"")],
+                     by = ""Package"",
+                     all.x = TRUE,
+                     sort = FALSE
+  )
+
+  cran_df$cran <- !is.na(cran_df$Version.y)
+  cran_df$cran[is.na(cran_df$cran)] <- FALSE
+
+  result <- merge(result,
+                  cran_df[, c(""Package"", ""cran"")],
+                  by = ""Package"",
+                  sort = FALSE,
+                  all.x = TRUE)
+
   if (length(checkred$scope)) {
     checkred_all <- checked_packages()
     flavors <- if (is.null(checkred$flavors)) grep(""r-"", colnames(checkred_all)) else checkred$flavors
     scope_final <- c(checkred$scope, paste0(checkred$scope, ""*""))
     checkred_all$red_status <- apply(checkred_all[, flavors, drop = FALSE], 1, function(x) any(x %in% scope_final))
     checkred_names_scope <- checkred_all$Package[checkred_all$red_status]
     result$checkred <- (result$Package %in% checkred_names_scope) & result$newest
-    result$checkred[is.na(result$newest)] <- NA
+    result$checkred[is.na(result$newest) | !result$cran] <- NA
   }
 
   if (lifeduration) {
@@ -112,7 +130,7 @@ lib_validate <- function(lib.loc = NULL,
 #' @param fields character vector with possible values `c(""Depends"", ""Imports"", ""LinkingTo"", ""Suggests"")`. Default: `c(""Depends"", ""Imports"", ""LinkingTo"")`
 #' @param lifeduration logical if to add life duration column, might take some time. Default: FALSE
 #' @param checkred list with two named fields, `scope` and `flavor`. `scope` of R CRAN check pages statuses to consider, any of `c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")`. `flavor` vector of machines to consider, which might be retrieved with `pacs::cran_flavors()$Flavor`. By default an empty scope field deactivated assessment for `checkred` column, and NULL flavor will results in checking all machines. Default `list(scope = character(0), flavor = NULL)`
-#' @param repos character the base URL of the repository to use. Used only for the validation. Default `https://cran.rstudio.com/`
+#' @param repos character the base URL of the repository to use. Default `pacs::biocran_repos()`
 #' @return data.frame with 5/6/7 columns.
 #' \describe{
 #' \item{Package}{character a package name.}
@@ -121,6 +139,7 @@ lib_validate <- function(lib.loc = NULL,
 #' \item{version_status}{ numeric -1/0/1 which comes from `utils::compareVersion` function.
 #' 0 means that we have the same version as required by DESCRIPTION files. -1 means we have too low version installed, this is an error. 1 means we have higher version.}
 #' \item{newest}{ logical if the installed version is the newest one.}
+#' \item{cran}{logical if the package is on CRAN, version is not taken into accout here.}
 #' \item{checkred}{(Optional) logical if the NEWEST package contains any specified statuses on CRAN check page.}
 #' \item{lifeduration}{(Optional) integer number of days a package was released.}
 #' }
@@ -141,7 +160,7 @@ pac_validate <- function(pac,
                          fields = c(""Depends"", ""Imports"", ""LinkingTo""),
                          lifeduration = FALSE,
                          checkred = list(scope = character(0), flavors = NULL),
-                         repos = ""https://cran.rstudio.com/"") {
+                         repos = biocran_repos()) {
   stopifnot(is.null(lib.loc) || all(lib.loc %in% .libPaths()))
   stopifnot(all(fields %in% c(""Depends"", ""Imports"", ""Suggests"", ""LinkingTo"")))
   stopifnot((length(pac) == 1) && is.character(pac))
@@ -163,19 +182,22 @@ pac_validate <- function(pac,
     suffix = c("".expected.min"", "".have"")
   )
 
+  if (nrow(result)) {
   result$version_status <- apply(result, 1, function(x) utils::compareVersion(x[""Version.have""], x[""Version.expected.min""]))
 
   result <- result[!is.na(result$Package) & !(result$Package %in% c(""NA"", pacs_base())), ]
 
-  result$newest <- apply(result, 1, function(x) is_last_release(x[""Package""], x[""Version.have""]))
+  result$newest <- apply(result, 1, function(x) isTRUE(pac_last(x[""Package""]) == x[""Version.have""]))
+
+  result$cran <- apply(result, 1, function(x) isTRUE(is_cran(x[""Package""])))
 
   if (length(checkred$scope)) {
-    result$checkred <- vapply(seq_len(nrow(result)), function(x) isTRUE(result$newest[x] && pac_checkred(result$Package[x], scope = checkred$scope, flavors = checkred$flavors, repos = repos)), logical(1))
+    result$checkred <- vapply(seq_len(nrow(result)), function(x) isTRUE(result$newest[x] && result$cran[x] && pac_checkred(result$Package[x], scope = checkred$scope, flavors = checkred$flavors)), logical(1))
   }
 
   if (lifeduration) {
     result$lifeduration <- vapply(seq_len(nrow(result)), function(x) pac_lifeduration(result[x, ""Package"", drop = TRUE], as.character(result[x, ""Version.have"", drop = TRUE]), repos = repos, lib.loc = lib.loc), numeric(1))
   }
-
+  }
   result
 }

---FILE: README.md---
@@ -13,28 +13,30 @@
 - Retrieving a DESCRIPTION or NAMESPACE file for any package version.
 - Comparing DESCRIPTION or NAMESPACE files between different package versions.
 - Getting a list of all releases for a specific package.
+- The Bioconductor is partly supported.
 
 | Function                            | Description                                                 | 
 |:------------------------------------|:-----------------------------------------------|
 |`lib_validate`                       | Validate the local library          |
 |`pac_validate`             | Validate a specific local package              |
-|`pac_deps`               |  Package dependencies with installed or expected versions |
-|`pac_deps_timemachine`|  Package dependencies for certain version or time point|
-|`pac_description` | Package DESCRIPTION file at Date or for a certain version      |
-|`pac_namespace` | Package NAMESPACE file at Date or for a certain version      |
+|`pac_deps`               |  CRAN package dependencies with installed or expected versions |
+|`pac_deps_timemachine`|  CRAN package dependencies for certain version or time point|
+|`pac_description` | CRAN package DESCRIPTION file at Date or for a certain version      |
+|`pac_namespace` | CRAN package NAMESPACE file at Date or for a certain version      |
 |`pac_lifeduration` | Package version life duration  |
-|`pac_health`           | Package version health    |
+|`pac_health`           | CRAN package version health    |
 |`pac_size`             | Size of the package                                       | 
-|`pac_timemachine` | Package versions at a specific Date or a Date interval   |
-|`pac_compare_versions`               | Compare dependencies between different versions of a package          |
-|`pac_compare_namespace`               | Compare NAMESPACE fields between different versions of a package  |
+|`pac_timemachine` | CRAN package versions at a specific Date or a Date interval   |
+|`pac_compare_versions`               | Compare dependencies between different versions of a CRAN package          |
+|`pac_compare_namespace`               | Compare NAMESPACE fields between different versions of a CRAN package  |
 |`pac_true_size`                      | True size of the package (with dependencies)| 
 |`pacs_base`                          | R base packages                               |
-|`pac_last`|  The most recent package version|
+|`pac_last`|The most recent package version|
 |`pac_checkred` | Checking the R CRAN package check page status for any errors and warnings|
 |`checked_packages`| Downloading all R CRAN packages check page statuses|
 |`pac_checkpage` |   Retrieving the package R CRAN check page|
 |`cran_flavors`|  Retrieving all R CRAN servers flavors|
+|`biocran_repos()`| Display current Bioconductor and CRAN repositories|
 
 **Hint1**: `Version` variable is mostly a minimal required i.e. max(version1, version2 , ...)
 

---FILE: man/available_packages.Rd---
@@ -0,0 +1,14 @@
+% Generated by roxygen2: do not edit by hand
+% Please edit documentation in R/utils.R
+\name{available_packages}
+\alias{available_packages}
+\title{List Available Packages at CRAN-like Repositories}
+\usage{
+available_packages(repos = biocran_repos())
+}
+\arguments{
+\item{repos}{character vector, the base URL(s) of the repositories to use. Default \code{pacs::biocran_repos()}}
+}
+\description{
+available_packages returns a matrix of details corresponding to packages currently available at one or more repositories. The current list of packages is downloaded over the internet (or copied from a local mirror).
+}

---FILE: man/biocran_repos.Rd---
@@ -0,0 +1,21 @@
+% Generated by roxygen2: do not edit by hand
+% Please edit documentation in R/utils.R
+\name{biocran_repos}
+\alias{biocran_repos}
+\title{Simple wrapper around \code{BiocManager::repositories}}
+\usage{
+biocran_repos(...)
+}
+\arguments{
+\item{...}{optional \code{BiocManager::repositories} arguments.}
+}
+\value{
+named character vector of repositories.
+}
+\description{
+Simple wrapper around \code{BiocManager::repositories}, suppress messages which are expected e.g. for RStudio users.
+}
+\examples{
+biocran_repos()
+biocran_repos(version = ""3.13"")
+}

---FILE: man/lib_validate.Rd---
@@ -9,7 +9,7 @@ lib_validate(
   fields = c(""Depends"", ""Imports"", ""LinkingTo""),
   lifeduration = FALSE,
   checkred = list(scope = character(0), flavors = NULL),
-  repos = ""https://cran.rstudio.com/""
+  repos = biocran_repos()
 )
 }
 \arguments{
@@ -21,17 +21,18 @@ lib_validate(
 
 \item{checkred}{list with two named fields, \code{scope} and \code{flavor}. \code{scope} of R CRAN check pages statuses to consider, any of \code{c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")}. \code{flavor} is a vector of CRAN machines to consider, which might be retrieved with \code{pacs::cran_flavors()$Flavor}. By default an empty scope field deactivated assessment for \code{checkred} column, and NULL flavor will results in checking all machines. Default \code{list(scope = character(0), flavor = NULL)}}
 
-\item{repos}{character the base URL of the repository to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
+\item{repos}{character the base URL of the repository to use. Default \code{pacs::biocran_repos()}}
 }
 \value{
-data.frame with 5/6/7 columns.
+data.frame with 6/7/8 columns.
 \describe{
 \item{Package}{character a package name.}
 \item{Version.expected.min}{character expected by DESCRIPTION files minimal version. """" means not specified so the newest version.}
 \item{Version.have}{character installed package version.}
 \item{version_status}{ numeric -1/0/1 which comes from \code{utils::compareVersion} function.
 0 means that we have the same version as required by DESCRIPTION files. -1 means we have too low version installed, this is an error. 1 means we have higher version.}
 \item{newest}{logical if the installed version is the newest one.}
+\item{cran}{logical if the package is on CRAN, version is not taken into accout here.}
 \item{checkred}{(Optional) logical if the NEWEST package contains any specified statuses on CRAN check page. \code{pacs::checked_packages} is used to quickly retrieve all statuses at once.}
 \item{lifeduration}{(Optional) integer number of days a package was released.}
 }
@@ -45,6 +46,7 @@ Optionally we could add life duration and CRAN check page status for each packag
 Version.expected.min column not count packages which are not a dependency for any package, so could not be find in DESCRIPTION files.
 When turn on the \code{lifeduration} options, calculations might be time consuming.
 Results are cached for 1 hour with \code{memoise} package.
+\code{BioConductor} packages are tested only in available scope, \code{checkred} is not assessed for them.
 }
 \examples{
 \dontrun{

---FILE: man/pac_checkpage.Rd---
@@ -4,12 +4,10 @@
 \alias{pac_checkpage}
 \title{Retrieving the package R CRAN check page}
 \usage{
-pac_checkpage(pac, repos = ""https://cran.rstudio.com/"")
+pac_checkpage(pac)
 }
 \arguments{
 \item{pac}{character a package name.}
-
-\item{repos}{character the base URL of the repository to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
 }
 \value{
 data.frame.

---FILE: man/pac_checkred.Rd---
@@ -4,21 +4,14 @@
 \alias{pac_checkred}
 \title{Checking the package R CRAN check page status}
 \usage{
-pac_checkred(
-  pac,
-  scope = c(""ERROR"", ""FAIL""),
-  flavors = NULL,
-  repos = ""https://cran.rstudio.com/""
-)
+pac_checkred(pac, scope = c(""ERROR"", ""FAIL""), flavors = NULL)
 }
 \arguments{
 \item{pac}{character a package name.}
 
 \item{scope}{character vector scope of the check, accepted values c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE""). Default c(""ERROR"", ""FAIL"")}
 
 \item{flavors}{character vector of CRAN machines to consider, which might be retrieved with \code{pacs::cran_flavors()$Flavor}. By default all CRAN machines are considered, NULL value. Default NULL}
-
-\item{repos}{character the base URL of the repository to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
 }
 \value{
 logical if the package fail under specified criteria.
@@ -29,6 +22,7 @@ using package R CRAN check page to validate if there are ANY errors and/or fails
 \note{
 Results are cached for 1 hour with \code{memoise} package.
 If you need to check many packages at once then is recommended usage of \code{pacs::checked_packages}.
+The used repository \verb{https://cran.rstudio.com/}.
 Please as a courtesy to the R CRAN, don't overload their server by constantly using this function.
 }
 \examples{

---FILE: man/pac_compare_namespace.Rd---
@@ -2,7 +2,7 @@
 % Please edit documentation in R/comapre.R
 \name{pac_compare_namespace}
 \alias{pac_compare_namespace}
-\title{Compare NAMESPACE exports between specific packages versions}
+\title{Compare NAMESPACE exports between specific CRAN packages versions}
 \usage{
 pac_compare_namespace(
   pac,

---FILE: man/pac_compare_versions.Rd---
@@ -2,7 +2,7 @@
 % Please edit documentation in R/comapre.R
 \name{pac_compare_versions}
 \alias{pac_compare_versions}
-\title{Compare DESCRIPTION files dependencies between specific packages versions}
+\title{Compare DESCRIPTION files dependencies between specific CRAN packages versions}
 \usage{
 pac_compare_versions(
   pac,
@@ -24,7 +24,7 @@ pac_compare_versions(
 
 \item{lib.loc}{character. Default: NULL}
 
-\item{repos}{character the base URL of the repository to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
+\item{repos}{character the base URL of the repository to use. Default ""https://cran.rstudio.org""}
 }
 \value{
 data.frame with 4 columns.

---FILE: man/pac_deps.Rd---
@@ -2,7 +2,7 @@
 % Please edit documentation in R/deps.R
 \name{pac_deps}
 \alias{pac_deps}
-\title{Package dependencies}
+\title{package dependencies}
 \usage{
 pac_deps(
   pac,

---FILE: man/pac_description.Rd---
@@ -2,7 +2,7 @@
 % Please edit documentation in R/description.R
 \name{pac_description}
 \alias{pac_description}
-\title{Package DESCRIPTION file}
+\title{CRAN package DESCRIPTION file}
 \usage{
 pac_description(
   pac,
@@ -30,7 +30,7 @@ pac_description(
 list with names proper for DESCRIPTION file fields.
 }
 \description{
-package DESCRIPTION file taken locally or remotely from GITHUB CRAN mirror or CRAN website.
+CRAN package DESCRIPTION file taken locally or remotely from GITHUB CRAN mirror or CRAN website.
 }
 \note{
 Results are cached for 1 hour with \code{memoise} package.

---FILE: man/pac_health.Rd---
@@ -2,7 +2,7 @@
 % Please edit documentation in R/lifeduration.R
 \name{pac_health}
 \alias{pac_health}
-\title{Package health state at a specific Date or for a specific version}
+\title{CRAN package health state at a specific Date or for a specific version}
 \usage{
 pac_health(
   pac,
@@ -30,7 +30,7 @@ pac_health(
 
 \item{lib.loc}{character vector. Is omitted for non NULL version. Default: NULL}
 
-\item{repos}{character the base URL of the repository to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
+\item{repos}{character the base URL of the repository to use. Default ""https://cran.rstudio.org""}
 }
 \value{
 logical if package is healthy.

---FILE: man/pac_last.Rd---
@@ -4,12 +4,12 @@
 \alias{pac_last}
 \title{Getting the most recent package version}
 \usage{
-pac_last(pac, repos = ""https://cran.rstudio.com/"")
+pac_last(pac, repos = biocran_repos())
 }
 \arguments{
 \item{pac}{character a package name.}
 
-\item{repos}{character the base URL of the repository to use. Default \verb{https://cran.rstudio.com/}}
+\item{repos}{character the base URL of the repository to use. Default \code{pacs::biocran_repos()}}
 }
 \value{
 character most recent package version.

---FILE: man/pac_lifeduration.Rd---
@@ -9,7 +9,7 @@ pac_lifeduration(
   version = NULL,
   at = NULL,
   lib.loc = NULL,
-  repos = ""https://cran.rstudio.com/""
+  repos = biocran_repos()
 )
 }
 \arguments{
@@ -21,7 +21,7 @@ pac_lifeduration(
 
 \item{lib.loc}{character vector. Is omitted for non NULL version. Default: NULL}
 
-\item{repos}{character the base URL of the repository to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
+\item{repos}{character the base URL of the repository to use. Default \code{biocran_repos()}}
 }
 \value{
 \code{difftime}, number of days package version was the newest one.

---FILE: man/pac_namespace.Rd---
@@ -2,7 +2,7 @@
 % Please edit documentation in R/namespace.R
 \name{pac_namespace}
 \alias{pac_namespace}
-\title{Package NAMESPACE file}
+\title{CRAN package NAMESPACE file}
 \usage{
 pac_namespace(
   pac,
@@ -30,7 +30,7 @@ pac_namespace(
 list with names proper for NAMESPACE file, the same as format as returned by \code{base::parseNamespaceFile}.
 }
 \description{
-package NAMESPACE file taken locally or remotely from GITHUB CRAN mirror or CRAN website.
+CRAN package NAMESPACE file taken locally or remotely from GITHUB CRAN mirror or CRAN website.
 }
 \note{
 Results are cached for 1 hour with \code{memoise} package.

---FILE: man/pac_timemachine.Rd---
@@ -4,14 +4,7 @@
 \alias{pac_timemachine}
 \title{Package version at a specific Date or a Date interval}
 \usage{
-pac_timemachine(
-  pac,
-  at = NULL,
-  from = NULL,
-  to = NULL,
-  version = NULL,
-  repos = ""https://cran.rstudio.com/""
-)
+pac_timemachine(pac, at = NULL, from = NULL, to = NULL, version = NULL)
 }
 \arguments{
 \item{pac}{character a package name.}
@@ -23,8 +16,6 @@ pac_timemachine(
 \item{to}{Date CRAN URL. Default: NULL}
 
 \item{version}{character version of package. Default: NULL}
-
-\item{repos}{character the base URL of the repository to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
 }
 \value{
 data.frame with 7 columns

---FILE: man/pac_validate.Rd---
@@ -10,7 +10,7 @@ pac_validate(
   fields = c(""Depends"", ""Imports"", ""LinkingTo""),
   lifeduration = FALSE,
   checkred = list(scope = character(0), flavors = NULL),
-  repos = ""https://cran.rstudio.com/""
+  repos = biocran_repos()
 )
 }
 \arguments{
@@ -24,7 +24,7 @@ pac_validate(
 
 \item{checkred}{list with two named fields, \code{scope} and \code{flavor}. \code{scope} of R CRAN check pages statuses to consider, any of \code{c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")}. \code{flavor} vector of machines to consider, which might be retrieved with \code{pacs::cran_flavors()$Flavor}. By default an empty scope field deactivated assessment for \code{checkred} column, and NULL flavor will results in checking all machines. Default \code{list(scope = character(0), flavor = NULL)}}
 
-\item{repos}{character the base URL of the repository to use. Used only for the validation. Default \verb{https://cran.rstudio.com/}}
+\item{repos}{character the base URL of the repository to use. Default \code{pacs::biocran_repos()}}
 }
 \value{
 data.frame with 5/6/7 columns.
@@ -35,6 +35,7 @@ data.frame with 5/6/7 columns.
 \item{version_status}{ numeric -1/0/1 which comes from \code{utils::compareVersion} function.
 0 means that we have the same version as required by DESCRIPTION files. -1 means we have too low version installed, this is an error. 1 means we have higher version.}
 \item{newest}{ logical if the installed version is the newest one.}
+\item{cran}{logical if the package is on CRAN, version is not taken into accout here.}
 \item{checkred}{(Optional) logical if the NEWEST package contains any specified statuses on CRAN check page.}
 \item{lifeduration}{(Optional) integer number of days a package was released.}
 }

---FILE: tests/testthat/test-base.R---
@@ -74,7 +74,8 @@ if (is_online()) {
   })
 
   test_that(""pacs::lib_validate"", {
-    expect_identical(sort(rownames(installed_packages())), sort(setdiff(c(lib_validate()$Package, pacs_base()), ""R"")))
+    expect_identical(sort(unique(rownames(installed_packages()))),
+                     sort(unique(setdiff(c(lib_validate()$Package, pacs_base()), ""R""))))
     expect_error(lib_validate(lib.loc = ""wrong""))
     lib_res <- lib_validate()
     expect_true(inherits(lib_res, ""data.frame""))
@@ -130,7 +131,7 @@ if (is_online()) {
 
   test_that(""pacs::pac_last"", {
     expect_identical(
-    unname(available.packages(repos = ""https://cran.rstudio.com/"", filters = list(
+    unname(utils::available.packages(repos = ""https://cran.rstudio.com/"", filters = list(
       function(db) db[db[,""Package""] == ""dplyr"", ]
     ))[""Version""]),
     pac_last(""dplyr"", repos = ""https://cran.rstudio.com/"")
@@ -163,7 +164,7 @@ if (is_online()) {
     expect_identical(suppressWarnings(pac_namespace(""dplyr"", ""0.0.0.1"")), list())
   })
 
-  checked <- pacs::checked_packages()
+  checked <-  suppressWarnings(pacs::checked_packages())
 
   test_that(""pacs::checked_packages"", {
     expect_true(is.data.frame(checked))"
Polkas,pacs,49fc9f57190817a12e2348d607c6718a67527020,Maciej Nasinski,nasinski.maciej@gmail.com,2021-08-09T22:51:54Z,Maciej Nasinski,nasinski.maciej@gmail.com,2021-08-14T16:51:15Z,last fixes,NEWS.md;R/valid.R;README.md;tests/testthat/test-base.R,False,True,True,False,46,27,73,"---FILE: NEWS.md---
@@ -5,6 +5,7 @@
 * Additional tests, maintain coverage over 80%.
 * Additional input validation.
 * Added `xml2` to imports.
+* Update `README` file.
 
 # 0.3.0
 

---FILE: R/valid.R---
@@ -78,8 +78,8 @@ lib_validate <- function(lib.loc = NULL,
   if (length(checkred$scope)) {
     checkred_all <- checked_packages()
     flavors <- if (is.null(checkred$flavors)) grep(""r-"", colnames(checkred_all)) else checkred$flavors
-    checkred_all$unique_status <- apply(checkred_all[, flavors], 1, function(x) paste0(sort(unique(x)), collapse = "", ""))
-    checkred_names_scope <- checkred_all$Package[grepl(sprintf(""(?:%s)"", paste(checkred$scope, collapse = ""|"")), checkred_all$unique_status)]
+    checkred_all$red_status <- apply(checkred_all[, flavors, drop = FALSE], 1, function(x) any(x %in% checkred$scope))
+    checkred_names_scope <- checkred_all$Package[checkred_all$red_status]
     result$checkred <- (result$Package %in% checkred_names_scope) & result$newest
   }
 

---FILE: README.md---
@@ -38,12 +38,19 @@
 
 **Hint1**: `Version` variable is mostly a minimal required i.e. max(version1, version2 , ...)
 
-**Hint2**: When working with many packages it is recommended to use global functions, which retrieving data for many packages at once. An example will be usage of `pacs::checked_packages()` over `pacs::pac_checkpage` (or `pacs::pac_checkred`). Another example will be usage of `utils::available.packages()` over `pacs::pac_last`.
+**Hint2**: When working with many packages it is recommended to use global functions, which retrieving data for many packages at once. An example will be usage of `pacs::checked_packages()` over `pacs::pac_checkpage` (or `pacs::pac_checkred`). Another example will be usage of `utils::available.packages` over `pacs::pac_last`. Finally most important one will be `pacs::lib_validate` over `pacs::pac_validate` and `pacs::pac_checkred` and others.
 
 **Hint3**: Almost all time consuming calculations are cached (for 1 hour) with `memoise::memoise` package, second invoke of the same call is instantaneous.
 
 **Hint4**: Use `parallel::mclapply` (Linux and Mac) or `parallel::parLapply` (Windows, Linux and Mac) to speed up loop calculations. Nevertheless under `parallel::mclapply` computation results are NOT cached with `memoise` package. Warning: Parallel computations might be unstable.
 
+## Installation
+
+```r
+# install.packages(""remotes"")
+remotes::install_github(""polkas/pacs"")
+```
+
 ## Validate the library
 
 This procedure will be crucial for R developers as clearly showing the possible broken packages inside the local library. Thus we could assess which packages require versions update.
@@ -69,7 +76,7 @@ pacs::lib_validate(lifeduration = TRUE,
                    checkred = list(scope = c(""ERROR"", ""FAIL"")))
 ```
 
-Not only scope for check pages could be updated, any of `c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")`. We could specify `flavors` field inside list consumed by the `checkred` argument and narrow the tested machines. The full list of CRAN servers (flavors) might be get with `pacs::cran_flavors()$Flavor`.
+Not only `scope` field inside `checkred` list could be updated, to remind any of `c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")`. We could specify `flavors` field inside the  `checkred` list argument and narrow the tested machines. The full list of CRAN servers (flavors) might be get with `pacs::cran_flavors()$Flavor`.
 
 ```r
 pacs::lib_validate(checkred = list(scope = c(""ERROR"", ""FAIL""), 
@@ -79,25 +86,24 @@ pacs::lib_validate(checkred = list(scope = c(""ERROR"", ""FAIL""),
 ## R CRAN packages check page statuses
 
 `checked_packages` was built to extend the `.packages` family functions, like `utils::installed.packages()` and `utils::available.packages()`. 
-`pacs::checked_packages` retrieves all current packages checks from CRAN, from `https://cran.r-project.org/web/checks/check_summary_by_package.html`.
+`pacs::checked_packages` retrieves all current packages checks from [CRAN webpage](https://cran.r-project.org/web/checks/check_summary_by_package.html).
 
 ```r
 pacs::checked_packages()
 ```
 
-Use `pacs::pac_checkpage(""dplyr"")` to get per package check page. However `pacs::checked_packages()` will be more efficient for many packages. Remember that `pacs::checked_packages()` result are cached after the first invoke.
+Use `pacs::pac_checkpage(""dplyr"")` to get per package check page. However `pacs::checked_packages()` will be more efficient for many packages. Remember that `pacs::checked_packages()` result is cached after the first invoke.
 
 ## Time machine - Package version at Date or specific Date interval
 
-Using R CRAN website to get packages version/versions used at a specific Date or a Date interval.  
-Please as a courtesy to the R CRAN, don't overload their server by constantly using these functions.
+Using R CRAN website to get packages version/versions used at a specific Date or a Date interval.
 
 ```r
-pac_timemachine(""dplyr"")
-pac_timemachine(""dplyr"", version = ""0.8.0"")
-pac_timemachine(""dplyr"", at = as.Date(""2017-02-02""))
-pac_timemachine(""dplyr"", from = as.Date(""2017-02-02""), to = as.Date(""2018-04-02""))
-pac_timemachine(""dplyr"", at = Sys.Date())
+pacs::pac_timemachine(""dplyr"")
+pacs::pac_timemachine(""dplyr"", version = ""0.8.0"")
+pacs::pac_timemachine(""dplyr"", at = as.Date(""2017-02-02""))
+pacs::pac_timemachine(""dplyr"", from = as.Date(""2017-02-02""), to = as.Date(""2018-04-02""))
+pacs::pac_timemachine(""dplyr"", at = Sys.Date())
 ```
 
 ## Package health
@@ -108,19 +114,21 @@ If not then we might assume something wrong was with it, as had to be quickly up
 e.g. `dplyr` under the ""0.8.0"" version seems to be a broken release, we could find out that it was published only for 1 day.
 
 ```r
-pac_lifeduration(""dplyr"", ""0.8.0"")
+pacs::pac_lifeduration(""dplyr"", ""0.8.0"")
 ```
 
-With 14 day limit we get a proper health status. We are sure about this state as this is not the newest release. For newest packages (released less than 14 days ago) we are checking if there are any red messages on CRAN check pages.
+With 14 day limit we get a proper health status. We are sure about this state as this is not the newest release. For newest packages we are checking if there are any red messages on CRAN check pages too, specify with a `scope` argument.
 
 ```r
-pac_health(""dplyr"", version = ""0.8.0"", limit = 14)
+pacs::pac_health(""dplyr"", version = ""0.8.0"", limit = 14)
 ```
 
 For the newest package we will check the CRAN check page too, the scope might be adjusted.
 
 ```r
-pac_health(""dplyr"", limit = 14, scope = c(""ERROR"", ""FAIL""))
+pacs::pac_health(""dplyr"", limit = 14, scope = c(""ERROR"", ""FAIL"", ""WARN""))
+pacs::pac_health(""dplyr"", limit = 14, scope = c(""ERROR"", ""FAIL"", ""WARN""), 
+                 flavors = pacs::cran_flavors()$Flavor[1])
 ```
 
 ## Package DESCRIPTION file
@@ -159,18 +167,9 @@ pacs::pac_deps_timemachine(""dplyr"", version = ""0.8.1"")
 
 ## Package dependencies and differences between versions
 
-The crucial functionality is to get versions for all package dependencies. 
+One of the main functionality is to get versions for all package dependencies. 
 Versions might come form installed packages or DESCRIPTION files.
 
-Useful functions to get list of base packages. 
-You might want to exclude them from final results.
-
-```r
-pacs::pacs_base()
-# start up loaded, base packages
-pacs::pacs_base(startup = TRUE)
-```
-
 `pac_deps` for an extremely fast retrieving of package dependencies, 
 packages versions might come from installed ones or from DESCRIPTION files (required minimum).
 
@@ -201,6 +200,17 @@ Raw dependencies from DESCRIPTION file
 pacs::pac_deps(""memoise"", description_v = TRUE, recursive = FALSE)
 ```
 
+Useful functions to get list of base packages. 
+You might want to exclude them from final results.
+
+```r
+pacs::pacs_base()
+# start up loaded, base packages
+pacs::pacs_base(startup = TRUE)
+```
+
+## Comparing DESCRIPTION or NAMESPACE files between different package versions
+
 Comparing DESCRIPTION file dependencies between local and newest package.
 We will get duplicated columns if the local version is the newest one.
 

---FILE: tests/testthat/test-base.R---
@@ -79,6 +79,14 @@ if (is_online()) {
     expect_true(inherits(lib_res, ""data.frame""))
     expect_error(lib_validate(checkred = TRUE))
     expect_error(lib_validate(checkred = ""ERROR""))
+    lib_res2 <- lib_validate(checkred = list(scope = c(""ERROR"", ""FAIL"")))
+    lib_res3 <- lib_validate(checkred = list(scope = c(""ERROR"", ""FAIL"", ""WARN"")))
+    lib_res4 <- lib_validate(checkred = list(scope = c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")))
+    expect_true(sum(lib_res3$checkred, na.rm = TRUE) >= sum(lib_res2$checkred, na.rm = TRUE))
+    expect_true(sum(lib_res4$checkred, na.rm = TRUE) >= sum(lib_res3$checkred, na.rm = TRUE))
+    lib_res_s1 <- lib_validate(checkred = list(scope = c(""ERROR"", ""FAIL""), flavors = cran_flavors()$Flavor[1]))
+    lib_res_s2 <- lib_validate(checkred = list(scope = c(""ERROR"", ""FAIL""), flavors = cran_flavors()$Flavor[1:4]))
+    expect_true(sum(lib_res_s2$checkred, na.rm = TRUE) >= sum(lib_res_s1$checkred, na.rm = TRUE))
   })
 
   test_that(""pacs::pac_validate"", {"
Polkas,pacs,ad31714a2a7d2bb9d5aa606099e518ad9ed33885,Maciej Nasinski,nasinski.maciej@gmail.com,2021-08-03T21:37:35Z,Maciej Nasinski,nasinski.maciej@gmail.com,2021-08-03T21:37:35Z,"namesapce functions, and small fixes",NAMESPACE;NEWS.md;R/comapre.R;R/description.R;R/namespace.R;README.md;man/pac_compare_exports.Rd;man/pac_compare_versions.Rd;man/pac_namespace.Rd;tests/testthat/test-base.R,False,True,True,False,522,26,548,"---FILE: NAMESPACE---
@@ -4,13 +4,15 @@ export(compareVersionsMax)
 export(compareVersionsMin)
 export(lib_validate)
 export(pac_checkred)
+export(pac_compare_exports)
 export(pac_compare_versions)
 export(pac_deps)
 export(pac_deps_timemachine)
 export(pac_description)
 export(pac_health)
 export(pac_last)
 export(pac_lifeduration)
+export(pac_namespace)
 export(pac_size)
 export(pac_timemachine)
 export(pac_true_size)

---FILE: NEWS.md---
@@ -3,6 +3,7 @@
 * Fixed `pac_lifeduration`, not work for old packages which do not have UTC in published Date.
 * `checkred` argument from `lib_validate` will expecting any values from `c(""ERROR"", ""FAIL"", ""WARN"", ""NOTE"")` vector.
 * Default `scope` for `pac_checkred` will be `c(""ERROR"", ""FAIL"")`.
+* Improve `pac_compare_versions`, e.g. Default old version is the local one and the new one is the last release.
 
 # 0.2.8
 

---FILE: R/comapre.R---
@@ -1,9 +1,11 @@
 #' Compare DESCRIPTION files dependencies between specific packages versions
-#' @description using the remote CRAN mirror to compare DESCRIPTION files dependencies between specific packages versions.
+#' @description using the remote github CRAN mirror to compare DESCRIPTION files dependencies between specific packages versions.
 #' @param pac character a package name.
-#' @param old character an old version of package.
-#' @param new character a new version of package.
+#' @param old character an old version of package, default local version. Default: NULL
+#' @param new character a new version of package, default newest version. Default: NULL
 #' @param fields character a vector with possible values `c(""Depends"", ""Imports"", ""LinkingTo"", ""Suggests"")`. Default: `c(""Depends"", ""Imports"", ""LinkingTo"")`
+#' @param lib.loc character. Default: NULL
+#' @param repos character the base URL of the repositories to use. Default `https://cran.rstudio.com/`
 #' @return data.frame with 4 columns.
 #' \describe{
 #' \item{Package}{character package names.}
@@ -15,25 +17,39 @@
 #' @export
 #' @examples
 #' pac_compare_versions(""memoise"", ""0.2.1"", ""2.0.0"")
+#' pac_compare_versions(""memoise"", ""0.2.1"")
 pac_compare_versions <- function(pac,
-                                 old,
-                                 new,
-                                 fields = c(""Imports"", ""Depends"", ""LinkingTo"")) {
+                                 old = NULL,
+                                 new = NULL,
+                                 fields = c(""Imports"", ""Depends"", ""LinkingTo""),
+                                 lib.loc = NULL,
+                                 repos = ""https://cran.rstudio.com/"") {
   stopifnot((length(pac) == 1) && is.character(pac))
-  stopifnot((length(old) == 1) && is.character(old))
-  stopifnot((length(new) == 1) && is.character(new))
-
+  stopifnot(is.null(old) || (length(old) == 1) && is.character(old))
+  stopifnot(is.null(new) || (length(new) == 1) && is.character(new))
   stopifnot(all(fields %in% c(""Depends"", ""Imports"", ""Suggests"", ""LinkingTo"")))
-  stopifnot(utils::compareVersion(new, old) == 1)
 
-  one_base <- paste(Filter(function(x) length(x) > 0, pac_description(pac, version = old)[fields]), collapse = "","")
+  if (is.null(old)) {
+    stopifnot(pac %in% rownames(installed_packages(lib.loc = lib.loc)))
+    old <- pac_description(pac, local = TRUE)$Version
+  }
+
+  if (is.null(new)) {
+    new <- pac_last(pac)
+  }
+
+  if (utils::compareVersion(new, old) < 0) {
+    return(data.frame())
+  }
+
+  one_base <- paste(Filter(function(x) length(x) > 0, pac_description(pac, version = old, lib.loc = lib.loc, repos = repos)[fields]), collapse = "","")
   one_e <- extract_deps(one_base)
   s_remote <- unique(data.frame(
     Package = one_e$packages[[1]], Version = replaceNA(one_e$versions[[1]], """"),
     stringsAsFactors = FALSE
   ))
 
-  two_base <- paste(Filter(function(x) length(x) > 0, pac_description(pac, version = new)[fields]), collapse = "","")
+  two_base <- paste(Filter(function(x) length(x) > 0, pac_description(pac, version = new, lib.loc = lib.loc, repos = repos)[fields]), collapse = "","")
   two_e <- extract_deps(two_base)
   s_remote2 <- unique(data.frame(
     Package = two_e$packages[[1]], Version = replaceNA(two_e$versions[[1]], """"),
@@ -47,3 +63,46 @@ pac_compare_versions <- function(pac,
   rownames(res) <- NULL
   res
 }
+
+#' Compare NAMESPACE exports between specific packages versions
+#' @description using the remote github CRAN mirror to compare NAMESPACE exports between specific packages versions.
+#' @param pac character a package name.
+#' @param old character an old version of package.
+#' @param new character a new version of package.
+#' @param lib.loc character. Default: NULL
+#' @param repos character the base URL of the repositories to use. Default `https://cran.rstudio.com/`
+#' @return list with two slots, added and removed
+#' @note The comparison is only about exports.
+#' @export
+#' @examples
+#' pac_compare_exports(""memoise"", ""0.2.1"", ""2.0.0"")
+#' pac_compare_exports(""shiny"", ""1.4.0"", ""1.6.0"")
+pac_compare_exports <- function(pac,
+                                old = NULL,
+                                new = NULL,
+                                lib.loc = NULL,
+                                repos = ""https://cran.rstudio.com/"") {
+  stopifnot((length(pac) == 1) && is.character(pac))
+  stopifnot(is.null(old) || (length(old) == 1) && is.character(old))
+  stopifnot(is.null(new) || (length(new) == 1) && is.character(new))
+
+  if (is.null(old)) {
+    stopifnot(pac %in% rownames(installed_packages(lib.loc = lib.loc)))
+    old <- pac_description(pac, local = TRUE)$Version
+  }
+
+  if (is.null(new)) {
+    new <- pac_last(pac)
+  }
+
+  if (utils::compareVersion(new, old) < 0) {
+    return(list())
+  }
+
+  old_e <- pac_namespace(pac, old, lib.loc = lib.loc, repos = repos)$exports
+  new_e <- pac_namespace(pac, new, lib.loc = lib.loc, repos = repos)$exports
+
+  cat(sprintf(""%s:%s vs %s\n"", pac, old, new))
+  list(removed = setdiff(old_e, new_e), added = setdiff(new_e, old_e))
+
+}

---FILE: R/description.R---
@@ -31,6 +31,7 @@ pac_description <- function(pac,
   }
 
   if (local && (is.null(version) || (!is.null(version) && isTRUE(utils::packageDescription(pac)$Version == version)))) {
+    if (!pac %in% installed_packages(lib.loc = lib.loc)) return(list())
     return(utils::packageDescription(pac, lib.loc))
   } else {
     pac_description_dcf(pac, version, at)
@@ -91,10 +92,14 @@ pac_description_dcf_raw <- function(pac, version, at) {
     temp_dir <- tempdir(check = TRUE)
     utils::untar(temp_tar, exdir = temp_dir)
     # tabs are not acceptable
-    as.list(read.dcf(file.path(temp_dir, pac, ""DESCRIPTION""))[1, ])
+    result <- as.list(read.dcf(file.path(temp_dir, pac, ""DESCRIPTION""))[1, ])
+    unlink(""temp_dir"", recursive = TRUE)
   } else {
-    as.list(read.dcf(ee)[1, ])
+    result <- as.list(read.dcf(ee)[1, ])
+    unlink(ee)
   }
+
+  result
 }
 
 pac_description_dcf <- memoise::memoise(pac_description_dcf_raw, cache = cachem::cache_mem(max_age = 60 * 60))

---FILE: R/namespace.R---
@@ -0,0 +1,303 @@
+#' Package NAMESPACE file
+#' @description package NAMESPACE file taken locally or remotely from GITHUB CRAN mirror or CRAN website.
+#' @param pac character a package name.
+#' @param version character package version. Default: NULL
+#' @param at Date. Default: NULL
+#' @param local logical if to use local library. Default: FALSE
+#' @param lib.loc character used optionally when local is equal TRUE. Default: NULL
+#' @param repos character the base URL of the repositories to use. Default `https://cran.rstudio.com/`
+#' @return list with names proper for DESCRIPTION file fields.
+#' @note Results are cached for 1 hour with `memoise` package.
+#' This function is mainly built under source code from `base::parseNamespaceFile`.
+#' @export
+#' @examples
+#' pac_namespace(""dplyr"", version = ""0.8.0"")
+#' pac_namespace(""dplyr"", at = as.Date(""2019-02-01""))
+#' pac_namespace(""memoise"", local = TRUE)
+#'
+pac_namespace <- function(pac, version = NULL, at = NULL, local = FALSE, lib.loc = NULL, repos = ""https://cran.rstudio.com/"") {
+  stopifnot(isFALSE(local) ||
+              (isTRUE(local) && (is.null(version) || isTRUE(utils::packageDescription(pac)$Version == version))))
+  stopifnot(all(c(is.null(version), is.null(at))) || xor(!is.null(version), !is.null(at)))
+  stopifnot(is.null(at) || inherits(at, ""Date""))
+  stopifnot(length(pac) == 1 && is.character(pac))
+  stopifnot(is.null(lib.loc) || all(lib.loc %in% .libPaths()))
+  stopifnot(is.null(version) || (length(version) == 1 && is.character(version)))
+
+  if (!pac %in% rownames(available_packages(repos = repos)) || (!is.null(version) && isTRUE(utils::compareVersion(version, pac_last(pac)) == 1))) {
+    return(list())
+  }
+
+  if (local && (is.null(version) || (!is.null(version) && isTRUE(utils::packageDescription(pac)$Version == version)))) {
+    if (!pac %in% installed_packages(lib.loc = lib.loc)) return(list())
+    namespace_lines <- readLines(system.file(package = pac, ""NAMESPACE""))
+  } else {
+    namespace_lines <- pac_readnamespace(pac, version, at)
+  }
+
+  enc <- pacs::pac_description(pac = pac, version = version, at = at, lib.loc = lib.loc, repos = repos)$Encoding
+  if (is.null(enc)) enc <- ""UTF-8""
+
+  directives <- if (!is.na(enc) && !Sys.getlocale(""LC_CTYPE"") %in%
+                    c(""C"", ""POSIX"")) {
+    lines <- namespace_lines
+    tmp <- iconv(lines, from = enc, to = """")
+    bad <- which(is.na(tmp))
+    comm <- grep(""^[[:space:]]*#"", lines[bad],
+                 invert = TRUE,
+                 useBytes = TRUE
+    )
+    if (length(bad[comm])) {
+      stop(""unable to re-encode some lines in NAMESPACE file"")
+    }
+    tmp <- iconv(lines, from = enc, to = """", sub = ""byte"")
+    con <- textConnection(tmp)
+    on.exit(close(con))
+    parse(con, keep.source = FALSE, srcfile = NULL)
+  }
+
+  exports <- character()
+  exportPatterns <- character()
+  exportClasses <- character()
+  exportClassPatterns <- character()
+  exportMethods <- character()
+  imports <- list()
+  importMethods <- list()
+  importClasses <- list()
+  dynlibs <- character()
+  nS3methods <- 1000L
+  S3methods <- matrix(NA_character_, nS3methods, 4L)
+  nS3 <- 0L
+
+  parseDirective <- function(e) {
+    asChar <- function(cc) {
+      r <- as.character(cc)
+      if (any(r == """")) {
+        stop(gettextf(
+          ""empty name in directive '%s' in 'NAMESPACE' file"",
+          as.character(e[[1L]])
+        ), domain = NA)
+      }
+      r
+    }
+    evalToChar <- function(cc) {
+      vars <- all.vars(cc)
+      names(vars) <- vars
+      as.character(eval(
+        eval(call(""substitute"", cc, as.list(vars))),
+        .GlobalEnv
+      ))
+    }
+    switch(as.character(e[[1L]]), `if` = if (eval(
+      e[[2L]],
+      .GlobalEnv
+    )) {
+      parseDirective(e[[3L]])
+    } else if (length(e) ==
+               4L) {
+      parseDirective(e[[4L]])
+    }, `{` = for (ee in as.list(e[-1L])) parseDirective(ee),
+    `=` = , `<-` = {
+      parseDirective(e[[3L]])
+      if (as.character(e[[3L]][[1L]]) == ""useDynLib"") names(dynlibs)[length(dynlibs)] <<- asChar(e[[2L]])
+    }, export = {
+      exp <- e[-1L]
+      exp <- structure(asChar(exp), names = names(exp))
+      exports <<- c(exports, exp)
+    }, exportPattern = {
+      pat <- asChar(e[-1L])
+      exportPatterns <<- c(pat, exportPatterns)
+    }, exportClassPattern = {
+      pat <- asChar(e[-1L])
+      exportClassPatterns <<- c(pat, exportClassPatterns)
+    }, exportClass = , exportClasses = {
+      exportClasses <<- c(asChar(e[-1L]), exportClasses)
+    }, exportMethods = {
+      exportMethods <<- c(asChar(e[-1L]), exportMethods)
+    }, import = {
+      except <- e$except
+      e$except <- NULL
+      pkgs <- as.list(asChar(e[-1L]))
+      if (!is.null(except)) {
+        pkgs <- lapply(pkgs, list, except = evalToChar(except))
+      }
+      imports <<- c(imports, pkgs)
+    }, importFrom = {
+      imp <- e[-1L]
+      ivars <- imp[-1L]
+      inames <- names(ivars)
+      imp <- list(asChar(imp[1L]), structure(asChar(ivars),
+                                             names = inames
+      ))
+      imports <<- c(imports, list(imp))
+    }, importClassFrom = , importClassesFrom = {
+      imp <- asChar(e[-1L])
+      pkg <- imp[[1L]]
+      impClasses <- imp[-1L]
+      imp <- list(asChar(pkg), asChar(impClasses))
+      importClasses <<- c(importClasses, list(imp))
+    }, importMethodsFrom = {
+      imp <- asChar(e[-1L])
+      pkg <- imp[[1L]]
+      impMethods <- imp[-1L]
+      imp <- list(asChar(pkg), asChar(impMethods))
+      importMethods <<- c(importMethods, list(imp))
+    }, useDynLib = {
+      dyl <- as.character(e[2L])
+      dynlibs <<- structure(c(dynlibs, dyl), names = c(
+        names(dynlibs),
+        ifelse(!is.null(names(e)) && nzchar(names(e)[2L]),
+               names(e)[2L], """"
+        )
+      ))
+      if (length(e) > 2L) {
+        symNames <- as.character(e[-c(1L, 2L)])
+        names(symNames) <- names(e[-c(1, 2)])
+        if (length(names(symNames)) == 0L) {
+          names(symNames) <- symNames
+        } else if (any(w <- names(symNames) ==
+                       """")) {
+          names(symNames)[w] <- symNames[w]
+        }
+        dup <- duplicated(names(symNames))
+        if (any(dup)) {
+          warning(gettextf(
+            ""duplicate symbol names %s in useDynLib(\""%s\"")"",
+            paste(sQuote(names(symNames)[dup]), collapse = "", ""),
+            dyl
+          ), domain = NA, call. = FALSE)
+        }
+        symNames <- symNames[!dup]
+        fixes <- c("""", """")
+        idx <- match("".fixes"", names(symNames))
+        if (!is.na(idx)) {
+          if (nzchar(symNames[idx])) {
+            e <- parse(
+              text = symNames[idx], keep.source = FALSE,
+              srcfile = NULL
+            )[[1L]]
+            if (is.call(e)) val <- eval(e, .GlobalEnv) else val <- as.character(e)
+            if (length(val)) fixes[seq_along(val)] <- val
+          }
+          symNames <- symNames[-idx]
+        }
+        useRegistration <- FALSE
+        idx <- match("".registration"", names(symNames))
+        if (!is.na(idx)) {
+          useRegistration <- as.logical(symNames[idx])
+          symNames <- symNames[-idx]
+        }
+      }
+    }, S3method = {
+      spec <- e[-1L]
+      if (length(spec) != 2L && length(spec) != 3L) {
+        stop(gettextf(
+          ""bad 'S3method' directive: %s"",
+          deparse(e)
+        ), call. = FALSE, domain = NA)
+      }
+      nS3 <<- nS3 + 1L
+      if (nS3 > nS3methods) {
+        old <- S3methods
+        nold <- nS3methods
+        nS3methods <<- nS3methods * 2L
+        new <- matrix(NA_character_, nS3methods, 4L)
+        ind <- seq_len(nold)
+        for (i in 1:4) new[ind, i] <- old[ind, i]
+        S3methods <<- new
+        rm(old, new)
+      }
+      if (is.call(gen <- spec[[1L]]) && identical(
+        as.character(gen[[1L]]),
+        ""::""
+      )) {
+        pkg <- as.character(gen[[2L]])[1L]
+        gen <- as.character(gen[[3L]])[1L]
+        S3methods[nS3, c(seq_along(spec), 4L)] <<- c(
+          gen,
+          asChar(spec[-1L]), pkg
+        )
+      } else {
+        S3methods[nS3, seq_along(spec)] <<- asChar(spec)
+      }
+    }, stop(gettextf(
+      ""unknown namespace directive: %s"",
+      deparse(e, nlines = 1L)
+    ), call. = FALSE, domain = NA)
+    )
+  }
+  for (e in directives) parseDirective(e)
+  dynlibs <- dynlibs[!duplicated(dynlibs)]
+  list(imports = imports, exports = exports, exportPatterns = unique(exportPatterns),
+       importClasses = importClasses, importMethods = importMethods,
+       exportClasses = unique(exportClasses), exportMethods = unique(exportMethods),
+       exportClassPatterns = unique(exportClassPatterns), dynlibs = dynlibs, S3methods = unique(S3methods[seq_len(nS3),
+                                                                                                          , drop = FALSE]))
+}
+
+
+pac_readnamespace_raw <- function(pac, version, at) {
+  if (!is.null(at)) {
+    tt <- pac_timemachine(pac, at = at)
+    version <- utils::tail(tt[order(tt$Life_Duration), ], 1)$Version
+  }
+
+  ee <- tempfile()
+
+  last_version <- pac_last(pac)
+
+  if (is.null(version)) {
+    version <- last_version
+  }
+
+  d_url <- sprintf(
+    ""https://raw.githubusercontent.com/cran/%s/%s/NAMESPACE"",
+    pac,
+    version
+  )
+  tt <- try(
+    {
+      suppressWarnings(utils::download.file(d_url,
+                                            destfile = ee,
+                                            quiet = TRUE
+      ))
+    },
+    silent = TRUE
+  )
+  if (inherits(tt, ""try-error"")) {
+    temp_tar <- tempfile(fileext = ""tar.gz"")
+    if (!is.null(version) && version != last_version) {
+      base_url <- sprintf(""https://cran.r-project.org/src/contrib/Archive/%s"", pac)
+    } else {
+      base_url <- ""https://cran.r-project.org/src/contrib""
+      version <- last_version
+    }
+    d_url <- sprintf(
+      ""%s/%s_%s.tar.gz"",
+      base_url,
+      pac,
+      version
+    )
+
+    download <- try({
+      utils::download.file(d_url,
+                           destfile = temp_tar,
+                           quiet = TRUE
+      )}, silent = TRUE)
+
+    if (inherits(download, ""try-error"")) return(list())
+
+    temp_dir <- tempdir(check = TRUE)
+    utils::untar(temp_tar, exdir = temp_dir)
+    # tabs are not acceptable
+    result <- readLines(file.path(temp_dir, pac, ""NAMESPACE""))
+    unlink(""temp_dir"", recursive = TRUE)
+  } else {
+    result <- readLines(ee)
+    unlink(ee)
+  }
+
+  result
+}
+
+pac_readnamespace <- memoise::memoise(pac_readnamespace_raw, cache = cachem::cache_mem(max_age = 60 * 60))

---FILE: README.md---
@@ -51,6 +51,7 @@ pacs::lib_validate()
 The full library validation require activation of two additional arguments `lifeduration` and `checkred`. Additional arguments are on default turned off as are time consuming, assessment might take even few minutes.
 
 ```r
+options(mc.cores = parallel::detectCores() - 1) # once per session
 pacs::lib_validate(lifeduration = TRUE, checkred = c(""ERROR"", ""FAIL""))
 ```
 
@@ -209,12 +210,10 @@ pacs::pac_deps(""memoise"", description_v = TRUE, recursive = FALSE)
 ```
 
 Comparing DESCRIPTION file dependencies between local and newest package.
-This might fail if you already have a newest package.
+We will get duplicated columns if the local version is the newest one.
 
 ```r
-pacs::pac_compare_versions(""shiny"", 
-                           pacs::pac_description(""shiny"", local = TRUE)$Version,
-                           pacs::pac_last(""shiny""))
+pacs::pac_compare_versions(""shiny"")
 ```
 
 Comparing DESCRIPTION file dependencies between package versions.
@@ -223,6 +222,24 @@ Comparing DESCRIPTION file dependencies between package versions.
 pacs::pac_compare_versions(""shiny"", ""1.4.0"", ""1.5.0"")
 
 pacs::pac_compare_versions(""shiny"", ""1.4.0"", ""1.6.0"")
+# to newest release
+pacs::pac_compare_versions(""shiny"", ""1.4.0"")
+```
+
+Comparing NAMESPACE exports between local and newest package.
+
+```r
+pacs::pac_compare_exports(""shiny"")
+```
+
+Comparing NAMESPACE exports between package versions.
+
+```r
+pacs::pac_compare_exports(""shiny"", ""1.4.0"", ""1.5.0"")
+
+pacs::pac_compare_exports(""shiny"", ""1.4.0"", ""1.6.0"")
+# to newest release
+pacs::pac_compare_exports(""shiny"", ""1.4.0"")
 ```
 
 ## packages versions

---FILE: man/pac_compare_exports.Rd---
@@ -0,0 +1,38 @@
+% Generated by roxygen2: do not edit by hand
+% Please edit documentation in R/comapre.R
+\name{pac_compare_exports}
+\alias{pac_compare_exports}
+\title{Compare NAMESPACE exports between specific packages versions}
+\usage{
+pac_compare_exports(
+  pac,
+  old = NULL,
+  new = NULL,
+  lib.loc = NULL,
+  repos = ""https://cran.rstudio.com/""
+)
+}
+\arguments{
+\item{pac}{character a package name.}
+
+\item{old}{character an old version of package.}
+
+\item{new}{character a new version of package.}
+
+\item{lib.loc}{character. Default: NULL}
+
+\item{repos}{character the base URL of the repositories to use. Default \verb{https://cran.rstudio.com/}}
+}
+\value{
+list with two slots, added and removed
+}
+\description{
+using the remote github CRAN mirror to compare NAMESPACE exports between specific packages versions.
+}
+\note{
+The comparison is only about exports.
+}
+\examples{
+pac_compare_exports(""memoise"", ""0.2.1"", ""2.0.0"")
+pac_compare_exports(""shiny"", ""1.4.0"", ""1.6.0"")
+}

---FILE: man/pac_compare_versions.Rd---
@@ -6,19 +6,25 @@
 \usage{
 pac_compare_versions(
   pac,
-  old,
-  new,
-  fields = c(""Imports"", ""Depends"", ""LinkingTo"")
+  old = NULL,
+  new = NULL,
+  fields = c(""Imports"", ""Depends"", ""LinkingTo""),
+  lib.loc = NULL,
+  repos = ""https://cran.rstudio.com/""
 )
 }
 \arguments{
 \item{pac}{character a package name.}
 
-\item{old}{character an old version of package.}
+\item{old}{character an old version of package, default local version. Default: NULL}
 
-\item{new}{character a new version of package.}
+\item{new}{character a new version of package, default newest version. Default: NULL}
 
 \item{fields}{character a vector with possible values \code{c(""Depends"", ""Imports"", ""LinkingTo"", ""Suggests"")}. Default: \code{c(""Depends"", ""Imports"", ""LinkingTo"")}}
+
+\item{lib.loc}{character. Default: NULL}
+
+\item{repos}{character the base URL of the repositories to use. Default \verb{https://cran.rstudio.com/}}
 }
 \value{
 data.frame with 4 columns.
@@ -31,8 +37,9 @@ data.frame with 4 columns.
 }
 }
 \description{
-using the remote CRAN mirror to compare DESCRIPTION files dependencies between specific packages versions.
+using the remote github CRAN mirror to compare DESCRIPTION files dependencies between specific packages versions.
 }
 \examples{
 pac_compare_versions(""memoise"", ""0.2.1"", ""2.0.0"")
+pac_compare_versions(""memoise"", ""0.2.1"")
 }

---FILE: man/pac_namespace.Rd---
@@ -0,0 +1,44 @@
+% Generated by roxygen2: do not edit by hand
+% Please edit documentation in R/namespace.R
+\name{pac_namespace}
+\alias{pac_namespace}
+\title{Package NAMESPACE file}
+\usage{
+pac_namespace(
+  pac,
+  version = NULL,
+  at = NULL,
+  local = FALSE,
+  lib.loc = NULL,
+  repos = ""https://cran.rstudio.com/""
+)
+}
+\arguments{
+\item{pac}{character a package name.}
+
+\item{version}{character package version. Default: NULL}
+
+\item{at}{Date. Default: NULL}
+
+\item{local}{logical if to use local library. Default: FALSE}
+
+\item{lib.loc}{character used optionally when local is equal TRUE. Default: NULL}
+
+\item{repos}{character the base URL of the repositories to use. Default \verb{https://cran.rstudio.com/}}
+}
+\value{
+list with names proper for DESCRIPTION file fields.
+}
+\description{
+package NAMESPACE file taken locally or remotely from GITHUB CRAN mirror or CRAN website.
+}
+\note{
+Results are cached for 1 hour with \code{memoise} package.
+This function is mainly built under source code from \code{base::parseNamespaceFile}
+}
+\examples{
+pac_namespace(""dplyr"", version = ""0.8.0"")
+pac_namespace(""dplyr"", at = as.Date(""2019-02-01""))
+pac_namespace(""memoise"", local = TRUE)
+
+}

---FILE: tests/testthat/test-base.R---
@@ -58,6 +58,12 @@ if (is_online()) {
     expect_true(nrow(pac_compare_versions(""memoise"", ""0.2.1"", ""2.0.0"")) == 3)
   })
 
+  test_that(""pacs::pac_compare_exports"", {
+    expect_true(length(pac_compare_exports(""memoise"", ""0.2.1"", ""2.0.0"")) == 2)
+    expect_identical(pac_compare_exports(""memoise"", ""0.2.1"", ""2.0.0"")$added, c(""cache_filesystem"", ""cache_gcs"", ""cache_memory"", ""cache_s3"",
+                                                                               ""drop_cache"", ""has_cache"", ""timeout""))
+  })
+
   test_that(""pacs::pac_deps_timemachine"", {
     expect_true(length(pac_deps_timemachine(""memoise"", ""0.2.1"")) == 1)
   })
@@ -102,17 +108,31 @@ if (is_online()) {
                                       pac_description(""memoise"", local = FALSE)$Version) %in% c(0, 1))
     expect_identical(pac_description(""dplyr"", ""1.1.1.1""), list())
     expect_identical(pac_description(""WRONG""), list())
-    expect_identical(pac_description(""dplyr"", ""0.0.0.1""), list())
+    expect_identical(suppressWarnings(pac_description(""dplyr"", ""0.0.0.1"")), list())
   })
 
   test_that(""pac_last"", {
     expect_identical(
     unname(available.packages(repos = ""https://cran.rstudio.com/"", filters = list(
-      function (db) db[db[,""Package""] == ""dplyr"", ]
+      function(db) db[db[,""Package""] == ""dplyr"", ]
     ))[""Version""]),
     pac_last(""dplyr"", repos = ""https://cran.rstudio.com/"")
     )
     expect_true(is.na(pac_last(""WRONG"")))
   })
 
+  test_that(""pac_namespace"", {
+    expect_true(length(pac_namespace(""dplyr"", version = ""0.8.0"")) == 10)
+    expect_true(length(pac_namespace(""shiny"")) > 0)
+    expect_true(length(pac_namespace(""sp"")) > 0)
+    expect_identical(sort(pac_namespace(""memoise"", local = TRUE)$exports), sort(base::getNamespaceExports(""memoise"")))
+    expect_identical(pac_namespace(""dplyr"", ""1.1.1.1""), list())
+    expect_identical(pac_namespace(""WRONG""), list())
+    expect_identical(suppressWarnings(pac_namespace(""dplyr"", ""0.0.0.1"")), list(imports = list(), exports = character(0), exportPatterns = character(0),
+                                                                               importClasses = list(), importMethods = list(), exportClasses = character(0),
+                                                                               exportMethods = character(0), exportClassPatterns = character(0),
+                                                                               dynlibs = character(0), S3methods = structure(character(0), .Dim = c(0L,
+                                                                                                                                                    4L))))
+  })
+
 }"
Polkas,pacs,6b97c8c1d617c38930191324abd627310049ca1f,Maciej Nasinski,nasinski.maciej@gmail.com,2021-08-02T16:00:43Z,Maciej Nasinski,nasinski.maciej@gmail.com,2021-08-02T16:00:43Z,fix pac_lifeduration,DESCRIPTION;NEWS.md;R/lifeduration.R,False,True,True,False,9,3,12,"---FILE: DESCRIPTION---
@@ -1,6 +1,6 @@
 Package: pacs
 Title: Supplementary Tools for R Packages Developers
-Version: 0.2.8
+Version: 0.2.9
 Authors@R: 
     person(given = ""Maciej"",
            family = ""Nasinski"",

---FILE: NEWS.md---
@@ -1,3 +1,7 @@
+# 0.2.9
+
+* Fixed `pac_lifeduration`, not work for old packages which do not have UTC in published Date.
+
 # 0.2.8
 
 * Added `pac_last` to check the most recent package version.
@@ -9,7 +13,7 @@
 * Removed all `pacs` functions, to give somebody the freedom of using different loop functions.
 * Added a hint to use `mclapply` for non Windows users.
 * Use `vapply` over the `parallel::mclapply` to be sure about the result length.
-* Added additional `ad.Date` so on older R versions binding is correct.
+* Added additional `as.Date` so on older R versions binding is correct.
 
 # 0.2.6
 

---FILE: R/lifeduration.R---
@@ -38,7 +38,9 @@ pac_lifeduration <- function(pac,
     if (is_installed) {
     descr <- utils::packageDescription(pac, lib.loc = lib.loc)
     if (isTRUE(utils::compareVersion(descr[[""Version""]], last_version) == 0)) {
-      life <- Sys.Date() - as.Date.character(as.character(descr[[""Date/Publication""]]), format = ""%Y-%m-%d %H:%M:%S UTC"")
+      base_date <- descr[[""Date/Publication""]]
+      isUTC <- grepl(""UTC"", base_date)
+      life <- Sys.Date() - as.Date.character(substr(as.character(base_date), 1, 19), format = paste0(""%Y-%m-%d %H:%M:%S""))
       return(life)
     } else {
       life <- Sys.Date() - as.Date(pac_description(pac,"
Polkas,pacs,a56d0162fd17c69b2058ef75d89fe31948fed548,Maciej Nasinski,nasinski.maciej@gmail.com,2021-07-30T08:15:30Z,Maciej Nasinski,nasinski.maciej@gmail.com,2021-07-30T08:15:30Z,small fixes,R/timemachine.R;README.md,False,True,True,False,1,11,12,"---FILE: R/timemachine.R---
@@ -92,7 +92,7 @@ pac_cran_recent <- memoise::memoise(pac_cran_recent_raw, cache = cachem::cache_m
 
 pac_archived_raw <- function(pac) {
   base_archive <- sprintf(""/src/contrib/Archive/%s/"", pac)
-  rr <- try(readLines(paste0(""https://cran.r-project.org/"", base_archive)), silent = TRUE)
+  rr <- try(readLines(paste0(""https://cran.r-project.org"", base_archive)), silent = TRUE)
 
   if (!inherits(rr, ""try-error"")) {
     rr_range <- grep(""</?table>"", rr)

---FILE: README.md---
@@ -216,16 +216,6 @@ pacs::pac_compare_versions(""shiny"", ""1.4.0"", ""1.5.0"")
 pacs::pac_compare_versions(""shiny"", ""1.4.0"", ""1.6.0"")
 ```
 
-## Packages dependencies
-
-```r
-all_deps <- pacs_deps()
-```
-
-```r
-pacs_deps(c(""stats"", ""shiny""))
-```
-
 ## packages versions
 
 Small guide how to work with packages versions (""package_version"" and ""numeric_version"" classes)."
Polkas,pacs,79a8caa1e10adb84f7042f13aea63edd3885ef39,Maciej Nasinski,nasinski.maciej@gmail.com,2021-07-29T17:37:30Z,Maciej Nasinski,nasinski.maciej@gmail.com,2021-07-29T17:37:30Z,life duration small fix 2,R/lifeduration.R,False,True,True,False,1,1,2,"---FILE: R/lifeduration.R---
@@ -47,7 +47,7 @@ pac_lifeduration <- function(pac, version = NULL, at = NULL) {
   } else {
     pac_tm <- pac_timemachine(pac)
     if (any(vapply(pac_tm$Version, function(v) isTRUE(utils::compareVersion(v, version) == 0), logical(1)))) return(NA)
-    pac_tm <- pac_tm[pac_tm$Version == version, ]
+    pac_tm <- pac_tm[vapply(pac_tm$Version, function(v) isTRUE(utils::compareVersion(v, version) == 0), logical(1)), ]
     pac_tm$Life_Duration
   }
 }"
Polkas,pacs,35f56f2d6efc017dbaa29934fbeadce927f74760,Maciej Nasinski,nasinski.maciej@gmail.com,2021-07-29T17:34:18Z,Maciej Nasinski,nasinski.maciej@gmail.com,2021-07-29T17:34:18Z,life duration small fix,R/lifeduration.R,False,True,True,False,1,1,2,"---FILE: R/lifeduration.R---
@@ -46,7 +46,7 @@ pac_lifeduration <- function(pac, version = NULL, at = NULL) {
     pac_tm$Life_Duration
   } else {
     pac_tm <- pac_timemachine(pac)
-    stopifnot(version %in% pac_tm$Version)
+    if (any(vapply(pac_tm$Version, function(v) isTRUE(utils::compareVersion(v, version) == 0), logical(1)))) return(NA)
     pac_tm <- pac_tm[pac_tm$Version == version, ]
     pac_tm$Life_Duration
   }"
Polkas,pacs,cb53347f29f1144d3b88191bb8f4e2adee7a11de,Maciej Nasinski,nasinski.maciej@gmail.com,2021-06-28T07:00:56Z,Maciej Nasinski,nasinski.maciej@gmail.com,2021-06-28T20:09:03Z,"stringAsFactors

as.character 3.6.3

hot fix

hot fix2",DESCRIPTION;R/base.R;README.md,False,True,True,False,12,8,20,"---FILE: DESCRIPTION---
@@ -1,6 +1,6 @@
 Package: pacs
 Title: utils for R packages
-Version: 0.1.0
+Version: 0.1.2
 Authors@R: 
     person(given = ""Maciej"",
            family = ""Nasinski"",

---FILE: R/base.R---
@@ -63,17 +63,17 @@ pac_deps <- function(pac,
 
   deps(pac, lib.loc, fields)
   res_df <- data.frame(
-    Package = names(paks_global),
-    Version = unlist(paks_global),
-    Package_raw = vapply(paks_global,
+    Package = as.character(names(paks_global)),
+    Version = as.character(unlist(paks_global)),
+    Package_raw = as.character(vapply(paks_global,
                        function(x) names(x),
-                       character(1)))
+                       character(1))), stringsAsFactors = FALSE)
   res_df$Version[is.na(res_df$Version)] <- """"
   if (attr) {
     attr(res_df, ""Package"") <- pac
     attr(res_df, ""Version"") <- pac_v
   } else {
-    base_package <- data.frame(Package = pac, Version = as.character(pac_v), Package_raw = """")
+    base_package <- data.frame(Package = pac, Version = as.character(pac_v), Package_raw = """", stringsAsFactors = FALSE)
     res_df <- rbind(res_df, base_package)
   }
 
@@ -250,7 +250,10 @@ validate_lib <- function(lib.loc = NULL) {
   pp <- pacs_deps(lib.loc = lib.loc)
 
   ii_df <- as.data.frame(utils::installed.packages(lib.loc = lib.loc))
-  ii_res <-  rbind(stats::aggregate(ii_df[, c(""Version""), drop = FALSE], list(Package = ii_df$Package), function(x) x[1]),
+  ii_agg <- stats::aggregate(ii_df[, c(""Version""), drop = FALSE], list(Package = ii_df$Package), function(x) x[1])
+  ii_agg$Version <- as.character(ii_agg$Version)
+  ii_agg$Package <- as.character(ii_agg$Package)
+  ii_res <-  rbind(ii_agg,
                    c(""R"", paste(R.Version()[c(""major"", ""minor"")], collapse = ""."")))
 
   res <- merge(ii_res, pp, by = c(""Package""), suffix = c("".have"", "".minimal""), all = TRUE)

---FILE: README.md---
@@ -103,7 +103,8 @@ pacs_deps(c(""stats"", ""shiny""))
 ```r
 # Test with adding older cachem than extected
 withr::with_temp_libpaths({
-devtools::install_version(""cachem"", ""1.0.0"")
+devtools::install_version(""shiny"", ""1.4.0-2"")
+devtools::install_version(""rlang"", ""0.4.6"")
 pacs::validate_lib()
 })
 ```"
